This file is a merged representation of the entire codebase, combined into a single document by Repomix.
The content has been processed where security check has been disabled.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Security check has been disabled - content may contain sensitive information
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
backend/
  prisma/
    migrations/
      20251207194046_init/
        migration.sql
      migration_lock.toml
    schema.prisma
  scripts/
    setup-garage.sh
    setup-test-data.ts
  src/
    controllers/
      adminReferral.controller.ts
      auth.controller.ts
      client.controller.ts
      clientAuth.controller.ts
      dashboard.controller.ts
      dietPlan.controller.ts
      foodItem.controller.ts
      meal.controller.ts
      mealLog.controller.ts
      organization.controller.ts
      referral.controller.ts
      reports.controller.ts
      share.controller.ts
      team.controller.ts
      weightLog.controller.ts
    errors/
      AppError.ts
    middleware/
      auth.middleware.ts
      clientAuth.middleware.ts
      errorHandler.ts
      testAuth.middleware.ts
      upload.middleware.ts
      validation.middleware.ts
    routes/
      adminReferral.routes.ts
      auth.routes.ts
      client.routes.ts
      clientApi.routes.ts
      clientAuth.routes.ts
      dashboard.routes.ts
      dietPlan.routes.ts
      foodItem.routes.ts
      meal.routes.ts
      mealLog.routes.ts
      media.routes.ts
      organization.routes.ts
      referral.routes.ts
      reports.routes.ts
      share.routes.ts
      team.routes.ts
      weightLog.routes.ts
    schemas/
      client.schema.ts
      dietPlan.schema.ts
      foodItem.schema.ts
      mealLog.schema.ts
      organization.schema.ts
      weightLog.schema.ts
    services/
      storage.service.ts
    types/
      auth.types.ts
    utils/
      asyncHandler.ts
      emailService.ts
      logger.ts
      pdfGenerator.ts
      prisma.ts
    app.ts
    server.ts
  .env.example
  .gitignore
  package.json
  prisma.config.ts
  tsconfig.json
client-app/
  app/
    (auth)/
      _layout.tsx
      login.tsx
      verify.tsx
    (tabs)/
      home/
        meal/
          [id].tsx
        _layout.tsx
        index.tsx
      notifications/
        _layout.tsx
        index.tsx
      profile/
        _layout.tsx
        index.tsx
        referral.tsx
        reports.tsx
      progress/
        _layout.tsx
        index.tsx
      weight/
        _layout.tsx
        index.tsx
      _layout.tsx
    _layout.tsx
    index.tsx
  assets/
    adaptive-icon.png
    favicon.png
    icon.png
    splash-icon.png
  components/
    BottomTabBar.tsx
    MealCard.tsx
  constants/
    theme.ts
  hooks/
    useAuth.ts
    useMealLog.ts
    useMeals.ts
    useWeight.ts
  services/
    api.ts
  store/
    authStore.ts
  types/
    index.ts
  .gitignore
  .npmrc
  app.json
  package.json
  tsconfig.json
Design/
  mobileapp/
    dietician's_remark_detail/
      code.html
      screen.png
    home_/
      _today’s_meals/
        code.html
        screen.png
    log_meal_screen/
      code.html
      screen.png
    notifications_(inbox)/
      code.html
      screen.png
    progress_tab/
      code.html
      screen.png
    settings/
      profile/
        code.html
        screen.png
    weight_tracking/
      code.html
      screen.png
  website/
    Design/
      analytics/
        progress/
          code.html
          screen.png
      client_list/
        code.html
        screen.png
      client_profile_view/
        code.html
        screen.png
      dashboard_home/
        code.html
        screen.png
      diet_options_library/
        code.html
        screen.png
      diet_plan_builder_flow/
        code.html
        screen.png
      diet_plan_creation_page_1/
        code.html
        screen.png
      diet_plan_creation_page_2/
        code.html
        screen.png
      diet_plan_creation_page_3/
        code.html
        screen.png
      landingpage/
        code.html
        screen.png
      meal_photo_review_queue/
        code.html
        screen.png
      team_dieticians/
        code.html
        screen.png
Docs/
  APIroutes.md
  database_schema.md
  dietconnect_prd.md
frontend/
  src/
    app/
      dashboard/
        analytics/
          page.tsx
        clients/
          [id]/
            page.tsx
          new/
            page.tsx
          page.tsx
        diet-plans/
          [id]/
            page.tsx
          new/
            page.tsx
          page.tsx
        food-library/
          page.tsx
        referrals/
          page.tsx
        reviews/
          page.tsx
        settings/
          page.tsx
        team/
          page.tsx
        layout.tsx
        page.tsx
      fonts/
        GeistMonoVF.woff
        GeistVF.woff
      join/
        page.tsx
      sign-in/
        [[...sign-in]]/
          page.tsx
      sign-up/
        [[...sign-up]]/
          page.tsx
      favicon.ico
      globals.css
      layout.tsx
      page.tsx
      providers.tsx
    components/
      modals/
        add-client-modal.tsx
        add-food-modal.tsx
        create-food-item-modal.tsx
        invite-member-modal.tsx
      ui/
        modal.tsx
    lib/
      api/
        client.ts
        use-api-client.ts
      hooks/
        use-clients.ts
        use-dashboard.ts
        use-diet-plans.ts
        use-food-items.ts
        use-meal-logs.ts
        use-profile.ts
        use-team.ts
      utils.ts
    middleware.ts
  .env.local.example
  .eslintrc.json
  .gitignore
  next.config.mjs
  package.json
  postcss.config.mjs
  README.md
  tailwind.config.ts
  tsconfig.json
info.txt
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="backend/prisma/migrations/20251207194046_init/migration.sql">
-- CreateEnum
CREATE TYPE "public"."SubscriptionTier" AS ENUM ('free', 'pro', 'clinic', 'enterprise');

-- CreateEnum
CREATE TYPE "public"."SubscriptionStatus" AS ENUM ('active', 'paused', 'cancelled');

-- CreateEnum
CREATE TYPE "public"."UserRole" AS ENUM ('owner', 'admin', 'dietitian');

-- CreateEnum
CREATE TYPE "public"."Gender" AS ENUM ('male', 'female', 'other');

-- CreateEnum
CREATE TYPE "public"."ActivityLevel" AS ENUM ('sedentary', 'lightly_active', 'moderately_active', 'very_active');

-- CreateEnum
CREATE TYPE "public"."DietPlanStatus" AS ENUM ('draft', 'active', 'completed', 'paused');

-- CreateEnum
CREATE TYPE "public"."DietPlanVisibility" AS ENUM ('private', 'org_shared', 'public');

-- CreateEnum
CREATE TYPE "public"."MealType" AS ENUM ('breakfast', 'lunch', 'snack', 'dinner');

-- CreateEnum
CREATE TYPE "public"."MealLogStatus" AS ENUM ('pending', 'eaten', 'skipped', 'substituted');

-- CreateEnum
CREATE TYPE "public"."NoteType" AS ENUM ('SOAP', 'DAP', 'other');

-- CreateEnum
CREATE TYPE "public"."RecipientType" AS ENUM ('user', 'client');

-- CreateEnum
CREATE TYPE "public"."DeliveryStatus" AS ENUM ('pending', 'delivered', 'failed');

-- CreateEnum
CREATE TYPE "public"."InvoiceStatus" AS ENUM ('unpaid', 'sent', 'paid', 'cancelled');

-- CreateTable
CREATE TABLE "public"."Organization" (
    "id" TEXT NOT NULL,
    "name" TEXT NOT NULL,
    "description" TEXT,
    "logoUrl" TEXT,
    "phone" TEXT,
    "email" TEXT,
    "address" TEXT,
    "city" TEXT,
    "country" TEXT NOT NULL DEFAULT 'IN',
    "timezone" TEXT NOT NULL DEFAULT 'Asia/Kolkata',
    "subscriptionTier" "public"."SubscriptionTier" NOT NULL DEFAULT 'free',
    "subscriptionStatus" "public"."SubscriptionStatus" NOT NULL DEFAULT 'active',
    "subscriptionExpiresAt" TIMESTAMP(3),
    "maxClients" INTEGER NOT NULL DEFAULT 10,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "deletedAt" TIMESTAMP(3),
    "isActive" BOOLEAN NOT NULL DEFAULT true,

    CONSTRAINT "Organization_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."User" (
    "id" TEXT NOT NULL,
    "orgId" TEXT NOT NULL,
    "clerkUserId" TEXT,
    "role" "public"."UserRole" NOT NULL,
    "email" TEXT NOT NULL,
    "fullName" TEXT NOT NULL,
    "phone" TEXT,
    "profilePhotoUrl" TEXT,
    "licenseNumber" TEXT,
    "specialization" TEXT,
    "bio" TEXT,
    "mfaEnabled" BOOLEAN NOT NULL DEFAULT false,
    "lastLoginAt" TIMESTAMP(3),
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "deletedAt" TIMESTAMP(3),
    "isActive" BOOLEAN NOT NULL DEFAULT true,

    CONSTRAINT "User_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."Client" (
    "id" TEXT NOT NULL,
    "orgId" TEXT NOT NULL,
    "primaryDietitianId" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "phone" TEXT NOT NULL,
    "fullName" TEXT NOT NULL,
    "dateOfBirth" DATE,
    "gender" "public"."Gender",
    "profilePhotoUrl" TEXT,
    "heightCm" DECIMAL(5,2),
    "currentWeightKg" DECIMAL(5,2),
    "targetWeightKg" DECIMAL(5,2),
    "activityLevel" "public"."ActivityLevel",
    "dietaryPreferences" TEXT[],
    "allergies" TEXT[],
    "medicalConditions" TEXT[],
    "medications" TEXT[],
    "healthNotes" TEXT,
    "emergencyContactName" TEXT,
    "emergencyContactPhone" TEXT,
    "onboardingCompleted" BOOLEAN NOT NULL DEFAULT false,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "deletedAt" TIMESTAMP(3),
    "createdByUserId" TEXT,
    "isActive" BOOLEAN NOT NULL DEFAULT true,

    CONSTRAINT "Client_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."MedicalProfile" (
    "id" TEXT NOT NULL,
    "clientId" TEXT NOT NULL,
    "diagnoses" TEXT[],
    "allergies" TEXT[],
    "intolerances" TEXT[],
    "medications" TEXT[],
    "supplements" TEXT[],
    "surgeries" TEXT[],
    "familyHistory" TEXT,
    "healthNotes" TEXT,
    "dietaryRestrictions" TEXT,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "updatedByUserId" TEXT,

    CONSTRAINT "MedicalProfile_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."DietPlan" (
    "id" TEXT NOT NULL,
    "orgId" TEXT NOT NULL,
    "clientId" TEXT NOT NULL,
    "createdByUserId" TEXT NOT NULL,
    "name" TEXT NOT NULL,
    "description" TEXT,
    "startDate" DATE NOT NULL,
    "endDate" DATE,
    "targetCalories" INTEGER,
    "targetProteinG" DECIMAL(5,1),
    "targetCarbsG" DECIMAL(5,1),
    "targetFatsG" DECIMAL(5,1),
    "targetFiberG" DECIMAL(5,1),
    "notesForClient" TEXT,
    "internalNotes" TEXT,
    "status" "public"."DietPlanStatus" NOT NULL DEFAULT 'draft',
    "isTemplate" BOOLEAN NOT NULL DEFAULT false,
    "templateCategory" TEXT,
    "visibility" "public"."DietPlanVisibility" NOT NULL DEFAULT 'private',
    "publishedAt" TIMESTAMP(3),
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "deletedAt" TIMESTAMP(3),
    "isActive" BOOLEAN NOT NULL DEFAULT true,

    CONSTRAINT "DietPlan_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."Meal" (
    "id" TEXT NOT NULL,
    "planId" TEXT NOT NULL,
    "dayOfWeek" INTEGER,
    "mealDate" DATE,
    "sequenceNumber" INTEGER,
    "mealType" "public"."MealType" NOT NULL,
    "timeOfDay" TEXT,
    "name" TEXT NOT NULL,
    "description" TEXT,
    "instructions" TEXT,
    "servingSizeNotes" TEXT,
    "totalCalories" INTEGER,
    "totalProteinG" DECIMAL(5,1),
    "totalCarbsG" DECIMAL(5,1),
    "totalFatsG" DECIMAL(5,1),
    "totalFiberG" DECIMAL(5,1),
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "Meal_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."FoodItem" (
    "id" TEXT NOT NULL,
    "orgId" TEXT,
    "name" TEXT NOT NULL,
    "brand" TEXT,
    "category" TEXT NOT NULL,
    "subCategory" TEXT,
    "servingSizeG" DECIMAL(6,2) NOT NULL DEFAULT 100,
    "calories" INTEGER NOT NULL,
    "proteinG" DECIMAL(5,1),
    "carbsG" DECIMAL(5,1),
    "fatsG" DECIMAL(5,1),
    "fiberG" DECIMAL(5,1),
    "sodiumMg" DECIMAL(7,2),
    "sugarG" DECIMAL(5,1),
    "isVerified" BOOLEAN NOT NULL DEFAULT false,
    "source" TEXT,
    "barcode" TEXT,
    "allergenFlags" TEXT[],
    "dietaryTags" TEXT[],
    "createdByUserId" TEXT,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "FoodItem_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."MealFoodItem" (
    "id" TEXT NOT NULL,
    "mealId" TEXT NOT NULL,
    "foodId" TEXT NOT NULL,
    "quantityG" DECIMAL(6,2) NOT NULL,
    "calories" INTEGER,
    "proteinG" DECIMAL(5,1),
    "carbsG" DECIMAL(5,1),
    "fatsG" DECIMAL(5,1),
    "fiberG" DECIMAL(5,1),
    "sortOrder" INTEGER NOT NULL DEFAULT 0,
    "notes" TEXT,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "MealFoodItem_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."MealLog" (
    "id" TEXT NOT NULL,
    "orgId" TEXT NOT NULL,
    "clientId" TEXT NOT NULL,
    "mealId" TEXT NOT NULL,
    "scheduledDate" DATE NOT NULL,
    "scheduledTime" TEXT,
    "status" "public"."MealLogStatus" NOT NULL DEFAULT 'pending',
    "mealPhotoUrl" TEXT,
    "mealPhotoSmallUrl" TEXT,
    "photoUploadedAt" TIMESTAMP(3),
    "aiFoodRecognition" JSONB,
    "clientNotes" TEXT,
    "dietitianFeedback" TEXT,
    "dietitianFeedbackAt" TIMESTAMP(3),
    "reviewedByUserId" TEXT,
    "substituteDescription" TEXT,
    "substituteCaloriesEst" INTEGER,
    "loggedAt" TIMESTAMP(3),
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "MealLog_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."WeightLog" (
    "id" TEXT NOT NULL,
    "orgId" TEXT NOT NULL,
    "clientId" TEXT NOT NULL,
    "weightKg" DECIMAL(5,2) NOT NULL,
    "logDate" DATE NOT NULL,
    "logTime" TEXT,
    "notes" TEXT,
    "progressPhotoUrl" TEXT,
    "bmi" DECIMAL(4,2),
    "weightChangeFromPrevious" DECIMAL(5,2),
    "isOutlier" BOOLEAN NOT NULL DEFAULT false,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "WeightLog_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."BodyMeasurement" (
    "id" TEXT NOT NULL,
    "orgId" TEXT NOT NULL,
    "clientId" TEXT NOT NULL,
    "logDate" DATE NOT NULL,
    "chestCm" DECIMAL(5,2),
    "waistCm" DECIMAL(5,2),
    "hipsCm" DECIMAL(5,2),
    "thighsCm" DECIMAL(5,2),
    "armsCm" DECIMAL(5,2),
    "bodyFatPercentage" DECIMAL(4,2),
    "notes" TEXT,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "BodyMeasurement_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."SessionNote" (
    "id" TEXT NOT NULL,
    "orgId" TEXT NOT NULL,
    "clientId" TEXT NOT NULL,
    "createdByUserId" TEXT NOT NULL,
    "noteType" "public"."NoteType" NOT NULL,
    "title" TEXT NOT NULL,
    "subjective" TEXT,
    "objective" TEXT,
    "assessment" TEXT,
    "plan" TEXT,
    "internalNotes" TEXT,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "deletedAt" TIMESTAMP(3),

    CONSTRAINT "SessionNote_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."Notification" (
    "id" TEXT NOT NULL,
    "recipientId" TEXT NOT NULL,
    "recipientType" "public"."RecipientType" NOT NULL,
    "orgId" TEXT NOT NULL,
    "type" TEXT NOT NULL,
    "category" TEXT,
    "title" TEXT NOT NULL,
    "message" TEXT NOT NULL,
    "icon" TEXT,
    "deepLink" TEXT,
    "relatedEntityType" TEXT,
    "relatedEntityId" TEXT,
    "isRead" BOOLEAN NOT NULL DEFAULT false,
    "readAt" TIMESTAMP(3),
    "sentViaChannels" TEXT[] DEFAULT ARRAY['push']::TEXT[],
    "deliveryStatus" "public"."DeliveryStatus" NOT NULL DEFAULT 'pending',
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "expiresAt" TIMESTAMP(3) NOT NULL DEFAULT NOW() + INTERVAL '30 days',

    CONSTRAINT "Notification_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."ActivityLog" (
    "id" TEXT NOT NULL,
    "orgId" TEXT NOT NULL,
    "userId" TEXT,
    "userType" TEXT,
    "action" TEXT NOT NULL,
    "entityType" TEXT,
    "entityId" TEXT,
    "oldValues" JSONB,
    "newValues" JSONB,
    "changeDesc" TEXT,
    "ipAddress" TEXT,
    "userAgent" TEXT,
    "status" TEXT NOT NULL DEFAULT 'success',
    "errorMessage" TEXT,
    "metadata" JSONB,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "ActivityLog_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "public"."Invoice" (
    "id" TEXT NOT NULL,
    "orgId" TEXT NOT NULL,
    "clientId" TEXT NOT NULL,
    "createdByUserId" TEXT NOT NULL,
    "invoiceNumber" TEXT NOT NULL,
    "issueDate" DATE NOT NULL,
    "dueDate" DATE NOT NULL,
    "currency" TEXT NOT NULL DEFAULT 'INR',
    "subtotal" DECIMAL(10,2) NOT NULL,
    "tax" DECIMAL(10,2) NOT NULL DEFAULT 0,
    "total" DECIMAL(10,2) NOT NULL,
    "status" "public"."InvoiceStatus" NOT NULL DEFAULT 'unpaid',
    "notes" TEXT,
    "sentAt" TIMESTAMP(3),
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "Invoice_pkey" PRIMARY KEY ("id")
);

-- CreateIndex
CREATE UNIQUE INDEX "Organization_name_key" ON "public"."Organization"("name");

-- CreateIndex
CREATE INDEX "Organization_subscriptionStatus_idx" ON "public"."Organization"("subscriptionStatus");

-- CreateIndex
CREATE INDEX "Organization_isActive_idx" ON "public"."Organization"("isActive");

-- CreateIndex
CREATE UNIQUE INDEX "User_clerkUserId_key" ON "public"."User"("clerkUserId");

-- CreateIndex
CREATE INDEX "User_orgId_idx" ON "public"."User"("orgId");

-- CreateIndex
CREATE INDEX "User_clerkUserId_idx" ON "public"."User"("clerkUserId");

-- CreateIndex
CREATE INDEX "User_role_idx" ON "public"."User"("role");

-- CreateIndex
CREATE UNIQUE INDEX "User_orgId_email_key" ON "public"."User"("orgId", "email");

-- CreateIndex
CREATE INDEX "Client_orgId_idx" ON "public"."Client"("orgId");

-- CreateIndex
CREATE INDEX "Client_primaryDietitianId_idx" ON "public"."Client"("primaryDietitianId");

-- CreateIndex
CREATE INDEX "Client_isActive_idx" ON "public"."Client"("isActive");

-- CreateIndex
CREATE UNIQUE INDEX "Client_orgId_email_key" ON "public"."Client"("orgId", "email");

-- CreateIndex
CREATE UNIQUE INDEX "MedicalProfile_clientId_key" ON "public"."MedicalProfile"("clientId");

-- CreateIndex
CREATE INDEX "MedicalProfile_clientId_idx" ON "public"."MedicalProfile"("clientId");

-- CreateIndex
CREATE INDEX "DietPlan_orgId_idx" ON "public"."DietPlan"("orgId");

-- CreateIndex
CREATE INDEX "DietPlan_clientId_idx" ON "public"."DietPlan"("clientId");

-- CreateIndex
CREATE INDEX "DietPlan_status_idx" ON "public"."DietPlan"("status");

-- CreateIndex
CREATE INDEX "DietPlan_isTemplate_idx" ON "public"."DietPlan"("isTemplate");

-- CreateIndex
CREATE INDEX "Meal_planId_idx" ON "public"."Meal"("planId");

-- CreateIndex
CREATE INDEX "Meal_mealDate_idx" ON "public"."Meal"("mealDate");

-- CreateIndex
CREATE INDEX "FoodItem_orgId_idx" ON "public"."FoodItem"("orgId");

-- CreateIndex
CREATE INDEX "FoodItem_category_idx" ON "public"."FoodItem"("category");

-- CreateIndex
CREATE INDEX "MealFoodItem_mealId_idx" ON "public"."MealFoodItem"("mealId");

-- CreateIndex
CREATE INDEX "MealFoodItem_foodId_idx" ON "public"."MealFoodItem"("foodId");

-- CreateIndex
CREATE INDEX "MealLog_orgId_idx" ON "public"."MealLog"("orgId");

-- CreateIndex
CREATE INDEX "MealLog_clientId_idx" ON "public"."MealLog"("clientId");

-- CreateIndex
CREATE INDEX "MealLog_scheduledDate_idx" ON "public"."MealLog"("scheduledDate");

-- CreateIndex
CREATE INDEX "MealLog_status_idx" ON "public"."MealLog"("status");

-- CreateIndex
CREATE INDEX "WeightLog_orgId_idx" ON "public"."WeightLog"("orgId");

-- CreateIndex
CREATE INDEX "WeightLog_clientId_idx" ON "public"."WeightLog"("clientId");

-- CreateIndex
CREATE UNIQUE INDEX "WeightLog_clientId_logDate_key" ON "public"."WeightLog"("clientId", "logDate");

-- CreateIndex
CREATE INDEX "BodyMeasurement_orgId_idx" ON "public"."BodyMeasurement"("orgId");

-- CreateIndex
CREATE INDEX "BodyMeasurement_clientId_idx" ON "public"."BodyMeasurement"("clientId");

-- CreateIndex
CREATE INDEX "SessionNote_orgId_idx" ON "public"."SessionNote"("orgId");

-- CreateIndex
CREATE INDEX "SessionNote_clientId_idx" ON "public"."SessionNote"("clientId");

-- CreateIndex
CREATE INDEX "Notification_recipientId_recipientType_idx" ON "public"."Notification"("recipientId", "recipientType");

-- CreateIndex
CREATE INDEX "Notification_isRead_idx" ON "public"."Notification"("isRead");

-- CreateIndex
CREATE INDEX "Notification_orgId_idx" ON "public"."Notification"("orgId");

-- CreateIndex
CREATE INDEX "ActivityLog_orgId_idx" ON "public"."ActivityLog"("orgId");

-- CreateIndex
CREATE INDEX "ActivityLog_userId_idx" ON "public"."ActivityLog"("userId");

-- CreateIndex
CREATE INDEX "ActivityLog_action_idx" ON "public"."ActivityLog"("action");

-- CreateIndex
CREATE UNIQUE INDEX "Invoice_invoiceNumber_key" ON "public"."Invoice"("invoiceNumber");

-- CreateIndex
CREATE INDEX "Invoice_orgId_idx" ON "public"."Invoice"("orgId");

-- CreateIndex
CREATE INDEX "Invoice_clientId_idx" ON "public"."Invoice"("clientId");

-- CreateIndex
CREATE INDEX "Invoice_status_idx" ON "public"."Invoice"("status");

-- AddForeignKey
ALTER TABLE "public"."User" ADD CONSTRAINT "User_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."Client" ADD CONSTRAINT "Client_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."Client" ADD CONSTRAINT "Client_primaryDietitianId_fkey" FOREIGN KEY ("primaryDietitianId") REFERENCES "public"."User"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."MedicalProfile" ADD CONSTRAINT "MedicalProfile_clientId_fkey" FOREIGN KEY ("clientId") REFERENCES "public"."Client"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."DietPlan" ADD CONSTRAINT "DietPlan_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."DietPlan" ADD CONSTRAINT "DietPlan_clientId_fkey" FOREIGN KEY ("clientId") REFERENCES "public"."Client"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."DietPlan" ADD CONSTRAINT "DietPlan_createdByUserId_fkey" FOREIGN KEY ("createdByUserId") REFERENCES "public"."User"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."Meal" ADD CONSTRAINT "Meal_planId_fkey" FOREIGN KEY ("planId") REFERENCES "public"."DietPlan"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."FoodItem" ADD CONSTRAINT "FoodItem_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."FoodItem" ADD CONSTRAINT "FoodItem_createdByUserId_fkey" FOREIGN KEY ("createdByUserId") REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."MealFoodItem" ADD CONSTRAINT "MealFoodItem_mealId_fkey" FOREIGN KEY ("mealId") REFERENCES "public"."Meal"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."MealFoodItem" ADD CONSTRAINT "MealFoodItem_foodId_fkey" FOREIGN KEY ("foodId") REFERENCES "public"."FoodItem"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."MealLog" ADD CONSTRAINT "MealLog_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."MealLog" ADD CONSTRAINT "MealLog_clientId_fkey" FOREIGN KEY ("clientId") REFERENCES "public"."Client"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."MealLog" ADD CONSTRAINT "MealLog_mealId_fkey" FOREIGN KEY ("mealId") REFERENCES "public"."Meal"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."MealLog" ADD CONSTRAINT "MealLog_reviewedByUserId_fkey" FOREIGN KEY ("reviewedByUserId") REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."WeightLog" ADD CONSTRAINT "WeightLog_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."WeightLog" ADD CONSTRAINT "WeightLog_clientId_fkey" FOREIGN KEY ("clientId") REFERENCES "public"."Client"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."BodyMeasurement" ADD CONSTRAINT "BodyMeasurement_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."BodyMeasurement" ADD CONSTRAINT "BodyMeasurement_clientId_fkey" FOREIGN KEY ("clientId") REFERENCES "public"."Client"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."SessionNote" ADD CONSTRAINT "SessionNote_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."SessionNote" ADD CONSTRAINT "SessionNote_clientId_fkey" FOREIGN KEY ("clientId") REFERENCES "public"."Client"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."SessionNote" ADD CONSTRAINT "SessionNote_createdByUserId_fkey" FOREIGN KEY ("createdByUserId") REFERENCES "public"."User"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."Notification" ADD CONSTRAINT "Notification_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."ActivityLog" ADD CONSTRAINT "ActivityLog_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."ActivityLog" ADD CONSTRAINT "ActivityLog_userId_fkey" FOREIGN KEY ("userId") REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."Invoice" ADD CONSTRAINT "Invoice_orgId_fkey" FOREIGN KEY ("orgId") REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."Invoice" ADD CONSTRAINT "Invoice_clientId_fkey" FOREIGN KEY ("clientId") REFERENCES "public"."Client"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "public"."Invoice" ADD CONSTRAINT "Invoice_createdByUserId_fkey" FOREIGN KEY ("createdByUserId") REFERENCES "public"."User"("id") ON DELETE RESTRICT ON UPDATE CASCADE;
</file>

<file path="backend/prisma/migrations/migration_lock.toml">
# Please do not edit this file manually
# It should be added in your version-control system (e.g., Git)
provider = "postgresql"
</file>

<file path="backend/prisma/schema.prisma">
// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum SubscriptionTier {
  free
  pro
  clinic
  enterprise
}

enum SubscriptionStatus {
  active
  paused
  cancelled
}

enum UserRole {
  owner
  admin
  dietitian
}

enum Gender {
  male
  female
  other
}

enum ActivityLevel {
  sedentary
  lightly_active
  moderately_active
  very_active
}

enum DietPlanStatus {
  draft
  active
  completed
  paused
}

enum DietPlanVisibility {
  private
  org_shared
  public
}

enum MealType {
  breakfast
  lunch
  snack
  dinner
}

enum MealLogStatus {
  pending
  eaten
  skipped
  substituted
}

enum NoteType {
  SOAP
  DAP
  other
}

enum RecipientType {
  user
  client
}

enum DeliveryStatus {
  pending
  delivered
  failed
}

enum InvoiceStatus {
  unpaid
  sent
  paid
  cancelled
}

enum ReferralSource {
  doctor
  dietitian
  client_referral
  social_media
  website
  other
}

// ============ MODELS ============

model Organization {
  id                    String             @id @default(uuid())
  name                  String             @unique
  description           String?
  logoUrl               String?
  phone                 String?
  email                 String?
  address               String?
  city                  String?
  country               String             @default("IN")
  timezone              String             @default("Asia/Kolkata")
  subscriptionTier      SubscriptionTier   @default(free)
  subscriptionStatus    SubscriptionStatus @default(active)
  subscriptionExpiresAt DateTime?
  maxClients            Int                @default(10)
  createdAt             DateTime           @default(now())
  updatedAt             DateTime           @updatedAt
  deletedAt             DateTime?
  isActive              Boolean            @default(true)

  // Relations
  users            User[]
  clients          Client[]
  dietPlans        DietPlan[]
  foodItems        FoodItem[]
  mealLogs         MealLog[]
  weightLogs       WeightLog[]
  bodyMeasurements BodyMeasurement[]
  sessionNotes     SessionNote[]
  notifications    Notification[]
  activityLogs     ActivityLog[]
  invoices         Invoice[]
  invitations      Invitation[]
  clientReports    ClientReport[]

  @@index([subscriptionStatus])
  @@index([isActive])
}

model User {
  id              String    @id @default(uuid())
  orgId           String
  clerkUserId     String?   @unique
  role            UserRole
  email           String
  fullName        String
  phone           String?
  profilePhotoUrl String?
  licenseNumber   String?
  specialization  String?
  bio             String?
  mfaEnabled      Boolean   @default(false)
  lastLoginAt     DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  deletedAt       DateTime?
  isActive        Boolean   @default(true)

  // Relations
  organization        Organization  @relation(fields: [orgId], references: [id], onDelete: Cascade)
  clientsPrimary      Client[]      @relation("PrimaryDietitian")
  createdDietPlans    DietPlan[]    @relation("DietPlanCreator")
  createdFoodItems    FoodItem[]    @relation("FoodItemCreator")
  reviewedMealLogs    MealLog[]     @relation("MealLogReviewer")
  createdSessionNotes SessionNote[] @relation("SessionNoteCreator")
  createdInvoices     Invoice[]     @relation("InvoiceCreator")
  activityLogs        ActivityLog[] @relation("UserActivityLog")

  @@unique([orgId, email])
  @@index([orgId])
  @@index([clerkUserId])
  @@index([role])
}

model Client {
  id                    String         @id @default(uuid())
  orgId                 String
  primaryDietitianId    String
  email                 String
  phone                 String
  fullName              String
  dateOfBirth           DateTime?      @db.Date
  gender                Gender?
  profilePhotoUrl       String?
  heightCm              Decimal?       @db.Decimal(5, 2)
  currentWeightKg       Decimal?       @db.Decimal(5, 2)
  targetWeightKg        Decimal?       @db.Decimal(5, 2)
  activityLevel         ActivityLevel?
  dietaryPreferences    String[]
  allergies             String[]
  medicalConditions     String[]
  medications           String[]
  healthNotes           String?
  emergencyContactName  String?
  emergencyContactPhone String?
  onboardingCompleted   Boolean        @default(false)
  createdAt             DateTime       @default(now())
  updatedAt             DateTime       @updatedAt
  deletedAt             DateTime?
  createdByUserId       String?
  isActive              Boolean        @default(true)

  // Referral tracking
  referralSource      ReferralSource?
  referralSourceName  String? // Doctor/Dietitian name if applicable
  referralSourcePhone String? // Contact phone for referrer
  referralCode        String?         @unique
  referredByClientId  String?

  // Relations
  organization     Organization      @relation(fields: [orgId], references: [id], onDelete: Cascade)
  primaryDietitian User              @relation("PrimaryDietitian", fields: [primaryDietitianId], references: [id])
  medicalProfile   MedicalProfile?
  dietPlans        DietPlan[]
  mealLogs         MealLog[]
  weightLogs       WeightLog[]
  bodyMeasurements BodyMeasurement[]
  sessionNotes     SessionNote[]
  invoices         Invoice[]
  referralBenefit  ReferralBenefit?
  clientReports    ClientReport[]

  // Self-referential relation for client referrals
  referredByClient Client?  @relation("ClientReferrals", fields: [referredByClientId], references: [id])
  referredClients  Client[] @relation("ClientReferrals")

  @@unique([orgId, email])
  @@index([orgId])
  @@index([primaryDietitianId])
  @@index([isActive])
  @@index([referralCode])
  @@index([referredByClientId])
}

model MedicalProfile {
  id                  String   @id @default(uuid())
  clientId            String   @unique
  diagnoses           String[]
  allergies           String[]
  intolerances        String[]
  medications         String[]
  supplements         String[]
  surgeries           String[]
  familyHistory       String?
  healthNotes         String?
  dietaryRestrictions String?
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
  updatedByUserId     String?

  // Relations
  client Client @relation(fields: [clientId], references: [id], onDelete: Cascade)

  @@index([clientId])
}

model DietPlan {
  id               String             @id @default(uuid())
  orgId            String
  clientId         String? // Optional for templates
  createdByUserId  String
  name             String
  description      String?
  startDate        DateTime           @db.Date
  endDate          DateTime?          @db.Date
  targetCalories   Int?
  targetProteinG   Decimal?           @db.Decimal(5, 1)
  targetCarbsG     Decimal?           @db.Decimal(5, 1)
  targetFatsG      Decimal?           @db.Decimal(5, 1)
  targetFiberG     Decimal?           @db.Decimal(5, 1)
  notesForClient   String?
  internalNotes    String?
  status           DietPlanStatus     @default(draft)
  isTemplate       Boolean            @default(false)
  templateCategory String?
  visibility       DietPlanVisibility @default(private)
  publishedAt      DateTime?
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  deletedAt        DateTime?
  isActive         Boolean            @default(true)

  // Relations
  organization Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)
  client       Client?      @relation(fields: [clientId], references: [id], onDelete: Cascade)
  creator      User         @relation("DietPlanCreator", fields: [createdByUserId], references: [id])
  meals        Meal[]

  @@index([orgId])
  @@index([clientId])
  @@index([status])
  @@index([isTemplate])
}

model Meal {
  id               String    @id @default(uuid())
  planId           String
  dayOfWeek        Int?
  mealDate         DateTime? @db.Date
  sequenceNumber   Int?
  mealType         MealType
  timeOfDay        String?
  name             String
  description      String?
  instructions     String?
  servingSizeNotes String?
  totalCalories    Int?
  totalProteinG    Decimal?  @db.Decimal(5, 1)
  totalCarbsG      Decimal?  @db.Decimal(5, 1)
  totalFatsG       Decimal?  @db.Decimal(5, 1)
  totalFiberG      Decimal?  @db.Decimal(5, 1)
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt

  // Relations
  dietPlan  DietPlan       @relation(fields: [planId], references: [id], onDelete: Cascade)
  foodItems MealFoodItem[]
  mealLogs  MealLog[]

  @@index([planId])
  @@index([mealDate])
}

model FoodItem {
  id              String   @id @default(uuid())
  orgId           String?
  name            String
  brand           String?
  category        String
  subCategory     String?
  servingSizeG    Decimal  @default(100) @db.Decimal(6, 2)
  calories        Int
  proteinG        Decimal? @db.Decimal(5, 1)
  carbsG          Decimal? @db.Decimal(5, 1)
  fatsG           Decimal? @db.Decimal(5, 1)
  fiberG          Decimal? @db.Decimal(5, 1)
  sodiumMg        Decimal? @db.Decimal(7, 2)
  sugarG          Decimal? @db.Decimal(5, 1)
  isVerified      Boolean  @default(false)
  source          String?
  barcode         String?
  allergenFlags   String[]
  dietaryTags     String[]
  createdByUserId String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  // Relations
  organization  Organization?  @relation(fields: [orgId], references: [id], onDelete: SetNull)
  creator       User?          @relation("FoodItemCreator", fields: [createdByUserId], references: [id])
  mealFoodItems MealFoodItem[]

  @@index([orgId])
  @@index([category])
}

model MealFoodItem {
  id        String   @id @default(uuid())
  mealId    String
  foodId    String
  quantityG Decimal  @db.Decimal(6, 2)
  calories  Int?
  proteinG  Decimal? @db.Decimal(5, 1)
  carbsG    Decimal? @db.Decimal(5, 1)
  fatsG     Decimal? @db.Decimal(5, 1)
  fiberG    Decimal? @db.Decimal(5, 1)
  sortOrder Int      @default(0)
  notes     String?
  createdAt DateTime @default(now())

  // Relations
  meal     Meal     @relation(fields: [mealId], references: [id], onDelete: Cascade)
  foodItem FoodItem @relation(fields: [foodId], references: [id], onDelete: Cascade)

  @@index([mealId])
  @@index([foodId])
}

model MealLog {
  id                    String        @id @default(uuid())
  orgId                 String
  clientId              String
  mealId                String
  scheduledDate         DateTime      @db.Date
  scheduledTime         String?
  status                MealLogStatus @default(pending)
  mealPhotoUrl          String?
  mealPhotoSmallUrl     String?
  photoUploadedAt       DateTime?
  aiFoodRecognition     Json?
  clientNotes           String?
  dietitianFeedback     String?
  dietitianFeedbackAt   DateTime?
  reviewedByUserId      String?
  substituteDescription String?
  substituteCaloriesEst Int?
  loggedAt              DateTime?
  createdAt             DateTime      @default(now())
  updatedAt             DateTime      @updatedAt

  // Relations
  organization Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)
  client       Client       @relation(fields: [clientId], references: [id], onDelete: Cascade)
  meal         Meal         @relation(fields: [mealId], references: [id], onDelete: Cascade)
  reviewer     User?        @relation("MealLogReviewer", fields: [reviewedByUserId], references: [id])

  @@index([orgId])
  @@index([clientId])
  @@index([scheduledDate])
  @@index([status])
}

model WeightLog {
  id                       String   @id @default(uuid())
  orgId                    String
  clientId                 String
  weightKg                 Decimal  @db.Decimal(5, 2)
  logDate                  DateTime @db.Date
  logTime                  String?
  notes                    String?
  progressPhotoUrl         String?
  bmi                      Decimal? @db.Decimal(4, 2)
  weightChangeFromPrevious Decimal? @db.Decimal(5, 2)
  isOutlier                Boolean  @default(false)
  createdAt                DateTime @default(now())

  // Relations
  organization Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)
  client       Client       @relation(fields: [clientId], references: [id], onDelete: Cascade)

  @@unique([clientId, logDate])
  @@index([orgId])
  @@index([clientId])
}

model BodyMeasurement {
  id                String   @id @default(uuid())
  orgId             String
  clientId          String
  logDate           DateTime @db.Date
  chestCm           Decimal? @db.Decimal(5, 2)
  waistCm           Decimal? @db.Decimal(5, 2)
  hipsCm            Decimal? @db.Decimal(5, 2)
  thighsCm          Decimal? @db.Decimal(5, 2)
  armsCm            Decimal? @db.Decimal(5, 2)
  bodyFatPercentage Decimal? @db.Decimal(4, 2)
  notes             String?
  createdAt         DateTime @default(now())

  // Relations
  organization Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)
  client       Client       @relation(fields: [clientId], references: [id], onDelete: Cascade)

  @@index([orgId])
  @@index([clientId])
}

model SessionNote {
  id              String    @id @default(uuid())
  orgId           String
  clientId        String
  createdByUserId String
  noteType        NoteType
  title           String
  subjective      String?
  objective       String?
  assessment      String?
  plan            String?
  internalNotes   String?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  deletedAt       DateTime?

  // Relations
  organization Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)
  client       Client       @relation(fields: [clientId], references: [id], onDelete: Cascade)
  creator      User         @relation("SessionNoteCreator", fields: [createdByUserId], references: [id])

  @@index([orgId])
  @@index([clientId])
}

model Notification {
  id                String         @id @default(uuid())
  recipientId       String
  recipientType     RecipientType
  orgId             String
  type              String
  category          String?
  title             String
  message           String
  icon              String?
  deepLink          String?
  relatedEntityType String?
  relatedEntityId   String?
  isRead            Boolean        @default(false)
  readAt            DateTime?
  sentViaChannels   String[]       @default(["push"])
  deliveryStatus    DeliveryStatus @default(pending)
  createdAt         DateTime       @default(now())
  expiresAt         DateTime       @default(dbgenerated("NOW() + INTERVAL '30 days'"))

  // Relations
  organization Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)

  @@index([recipientId, recipientType])
  @@index([isRead])
  @@index([orgId])
}

model ActivityLog {
  id           String   @id @default(uuid())
  orgId        String
  userId       String?
  userType     String?
  action       String
  entityType   String?
  entityId     String?
  oldValues    Json?
  newValues    Json?
  changeDesc   String?
  ipAddress    String?
  userAgent    String?
  status       String   @default("success")
  errorMessage String?
  metadata     Json?
  createdAt    DateTime @default(now())

  // Relations
  organization Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)
  user         User?        @relation("UserActivityLog", fields: [userId], references: [id])

  @@index([orgId])
  @@index([userId])
  @@index([action])
}

model Invoice {
  id              String        @id @default(uuid())
  orgId           String
  clientId        String
  createdByUserId String
  invoiceNumber   String        @unique
  issueDate       DateTime      @db.Date
  dueDate         DateTime      @db.Date
  currency        String        @default("INR")
  subtotal        Decimal       @db.Decimal(10, 2)
  tax             Decimal       @default(0) @db.Decimal(10, 2)
  total           Decimal       @db.Decimal(10, 2)
  status          InvoiceStatus @default(unpaid)
  notes           String?
  sentAt          DateTime?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  // Relations
  organization Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)
  client       Client       @relation(fields: [clientId], references: [id], onDelete: Cascade)
  creator      User         @relation("InvoiceCreator", fields: [createdByUserId], references: [id])

  @@index([orgId])
  @@index([clientId])
  @@index([status])
}

model Invitation {
  id        String   @id @default(uuid())
  email     String
  role      UserRole
  token     String   @unique
  orgId     String
  expiresAt DateTime
  status    String   @default("pending") // pending, accepted, expired
  createdAt DateTime @default(now())

  organization Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)

  @@index([orgId])
  @@index([token])
  @@index([email])
}

model ReferralBenefit {
  id               String   @id @default(uuid())
  clientId         String   @unique
  referralCount    Int      @default(0)
  freeMonthsEarned Int      @default(0)
  freeMonthsUsed   Int      @default(0)
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  client Client @relation(fields: [clientId], references: [id], onDelete: Cascade)

  @@index([clientId])
}

model ClientReport {
  id         String   @id @default(uuid())
  orgId      String
  clientId   String
  fileName   String
  fileUrl    String
  fileType   String // pdf, image
  reportType String? // blood_test, scan, prescription, other
  notes      String?
  uploadedAt DateTime @default(now())

  organization Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)
  client       Client       @relation(fields: [clientId], references: [id], onDelete: Cascade)

  @@index([clientId])
  @@index([orgId])
}
</file>

<file path="backend/scripts/setup-garage.sh">
#!/bin/bash
set -e

# Remove old container
docker rm -f garage 2>/dev/null || true

# Generate secret
SECRET=$(openssl rand -hex 32)
ADMIN_TOKEN="hereisthetoken"

echo "Secret: $SECRET"
echo "Admin Token: $ADMIN_TOKEN"

# Create config inside volume
docker run --rm -v garage-data:/data alpine sh -c "mkdir -p /data/meta /data/data && cat > /data/garage.toml << 'CONFIGEOF'
metadata_dir = \"/data/meta\"
data_dir     = \"/data/data\"
db_engine    = \"sqlite\"

replication_factor = 1

rpc_bind_addr = \"[::]:3901\"
rpc_secret    = \"REPLACEME_SECRET\"

[s3_api]
s3_region = \"garage\"
api_bind_addr = \"[::]:3900\"
root_domain = \".s3.garage.localhost\"

[admin]
api_bind_addr = \"[::]:3902\"
admin_token = \"REPLACEME_TOKEN\"
CONFIGEOF
chown -R 1000:1000 /data"

# Replace placeholders with actual values
docker run --rm -v garage-data:/data alpine sh -c "sed -i 's/REPLACEME_SECRET/$SECRET/g' /data/garage.toml && sed -i 's/REPLACEME_TOKEN/$ADMIN_TOKEN/g' /data/garage.toml && cat /data/garage.toml"

# Start Garage with config file
docker run -d --name garage \
  -p 3900:3900 \
  -p 3901:3901 \
  -p 3902:3902 \
  -v garage-data:/data \
  dxflrs/garage:v2.1.0 \
  /garage -c /data/garage.toml server

sleep 2
echo "=== Container Status ==="
docker ps --filter name=garage
echo ""
echo "=== Garage Logs ==="
docker logs garage --tail 30
</file>

<file path="backend/scripts/setup-test-data.ts">
// Quick setup script to create test data
// Run with: npx tsx scripts/setup-test-data.ts

import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
    // Get Clerk user ID from command line or use placeholder
    const clerkUserId = process.argv[2];

    if (!clerkUserId) {
        console.log('Usage: npx tsx scripts/setup-test-data.ts <clerk-user-id>');
        console.log('\nTo find your Clerk user ID:');
        console.log('1. Go to https://dashboard.clerk.com');
        console.log('2. Click on Users');
        console.log('3. Find your user and copy the user_xxx ID');
        process.exit(1);
    }

    console.log('Setting up test data...\n');

    // Create organization
    let org = await prisma.organization.findFirst();
    if (!org) {
        org = await prisma.organization.create({
            data: {
                name: 'Diet Karo Clinic',
                email: 'admin@dietkaro.com',
                isActive: true,
            },
        });
        console.log('✓ Created organization:', org.name);
    } else {
        console.log('✓ Organization exists:', org.name);
    }

    // Create or update user
    let user = await prisma.user.findUnique({ where: { clerkUserId } });
    if (!user) {
        user = await prisma.user.create({
            data: {
                clerkUserId,
                email: 'dietitian@dietkaro.com',
                fullName: 'Test Dietitian',
                role: 'owner',
                orgId: org.id,
                isActive: true,
            },
        });
        console.log('✓ Created user:', user.fullName, `(${user.role})`);
    } else {
        console.log('✓ User exists:', user.fullName);
    }

    // Create sample client
    let client = await prisma.client.findFirst({ where: { orgId: org.id } });
    if (!client) {
        client = await prisma.client.create({
            data: {
                orgId: org.id,
                fullName: 'Priya Sharma',
                email: 'priya@example.com',
                phone: '+91 98765 43210',
                gender: 'female',
                heightCm: 165,
                currentWeightKg: 65,
                targetWeightKg: 58,
                primaryDietitianId: user.id,
                createdByUserId: user.id,
            },
        });
        console.log('✓ Created sample client:', client.fullName);
    }

    // Create sample food items
    const foodCount = await prisma.foodItem.count();
    if (foodCount === 0) {
        await prisma.foodItem.createMany({
            data: [
                { name: 'Oatmeal', category: 'grains', servingSizeG: 100, caloriesPer100g: 389, proteinPer100g: 17, carbsPer100g: 66, fatsPer100g: 7, isGlobal: true, isVerified: true },
                { name: 'Chicken Breast', category: 'proteins', servingSizeG: 100, caloriesPer100g: 165, proteinPer100g: 31, carbsPer100g: 0, fatsPer100g: 4, isGlobal: true, isVerified: true },
                { name: 'Brown Rice', category: 'grains', servingSizeG: 100, caloriesPer100g: 112, proteinPer100g: 2, carbsPer100g: 24, fatsPer100g: 1, isGlobal: true, isVerified: true },
                { name: 'Broccoli', category: 'vegetables', servingSizeG: 100, caloriesPer100g: 34, proteinPer100g: 3, carbsPer100g: 7, fatsPer100g: 0, isGlobal: true, isVerified: true },
                { name: 'Greek Yogurt', category: 'dairy', servingSizeG: 100, caloriesPer100g: 59, proteinPer100g: 10, carbsPer100g: 4, fatsPer100g: 0, isGlobal: true, isVerified: true },
                { name: 'Almonds', category: 'proteins', servingSizeG: 30, caloriesPer100g: 579, proteinPer100g: 21, carbsPer100g: 22, fatsPer100g: 50, isGlobal: true, isVerified: true },
            ],
        });
        console.log('✓ Created 6 sample food items');
    }

    console.log('\n✅ Setup complete! Restart your backend and try again.');
}

main()
    .catch(console.error)
    .finally(() => prisma.$disconnect());
</file>

<file path="backend/src/controllers/adminReferral.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';

/**
 * Get referral statistics for the organization (admin dashboard)
 */
export const getOrgReferralStats = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    // Get total clients with referral codes
    const clientsWithCodes = await prisma.client.count({
        where: {
            orgId: req.user.organizationId,
            referralCode: { not: null },
            isActive: true
        }
    });

    // Get total referred clients
    const referredClients = await prisma.client.count({
        where: {
            orgId: req.user.organizationId,
            referredByClientId: { not: null },
            isActive: true
        }
    });

    // Get referral source breakdown
    const referralSourceBreakdown = await prisma.client.groupBy({
        by: ['referralSource'],
        where: {
            orgId: req.user.organizationId,
            referralSource: { not: null },
            isActive: true
        },
        _count: { id: true }
    });

    // Get total free months earned/used
    const benefitsAggr = await prisma.referralBenefit.aggregate({
        where: {
            client: { orgId: req.user.organizationId }
        },
        _sum: {
            freeMonthsEarned: true,
            freeMonthsUsed: true,
            referralCount: true
        }
    });

    // Top referrers
    const topReferrers = await prisma.client.findMany({
        where: {
            orgId: req.user.organizationId,
            isActive: true,
            referredClients: { some: {} }
        },
        select: {
            id: true,
            fullName: true,
            referralCode: true,
            _count: { select: { referredClients: true } }
        },
        orderBy: {
            referredClients: { _count: 'desc' }
        },
        take: 10
    });

    res.status(200).json({
        success: true,
        data: {
            overview: {
                clientsWithCodes,
                referredClients,
                totalReferrals: benefitsAggr._sum.referralCount || 0,
                freeMonthsEarned: benefitsAggr._sum.freeMonthsEarned || 0,
                freeMonthsUsed: benefitsAggr._sum.freeMonthsUsed || 0,
                freeMonthsPending: (benefitsAggr._sum.freeMonthsEarned || 0) - (benefitsAggr._sum.freeMonthsUsed || 0)
            },
            referralSourceBreakdown: referralSourceBreakdown.map(item => ({
                source: item.referralSource,
                count: item._count.id
            })),
            topReferrers: topReferrers.map(client => ({
                id: client.id,
                name: client.fullName,
                code: client.referralCode,
                referralCount: client._count.referredClients
            }))
        }
    });
});

/**
 * Get list of clients referred by a specific client
 */
export const getClientReferrals = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { clientId } = req.params;
    const { page = '1', pageSize = '20' } = req.query;

    // Verify client belongs to org
    const client = await prisma.client.findFirst({
        where: { id: clientId, orgId: req.user.organizationId }
    });

    if (!client) throw AppError.notFound('Client not found');

    const skip = (Number(page) - 1) * Number(pageSize);
    const take = Number(pageSize);

    const [referrals, total] = await prisma.$transaction([
        prisma.client.findMany({
            where: {
                referredByClientId: clientId,
                isActive: true
            },
            select: {
                id: true,
                fullName: true,
                email: true,
                phone: true,
                createdAt: true
            },
            orderBy: { createdAt: 'desc' },
            skip,
            take
        }),
        prisma.client.count({
            where: {
                referredByClientId: clientId,
                isActive: true
            }
        })
    ]);

    // Get referral benefit info
    const benefit = await prisma.referralBenefit.findUnique({
        where: { clientId }
    });

    res.status(200).json({
        success: true,
        data: {
            referrer: {
                id: client.id,
                name: client.fullName,
                referralCode: client.referralCode
            },
            benefit: benefit ? {
                referralCount: benefit.referralCount,
                freeMonthsEarned: benefit.freeMonthsEarned,
                freeMonthsUsed: benefit.freeMonthsUsed,
                freeMonthsRemaining: benefit.freeMonthsEarned - benefit.freeMonthsUsed
            } : null,
            referrals
        },
        meta: {
            page: Number(page),
            pageSize: Number(pageSize),
            total,
            totalPages: Math.ceil(total / Number(pageSize))
        }
    });
});

/**
 * Get all clients with referral tracking info
 */
export const listClientsWithReferrals = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { page = '1', pageSize = '20', source, hasReferrals } = req.query;
    const skip = (Number(page) - 1) * Number(pageSize);
    const take = Number(pageSize);

    const where: any = {
        orgId: req.user.organizationId,
        isActive: true
    };

    if (source) {
        where.referralSource = String(source);
    }

    if (hasReferrals === 'true') {
        where.referredClients = { some: {} };
    }

    const [clients, total] = await prisma.$transaction([
        prisma.client.findMany({
            where,
            select: {
                id: true,
                fullName: true,
                email: true,
                phone: true,
                referralSource: true,
                referralSourceName: true,
                referralCode: true,
                createdAt: true,
                referredByClient: {
                    select: { id: true, fullName: true }
                },
                _count: { select: { referredClients: true } },
                referralBenefit: {
                    select: {
                        referralCount: true,
                        freeMonthsEarned: true,
                        freeMonthsUsed: true
                    }
                }
            },
            orderBy: { createdAt: 'desc' },
            skip,
            take
        }),
        prisma.client.count({ where })
    ]);

    res.status(200).json({
        success: true,
        data: clients.map(client => ({
            id: client.id,
            fullName: client.fullName,
            email: client.email,
            phone: client.phone,
            referralSource: client.referralSource,
            referralSourceName: client.referralSourceName,
            referralCode: client.referralCode,
            referredBy: client.referredByClient,
            referralCount: client._count.referredClients,
            benefit: client.referralBenefit,
            createdAt: client.createdAt
        })),
        meta: {
            page: Number(page),
            pageSize: Number(pageSize),
            total,
            totalPages: Math.ceil(total / Number(pageSize))
        }
    });
});

/**
 * Apply/redeem free month benefit for a client
 */
export const redeemFreeBenefit = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { clientId } = req.params;

    // Verify client belongs to org
    const client = await prisma.client.findFirst({
        where: { id: clientId, orgId: req.user.organizationId }
    });

    if (!client) throw AppError.notFound('Client not found');

    const benefit = await prisma.referralBenefit.findUnique({
        where: { clientId }
    });

    if (!benefit) {
        throw AppError.badRequest('Client has no referral benefits');
    }

    const available = benefit.freeMonthsEarned - benefit.freeMonthsUsed;
    if (available <= 0) {
        throw AppError.badRequest('No free months available to redeem');
    }

    // Increment used count
    const updated = await prisma.referralBenefit.update({
        where: { clientId },
        data: {
            freeMonthsUsed: { increment: 1 }
        }
    });

    logger.info('Free month redeemed', {
        clientId,
        byUserId: req.user.id,
        remaining: updated.freeMonthsEarned - updated.freeMonthsUsed
    });

    res.status(200).json({
        success: true,
        data: {
            redeemed: true,
            freeMonthsEarned: updated.freeMonthsEarned,
            freeMonthsUsed: updated.freeMonthsUsed,
            freeMonthsRemaining: updated.freeMonthsEarned - updated.freeMonthsUsed
        }
    });
});
</file>

<file path="backend/src/controllers/auth.controller.ts">
import { Request, Response } from 'express';
import { clerkClient, getAuth } from '@clerk/express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';

export const register = asyncHandler(async (req: Request, res: Response) => {
    const auth = getAuth(req);
    const clerkUserId = req.body.clerkUserId || auth.userId;

    if (!clerkUserId) {
        throw AppError.badRequest('Clerk user ID is required', 'MISSING_CLERK_USER');
    }

    const { email, fullName, role, orgId, phone, licenseNumber, specialization } = req.body;

    if (!email || !fullName || !role || !orgId) {
        throw AppError.badRequest('email, fullName, role, and orgId are required', 'MISSING_FIELDS');
    }

    try {
        await clerkClient.users.getUser(clerkUserId);
    } catch {
        throw AppError.badRequest('Invalid Clerk user ID', 'INVALID_CLERK_USER');
    }

    const existingUser = await prisma.user.findUnique({ where: { clerkUserId } });
    if (existingUser) {
        throw AppError.conflict('User already registered', 'USER_EXISTS');
    }

    const organization = await prisma.organization.findUnique({ where: { id: orgId } });
    if (!organization) {
        throw AppError.notFound('Organization not found', 'ORG_NOT_FOUND');
    }

    const user = await prisma.user.create({
        data: { clerkUserId, email, fullName, role, orgId, phone, licenseNumber, specialization, lastLoginAt: new Date() }
    });

    logger.info('User registered', { userId: user.id, clerkUserId, orgId });

    res.status(201).json({
        success: true,
        data: { id: user.id, organizationId: user.orgId, role: user.role, email: user.email, fullName: user.fullName, phone: user.phone, profilePhotoUrl: user.profilePhotoUrl, specialization: user.specialization }
    });
});

export const syncUser = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    await prisma.user.update({ where: { id: req.user.id }, data: { lastLoginAt: new Date() } });

    res.status(200).json({ success: true, data: { synced: true } });
});

export const getMe = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user || !req.dbUser) throw AppError.unauthorized();

    const user = req.dbUser;

    res.status(200).json({
        success: true,
        data: {
            id: user.id, organizationId: user.orgId, role: user.role, email: user.email,
            fullName: user.fullName, phone: user.phone, profilePhotoUrl: user.profilePhotoUrl,
            licenseNumber: user.licenseNumber, specialization: user.specialization, bio: user.bio,
            isActive: user.isActive, mfaEnabled: user.mfaEnabled, lastLoginAt: user.lastLoginAt,
            createdAt: user.createdAt, updatedAt: user.updatedAt
        }
    });
});

export const updateMe = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { fullName, phone, specialization, bio } = req.body;

    const updatedUser = await prisma.user.update({
        where: { id: req.user.id },
        data: {
            ...(fullName && { fullName }),
            ...(phone && { phone }),
            ...(specialization && { specialization }),
            ...(bio && { bio })
        }
    });

    logger.info('User profile updated', { userId: updatedUser.id });

    res.status(200).json({
        success: true,
        data: { id: updatedUser.id, fullName: updatedUser.fullName, phone: updatedUser.phone, specialization: updatedUser.specialization, bio: updatedUser.bio, updatedAt: updatedUser.updatedAt }
    });
});
</file>

<file path="backend/src/controllers/client.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';
import { CreateClientInput, UpdateClientInput } from '../schemas/client.schema';

export const createClient = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const data = req.body;

    const existingClient = await prisma.client.findFirst({
        where: { orgId: req.user.organizationId, email: data.email }
    });

    if (existingClient) {
        throw AppError.conflict('A client with this email already exists', 'CLIENT_EXISTS');
    }

    // Handle referral code - find referrer if code provided
    let referredByClientId: string | undefined;
    if (data.referralCode) {
        const referrer = await prisma.client.findUnique({
            where: { referralCode: data.referralCode.toUpperCase() },
            select: { id: true }
        });
        if (referrer) {
            referredByClientId = referrer.id;
        }
    }

    const client = await prisma.client.create({
        data: {
            orgId: req.user.organizationId,
            primaryDietitianId: data.primaryDietitianId || req.user.id,
            fullName: data.fullName,
            email: data.email,
            phone: data.phone,
            dateOfBirth: data.dateOfBirth ? new Date(data.dateOfBirth) : null,
            gender: data.gender,
            heightCm: data.heightCm,
            currentWeightKg: data.currentWeightKg,
            targetWeightKg: data.targetWeightKg,
            activityLevel: data.activityLevel,
            dietaryPreferences: data.dietaryPreferences || [],
            allergies: data.allergies || [],
            medicalConditions: data.medicalConditions || [],
            medications: data.medications || [],
            healthNotes: data.healthNotes,
            createdByUserId: req.user.id,
            // Referral tracking fields
            referralSource: data.referralSource,
            referralSourceName: data.referralSourceName,
            referralSourcePhone: data.referralSourcePhone,
            referredByClientId
        },
        include: {
            primaryDietitian: { select: { id: true, fullName: true } }
        }
    });

    // Update referrer's benefit count if referred by another client
    if (referredByClientId) {
        await prisma.referralBenefit.upsert({
            where: { clientId: referredByClientId },
            create: {
                clientId: referredByClientId,
                referralCount: 1,
                freeMonthsEarned: 0
            },
            update: {
                referralCount: { increment: 1 },
                freeMonthsEarned: {
                    set: await prisma.client.count({
                        where: { referredByClientId, isActive: true }
                    }).then(count => Math.floor(count / 3))
                }
            }
        });
    }

    logger.info('Client created', {
        clientId: client.id,
        orgId: req.user.organizationId,
        referralSource: data.referralSource,
        referredBy: referredByClientId
    });
    res.status(201).json({ success: true, data: client });
});


export const getClient = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const client = await prisma.client.findFirst({
        where: { id: req.params.id, orgId: req.user.organizationId, isActive: true },
        include: {
            primaryDietitian: { select: { id: true, fullName: true } },
            medicalProfile: true
        }
    });

    if (!client) throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');

    res.status(200).json({ success: true, data: client });
});

export const listClients = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { page = '1', pageSize = '20', search, status, primaryDietitianId, sortBy = 'createdAt' } = req.query;

    const skip = (Number(page) - 1) * Number(pageSize);
    const take = Number(pageSize);

    const where: any = {
        orgId: req.user.organizationId,
        isActive: status !== 'inactive'
    };

    if (search) {
        where.OR = [
            { fullName: { contains: String(search), mode: 'insensitive' } },
            { email: { contains: String(search), mode: 'insensitive' } },
            { phone: { contains: String(search) } }
        ];
    }

    if (primaryDietitianId) where.primaryDietitianId = String(primaryDietitianId);
    if (req.user.role === 'dietitian') where.primaryDietitianId = req.user.id;

    const [clients, total] = await prisma.$transaction([
        prisma.client.findMany({
            where, skip, take,
            orderBy: { [String(sortBy)]: 'desc' },
            include: { primaryDietitian: { select: { id: true, fullName: true } } }
        }),
        prisma.client.count({ where })
    ]);

    res.status(200).json({
        success: true,
        data: clients,
        meta: {
            page: Number(page),
            pageSize: Number(pageSize),
            total,
            totalPages: Math.ceil(total / Number(pageSize)),
            hasNextPage: Number(page) < Math.ceil(total / Number(pageSize)),
            hasPreviousPage: Number(page) > 1
        }
    });
});

export const updateClient = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;
    const updateData: any = req.body;

    const existingClient = await prisma.client.findFirst({
        where: { id, orgId: req.user.organizationId }
    });

    if (!existingClient) throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');

    // Handle date conversion
    if (updateData.dateOfBirth) {
        updateData.dateOfBirth = new Date(updateData.dateOfBirth);
    }

    const client = await prisma.client.update({
        where: { id },
        data: updateData,
        include: { primaryDietitian: { select: { id: true, fullName: true } } }
    });

    logger.info('Client updated', { clientId: client.id });
    res.status(200).json({ success: true, data: client });
});

export const deleteClient = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const existingClient = await prisma.client.findFirst({
        where: { id: req.params.id, orgId: req.user.organizationId }
    });

    if (!existingClient) throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');

    await prisma.client.update({
        where: { id: req.params.id },
        data: { isActive: false, deletedAt: new Date() }
    });

    logger.info('Client deleted (soft)', { clientId: req.params.id });
    res.status(204).send();
});

export const getClientProgress = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;
    const { dateFrom, dateTo } = req.query;

    const client = await prisma.client.findFirst({
        where: { id, orgId: req.user.organizationId }
    });

    if (!client) throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');

    const dateFilter: any = {};
    if (dateFrom) dateFilter.gte = new Date(String(dateFrom));
    if (dateTo) dateFilter.lte = new Date(String(dateTo));

    const weightLogs = await prisma.weightLog.findMany({
        where: { clientId: id, ...(Object.keys(dateFilter).length > 0 && { logDate: dateFilter }) },
        orderBy: { logDate: 'asc' }
    });

    let startWeight: number | null = null;
    let currentWeight: number | null = null;
    let totalWeightChange: number | null = null;
    let weeklyAvgChange: number | null = null;
    let targetWeight = client.targetWeightKg ? Number(client.targetWeightKg) : null;
    let progressToGoal: number | null = null;

    if (weightLogs.length > 0) {
        startWeight = Number(weightLogs[0].weightKg);
        currentWeight = Number(weightLogs[weightLogs.length - 1].weightKg);
        totalWeightChange = Math.round((currentWeight - startWeight) * 100) / 100;

        const firstDate = new Date(weightLogs[0].logDate);
        const lastDate = new Date(weightLogs[weightLogs.length - 1].logDate);
        const weeksDiff = Math.max(1, Math.round((lastDate.getTime() - firstDate.getTime()) / (7 * 24 * 60 * 60 * 1000)));
        weeklyAvgChange = Math.round((totalWeightChange / weeksDiff) * 100) / 100;

        if (targetWeight && startWeight) {
            const totalToLose = startWeight - targetWeight;
            const lost = startWeight - currentWeight;
            progressToGoal = totalToLose > 0 ? Math.round((lost / totalToLose) * 100) : 0;
        }
    }

    const mealLogs = await prisma.mealLog.findMany({
        where: { clientId: id, ...(Object.keys(dateFilter).length > 0 && { scheduledDate: dateFilter }) }
    });

    const totalMeals = mealLogs.length;
    const eatenMeals = mealLogs.filter(m => m.status === 'eaten').length;
    const substitutedMeals = mealLogs.filter(m => m.status === 'substituted').length;
    const skippedMeals = mealLogs.filter(m => m.status === 'skipped').length;
    const pendingMeals = mealLogs.filter(m => m.status === 'pending').length;

    const adherencePercentage = totalMeals > 0 ? Math.round(((eatenMeals + substitutedMeals) / totalMeals) * 100) : 0;
    const completionPercentage = totalMeals > 0 ? Math.round(((totalMeals - pendingMeals) / totalMeals) * 100) : 0;

    const activePlansCount = await prisma.dietPlan.count({
        where: { clientId: id, status: 'active', isActive: true }
    });

    res.status(200).json({
        success: true,
        data: {
            client: { id: client.id, fullName: client.fullName },
            weightTrend: {
                startWeight, currentWeight, targetWeight, totalWeightChange,
                weeklyAverageChange: weeklyAvgChange, progressToGoalPercentage: progressToGoal,
                dataPoints: weightLogs.map(w => ({ date: w.logDate, weight: Number(w.weightKg) }))
            },
            mealAdherence: {
                totalMeals, eatenMeals, substitutedMeals, skippedMeals, pendingMeals,
                adherencePercentage, completionPercentage
            },
            activeDietPlans: activePlansCount,
            period: { from: dateFrom ? new Date(String(dateFrom)) : null, to: dateTo ? new Date(String(dateTo)) : null }
        }
    });
});
</file>

<file path="backend/src/controllers/clientAuth.controller.ts">
import { Request, Response } from 'express';
import prisma from '../utils/prisma';
import { asyncHandler } from '../utils/asyncHandler';
import { AppError } from '../errors/AppError';
import { signClientToken, ClientAuthRequest } from '../middleware/clientAuth.middleware';
import logger from '../utils/logger';

// In-memory OTP store (use Redis in production)
const otpStore = new Map<string, { otp: string; expiresAt: Date }>();

const generateOTP = (): string => {
    return Math.floor(100000 + Math.random() * 900000).toString();
};

export const requestOTP = asyncHandler(async (req: Request, res: Response) => {
    const { phone } = req.body;

    if (!phone || phone.length < 10) {
        throw AppError.badRequest('Valid phone number required', 'INVALID_PHONE');
    }

    // Check if client exists
    const client = await prisma.client.findFirst({
        where: { phone, isActive: true },
    });

    if (!client) {
        throw AppError.notFound('No account found with this phone number', 'CLIENT_NOT_FOUND');
    }

    // Generate OTP
    const otp = generateOTP();
    const expiresAt = new Date(Date.now() + 5 * 60 * 1000); // 5 minutes

    // Store OTP (in production, send via SMS)
    otpStore.set(phone, { otp, expiresAt });

    logger.info(`[Client OTP] Generated for ${phone}: ${otp}`); // Remove in production

    res.status(200).json({
        success: true,
        message: 'OTP sent successfully',
        // DEV ONLY: Remove in production
        dev_otp: process.env.NODE_ENV === 'development' ? otp : undefined,
    });
});

export const verifyOTP = asyncHandler(async (req: Request, res: Response) => {
    const { phone, otp } = req.body;

    if (!phone || !otp) {
        throw AppError.badRequest('Phone and OTP required', 'MISSING_FIELDS');
    }

    const stored = otpStore.get(phone);

    if (!stored) {
        throw AppError.badRequest('OTP expired or not found', 'OTP_EXPIRED');
    }

    if (stored.expiresAt < new Date()) {
        otpStore.delete(phone);
        throw AppError.badRequest('OTP expired', 'OTP_EXPIRED');
    }

    if (stored.otp !== otp) {
        throw AppError.badRequest('Invalid OTP', 'INVALID_OTP');
    }

    // OTP verified, delete from store
    otpStore.delete(phone);

    // Get client
    const client = await prisma.client.findFirst({
        where: { phone, isActive: true },
        include: {
            primaryDietitian: {
                select: { fullName: true, email: true },
            },
        },
    });

    if (!client) {
        throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');
    }

    // Generate JWT
    const token = signClientToken(client.id);

    logger.info(`[Client Auth] Login successful for ${phone}`);

    res.status(200).json({
        success: true,
        data: {
            token,
            client: {
                id: client.id,
                fullName: client.fullName,
                email: client.email,
                phone: client.phone,
                profilePhotoUrl: client.profilePhotoUrl,
                heightCm: client.heightCm,
                currentWeightKg: client.currentWeightKg,
                targetWeightKg: client.targetWeightKg,
                dietaryPreferences: client.dietaryPreferences,
                allergies: client.allergies,
                dietitian: client.primaryDietitian,
            },
        },
    });
});

export const getClientProfile = asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const client = await prisma.client.findUnique({
        where: { id: req.client.id },
        include: {
            primaryDietitian: {
                select: { fullName: true, email: true, phone: true },
            },
        },
    });

    if (!client) {
        throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');
    }

    res.status(200).json({
        success: true,
        data: {
            id: client.id,
            fullName: client.fullName,
            email: client.email,
            phone: client.phone,
            profilePhotoUrl: client.profilePhotoUrl,
            heightCm: client.heightCm,
            currentWeightKg: client.currentWeightKg,
            targetWeightKg: client.targetWeightKg,
            dietaryPreferences: client.dietaryPreferences,
            allergies: client.allergies,
            dietitian: client.primaryDietitian,
        },
    });
});

export const updateClientProfile = asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const { profilePhotoUrl } = req.body;

    const updated = await prisma.client.update({
        where: { id: req.client.id },
        data: {
            ...(profilePhotoUrl && { profilePhotoUrl }),
        },
    });

    res.status(200).json({
        success: true,
        data: {
            id: updated.id,
            profilePhotoUrl: updated.profilePhotoUrl,
        },
    });
});
</file>

<file path="backend/src/controllers/dashboard.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { asyncHandler } from '../utils/asyncHandler';
import { AppError } from '../errors/AppError';

export const getDashboardStats = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const orgId = req.user.organizationId;

    // Get counts
    const [
        totalClients,
        pendingReviews,
        activeDietPlans,
        recentClients,
        pendingMealLogs
    ] = await Promise.all([
        // Total active clients
        prisma.client.count({
            where: { orgId, isActive: true }
        }),
        // Pending meal log reviews
        prisma.mealLog.count({
            where: { orgId, status: 'pending' }
        }),
        // Active (published) diet plans
        prisma.dietPlan.count({
            where: { orgId, status: 'active' }
        }),
        // Recent clients (last 5)
        prisma.client.findMany({
            where: { orgId, isActive: true },
            orderBy: { updatedAt: 'desc' },
            take: 5,
            select: {
                id: true,
                fullName: true,
                updatedAt: true,
                createdAt: true
            }
        }),
        // Pending meal logs with client info
        prisma.mealLog.findMany({
            where: { orgId, status: 'pending' },
            orderBy: { scheduledDate: 'desc' },
            take: 5,
            include: {
                client: { select: { id: true, fullName: true } },
                meal: { select: { id: true, name: true, mealType: true } }
            }
        })
    ]);

    // Calculate average adherence (simplified - from last 30 days)
    const thirtyDaysAgo = new Date();
    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);

    const mealLogStats = await prisma.mealLog.groupBy({
        by: ['status'],
        where: {
            orgId,
            scheduledDate: { gte: thirtyDaysAgo }
        },
        _count: true
    });

    const totalMeals = mealLogStats.reduce((acc, s) => acc + s._count, 0);
    const eatenMeals = mealLogStats.find(s => s.status === 'eaten')?._count || 0;
    const adherencePercent = totalMeals > 0 ? Math.round((eatenMeals / totalMeals) * 100) : 0;

    // Weekly adherence breakdown
    const weeklyData: { day: string; value: number }[] = [];
    const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

    for (let i = 6; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dayStart = new Date(date.setHours(0, 0, 0, 0));
        const dayEnd = new Date(date.setHours(23, 59, 59, 999));

        const dayMealLogs = await prisma.mealLog.groupBy({
            by: ['status'],
            where: {
                orgId,
                scheduledDate: { gte: dayStart, lte: dayEnd }
            },
            _count: true
        });

        const dayTotal = dayMealLogs.reduce((acc, s) => acc + s._count, 0);
        const dayEaten = dayMealLogs.find(s => s.status === 'eaten')?._count || 0;
        const dayPercent = dayTotal > 0 ? Math.round((dayEaten / dayTotal) * 100) : 0;

        weeklyData.push({
            day: days[dayStart.getDay()],
            value: dayPercent
        });
    }

    res.status(200).json({
        success: true,
        data: {
            stats: {
                totalClients,
                pendingReviews,
                activeDietPlans,
                adherencePercent
            },
            weeklyAdherence: weeklyData,
            recentClients: recentClients.map(c => ({
                id: c.id,
                name: c.fullName,
                avatar: c.fullName.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2),
                status: 'active',
                lastActivity: c.updatedAt || c.createdAt
            })),
            pendingReviews: pendingMealLogs.map(m => ({
                id: m.id,
                client: m.client.fullName,
                meal: m.meal?.mealType || 'Meal',
                time: m.scheduledTime
            }))
        }
    });
});
</file>

<file path="backend/src/controllers/dietPlan.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';
import { CreateDietPlanInput, UpdateDietPlanInput } from '../schemas/dietPlan.schema';

export const createDietPlan = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const data: CreateDietPlanInput = req.body;
    const isTemplate = data.options?.saveAsTemplate || false;

    // For templates, clientId is optional. For regular plans, it's required.
    let clientId = data.clientId;
    if (!isTemplate) {
        if (!clientId) {
            throw AppError.badRequest('clientId is required for non-template diet plans', 'CLIENT_ID_REQUIRED');
        }
        const client = await prisma.client.findFirst({
            where: { id: clientId, orgId: req.user.organizationId }
        });
        if (!client) throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');
    }

    // For templates, we need a placeholder client or null clientId
    // Since schema requires clientId, we'll use a special approach:
    // For now, templates still need a clientId but we mark them as templates
    // A cleaner approach would be to make clientId nullable in schema

    const dietPlan = await prisma.dietPlan.create({
        data: {
            organization: { connect: { id: req.user.organizationId } },
            client: clientId ? { connect: { id: clientId } } : undefined,
            creator: { connect: { id: req.user.id } },
            name: data.name,
            description: data.description,
            startDate: new Date(data.startDate),
            endDate: data.endDate ? new Date(data.endDate) : null,
            targetCalories: data.targetCalories,
            targetProteinG: data.targetProteinG,
            targetCarbsG: data.targetCarbsG,
            targetFatsG: data.targetFatsG,
            targetFiberG: data.targetFiberG,
            notesForClient: data.notesForClient,
            internalNotes: data.internalNotes,
            status: 'draft',
            isTemplate: isTemplate,
            templateCategory: data.options?.templateCategory,
            meals: data.meals?.length ? {
                create: data.meals.map((meal: any, index: number) => ({
                    dayOfWeek: meal.dayIndex,
                    mealDate: meal.mealDate ? new Date(meal.mealDate) : null,
                    sequenceNumber: index,
                    mealType: meal.mealType,
                    timeOfDay: meal.timeOfDay,
                    name: meal.title,
                    description: meal.description,
                    instructions: meal.instructions,
                    foodItems: meal.foodItems?.length ? {
                        create: meal.foodItems.map((item: any, sortOrder: number) => ({
                            foodId: item.foodId,
                            quantityG: item.quantity,
                            notes: item.notes,
                            sortOrder
                        }))
                    } : undefined
                }))
            } : undefined
        },
        include: {
            client: { select: { id: true, fullName: true } },
            creator: { select: { id: true, fullName: true } },
            meals: { include: { foodItems: { include: { foodItem: true } } } }
        }
    });

    logger.info(isTemplate ? 'Diet plan template created' : 'Diet plan created', { planId: dietPlan.id, clientId });
    res.status(201).json({ success: true, data: dietPlan });
});

export const getDietPlan = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const dietPlan = await prisma.dietPlan.findFirst({
        where: { id: req.params.id, orgId: req.user.organizationId, isActive: true },
        include: {
            client: { select: { id: true, fullName: true, currentWeightKg: true, targetWeightKg: true } },
            creator: { select: { id: true, fullName: true } },
            meals: {
                orderBy: [{ dayOfWeek: 'asc' }, { sequenceNumber: 'asc' }],
                include: { foodItems: { orderBy: { sortOrder: 'asc' }, include: { foodItem: true } } }
            }
        }
    });

    if (!dietPlan) throw AppError.notFound('Diet plan not found', 'PLAN_NOT_FOUND');

    res.status(200).json({ success: true, data: dietPlan });
});

export const listDietPlans = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { clientId, status, isTemplate, page = '1', pageSize = '20' } = req.query;
    const skip = (Number(page) - 1) * Number(pageSize);
    const take = Number(pageSize);

    const where: any = { orgId: req.user.organizationId, isActive: true };
    if (clientId) where.clientId = String(clientId);
    if (status) where.status = String(status);
    if (isTemplate !== undefined) where.isTemplate = isTemplate === 'true';

    const [plans, total] = await prisma.$transaction([
        prisma.dietPlan.findMany({
            where, skip, take,
            orderBy: { createdAt: 'desc' },
            include: {
                client: { select: { id: true, fullName: true } },
                creator: { select: { id: true, fullName: true } },
                _count: { select: { meals: true } }
            }
        }),
        prisma.dietPlan.count({ where })
    ]);

    res.status(200).json({
        success: true,
        data: plans.map(p => ({ ...p, mealCount: p._count.meals })),
        meta: { page: Number(page), pageSize: Number(pageSize), total, totalPages: Math.ceil(total / Number(pageSize)) }
    });
});

export const updateDietPlan = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const data: UpdateDietPlanInput = req.body;

    const existing = await prisma.dietPlan.findFirst({
        where: { id: req.params.id, orgId: req.user.organizationId }
    });

    if (!existing) throw AppError.notFound('Diet plan not found', 'PLAN_NOT_FOUND');

    const updated = await prisma.dietPlan.update({
        where: { id: req.params.id },
        data: {
            ...(data.name && { name: data.name }),
            ...(data.description !== undefined && { description: data.description }),
            ...(data.startDate && { startDate: new Date(data.startDate) }),
            ...(data.endDate !== undefined && { endDate: data.endDate ? new Date(data.endDate) : null }),
            ...(data.targetCalories !== undefined && { targetCalories: data.targetCalories }),
            ...(data.targetProteinG !== undefined && { targetProteinG: data.targetProteinG }),
            ...(data.targetCarbsG !== undefined && { targetCarbsG: data.targetCarbsG }),
            ...(data.targetFatsG !== undefined && { targetFatsG: data.targetFatsG }),
            ...(data.targetFiberG !== undefined && { targetFiberG: data.targetFiberG }),
            ...(data.notesForClient !== undefined && { notesForClient: data.notesForClient }),
            ...(data.internalNotes !== undefined && { internalNotes: data.internalNotes })
        }
    });

    logger.info('Diet plan updated', { planId: updated.id });
    res.status(200).json({ success: true, data: updated });
});

export const publishDietPlan = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const plan = await prisma.dietPlan.findFirst({
        where: { id: req.params.id, orgId: req.user.organizationId },
        include: { meals: true }
    });

    if (!plan) throw AppError.notFound('Diet plan not found', 'PLAN_NOT_FOUND');

    const updated = await prisma.dietPlan.update({
        where: { id: req.params.id },
        data: { status: 'active', publishedAt: new Date() }
    });

    logger.info('Diet plan published', { planId: updated.id });
    res.status(200).json({
        success: true,
        data: { planId: updated.id, status: updated.status, publishedAt: updated.publishedAt, mealLogsCreated: plan.meals.length }
    });
});

// Assign a template to a client (clone template to create a new plan)
export const assignTemplateToClient = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const templateId = req.params.id;
    const { clientId, startDate, name } = req.body;

    if (!clientId) throw AppError.badRequest('clientId is required', 'CLIENT_ID_REQUIRED');
    if (!startDate) throw AppError.badRequest('startDate is required', 'START_DATE_REQUIRED');

    // Verify template exists and is actually a template
    const template = await prisma.dietPlan.findFirst({
        where: { id: templateId, orgId: req.user.organizationId, isTemplate: true, isActive: true },
        include: {
            meals: {
                include: { foodItems: true }
            }
        }
    });

    if (!template) throw AppError.notFound('Template not found', 'TEMPLATE_NOT_FOUND');

    // Verify client exists
    const client = await prisma.client.findFirst({
        where: { id: clientId, orgId: req.user.organizationId }
    });

    if (!client) throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');

    // Create new diet plan based on template
    const newPlan = await prisma.dietPlan.create({
        data: {
            organization: { connect: { id: req.user.organizationId } },
            client: { connect: { id: clientId } },
            creator: { connect: { id: req.user.id } },
            name: name || `${template.name} - ${client.fullName}`,
            description: template.description,
            startDate: new Date(startDate),
            targetCalories: template.targetCalories,
            targetProteinG: template.targetProteinG,
            targetCarbsG: template.targetCarbsG,
            targetFatsG: template.targetFatsG,
            targetFiberG: template.targetFiberG,
            notesForClient: template.notesForClient,
            internalNotes: template.internalNotes,
            status: 'draft',
            isTemplate: false, // This is a real plan, not a template
            meals: {
                create: template.meals.map((meal, index) => ({
                    dayOfWeek: meal.dayOfWeek,
                    mealDate: null, // Will be set based on startDate later
                    sequenceNumber: meal.sequenceNumber ?? index,
                    mealType: meal.mealType,
                    timeOfDay: meal.timeOfDay,
                    name: meal.name,
                    description: meal.description,
                    instructions: meal.instructions,
                    servingSizeNotes: meal.servingSizeNotes,
                    foodItems: meal.foodItems.length ? {
                        create: meal.foodItems.map((item, sortOrder) => ({
                            foodId: item.foodId,
                            quantityG: item.quantityG,
                            notes: item.notes,
                            sortOrder: item.sortOrder ?? sortOrder
                        }))
                    } : undefined
                }))
            }
        },
        include: {
            client: { select: { id: true, fullName: true } },
            creator: { select: { id: true, fullName: true } },
            meals: { include: { foodItems: { include: { foodItem: true } } } }
        }
    });

    logger.info('Template assigned to client', { templateId, newPlanId: newPlan.id, clientId });
    res.status(201).json({ success: true, data: newPlan });
});
</file>

<file path="backend/src/controllers/foodItem.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';
import { CreateFoodItemInput, UpdateFoodItemInput } from '../schemas/foodItem.schema';

/**
 * POST /api/v1/food-items
 * Create a new food item in the organization's food library
 */
export const createFoodItem = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const data: CreateFoodItemInput = req.body;

    const foodItem = await prisma.foodItem.create({
        data: {
            orgId: req.user.organizationId,
            name: data.name,
            brand: data.brand,
            category: data.category,
            subCategory: data.subCategory,
            servingSizeG: data.servingSizeG || 100,
            calories: data.calories,
            proteinG: data.proteinG,
            carbsG: data.carbsG,
            fatsG: data.fatsG,
            fiberG: data.fiberG,
            sodiumMg: data.sodiumMg,
            sugarG: data.sugarG,
            barcode: data.barcode,
            allergenFlags: data.allergenFlags || [],
            dietaryTags: data.dietaryTags || [],
            createdByUserId: req.user.id,
            isVerified: false,
            source: 'user_created'
        }
    });

    logger.info('Food item created', { foodItemId: foodItem.id, name: foodItem.name });

    res.status(201).json({
        success: true,
        data: {
            id: foodItem.id,
            organizationId: foodItem.orgId,
            name: foodItem.name,
            brand: foodItem.brand,
            category: foodItem.category,
            subCategory: foodItem.subCategory,
            servingSize: `${foodItem.servingSizeG} g`,
            isGlobal: foodItem.orgId === null,
            isVerified: foodItem.isVerified,
            nutrition: {
                calories: foodItem.calories,
                proteinG: foodItem.proteinG ? Number(foodItem.proteinG) : null,
                carbsG: foodItem.carbsG ? Number(foodItem.carbsG) : null,
                fatsG: foodItem.fatsG ? Number(foodItem.fatsG) : null,
                fiberG: foodItem.fiberG ? Number(foodItem.fiberG) : null,
                sodiumMg: foodItem.sodiumMg ? Number(foodItem.sodiumMg) : null,
                sugarG: foodItem.sugarG ? Number(foodItem.sugarG) : null
            },
            allergenFlags: foodItem.allergenFlags,
            dietaryTags: foodItem.dietaryTags,
            barcode: foodItem.barcode,
            createdByUserId: foodItem.createdByUserId,
            createdAt: foodItem.createdAt
        }
    });
});

/**
 * GET /api/v1/food-items
 * Search and list food items (global + org-specific)
 */
export const listFoodItems = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const {
        q,
        category,
        orgScope = 'all',
        isVerified,
        page = '1',
        pageSize = '20',
        sortBy = 'name'
    } = req.query;

    const skip = (Number(page) - 1) * Number(pageSize);
    const take = Number(pageSize);

    // Build where clause
    const where: any = {
        OR: [
            { orgId: null }, // Global foods
            { orgId: req.user.organizationId } // Org-specific foods
        ]
    };

    // Filter by org scope
    if (orgScope === 'org_only') {
        where.OR = [{ orgId: req.user.organizationId }];
    } else if (orgScope === 'global_only') {
        where.OR = [{ orgId: null }];
    }

    // Search by name/brand
    if (q) {
        where.AND = [
            {
                OR: [
                    { name: { contains: String(q), mode: 'insensitive' } },
                    { brand: { contains: String(q), mode: 'insensitive' } }
                ]
            }
        ];
    }

    // Filter by category
    if (category) {
        where.category = String(category);
    }

    // Filter by verified status
    if (isVerified !== undefined) {
        where.isVerified = isVerified === 'true';
    }

    const [foodItems, total] = await prisma.$transaction([
        prisma.foodItem.findMany({
            where,
            skip,
            take,
            orderBy: { [String(sortBy)]: 'asc' },
            include: {
                creator: { select: { id: true, fullName: true } }
            }
        }),
        prisma.foodItem.count({ where })
    ]);

    res.status(200).json({
        success: true,
        data: foodItems.map(item => ({
            id: item.id,
            name: item.name,
            brand: item.brand,
            category: item.category,
            subCategory: item.subCategory,
            servingSize: `${item.servingSizeG} g`,
            isGlobal: item.orgId === null,
            isVerified: item.isVerified,
            nutrition: {
                calories: item.calories,
                proteinG: item.proteinG ? Number(item.proteinG) : null,
                carbsG: item.carbsG ? Number(item.carbsG) : null,
                fatsG: item.fatsG ? Number(item.fatsG) : null,
                fiberG: item.fiberG ? Number(item.fiberG) : null
            },
            allergenFlags: item.allergenFlags,
            dietaryTags: item.dietaryTags,
            barcode: item.barcode,
            createdBy: item.creator
        })),
        meta: {
            page: Number(page),
            pageSize: Number(pageSize),
            total,
            totalPages: Math.ceil(total / Number(pageSize))
        }
    });
});

/**
 * GET /api/v1/food-items/:id
 * Get single food item details
 */
export const getFoodItem = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;

    const foodItem = await prisma.foodItem.findFirst({
        where: {
            id,
            OR: [
                { orgId: null },
                { orgId: req.user.organizationId }
            ]
        },
        include: {
            creator: { select: { id: true, fullName: true } }
        }
    });

    if (!foodItem) throw AppError.notFound('Food item not found', 'FOOD_NOT_FOUND');

    res.status(200).json({
        success: true,
        data: {
            id: foodItem.id,
            organizationId: foodItem.orgId,
            name: foodItem.name,
            brand: foodItem.brand,
            category: foodItem.category,
            subCategory: foodItem.subCategory,
            servingSize: `${foodItem.servingSizeG} g`,
            servingSizeG: Number(foodItem.servingSizeG),
            isGlobal: foodItem.orgId === null,
            isVerified: foodItem.isVerified,
            nutrition: {
                calories: foodItem.calories,
                proteinG: foodItem.proteinG ? Number(foodItem.proteinG) : null,
                carbsG: foodItem.carbsG ? Number(foodItem.carbsG) : null,
                fatsG: foodItem.fatsG ? Number(foodItem.fatsG) : null,
                fiberG: foodItem.fiberG ? Number(foodItem.fiberG) : null,
                sodiumMg: foodItem.sodiumMg ? Number(foodItem.sodiumMg) : null,
                sugarG: foodItem.sugarG ? Number(foodItem.sugarG) : null
            },
            allergenFlags: foodItem.allergenFlags,
            dietaryTags: foodItem.dietaryTags,
            barcode: foodItem.barcode,
            source: foodItem.source,
            createdBy: foodItem.creator,
            createdAt: foodItem.createdAt,
            updatedAt: foodItem.updatedAt
        }
    });
});

/**
 * PATCH /api/v1/food-items/:id
 * Update food item (org-specific only)
 */
export const updateFoodItem = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;
    const data: UpdateFoodItemInput = req.body;

    // Only allow updating org-specific foods
    const existingFood = await prisma.foodItem.findFirst({
        where: { id, orgId: req.user.organizationId }
    });

    if (!existingFood) {
        throw AppError.notFound('Food item not found or cannot be edited', 'FOOD_NOT_FOUND');
    }

    const updated = await prisma.foodItem.update({
        where: { id },
        data: {
            ...(data.name && { name: data.name }),
            ...(data.brand !== undefined && { brand: data.brand }),
            ...(data.category && { category: data.category }),
            ...(data.subCategory !== undefined && { subCategory: data.subCategory }),
            ...(data.servingSizeG && { servingSizeG: data.servingSizeG }),
            ...(data.calories !== undefined && { calories: data.calories }),
            ...(data.proteinG !== undefined && { proteinG: data.proteinG }),
            ...(data.carbsG !== undefined && { carbsG: data.carbsG }),
            ...(data.fatsG !== undefined && { fatsG: data.fatsG }),
            ...(data.fiberG !== undefined && { fiberG: data.fiberG }),
            ...(data.sodiumMg !== undefined && { sodiumMg: data.sodiumMg }),
            ...(data.sugarG !== undefined && { sugarG: data.sugarG }),
            ...(data.barcode !== undefined && { barcode: data.barcode }),
            ...(data.allergenFlags && { allergenFlags: data.allergenFlags }),
            ...(data.dietaryTags && { dietaryTags: data.dietaryTags })
        }
    });

    logger.info('Food item updated', { foodItemId: updated.id });

    res.status(200).json({
        success: true,
        data: {
            id: updated.id,
            name: updated.name,
            category: updated.category,
            updatedAt: updated.updatedAt
        }
    });
});

/**
 * DELETE /api/v1/food-items/:id
 * Delete org-specific food (soft delete via removing)
 */
export const deleteFoodItem = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;

    // Only allow deleting org-specific foods
    const existingFood = await prisma.foodItem.findFirst({
        where: { id, orgId: req.user.organizationId }
    });

    if (!existingFood) {
        throw AppError.notFound('Food item not found or cannot be deleted', 'FOOD_NOT_FOUND');
    }

    // Check if food is used in any meals
    const usageCount = await prisma.mealFoodItem.count({
        where: { foodId: id }
    });

    if (usageCount > 0) {
        throw AppError.conflict(
            `Cannot delete: food item is used in ${usageCount} meal(s)`,
            'FOOD_IN_USE'
        );
    }

    await prisma.foodItem.delete({ where: { id } });

    logger.info('Food item deleted', { foodItemId: id });

    res.status(204).send();
});

/**
 * POST /api/v1/meals/:mealId/food-items
 * Add a food item to a meal
 */
export const addFoodToMeal = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { mealId } = req.params;
    const { foodId, quantityG, notes } = req.body;

    // Verify meal exists and belongs to org
    const meal = await prisma.meal.findFirst({
        where: { id: mealId },
        include: { dietPlan: true }
    });

    if (!meal || meal.dietPlan.orgId !== req.user.organizationId) {
        throw AppError.notFound('Meal not found', 'MEAL_NOT_FOUND');
    }

    // Verify food exists
    const foodItem = await prisma.foodItem.findFirst({
        where: {
            id: foodId,
            OR: [
                { orgId: null },
                { orgId: req.user.organizationId }
            ]
        }
    });

    if (!foodItem) throw AppError.notFound('Food item not found', 'FOOD_NOT_FOUND');

    // Calculate nutrition based on quantity
    const multiplier = quantityG / Number(foodItem.servingSizeG);
    const calculatedCalories = Math.round(foodItem.calories * multiplier);
    const calculatedProtein = foodItem.proteinG ? Number(foodItem.proteinG) * multiplier : null;
    const calculatedCarbs = foodItem.carbsG ? Number(foodItem.carbsG) * multiplier : null;
    const calculatedFats = foodItem.fatsG ? Number(foodItem.fatsG) * multiplier : null;
    const calculatedFiber = foodItem.fiberG ? Number(foodItem.fiberG) * multiplier : null;

    // Get current max sortOrder
    const maxSortOrder = await prisma.mealFoodItem.aggregate({
        where: { mealId },
        _max: { sortOrder: true }
    });

    const mealFoodItem = await prisma.mealFoodItem.create({
        data: {
            mealId,
            foodId,
            quantityG,
            calories: calculatedCalories,
            proteinG: calculatedProtein,
            carbsG: calculatedCarbs,
            fatsG: calculatedFats,
            fiberG: calculatedFiber,
            notes,
            sortOrder: (maxSortOrder._max.sortOrder || 0) + 1
        },
        include: {
            foodItem: true
        }
    });

    logger.info('Food added to meal', { mealId, foodId, mealFoodItemId: mealFoodItem.id });

    res.status(201).json({
        success: true,
        data: {
            id: mealFoodItem.id,
            mealId: mealFoodItem.mealId,
            foodId: mealFoodItem.foodId,
            foodName: mealFoodItem.foodItem.name,
            quantity: Number(mealFoodItem.quantityG),
            unit: 'g',
            nutrition: {
                calories: mealFoodItem.calories,
                proteinG: mealFoodItem.proteinG ? Math.round(Number(mealFoodItem.proteinG) * 10) / 10 : null,
                carbsG: mealFoodItem.carbsG ? Math.round(Number(mealFoodItem.carbsG) * 10) / 10 : null,
                fatsG: mealFoodItem.fatsG ? Math.round(Number(mealFoodItem.fatsG) * 10) / 10 : null,
                fiberG: mealFoodItem.fiberG ? Math.round(Number(mealFoodItem.fiberG) * 10) / 10 : null
            },
            notes: mealFoodItem.notes,
            sortOrder: mealFoodItem.sortOrder
        }
    });
});

/**
 * PATCH /api/v1/meals/:mealId/food-items/:itemId
 * Update quantity of a food in a meal
 */
export const updateMealFoodItem = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { mealId, itemId } = req.params;
    const { quantityG, notes } = req.body;

    // Verify meal food item exists
    const existing = await prisma.mealFoodItem.findFirst({
        where: { id: itemId, mealId },
        include: {
            meal: { include: { dietPlan: true } },
            foodItem: true
        }
    });

    if (!existing || existing.meal.dietPlan.orgId !== req.user.organizationId) {
        throw AppError.notFound('Meal food item not found', 'ITEM_NOT_FOUND');
    }

    // Recalculate nutrition if quantity changed
    let updateData: any = {};
    if (notes !== undefined) updateData.notes = notes;

    if (quantityG) {
        const multiplier = quantityG / Number(existing.foodItem.servingSizeG);
        updateData = {
            ...updateData,
            quantityG,
            calories: Math.round(existing.foodItem.calories * multiplier),
            proteinG: existing.foodItem.proteinG ? Number(existing.foodItem.proteinG) * multiplier : null,
            carbsG: existing.foodItem.carbsG ? Number(existing.foodItem.carbsG) * multiplier : null,
            fatsG: existing.foodItem.fatsG ? Number(existing.foodItem.fatsG) * multiplier : null,
            fiberG: existing.foodItem.fiberG ? Number(existing.foodItem.fiberG) * multiplier : null
        };
    }

    const updated = await prisma.mealFoodItem.update({
        where: { id: itemId },
        data: updateData,
        include: { foodItem: true }
    });

    logger.info('Meal food item updated', { itemId });

    res.status(200).json({
        success: true,
        data: {
            id: updated.id,
            foodName: updated.foodItem.name,
            quantity: Number(updated.quantityG),
            nutrition: {
                calories: updated.calories,
                proteinG: updated.proteinG ? Math.round(Number(updated.proteinG) * 10) / 10 : null
            }
        }
    });
});

/**
 * DELETE /api/v1/meals/:mealId/food-items/:itemId
 * Remove a food item from a meal
 */
export const removeFoodFromMeal = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { mealId, itemId } = req.params;

    // Verify meal food item exists
    const existing = await prisma.mealFoodItem.findFirst({
        where: { id: itemId, mealId },
        include: { meal: { include: { dietPlan: true } } }
    });

    if (!existing || existing.meal.dietPlan.orgId !== req.user.organizationId) {
        throw AppError.notFound('Meal food item not found', 'ITEM_NOT_FOUND');
    }

    await prisma.mealFoodItem.delete({ where: { id: itemId } });

    logger.info('Food removed from meal', { mealId, itemId });

    res.status(204).send();
});
</file>

<file path="backend/src/controllers/meal.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';

export const addMealToPlan = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { planId, dayIndex, mealDate, mealType, timeOfDay, title, description, instructions, foodItems } = req.body;

    if (!planId || !mealType || !title) {
        throw AppError.badRequest('planId, mealType, and title are required', 'MISSING_FIELDS');
    }

    const plan = await prisma.dietPlan.findFirst({
        where: { id: planId, orgId: req.user.organizationId }
    });

    if (!plan) throw AppError.notFound('Diet plan not found', 'PLAN_NOT_FOUND');

    const meal = await prisma.meal.create({
        data: {
            planId,
            dayOfWeek: dayIndex,
            mealDate: mealDate ? new Date(mealDate) : null,
            mealType,
            timeOfDay,
            name: title,
            description,
            instructions,
            foodItems: foodItems?.length ? {
                create: foodItems.map((item: any, sortOrder: number) => ({
                    foodId: item.foodId,
                    quantityG: item.quantity,
                    notes: item.notes,
                    sortOrder
                }))
            } : undefined
        },
        include: { foodItems: { include: { foodItem: true } } }
    });

    logger.info('Meal added to plan', { mealId: meal.id, planId });
    res.status(201).json({ success: true, data: meal });
});

export const updateMeal = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { title, description, instructions, timeOfDay } = req.body;

    const meal = await prisma.meal.findUnique({
        where: { id: req.params.id },
        include: { dietPlan: true }
    });

    if (!meal || meal.dietPlan.orgId !== req.user.organizationId) {
        throw AppError.notFound('Meal not found', 'MEAL_NOT_FOUND');
    }

    const updated = await prisma.meal.update({
        where: { id: req.params.id },
        data: {
            ...(title && { name: title }),
            ...(description !== undefined && { description }),
            ...(instructions !== undefined && { instructions }),
            ...(timeOfDay !== undefined && { timeOfDay })
        }
    });

    logger.info('Meal updated', { mealId: updated.id });
    res.status(200).json({ success: true, data: updated });
});

export const deleteMeal = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const meal = await prisma.meal.findUnique({
        where: { id: req.params.id },
        include: { dietPlan: true }
    });

    if (!meal || meal.dietPlan.orgId !== req.user.organizationId) {
        throw AppError.notFound('Meal not found', 'MEAL_NOT_FOUND');
    }

    await prisma.meal.delete({ where: { id: req.params.id } });

    logger.info('Meal deleted', { mealId: req.params.id });
    res.status(204).send();
});
</file>

<file path="backend/src/controllers/mealLog.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';
import { CreateMealLogInput, UpdateMealLogInput, ReviewMealLogInput } from '../schemas/mealLog.schema';

export const createMealLog = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const data: CreateMealLogInput = req.body;

    const client = await prisma.client.findFirst({
        where: { id: data.clientId, orgId: req.user.organizationId }
    });

    if (!client) throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');

    const meal = await prisma.meal.findUnique({
        where: { id: data.mealId },
        include: { dietPlan: true }
    });

    if (!meal || meal.dietPlan.orgId !== req.user.organizationId) {
        throw AppError.notFound('Meal not found', 'MEAL_NOT_FOUND');
    }

    const mealLog = await prisma.mealLog.create({
        data: {
            orgId: req.user.organizationId,
            clientId: data.clientId,
            mealId: data.mealId,
            scheduledDate: new Date(data.scheduledDate),
            scheduledTime: data.scheduledTime,
            status: 'pending'
        },
        include: {
            meal: { select: { name: true, mealType: true } },
            client: { select: { id: true, fullName: true } }
        }
    });

    logger.info('Meal log created', { mealLogId: mealLog.id });
    res.status(201).json({ success: true, data: mealLog });
});

export const listMealLogs = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { clientId, dateFrom, dateTo, status, page = '1', pageSize = '20', sortBy = 'scheduledDate' } = req.query;

    const skip = (Number(page) - 1) * Number(pageSize);
    const take = Number(pageSize);

    const where: any = { orgId: req.user.organizationId };
    if (clientId) where.clientId = String(clientId);
    if (status) where.status = String(status);

    if (dateFrom || dateTo) {
        where.scheduledDate = {};
        if (dateFrom) where.scheduledDate.gte = new Date(String(dateFrom));
        if (dateTo) where.scheduledDate.lte = new Date(String(dateTo));
    }

    if (req.user.role === 'dietitian') {
        where.client = { primaryDietitianId: req.user.id };
    }

    const [mealLogs, total] = await prisma.$transaction([
        prisma.mealLog.findMany({
            where, skip, take,
            orderBy: { [String(sortBy)]: 'desc' },
            include: {
                meal: { select: { name: true, mealType: true, timeOfDay: true } },
                client: { select: { id: true, fullName: true } },
                reviewer: { select: { id: true, fullName: true } }
            }
        }),
        prisma.mealLog.count({ where })
    ]);

    res.status(200).json({
        success: true,
        data: mealLogs.map(log => ({
            id: log.id,
            mealId: log.mealId,
            scheduledDate: log.scheduledDate,
            scheduledTime: log.scheduledTime,
            meal: { title: log.meal.name, mealType: log.meal.mealType },
            client: log.client,
            status: log.status,
            photoUrl: log.mealPhotoUrl,
            clientNotes: log.clientNotes,
            dietitianFeedback: log.dietitianFeedback,
            reviewedByUser: log.reviewer,
            dietitianReviewedAt: log.dietitianFeedbackAt,
            loggedAt: log.loggedAt,
            createdAt: log.createdAt
        })),
        meta: { page: Number(page), pageSize: Number(pageSize), total, totalPages: Math.ceil(total / Number(pageSize)) }
    });
});

export const getMealLog = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const mealLog = await prisma.mealLog.findFirst({
        where: { id: req.params.id, orgId: req.user.organizationId },
        include: {
            meal: { include: { foodItems: { include: { foodItem: true } } } },
            client: { select: { id: true, fullName: true } },
            reviewer: { select: { id: true, fullName: true } }
        }
    });

    if (!mealLog) throw AppError.notFound('Meal log not found', 'MEAL_LOG_NOT_FOUND');

    let totalCalories = 0, totalProteinG = 0, totalCarbsG = 0, totalFatsG = 0;

    const items = mealLog.meal.foodItems.map(mfi => {
        const food = mfi.foodItem;
        const quantity = Number(mfi.quantityG);
        const servingSize = Number(food.servingSizeG);
        const multiplier = quantity / servingSize;

        const calories = Math.round(food.calories * multiplier);
        const proteinG = food.proteinG ? Number(food.proteinG) * multiplier : 0;
        const carbsG = food.carbsG ? Number(food.carbsG) * multiplier : 0;
        const fatsG = food.fatsG ? Number(food.fatsG) * multiplier : 0;

        totalCalories += calories;
        totalProteinG += proteinG;
        totalCarbsG += carbsG;
        totalFatsG += fatsG;

        return { foodId: food.id, foodName: food.name, quantity, unit: 'g', nutrition: { calories, proteinG: Math.round(proteinG * 10) / 10, carbsG: Math.round(carbsG * 10) / 10, fatsG: Math.round(fatsG * 10) / 10 } };
    });

    res.status(200).json({
        success: true,
        data: {
            id: mealLog.id,
            organizationId: mealLog.orgId,
            client: mealLog.client,
            mealId: mealLog.mealId,
            scheduledDate: mealLog.scheduledDate,
            scheduledTime: mealLog.scheduledTime,
            meal: { title: mealLog.meal.name, mealType: mealLog.meal.mealType, instructions: mealLog.meal.instructions, items, totals: { calories: totalCalories, proteinG: Math.round(totalProteinG * 10) / 10, carbsG: Math.round(totalCarbsG * 10) / 10, fatsG: Math.round(totalFatsG * 10) / 10 } },
            status: mealLog.status,
            photoUrl: mealLog.mealPhotoUrl,
            clientNotes: mealLog.clientNotes,
            dietitianFeedback: mealLog.dietitianFeedback,
            reviewedByUser: mealLog.reviewer,
            dietitianReviewedAt: mealLog.dietitianFeedbackAt,
            loggedAt: mealLog.loggedAt,
            createdAt: mealLog.createdAt,
            updatedAt: mealLog.updatedAt
        }
    });
});

export const updateMealLog = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const data: UpdateMealLogInput = req.body;

    const mealLog = await prisma.mealLog.findFirst({
        where: { id: req.params.id, orgId: req.user.organizationId }
    });

    if (!mealLog) throw AppError.notFound('Meal log not found', 'MEAL_LOG_NOT_FOUND');

    const updateData: any = {};
    if (data.status) updateData.status = data.status;
    if (data.clientNotes !== undefined) updateData.clientNotes = data.clientNotes;
    if (data.substituteDescription !== undefined) updateData.substituteDescription = data.substituteDescription;
    if (data.substituteCaloriesEst !== undefined) updateData.substituteCaloriesEst = data.substituteCaloriesEst;
    if (data.photoUrl) { updateData.mealPhotoUrl = data.photoUrl; updateData.photoUploadedAt = new Date(); }
    if (data.status && data.status !== 'pending') updateData.loggedAt = new Date();

    const updated = await prisma.mealLog.update({ where: { id: req.params.id }, data: updateData });

    logger.info('Meal log updated', { mealLogId: updated.id });
    res.status(200).json({ success: true, data: { id: updated.id, status: updated.status, photoUrl: updated.mealPhotoUrl, clientNotes: updated.clientNotes, loggedAt: updated.loggedAt } });
});

export const reviewMealLog = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const data: ReviewMealLogInput = req.body;

    const mealLog = await prisma.mealLog.findFirst({
        where: { id: req.params.id, orgId: req.user.organizationId }
    });

    if (!mealLog) throw AppError.notFound('Meal log not found', 'MEAL_LOG_NOT_FOUND');

    const updateData: any = { reviewedByUserId: req.user.id, dietitianFeedbackAt: new Date() };
    if (data.dietitianFeedback !== undefined) updateData.dietitianFeedback = data.dietitianFeedback;
    if (data.status) updateData.status = data.status;
    if (data.overrideCalories !== undefined) updateData.substituteCaloriesEst = data.overrideCalories;

    const updated = await prisma.mealLog.update({
        where: { id: req.params.id },
        data: updateData,
        include: { reviewer: { select: { id: true, fullName: true } } }
    });

    logger.info('Meal log reviewed', { mealLogId: updated.id, reviewerId: req.user.id });
    res.status(200).json({ success: true, data: { id: updated.id, status: updated.status, dietitianFeedback: updated.dietitianFeedback, reviewedByUser: updated.reviewer, dietitianReviewedAt: updated.dietitianFeedbackAt } });
});

/**
 * POST /api/v1/meal-logs/:id/photo
 * Upload meal photo with compression and thumbnail
 */
export const uploadMealPhoto = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;

    // Check if file was uploaded
    if (!req.file) {
        throw AppError.badRequest('No photo file provided', 'NO_FILE');
    }

    // Verify meal log exists and belongs to org
    const mealLog = await prisma.mealLog.findFirst({
        where: { id, orgId: req.user.organizationId }
    });

    if (!mealLog) throw AppError.notFound('Meal log not found', 'MEAL_LOG_NOT_FOUND');

    // Import storage service
    const { StorageService } = await import('../services/storage.service');

    // Process and upload image
    const { fullUrl, thumbUrl } = await StorageService.uploadMealPhoto(
        req.file.buffer,
        req.user.organizationId,
        id
    );

    // Update meal log with photo URLs
    const updated = await prisma.mealLog.update({
        where: { id },
        data: {
            mealPhotoUrl: fullUrl,
            mealPhotoSmallUrl: thumbUrl,
            photoUploadedAt: new Date(),
            // Auto-set status to 'eaten' if pending
            ...(mealLog.status === 'pending' && { status: 'eaten', loggedAt: new Date() })
        }
    });

    logger.info('Meal photo uploaded', {
        mealLogId: id,
        fullUrl,
        thumbUrl,
        originalSize: req.file.size
    });

    res.status(200).json({
        success: true,
        data: {
            id: updated.id,
            mealPhotoUrl: updated.mealPhotoUrl,
            mealPhotoSmallUrl: updated.mealPhotoSmallUrl,
            photoUploadedAt: updated.photoUploadedAt,
            status: updated.status
        }
    });
});
</file>

<file path="backend/src/controllers/organization.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';
import { CreateOrganizationInput } from '../schemas/organization.schema';

export const createOrganization = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    const data: CreateOrganizationInput = req.body;

    const existingOrg = await prisma.organization.findUnique({
        where: { name: data.name }
    });

    if (existingOrg) {
        throw AppError.conflict('Organization name already taken', 'ORG_EXISTS');
    }

    const organization = await prisma.organization.create({
        data: {
            name: data.name,
            description: data.description,
            email: data.email,
            phone: data.phone,
            address: data.address,
            city: data.city,
            country: data.country || 'IN',
            timezone: data.timezone || 'Asia/Kolkata'
        }
    });

    logger.info('Organization created', { orgId: organization.id, name: organization.name });

    res.status(201).json({
        success: true,
        data: organization
    });
});

export const getOrganization = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) {
        throw AppError.unauthorized();
    }

    const organization = await prisma.organization.findUnique({
        where: { id: req.user.organizationId },
        include: {
            _count: {
                select: { clients: true, users: true }
            }
        }
    });

    if (!organization) {
        throw AppError.notFound('Organization not found', 'ORG_NOT_FOUND');
    }

    res.status(200).json({
        success: true,
        data: {
            ...organization,
            currentClientCount: organization._count.clients,
            currentUserCount: organization._count.users
        }
    });
});
</file>

<file path="backend/src/controllers/referral.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { ClientAuthRequest } from '../middleware/clientAuth.middleware';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';
import crypto from 'crypto';

/**
 * Generate a unique referral code for the client
 * Format: 6 alphanumeric characters, uppercase
 */
function generateReferralCode(): string {
    return crypto.randomBytes(3).toString('hex').toUpperCase();
}

/**
 * Get or generate referral code for the authenticated client
 */
export const getReferralCode = asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    let client = await prisma.client.findUnique({
        where: { id: req.client.id },
        select: { id: true, referralCode: true, fullName: true }
    });

    if (!client) throw AppError.notFound('Client not found');

    // Generate referral code if not exists
    if (!client.referralCode) {
        let code = generateReferralCode();
        let attempts = 0;

        // Ensure uniqueness
        while (attempts < 10) {
            const existing = await prisma.client.findUnique({
                where: { referralCode: code }
            });
            if (!existing) break;
            code = generateReferralCode();
            attempts++;
        }

        client = await prisma.client.update({
            where: { id: req.client.id },
            data: { referralCode: code },
            select: { id: true, referralCode: true, fullName: true }
        });

        logger.info('Referral code generated', { clientId: req.client.id, code });
    }

    // Generate share message
    const shareMessage = `Hey! I'm using DietKaro for my nutrition journey and it's been amazing! 🥗\n\nUse my referral code: ${client.referralCode}\n\nDownload the app and start your health journey today!`;

    res.status(200).json({
        success: true,
        data: {
            referralCode: client.referralCode,
            shareMessage,
            whatsappLink: `https://wa.me/?text=${encodeURIComponent(shareMessage)}`
        }
    });
});

/**
 * Get referral statistics and benefits for the authenticated client
 */
export const getReferralStats = asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    // Get count of clients referred by this client
    const referredClientsCount = await prisma.client.count({
        where: { referredByClientId: req.client.id, isActive: true }
    });

    // Get or create referral benefit record
    let benefit = await prisma.referralBenefit.findUnique({
        where: { clientId: req.client.id }
    });

    if (!benefit) {
        benefit = await prisma.referralBenefit.create({
            data: {
                clientId: req.client.id,
                referralCount: referredClientsCount,
                freeMonthsEarned: Math.floor(referredClientsCount / 3), // 3 referrals = 1 free month
                freeMonthsUsed: 0
            }
        });
    } else if (benefit.referralCount !== referredClientsCount) {
        // Update if count changed
        benefit = await prisma.referralBenefit.update({
            where: { clientId: req.client.id },
            data: {
                referralCount: referredClientsCount,
                freeMonthsEarned: Math.floor(referredClientsCount / 3)
            }
        });
    }

    // Get list of referred clients (limited info)
    const referredClients = await prisma.client.findMany({
        where: { referredByClientId: req.client.id, isActive: true },
        select: {
            id: true,
            fullName: true,
            createdAt: true
        },
        orderBy: { createdAt: 'desc' },
        take: 10
    });

    res.status(200).json({
        success: true,
        data: {
            referralCount: referredClientsCount,
            freeMonthsEarned: benefit.freeMonthsEarned,
            freeMonthsUsed: benefit.freeMonthsUsed,
            freeMonthsRemaining: benefit.freeMonthsEarned - benefit.freeMonthsUsed,
            referralsUntilNextReward: 3 - (referredClientsCount % 3),
            referredClients: referredClients.map(c => ({
                name: c.fullName,
                joinedAt: c.createdAt
            }))
        }
    });
});

/**
 * Validate a referral code (for client onboarding)
 */
export const validateReferralCode = asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    const { code } = req.params;

    if (!code || code.length !== 6) {
        throw AppError.badRequest('Invalid referral code format');
    }

    const referrer = await prisma.client.findUnique({
        where: { referralCode: code.toUpperCase() },
        select: { id: true, fullName: true }
    });

    if (!referrer) {
        res.status(200).json({
            success: true,
            data: { valid: false }
        });
        return;
    }

    res.status(200).json({
        success: true,
        data: {
            valid: true,
            referrerName: referrer.fullName
        }
    });
});
</file>

<file path="backend/src/controllers/reports.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { ClientAuthRequest } from '../middleware/clientAuth.middleware';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';
import { S3Client, PutObjectCommand, DeleteObjectCommand } from '@aws-sdk/client-s3';
import { getSignedUrl } from '@aws-sdk/s3-request-presigner';

// Initialize S3 client
const s3Client = new S3Client({
    region: process.env.AWS_REGION || 'ap-south-1',
    credentials: {
        accessKeyId: process.env.AWS_ACCESS_KEY_ID || '',
        secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY || '',
    },
});

const BUCKET_NAME = process.env.AWS_S3_BUCKET || 'dietconnect-uploads';

/**
 * Get list of reports for the authenticated client
 */
export const listReports = asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const { reportType, limit = '20' } = req.query;

    const where: any = {
        clientId: req.client.id
    };

    if (reportType) {
        where.reportType = String(reportType);
    }

    const reports = await prisma.clientReport.findMany({
        where,
        orderBy: { uploadedAt: 'desc' },
        take: Number(limit)
    });

    res.status(200).json({
        success: true,
        data: reports
    });
});

/**
 * Get presigned URL for uploading a report
 */
export const getUploadUrl = asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const { fileName, fileType, reportType } = req.body;

    if (!fileName || !fileType) {
        throw AppError.badRequest('fileName and fileType are required');
    }

    // Validate file type
    const allowedTypes = ['application/pdf', 'image/jpeg', 'image/png', 'image/webp'];
    if (!allowedTypes.includes(fileType)) {
        throw AppError.badRequest('Invalid file type. Allowed: PDF, JPEG, PNG, WEBP');
    }

    // Generate unique key for S3
    const timestamp = Date.now();
    const sanitizedFileName = fileName.replace(/[^a-zA-Z0-9.-]/g, '_');
    const key = `reports/${req.client.orgId}/${req.client.id}/${timestamp}-${sanitizedFileName}`;

    // Generate presigned URL for upload
    const command = new PutObjectCommand({
        Bucket: BUCKET_NAME,
        Key: key,
        ContentType: fileType,
    });

    const uploadUrl = await getSignedUrl(s3Client, command, { expiresIn: 3600 }); // 1 hour

    res.status(200).json({
        success: true,
        data: {
            uploadUrl,
            key,
            fileName,
            fileType,
            reportType
        }
    });
});

/**
 * Confirm upload and save report metadata
 */
export const createReport = asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const { key, fileName, fileType, reportType, notes } = req.body;

    if (!key || !fileName || !fileType) {
        throw AppError.badRequest('key, fileName, and fileType are required');
    }

    // Construct the file URL
    const fileUrl = `https://${BUCKET_NAME}.s3.${process.env.AWS_REGION || 'ap-south-1'}.amazonaws.com/${key}`;

    // Create report record
    const report = await prisma.clientReport.create({
        data: {
            orgId: req.client.orgId,
            clientId: req.client.id,
            fileName,
            fileUrl,
            fileType: fileType.startsWith('image/') ? 'image' : 'pdf',
            reportType: reportType || 'other',
            notes
        }
    });

    logger.info('Client report uploaded', {
        clientId: req.client.id,
        reportId: report.id,
        reportType
    });

    res.status(201).json({
        success: true,
        data: report
    });
});

/**
 * Delete a report
 */
export const deleteReport = asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const { id } = req.params;

    const report = await prisma.clientReport.findFirst({
        where: { id, clientId: req.client.id }
    });

    if (!report) {
        throw AppError.notFound('Report not found');
    }

    // Extract key from URL for S3 deletion
    const urlParts = report.fileUrl.split('.amazonaws.com/');
    if (urlParts.length === 2) {
        const key = urlParts[1];
        try {
            await s3Client.send(new DeleteObjectCommand({
                Bucket: BUCKET_NAME,
                Key: key
            }));
        } catch (error) {
            logger.warn('Failed to delete S3 object', { key, error });
        }
    }

    // Delete database record
    await prisma.clientReport.delete({
        where: { id }
    });

    logger.info('Client report deleted', { clientId: req.client.id, reportId: id });

    res.status(204).send();
});
</file>

<file path="backend/src/controllers/share.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';
import { generateDietPlanPDF, generateMealPlanPrintHtml } from '../utils/pdfGenerator';
import { sendEmail, generateDietPlanEmailHtml } from '../utils/emailService';

/**
 * Generate and download PDF for a diet plan
 */
export const downloadDietPlanPdf = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;

    const plan = await prisma.dietPlan.findFirst({
        where: { id, orgId: req.user.organizationId, isActive: true },
        include: {
            client: {
                select: { fullName: true, currentWeightKg: true, targetWeightKg: true }
            },
            meals: {
                orderBy: [{ dayOfWeek: 'asc' }, { sequenceNumber: 'asc' }],
                include: {
                    foodItems: {
                        orderBy: { sortOrder: 'asc' },
                        include: { foodItem: true }
                    }
                }
            }
        }
    });

    if (!plan) throw AppError.notFound('Diet plan not found');

    // Generate PDF
    const doc = generateDietPlanPDF(plan);

    // Set response headers for PDF download
    const filename = `diet-plan-${plan.name.replace(/[^a-z0-9]/gi, '-').toLowerCase()}.pdf`;
    res.setHeader('Content-Type', 'application/pdf');
    res.setHeader('Content-Disposition', `attachment; filename="${filename}"`);

    // Pipe PDF to response
    doc.pipe(res);
    doc.end();

    logger.info('Diet plan PDF generated', { planId: id, userId: req.user.id });
});

/**
 * Get print-friendly HTML view of diet plan
 */
export const getDietPlanPrintView = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;

    const plan = await prisma.dietPlan.findFirst({
        where: { id, orgId: req.user.organizationId, isActive: true },
        include: {
            client: {
                select: { fullName: true, currentWeightKg: true, targetWeightKg: true }
            },
            meals: {
                orderBy: [{ dayOfWeek: 'asc' }, { sequenceNumber: 'asc' }],
                include: {
                    foodItems: {
                        orderBy: { sortOrder: 'asc' },
                        include: { foodItem: true }
                    }
                }
            }
        }
    });

    if (!plan) throw AppError.notFound('Diet plan not found');

    const html = generateMealPlanPrintHtml(plan);

    res.setHeader('Content-Type', 'text/html');
    res.send(html);

    logger.info('Diet plan print view generated', { planId: id, userId: req.user.id });
});

/**
 * Send diet plan via email to client
 */
export const emailDietPlan = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;
    const { recipientEmail, customMessage } = req.body;

    const plan = await prisma.dietPlan.findFirst({
        where: { id, orgId: req.user.organizationId, isActive: true },
        include: {
            client: {
                select: {
                    fullName: true,
                    email: true,
                    currentWeightKg: true,
                    targetWeightKg: true
                }
            },
            creator: {
                select: { fullName: true }
            },
            meals: {
                orderBy: [{ dayOfWeek: 'asc' }, { sequenceNumber: 'asc' }],
                include: {
                    foodItems: {
                        orderBy: { sortOrder: 'asc' },
                        include: { foodItem: true }
                    }
                }
            }
        }
    });

    if (!plan) throw AppError.notFound('Diet plan not found');

    // Use provided email or client's email
    const targetEmail = recipientEmail || plan.client?.email;
    if (!targetEmail) {
        throw AppError.badRequest('No email address provided or client has no email');
    }

    // Generate PDF as buffer
    const doc = generateDietPlanPDF(plan);
    const chunks: Buffer[] = [];

    await new Promise<void>((resolve, reject) => {
        doc.on('data', (chunk: Buffer) => chunks.push(chunk));
        doc.on('end', () => resolve());
        doc.on('error', reject);
        doc.end();
    });

    const pdfBuffer = Buffer.concat(chunks);

    // Generate email HTML
    const html = generateDietPlanEmailHtml(
        plan.name,
        plan.client?.fullName || 'Client',
        plan.creator?.fullName || 'Your Dietitian'
    );

    // Send email with PDF attachment
    const sent = await sendEmail({
        to: targetEmail,
        subject: `Your Diet Plan: ${plan.name}`,
        html: customMessage
            ? `<p>${customMessage}</p>${html}`
            : html,
        attachments: [
            {
                filename: `${plan.name.replace(/[^a-z0-9]/gi, '-')}.pdf`,
                content: pdfBuffer,
                contentType: 'application/pdf'
            }
        ]
    });

    if (!sent) {
        throw AppError.internal('Failed to send email');
    }

    logger.info('Diet plan emailed', { planId: id, to: targetEmail, userId: req.user.id });

    res.status(200).json({
        success: true,
        data: {
            sent: true,
            recipient: targetEmail
        }
    });
});

/**
 * Generate shareable WhatsApp link for diet plan
 */
export const getDietPlanShareLink = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;

    const plan = await prisma.dietPlan.findFirst({
        where: { id, orgId: req.user.organizationId, isActive: true },
        include: {
            client: { select: { fullName: true, phone: true } }
        }
    });

    if (!plan) throw AppError.notFound('Diet plan not found');

    // Generate summary message for WhatsApp
    const message = `🥗 *${plan.name}*

Hi ${plan.client?.fullName || 'there'}!

Your personalized diet plan is ready. 

📊 Daily Targets:
${plan.targetCalories ? `• Calories: ${plan.targetCalories} kcal` : ''}
${plan.targetProteinG ? `• Protein: ${plan.targetProteinG}g` : ''}
${plan.targetCarbsG ? `• Carbs: ${plan.targetCarbsG}g` : ''}
${plan.targetFatsG ? `• Fats: ${plan.targetFatsG}g` : ''}

📱 Open the DietKaro app to view your complete meal plan!

Best regards,
Your Dietitian at DietKaro`;

    const whatsappLink = `https://wa.me/${plan.client?.phone?.replace(/[^0-9]/g, '') || ''}?text=${encodeURIComponent(message)}`;

    res.status(200).json({
        success: true,
        data: {
            message,
            whatsappLink,
            clientPhone: plan.client?.phone
        }
    });
});
</file>

<file path="backend/src/controllers/team.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { asyncHandler } from '../utils/asyncHandler';
import { AppError } from '../errors/AppError';
import { clerkClient, getAuth } from '@clerk/express';

export const listTeamMembers = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const orgId = req.user.organizationId;

    const members = await prisma.user.findMany({
        where: { orgId, isActive: true },
        select: {
            id: true,
            fullName: true,
            email: true,
            phone: true,
            role: true,
            specialization: true,
            profilePhotoUrl: true,
            createdAt: true,
        },
        orderBy: { fullName: 'asc' }
    });

    // Get client counts separately
    const clientCounts = await prisma.client.groupBy({
        by: ['primaryDietitianId'],
        where: { orgId, isActive: true },
        _count: true
    });

    const countMap = new Map(clientCounts.map(c => [c.primaryDietitianId, c._count]));

    res.status(200).json({
        success: true,
        data: members.map(m => ({
            id: m.id,
            name: m.fullName,
            email: m.email,
            phone: m.phone,
            role: m.role,
            specialization: m.specialization,
            profilePhotoUrl: m.profilePhotoUrl,
            clientCount: countMap.get(m.id) || 0,
            avatar: m.fullName.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2)
        }))
    });
});

export const inviteMember = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    const { email, role } = req.body;

    if (!req.user) throw AppError.unauthorized();
    const orgId = req.user.organizationId;

    // Check if user already exists
    const existingUser = await prisma.user.findFirst({ where: { email } });
    if (existingUser) {
        throw AppError.conflict('User with this email already exists', 'USER_EXISTS');
    }

    // Generate token
    const token = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
    const expiresAt = new Date();
    expiresAt.setDate(expiresAt.getDate() + 7); // 7 days expiry

    const invitation = await prisma.invitation.create({
        data: {
            email,
            role,
            orgId,
            token,
            expiresAt,
            status: 'pending'
        }
    });

    const inviteLink = `${process.env.FRONTEND_URL || 'http://localhost:3000'}/join?token=${token}`;

    console.log(`[Team] Invitation created for ${email}. Link: ${inviteLink}`);

    res.status(200).json({
        success: true,
        message: 'Invitation link generated',
        data: {
            inviteLink,
            invitation
        }
    });
});

export const validateInvite = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    const { token } = req.params;

    const invitation = await prisma.invitation.findUnique({
        where: { token },
        include: { organization: true }
    });

    if (!invitation || invitation.status !== 'pending' || invitation.expiresAt < new Date()) {
        throw AppError.badRequest('Invalid or expired invitation', 'INVALID_INVITE');
    }

    res.status(200).json({
        success: true,
        data: {
            email: invitation.email,
            orgName: invitation.organization.name,
            role: invitation.role
        }
    });
});

export const acceptInvite = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    const { token } = req.body;

    // Manual Auth Check since we removed requireAuth middleware
    // This allows us to handle users who exist in Clerk but not yet in our DB
    const auth = getAuth(req);
    if (!auth.userId) {
        throw AppError.unauthorized();
    }
    const clerkUserId = auth.userId;

    // 1. Validate Invitation
    const invitation = await prisma.invitation.findUnique({ where: { token } });

    if (!invitation || invitation.status !== 'pending' || invitation.expiresAt < new Date()) {
        throw AppError.badRequest('Invalid or expired invitation', 'INVALID_INVITE');
    }

    // 2. Check if DB User exists
    const dbUser = await prisma.user.findUnique({ where: { clerkUserId } });

    if (dbUser) {
        // User exists -> Update Org/Role
        // Optional: Check if email matches invitation.email
        await prisma.$transaction([
            prisma.user.update({
                where: { id: dbUser.id },
                data: {
                    orgId: invitation.orgId,
                    role: invitation.role,
                    isActive: true
                }
            }),
            prisma.invitation.update({
                where: { id: invitation.id },
                data: { status: 'accepted' }
            })
        ]);
    } else {
        // User DOES NOT exist -> Create new User
        // Fetch Clerk Name + Email 
        const clerkUser = await clerkClient.users.getUser(clerkUserId);
        const email = clerkUser.emailAddresses[0]?.emailAddress;

        if (!email) throw AppError.badRequest('Clerk user has no email', 'NO_EMAIL');
        // if (email !== invitation.email) throw AppError.forbidden('Invite email does not match logged in user');

        const fullName = `${clerkUser.firstName || ''} ${clerkUser.lastName || ''}`.trim() || 'Team Member';

        await prisma.$transaction([
            prisma.user.create({
                data: {
                    clerkUserId,
                    email,
                    fullName,
                    role: invitation.role,
                    orgId: invitation.orgId,
                    isActive: true
                }
            }),
            prisma.invitation.update({
                where: { id: invitation.id },
                data: { status: 'accepted' }
            })
        ]);
    }

    res.status(200).json({
        success: true,
        message: 'Joined organization successfully'
    });
});
</file>

<file path="backend/src/controllers/weightLog.controller.ts">
import { Response } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';
import { AppError } from '../errors/AppError';
import { asyncHandler } from '../utils/asyncHandler';
import logger from '../utils/logger';
import { CreateWeightLogInput } from '../schemas/weightLog.schema';

export const createWeightLog = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { clientId } = req.params;
    const data: CreateWeightLogInput = req.body;

    const client = await prisma.client.findFirst({
        where: { id: clientId, orgId: req.user.organizationId }
    });

    if (!client) throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');

    let bmi: number | null = null;
    if (client.heightCm) {
        const heightM = Number(client.heightCm) / 100;
        bmi = Math.round((data.weightKg / (heightM * heightM)) * 10) / 10;
    }

    const previousLog = await prisma.weightLog.findFirst({
        where: { clientId },
        orderBy: { logDate: 'desc' }
    });

    let weightChange: number | null = null;
    if (previousLog) {
        weightChange = Math.round((data.weightKg - Number(previousLog.weightKg)) * 100) / 100;
    }

    const isOutlier = weightChange !== null && Math.abs(weightChange) > 3;

    const weightLog = await prisma.weightLog.create({
        data: {
            orgId: req.user.organizationId,
            clientId,
            logDate: new Date(data.logDate),
            logTime: data.logTime,
            weightKg: data.weightKg,
            bmi,
            weightChangeFromPrevious: weightChange,
            notes: data.notes,
            progressPhotoUrl: data.progressPhotoUrl,
            isOutlier
        }
    });

    await prisma.client.update({
        where: { id: clientId },
        data: { currentWeightKg: data.weightKg }
    });

    logger.info('Weight log created', { weightLogId: weightLog.id, clientId, weightKg: data.weightKg });

    res.status(201).json({
        success: true,
        data: {
            id: weightLog.id,
            clientId: weightLog.clientId,
            logDate: weightLog.logDate,
            logTime: weightLog.logTime,
            weightKg: Number(weightLog.weightKg),
            bmi: weightLog.bmi ? Number(weightLog.bmi) : null,
            weightChange: weightLog.weightChangeFromPrevious ? Number(weightLog.weightChangeFromPrevious) : null,
            notes: weightLog.notes,
            isOutlier: weightLog.isOutlier,
            createdAt: weightLog.createdAt
        }
    });
});

export const listWeightLogs = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { clientId } = req.params;
    const { dateFrom, dateTo, page = '1', pageSize = '100', sortBy = 'logDate' } = req.query;

    const client = await prisma.client.findFirst({
        where: { id: clientId, orgId: req.user.organizationId }
    });

    if (!client) throw AppError.notFound('Client not found', 'CLIENT_NOT_FOUND');

    const skip = (Number(page) - 1) * Number(pageSize);
    const take = Number(pageSize);

    const where: any = { clientId, orgId: req.user.organizationId };
    if (dateFrom || dateTo) {
        where.logDate = {};
        if (dateFrom) where.logDate.gte = new Date(String(dateFrom));
        if (dateTo) where.logDate.lte = new Date(String(dateTo));
    }

    const [weightLogs, total] = await prisma.$transaction([
        prisma.weightLog.findMany({ where, skip, take, orderBy: { [String(sortBy)]: 'asc' } }),
        prisma.weightLog.count({ where })
    ]);

    let totalStartWeight: number | null = null;
    let totalEndWeight: number | null = null;
    let totalWeightLoss: number | null = null;
    let averageWeightLossPerWeek: number | null = null;

    if (weightLogs.length > 0) {
        totalStartWeight = Number(weightLogs[0].weightKg);
        totalEndWeight = Number(weightLogs[weightLogs.length - 1].weightKg);
        totalWeightLoss = Math.round((totalStartWeight - totalEndWeight) * 100) / 100;

        const firstDate = new Date(weightLogs[0].logDate);
        const lastDate = new Date(weightLogs[weightLogs.length - 1].logDate);
        const weeksDiff = Math.max(1, Math.round((lastDate.getTime() - firstDate.getTime()) / (7 * 24 * 60 * 60 * 1000)));
        averageWeightLossPerWeek = Math.round((totalWeightLoss / weeksDiff) * 100) / 100;
    }

    res.status(200).json({
        success: true,
        data: weightLogs.map(log => ({
            id: log.id, logDate: log.logDate, logTime: log.logTime,
            weightKg: Number(log.weightKg), bmi: log.bmi ? Number(log.bmi) : null,
            weightChange: log.weightChangeFromPrevious ? Number(log.weightChangeFromPrevious) : null,
            notes: log.notes, progressPhotoUrl: log.progressPhotoUrl, isOutlier: log.isOutlier
        })),
        meta: { page: Number(page), pageSize: Number(pageSize), total, totalStartWeight, totalEndWeight, totalWeightLoss, averageWeightLossPerWeek }
    });
});

export const listAllWeightLogs = asyncHandler(async (req: AuthenticatedRequest, res: Response, next) => {
    if (!req.user) throw AppError.unauthorized();

    const { clientId } = req.query;

    if (!clientId) {
        throw AppError.badRequest('clientId query parameter is required', 'MISSING_CLIENT_ID');
    }

    req.params.clientId = String(clientId);
    await listWeightLogs(req, res, next);
});

export const createWeightLogGeneral = asyncHandler(async (req: AuthenticatedRequest, res: Response, next) => {
    const { clientId } = req.body;

    if (!clientId) {
        throw AppError.badRequest('clientId is required', 'MISSING_CLIENT_ID');
    }

    req.params.clientId = clientId;
    await createWeightLog(req, res, next);
});

/**
 * POST /api/v1/weight-logs/:id/photo
 * Upload progress photo for weight log with compression and thumbnail
 */
export const uploadProgressPhoto = asyncHandler(async (req: AuthenticatedRequest, res: Response) => {
    if (!req.user) throw AppError.unauthorized();

    const { id } = req.params;

    // Check if file was uploaded
    if (!req.file) {
        throw AppError.badRequest('No photo file provided', 'NO_FILE');
    }

    // Verify weight log exists and belongs to org
    const weightLog = await prisma.weightLog.findFirst({
        where: { id, orgId: req.user.organizationId }
    });

    if (!weightLog) throw AppError.notFound('Weight log not found', 'WEIGHT_LOG_NOT_FOUND');

    // Import storage service
    const { StorageService } = await import('../services/storage.service');

    // Process and upload image
    const { fullUrl, thumbUrl } = await StorageService.uploadWeightPhoto(
        req.file.buffer,
        req.user.organizationId,
        id
    );

    // Update weight log with photo URL
    const updated = await prisma.weightLog.update({
        where: { id },
        data: {
            progressPhotoUrl: fullUrl
        }
    });

    logger.info('Progress photo uploaded', {
        weightLogId: id,
        fullUrl,
        thumbUrl,
        originalSize: req.file.size
    });

    res.status(200).json({
        success: true,
        data: {
            id: updated.id,
            progressPhotoUrl: updated.progressPhotoUrl,
            progressPhotoThumbUrl: thumbUrl
        }
    });
});
</file>

<file path="backend/src/errors/AppError.ts">
/**
 * Custom application error class for operational errors
 */
export class AppError extends Error {
    public readonly statusCode: number;
    public readonly code: string;
    public readonly isOperational: boolean;
    public readonly details?: unknown;

    constructor(
        message: string,
        statusCode: number = 500,
        code: string = 'INTERNAL_ERROR',
        isOperational: boolean = true,
        details?: unknown
    ) {
        super(message);
        this.statusCode = statusCode;
        this.code = code;
        this.isOperational = isOperational;
        this.details = details;

        Object.setPrototypeOf(this, AppError.prototype);
        Error.captureStackTrace(this, this.constructor);
    }

    // Common error factories
    static badRequest(message: string, code: string = 'BAD_REQUEST', details?: unknown) {
        return new AppError(message, 400, code, true, details);
    }

    static unauthorized(message: string = 'Authentication required', code: string = 'UNAUTHORIZED') {
        return new AppError(message, 401, code);
    }

    static forbidden(message: string = 'Access denied', code: string = 'FORBIDDEN') {
        return new AppError(message, 403, code);
    }

    static notFound(message: string = 'Resource not found', code: string = 'NOT_FOUND') {
        return new AppError(message, 404, code);
    }

    static conflict(message: string, code: string = 'CONFLICT') {
        return new AppError(message, 409, code);
    }

    static internal(message: string = 'Internal server error', code: string = 'INTERNAL_ERROR') {
        return new AppError(message, 500, code, false);
    }

    static validation(message: string, details?: unknown) {
        return new AppError(message, 400, 'VALIDATION_ERROR', true, details);
    }
}
</file>

<file path="backend/src/middleware/auth.middleware.ts">
import { Response, NextFunction } from 'express';
import { clerkClient, getAuth } from '@clerk/express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';

/**
 * Middleware to require authentication.
 * Uses Clerk's getAuth() to verify the session token.
 */
export const requireAuth = async (
    req: AuthenticatedRequest,
    res: Response,
    next: NextFunction
) => {
    try {
        // Get auth info from Clerk
        const auth = getAuth(req);

        if (!auth.userId) {
            return res.status(401).json({
                   success: false,
                error: {
                    code: 'UNAUTHORIZED',
                    message: 'Authentication required'
                }
            });
        }

        // Find user in our database by clerkUserId
        const dbUser = await prisma.user.findUnique({
            where: { clerkUserId: auth.userId },
            include: { organization: true }
        });

        if (!dbUser) {
            return res.status(401).json({
                success: false,
                error: {
                    code: 'USER_NOT_REGISTERED',
                    message: 'User not registered in the system. Please complete registration first.'
                }
            });
        }

        if (!dbUser.isActive) {
            return res.status(403).json({
                success: false,
                error: {
                    code: 'USER_INACTIVE',
                    message: 'User account is inactive'
                }
            });
        }

        // Attach user info to request
        req.user = {
            id: dbUser.id,
            clerkUserId: dbUser.clerkUserId!,
            organizationId: dbUser.orgId,
            role: dbUser.role,
            email: dbUser.email,
            fullName: dbUser.fullName
        };
        req.dbUser = dbUser;

        next();
    } catch (error) {
        console.error('Auth middleware error:', error);
        return res.status(401).json({
            success: false,
            error: {
                code: 'AUTH_ERROR',
                message: 'Authentication failed'
            }
        });
    }
};

/**
 * Role-based authorization middleware.
 * Must be used after requireAuth.
 */
export const requireRole = (...allowedRoles: string[]) => {
    return (req: AuthenticatedRequest, res: Response, next: NextFunction) => {
        if (!req.user) {
            return res.status(401).json({
                success: false,
                error: {
                    code: 'UNAUTHORIZED',
                    message: 'Authentication required'
                }
            });
        }

        if (!allowedRoles.includes(req.user.role)) {
            return res.status(403).json({
                success: false,
                error: {
                    code: 'FORBIDDEN',
                    message: 'You do not have permission to perform this action'
                }
            });
        }

        next();
    };
};
</file>

<file path="backend/src/middleware/clientAuth.middleware.ts">
import { Request, Response, NextFunction } from 'express';
import jwt from 'jsonwebtoken';
import prisma from '../utils/prisma';

export interface ClientAuthRequest extends Request {
    client?: {
        id: string;
        fullName: string;
        phone: string;
        email: string;
        orgId: string;
    };
}

const JWT_SECRET = process.env.CLIENT_JWT_SECRET || 'client-secret-change-in-production';

export const requireClientAuth = async (
    req: ClientAuthRequest,
    res: Response,
    next: NextFunction
) => {
    try {
        const authHeader = req.headers.authorization;
        if (!authHeader?.startsWith('Bearer ')) {
            return res.status(401).json({
                success: false,
                error: { code: 'UNAUTHORIZED', message: 'No token provided' },
            });
        }

        const token = authHeader.split(' ')[1];
        const decoded = jwt.verify(token, JWT_SECRET) as { clientId: string };

        const client = await prisma.client.findUnique({
            where: { id: decoded.clientId },
            select: {
                id: true,
                fullName: true,
                phone: true,
                email: true,
                orgId: true,
                isActive: true,
            },
        });

        if (!client || !client.isActive) {
            return res.status(401).json({
                success: false,
                error: { code: 'UNAUTHORIZED', message: 'Invalid or inactive client' },
            });
        }

        req.client = {
            id: client.id,
            fullName: client.fullName,
            phone: client.phone,
            email: client.email,
            orgId: client.orgId,
        };

        next();
    } catch (error) {
        return res.status(401).json({
            success: false,
            error: { code: 'UNAUTHORIZED', message: 'Invalid token' },
        });
    }
};

export const signClientToken = (clientId: string): string => {
    return jwt.sign({ clientId }, JWT_SECRET, { expiresIn: '30d' });
};
</file>

<file path="backend/src/middleware/errorHandler.ts">
import { Request, Response, NextFunction, ErrorRequestHandler } from 'express';
import { AppError } from '../errors/AppError';
import logger from '../utils/logger';
import { ZodError } from 'zod';
import { Prisma } from '@prisma/client';

/**
 * Global error handler middleware
 * Catches all errors and formats consistent responses
 */
export const errorHandler: ErrorRequestHandler = (
    err: Error,
    req: Request,
    res: Response,
    next: NextFunction
) => {
    // Log the error
    logger.error('Error caught by global handler', {
        error: err.message,
        stack: err.stack,
        path: req.path,
        method: req.method,
        body: req.body
    });

    // Handle Zod validation errors
    if (err instanceof ZodError) {
        return res.status(400).json({
            success: false,
            error: {
                code: 'VALIDATION_ERROR',
                message: 'Validation failed',
                details: err.issues.map((e: any) => ({
                    field: e.path.join('.'),
                    message: e.message
                }))
            }
        });
    }

    // Handle Prisma errors
    if (err instanceof Prisma.PrismaClientKnownRequestError) {
        if (err.code === 'P2002') {
            return res.status(409).json({
                success: false,
                error: {
                    code: 'CONFLICT',
                    message: 'A record with this value already exists'
                }
            });
        }
        if (err.code === 'P2025') {
            return res.status(404).json({
                success: false,
                error: {
                    code: 'NOT_FOUND',
                    message: 'Record not found'
                }
            });
        }
    }

    // Handle AppError (operational errors)
    if (err instanceof AppError) {
        const errorResponse: any = {
            code: err.code,
            message: err.message
        };
        if (err.details) {
            errorResponse.details = err.details;
        }
        return res.status(err.statusCode).json({
            success: false,
            error: errorResponse
        });
    }

    // Handle unknown errors (programming errors)
    const statusCode = 500;
    const message = process.env.NODE_ENV === 'production'
        ? 'Internal server error'
        : err.message;

    return res.status(statusCode).json({
        success: false,
        error: {
            code: 'INTERNAL_ERROR',
            message,
            ...(process.env.NODE_ENV !== 'production' ? { stack: err.stack } : {})
        }
    });
};

/**
 * 404 handler for undefined routes
 */
export const notFoundHandler = (req: Request, res: Response) => {
    res.status(404).json({
        success: false,
        error: {
            code: 'NOT_FOUND',
            message: `Route ${req.method} ${req.path} not found`
        }
    });
};
</file>

<file path="backend/src/middleware/testAuth.middleware.ts">
import { Response, NextFunction } from 'express';
import prisma from '../utils/prisma';
import { AuthenticatedRequest } from '../types/auth.types';

/**
 * TEST-ONLY middleware that bypasses Clerk auth for development testing.
 * Use X-Test-User-Id header to simulate an authenticated user.
 * 
 * DO NOT USE IN PRODUCTION!
 */
export const testAuthBypass = async (
    req: AuthenticatedRequest,
    res: Response,
    next: NextFunction
) => {
    try {
        const testUserId = req.headers['x-test-user-id'] as string;

        if (!testUserId) {
            return res.status(401).json({
                success: false,
                error: {
                    code: 'UNAUTHORIZED',
                    message: 'X-Test-User-Id header required for testing'
                }
            });
        }

        const dbUser = await prisma.user.findUnique({
            where: { id: testUserId },
            include: { organization: true }
        });

        if (!dbUser) {
            return res.status(401).json({
                success: false,
                error: {
                    code: 'USER_NOT_FOUND',
                    message: 'Test user not found'
                }
            });
        }

        req.user = {
            id: dbUser.id,
            clerkUserId: dbUser.clerkUserId || 'test-clerk-id',
            organizationId: dbUser.orgId,
            role: dbUser.role,
            email: dbUser.email,
            fullName: dbUser.fullName
        };
        req.dbUser = dbUser;

        next();
    } catch (error) {
        console.error('Test auth error:', error);
        return res.status(500).json({
            success: false,
            error: { code: 'INTERNAL_ERROR', message: 'Test auth failed' }
        });
    }
};
</file>

<file path="backend/src/middleware/upload.middleware.ts">
import multer from 'multer';
import { Request } from 'express';
import { AppError } from '../errors/AppError';

// Memory storage for processing before S3 upload
const storage = multer.memoryStorage();

// File filter for images only
const imageFilter = (req: Request, file: Express.Multer.File, cb: multer.FileFilterCallback) => {
    const allowedMimes = ['image/jpeg', 'image/png', 'image/webp', 'image/heic', 'image/heif'];

    if (allowedMimes.includes(file.mimetype)) {
        cb(null, true);
    } else {
        cb(new AppError('Only image files are allowed (JPEG, PNG, WebP, HEIC)', 400, 'INVALID_FILE_TYPE'));
    }
};

// Multer configuration
export const upload = multer({
    storage,
    fileFilter: imageFilter,
    limits: {
        fileSize: 10 * 1024 * 1024, // 10MB max
        files: 1
    }
});

// Single photo upload middleware
export const uploadSinglePhoto = upload.single('photo');

export default upload;
</file>

<file path="backend/src/middleware/validation.middleware.ts">
import { Request, Response, NextFunction } from 'express';
import { ZodSchema, ZodError } from 'zod';

/**
 * Validation middleware factory
 * Validates request body, query, and params against Zod schemas
 */
export const validate = (schema: ZodSchema) => {
    return async (req: Request, res: Response, next: NextFunction) => {
        try {
            await schema.parseAsync({
                body: req.body,
                query: req.query,
                params: req.params
            });
            next();
        } catch (error) {
            if (error instanceof ZodError) {
                return res.status(400).json({
                    success: false,
                    error: {
                        code: 'VALIDATION_ERROR',
                        message: 'Validation failed',
                        details: error.issues.map((e: any) => ({
                            field: e.path.slice(1).join('.'),
                            message: e.message
                        }))
                    }
                });
            }
            next(error);
        }
    };
};

/**
 * Validate only request body
 */
export const validateBody = (schema: ZodSchema) => {
    return async (req: Request, res: Response, next: NextFunction) => {
        try {
            req.body = await schema.parseAsync(req.body);
            next();
        } catch (error) {
            if (error instanceof ZodError) {
                return res.status(400).json({
                    success: false,
                    error: {
                        code: 'VALIDATION_ERROR',
                        message: 'Validation failed',
                        details: error.issues.map((e: any) => ({
                            field: e.path.join('.'),
                            message: e.message
                        }))
                    }
                });
            }
            next(error);
        }
    };
};
</file>

<file path="backend/src/routes/adminReferral.routes.ts">
import { Router } from 'express';
import { requireAuth } from '../middleware/auth.middleware';
import {
    getOrgReferralStats,
    getClientReferrals,
    listClientsWithReferrals,
    redeemFreeBenefit,
} from '../controllers/adminReferral.controller';

const router = Router();

// All routes require authentication
router.use(requireAuth);

// Get overall referral statistics for the org
router.get('/stats', getOrgReferralStats);

// Get list of clients with their referral info
router.get('/clients', listClientsWithReferrals);

// Get referrals made by a specific client
router.get('/clients/:clientId/referrals', getClientReferrals);

// Redeem a free month for a client
router.post('/clients/:clientId/redeem', redeemFreeBenefit);

export default router;
</file>

<file path="backend/src/routes/auth.routes.ts">
import { Router } from 'express';
import { register, syncUser, getMe, updateMe } from '../controllers/auth.controller';
import { requireAuth } from '../middleware/auth.middleware';

const router = Router();

// Public route - called after Clerk signup
router.post('/register', register);

// Protected routes - require valid Clerk token
router.post('/sync', requireAuth, syncUser);
router.get('/me', requireAuth, getMe);
router.patch('/me', requireAuth, updateMe);

export default router;
</file>

<file path="backend/src/routes/client.routes.ts">
import { Router } from 'express';
import { createClient, getClient, listClients, updateClient, deleteClient, getClientProgress } from '../controllers/client.controller';
import { createWeightLog, listWeightLogs } from '../controllers/weightLog.controller';
import { requireAuth, requireRole } from '../middleware/auth.middleware';

const router = Router();

// All client routes require authentication
router.use(requireAuth);

router.post('/', createClient);
router.get('/', listClients);
router.get('/:id', getClient);
router.patch('/:id', updateClient);
router.delete('/:id', requireRole('admin', 'owner'), deleteClient);

// Client progress analytics
router.get('/:id/progress', getClientProgress);

// Client weight logs
router.post('/:clientId/weight-logs', createWeightLog);
router.get('/:clientId/weight-logs', listWeightLogs);

export default router;
</file>

<file path="backend/src/routes/clientApi.routes.ts">
import { Router } from 'express';
import { requireClientAuth, ClientAuthRequest } from '../middleware/clientAuth.middleware';
import { asyncHandler } from '../utils/asyncHandler';
import prisma from '../utils/prisma';
import { AppError } from '../errors/AppError';
import { Response } from 'express';

const router = Router();

// All routes require client auth
router.use(requireClientAuth);

// Get today's meals for client
router.get('/meals/today', asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const today = new Date();
    today.setHours(0, 0, 0, 0);
    const tomorrow = new Date(today);
    tomorrow.setDate(tomorrow.getDate() + 1);

    // Get active diet plan for this client
    const activePlan = await prisma.dietPlan.findFirst({
        where: {
            clientId: req.client.id,
            status: 'active',
            isActive: true,
        },
        include: {
            meals: {
                include: {
                    foodItems: {
                        include: { foodItem: true },
                    },
                },
                orderBy: { mealType: 'asc' },
            },
        },
    });

    if (!activePlan) {
        return res.status(200).json({ success: true, data: [] });
    }

    // Get meal logs for today
    const mealLogs = await prisma.mealLog.findMany({
        where: {
            clientId: req.client.id,
            scheduledDate: {
                gte: today,
                lt: tomorrow,
            },
        },
    });

    // Map meals to include log status
    const todayMeals = activePlan.meals.map((meal) => {
        const log = mealLogs.find((l) => l.mealId === meal.id);

        // Calculate macros from food items if not set on meal
        const foodItems = meal.foodItems || [];
        const calculatedCalories = foodItems.reduce((sum, fi) => {
            // Calculate from food item: (calories per 100g * quantity / 100)
            const itemCalories = fi.calories ||
                Math.round((fi.foodItem.calories * Number(fi.quantityG)) / 100);
            return sum + itemCalories;
        }, 0);
        const calculatedProtein = foodItems.reduce((sum, fi) => {
            const itemProtein = Number(fi.proteinG) ||
                (Number(fi.foodItem.proteinG || 0) * Number(fi.quantityG)) / 100;
            return sum + itemProtein;
        }, 0);
        const calculatedCarbs = foodItems.reduce((sum, fi) => {
            const itemCarbs = Number(fi.carbsG) ||
                (Number(fi.foodItem.carbsG || 0) * Number(fi.quantityG)) / 100;
            return sum + itemCarbs;
        }, 0);
        const calculatedFats = foodItems.reduce((sum, fi) => {
            const itemFats = Number(fi.fatsG) ||
                (Number(fi.foodItem.fatsG || 0) * Number(fi.quantityG)) / 100;
            return sum + itemFats;
        }, 0);

        return {
            id: log?.id || `pending-${meal.id}`,
            mealId: meal.id,
            scheduledDate: today.toISOString().split('T')[0],
            scheduledTime: meal.timeOfDay,
            status: log?.status || 'pending',
            mealPhotoUrl: log?.mealPhotoUrl,
            clientNotes: log?.clientNotes,
            dietitianFeedback: log?.dietitianFeedback,
            dietitianFeedbackAt: log?.dietitianFeedbackAt,
            loggedAt: log?.loggedAt,
            meal: {
                id: meal.id,
                planId: meal.planId,
                mealType: meal.mealType,
                name: meal.name,
                description: meal.description,
                timeOfDay: meal.timeOfDay,
                instructions: meal.instructions,
                totalCalories: meal.totalCalories || calculatedCalories,
                totalProteinG: Number(meal.totalProteinG) || Math.round(calculatedProtein),
                totalCarbsG: Number(meal.totalCarbsG) || Math.round(calculatedCarbs),
                totalFatsG: Number(meal.totalFatsG) || Math.round(calculatedFats),
                foodItems: foodItems.map((fi) => ({
                    id: fi.id,
                    foodId: fi.foodId,
                    foodName: fi.foodItem.name,
                    quantityG: fi.quantityG,
                    calories: fi.calories || Math.round((fi.foodItem.calories * Number(fi.quantityG)) / 100),
                })),
            },
        };
    });

    res.status(200).json({ success: true, data: todayMeals });
}));

// Log a meal (update status, add photo, notes)
router.patch('/meals/:mealLogId/log', asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const { mealLogId } = req.params;
    const { status, photoUrl, notes } = req.body;

    // Check if meal log exists, if not create it
    let mealLog = await prisma.mealLog.findUnique({ where: { id: mealLogId } });

    if (!mealLog) {
        // This might be a "pending" placeholder - need to create actual log
        // mealLogId here could be "pending-{mealId}" format
        if (mealLogId.startsWith('pending-')) {
            const mealId = mealLogId.replace('pending-', '');
            const meal = await prisma.meal.findUnique({ where: { id: mealId }, include: { dietPlan: true } });

            if (!meal || meal.dietPlan.clientId !== req.client.id) {
                throw AppError.notFound('Meal not found', 'MEAL_NOT_FOUND');
            }

            // Create today's date at start of day for proper matching
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            // Check if a log already exists for this meal today
            const existingLog = await prisma.mealLog.findFirst({
                where: {
                    clientId: req.client.id,
                    mealId: mealId,
                    scheduledDate: today,
                },
            });

            if (existingLog) {
                // Update existing log instead of creating duplicate
                mealLog = await prisma.mealLog.update({
                    where: { id: existingLog.id },
                    data: {
                        status: status || 'eaten',
                        mealPhotoUrl: photoUrl || existingLog.mealPhotoUrl,
                        clientNotes: notes || existingLog.clientNotes,
                        loggedAt: new Date(),
                    },
                });
            } else {
                // Create new log
                mealLog = await prisma.mealLog.create({
                    data: {
                        orgId: req.client.orgId,
                        clientId: req.client.id,
                        mealId: mealId,
                        scheduledDate: today,
                        status: status || 'eaten',
                        mealPhotoUrl: photoUrl,
                        clientNotes: notes,
                        loggedAt: new Date(),
                    },
                });
            }
        } else {
            throw AppError.notFound('Meal log not found', 'MEAL_LOG_NOT_FOUND');
        }
    } else {
        // Update existing
        if (mealLog.clientId !== req.client.id) {
            throw AppError.forbidden('Not authorized', 'FORBIDDEN');
        }

        mealLog = await prisma.mealLog.update({
            where: { id: mealLogId },
            data: {
                status: status || mealLog.status,
                mealPhotoUrl: photoUrl || mealLog.mealPhotoUrl,
                clientNotes: notes || mealLog.clientNotes,
                loggedAt: new Date(),
            },
        });
    }

    res.status(200).json({ success: true, data: mealLog });
}));

// Get client weight logs
router.get('/weight-logs', asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const limit = parseInt(req.query.limit as string) || 30;

    const logs = await prisma.weightLog.findMany({
        where: { clientId: req.client.id },
        orderBy: { logDate: 'desc' },
        take: limit,
    });

    res.status(200).json({ success: true, data: logs });
}));

// Create weight log
router.post('/weight-logs', asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const { weightKg, logDate, notes } = req.body;

    if (!weightKg || !logDate) {
        throw AppError.badRequest('weightKg and logDate required', 'MISSING_FIELDS');
    }

    const parsedDate = new Date(logDate);
    parsedDate.setHours(0, 0, 0, 0); // Normalize to start of day

    // Get previous log for delta calculation (exclude current date)
    const previousLog = await prisma.weightLog.findFirst({
        where: {
            clientId: req.client.id,
            logDate: { lt: parsedDate },
        },
        orderBy: { logDate: 'desc' },
    });

    const weightChange = previousLog ? weightKg - Number(previousLog.weightKg) : null;

    // Upsert: update if exists for same date, create if not
    const log = await prisma.weightLog.upsert({
        where: {
            clientId_logDate: {
                clientId: req.client.id,
                logDate: parsedDate,
            },
        },
        update: {
            weightKg,
            notes,
            weightChangeFromPrevious: weightChange,
        },
        create: {
            orgId: req.client.orgId,
            clientId: req.client.id,
            weightKg,
            logDate: parsedDate,
            notes,
            weightChangeFromPrevious: weightChange,
        },
    });

    // Update client's current weight
    await prisma.client.update({
        where: { id: req.client.id },
        data: { currentWeightKg: weightKg },
    });

    res.status(200).json({ success: true, data: log });
}));

// Get client stats
router.get('/stats', asyncHandler(async (req: ClientAuthRequest, res: Response) => {
    if (!req.client) throw AppError.unauthorized();

    const client = await prisma.client.findUnique({
        where: { id: req.client.id },
        select: { currentWeightKg: true, targetWeightKg: true },
    });

    // Get meal logs for last 7 days
    const weekAgo = new Date();
    weekAgo.setDate(weekAgo.getDate() - 7);

    const recentLogs = await prisma.mealLog.findMany({
        where: {
            clientId: req.client.id,
            scheduledDate: { gte: weekAgo },
        },
    });

    const totalMeals = recentLogs.length;
    const eatenMeals = recentLogs.filter((l) => l.status === 'eaten').length;
    const adherence = totalMeals > 0 ? Math.round((eatenMeals / totalMeals) * 100) : 0;

    // Get streak (consecutive days with at least one logged meal)
    // Simplified: just count recent weight logs for now
    const weightLogs = await prisma.weightLog.findMany({
        where: { clientId: req.client.id },
        orderBy: { logDate: 'desc' },
        take: 2,
    });

    let weightTrend: 'up' | 'down' | 'stable' = 'stable';
    if (weightLogs.length >= 2) {
        const diff = Number(weightLogs[0].weightKg) - Number(weightLogs[1].weightKg);
        if (diff > 0.5) weightTrend = 'up';
        else if (diff < -0.5) weightTrend = 'down';
    }

    res.status(200).json({
        success: true,
        data: {
            weeklyAdherence: adherence,
            mealCompletionRate: adherence,
            weightTrend,
            // Use latest weight log, fallback to client profile
            latestWeight: weightLogs.length > 0
                ? Number(weightLogs[0].weightKg)
                : (client?.currentWeightKg ? Number(client.currentWeightKg) : null),
            targetWeight: client?.targetWeightKg ? Number(client.targetWeightKg) : null,
            currentStreak: Math.min(eatenMeals, 7), // Simplified streak
        },
    });
}));

export default router;
</file>

<file path="backend/src/routes/clientAuth.routes.ts">
import { Router } from 'express';
import { requestOTP, verifyOTP, getClientProfile, updateClientProfile } from '../controllers/clientAuth.controller';
import { requireClientAuth } from '../middleware/clientAuth.middleware';

const router = Router();

// Public routes
router.post('/request-otp', requestOTP);
router.post('/verify-otp', verifyOTP);

// Protected routes (require client JWT)
router.get('/me', requireClientAuth, getClientProfile);
router.patch('/me', requireClientAuth, updateClientProfile);

export default router;
</file>

<file path="backend/src/routes/dashboard.routes.ts">
import { Router } from 'express';
import { requireAuth } from '../middleware/auth.middleware';
import { getDashboardStats } from '../controllers/dashboard.controller';

const router = Router();

router.get('/stats', requireAuth, getDashboardStats);

export default router;
</file>

<file path="backend/src/routes/dietPlan.routes.ts">
import { Router } from 'express';
import { createDietPlan, getDietPlan, listDietPlans, updateDietPlan, publishDietPlan, assignTemplateToClient } from '../controllers/dietPlan.controller';
import { requireAuth } from '../middleware/auth.middleware';

const router = Router();

router.use(requireAuth);

router.post('/', createDietPlan);
router.get('/', listDietPlans);
router.get('/:id', getDietPlan);
router.patch('/:id', updateDietPlan);
router.post('/:id/publish', publishDietPlan);
router.post('/:id/assign', assignTemplateToClient);

export default router;
</file>

<file path="backend/src/routes/foodItem.routes.ts">
import { Router } from 'express';
import {
    createFoodItem,
    listFoodItems,
    getFoodItem,
    updateFoodItem,
    deleteFoodItem
} from '../controllers/foodItem.controller';
import { requireAuth } from '../middleware/auth.middleware';

const router = Router();

router.use(requireAuth);

// Food Items CRUD
router.post('/', createFoodItem);
router.get('/', listFoodItems);
router.get('/:id', getFoodItem);
router.patch('/:id', updateFoodItem);
router.delete('/:id', deleteFoodItem);

export default router;
</file>

<file path="backend/src/routes/meal.routes.ts">
import { Router } from 'express';
import { addMealToPlan, updateMeal, deleteMeal } from '../controllers/meal.controller';
import { addFoodToMeal, updateMealFoodItem, removeFoodFromMeal } from '../controllers/foodItem.controller';
import { requireAuth } from '../middleware/auth.middleware';

const router = Router();

router.use(requireAuth);

// Meal CRUD
router.post('/', addMealToPlan);
router.patch('/:id', updateMeal);
router.delete('/:id', deleteMeal);

// Meal Food Items
router.post('/:mealId/food-items', addFoodToMeal);
router.patch('/:mealId/food-items/:itemId', updateMealFoodItem);
router.delete('/:mealId/food-items/:itemId', removeFoodFromMeal);

export default router;
</file>

<file path="backend/src/routes/mealLog.routes.ts">
import { Router } from 'express';
import {
    createMealLog,
    listMealLogs,
    getMealLog,
    updateMealLog,
    reviewMealLog,
    uploadMealPhoto
} from '../controllers/mealLog.controller';
import { requireAuth } from '../middleware/auth.middleware';
import { uploadSinglePhoto } from '../middleware/upload.middleware';

const router = Router();

router.use(requireAuth);

router.post('/', createMealLog);
router.get('/', listMealLogs);
router.get('/:id', getMealLog);
router.patch('/:id', updateMealLog);
router.patch('/:id/review', reviewMealLog);
router.post('/:id/photo', uploadSinglePhoto, uploadMealPhoto);

export default router;
</file>

<file path="backend/src/routes/media.routes.ts">
import { Router, Request, Response } from 'express';
import { S3Client, GetObjectCommand } from '@aws-sdk/client-s3';
import { Readable } from 'stream';

const router = Router();

// S3/Garage Configuration (reuse from storage service)
const s3Client = new S3Client({
    endpoint: process.env.S3_ENDPOINT || 'http://localhost:3900',
    region: process.env.S3_REGION || 'garage',
    credentials: {
        accessKeyId: process.env.S3_ACCESS_KEY || '',
        secretAccessKey: process.env.S3_SECRET_KEY || ''
    },
    forcePathStyle: true
});

const BUCKET = process.env.S3_BUCKET || 'dietkaro-media';

/**
 * GET /media/:prefix/:orgId/:entityId/:filename
 * Proxy endpoint to serve images from S3/Garage
 */
router.get('/:prefix/:orgId/:entityId/:filename', async (req: Request, res: Response) => {
    try {
        const { prefix, orgId, entityId, filename } = req.params;
        const key = `${prefix}/${orgId}/${entityId}/${filename}`;

        const command = new GetObjectCommand({
            Bucket: BUCKET,
            Key: key
        });

        const response = await s3Client.send(command);

        // Set content type
        res.setHeader('Content-Type', response.ContentType || 'image/jpeg');
        res.setHeader('Cache-Control', 'public, max-age=31536000'); // Cache for 1 year
        res.setHeader('Content-Length', response.ContentLength?.toString() || '0');

        // Stream the response
        if (response.Body instanceof Readable) {
            response.Body.pipe(res);
        } else if (response.Body) {
            const chunks: Buffer[] = [];
            const readable = response.Body as any;
            for await (const chunk of readable) {
                chunks.push(chunk);
            }
            res.send(Buffer.concat(chunks));
        } else {
            res.status(404).json({ success: false, error: { code: 'NOT_FOUND', message: 'Image not found' } });
        }
    } catch (error: any) {
        if (error.name === 'NoSuchKey') {
            return res.status(404).json({ success: false, error: { code: 'NOT_FOUND', message: 'Image not found' } });
        }
        console.error('Error fetching image:', error);
        res.status(500).json({ success: false, error: { code: 'INTERNAL_ERROR', message: 'Failed to fetch image' } });
    }
});

export default router;
</file>

<file path="backend/src/routes/organization.routes.ts">
import { Router } from 'express';
import { createOrganization, getOrganization } from '../controllers/organization.controller';
import { requireAuth, requireRole } from '../middleware/auth.middleware';

const router = Router();

// Public route for creating new organizations (during onboarding)
router.post('/', createOrganization);

// Protected routes
router.get('/', requireAuth, getOrganization);

export default router;
</file>

<file path="backend/src/routes/referral.routes.ts">
import { Router } from 'express';
import { getReferralCode, getReferralStats, validateReferralCode } from '../controllers/referral.controller';
import { requireClientAuth } from '../middleware/clientAuth.middleware';

const router = Router();

// All routes require client authentication
router.use(requireClientAuth);

// Get or generate referral code
router.get('/code', getReferralCode);

// Get referral statistics and benefits
router.get('/stats', getReferralStats);

// Validate a referral code
router.get('/validate/:code', validateReferralCode);

export default router;
</file>

<file path="backend/src/routes/reports.routes.ts">
import { Router } from 'express';
import { listReports, getUploadUrl, createReport, deleteReport } from '../controllers/reports.controller';
import { requireClientAuth } from '../middleware/clientAuth.middleware';

const router = Router();

// All routes require client authentication
router.use(requireClientAuth);

// List client's reports
router.get('/', listReports);

// Get presigned upload URL
router.post('/upload-url', getUploadUrl);

// Create/confirm report after upload
router.post('/', createReport);

// Delete a report
router.delete('/:id', deleteReport);

export default router;
</file>

<file path="backend/src/routes/share.routes.ts">
import { Router } from 'express';
import { requireAuth } from '../middleware/auth.middleware';
import {
    downloadDietPlanPdf,
    getDietPlanPrintView,
    emailDietPlan,
    getDietPlanShareLink,
} from '../controllers/share.controller';

const router = Router();

// All routes require authentication
router.use(requireAuth);

// PDF download
router.get('/diet-plans/:id/pdf', downloadDietPlanPdf);

// Print-friendly HTML view
router.get('/diet-plans/:id/print', getDietPlanPrintView);

// Email diet plan to client
router.post('/diet-plans/:id/email', emailDietPlan);

// Get WhatsApp share link
router.get('/diet-plans/:id/whatsapp', getDietPlanShareLink);

export default router;
</file>

<file path="backend/src/routes/team.routes.ts">
import { Router } from 'express';
import { requireAuth } from '../middleware/auth.middleware';
import { listTeamMembers, inviteMember, validateInvite, acceptInvite } from '../controllers/team.controller';

const router = Router();


router.get('/', requireAuth, listTeamMembers);
router.post('/invite', requireAuth, inviteMember);
router.get('/invitation/:token', validateInvite); // Public route
router.post('/join', acceptInvite);

export default router;
</file>

<file path="backend/src/routes/weightLog.routes.ts">
import { Router } from 'express';
import {
    createWeightLogGeneral,
    listAllWeightLogs,
    uploadProgressPhoto
} from '../controllers/weightLog.controller';
import { requireAuth } from '../middleware/auth.middleware';
import { uploadSinglePhoto } from '../middleware/upload.middleware';

const router = Router();

router.use(requireAuth);

router.post('/', createWeightLogGeneral);
router.get('/', listAllWeightLogs);
router.post('/:id/photo', uploadSinglePhoto, uploadProgressPhoto);

export default router;
</file>

<file path="backend/src/schemas/client.schema.ts">
import { z } from 'zod';

export const createClientSchema = z.object({
    fullName: z.string().min(2, 'Full name must be at least 2 characters'),
    email: z.string().email('Invalid email format'),
    phone: z.string().min(10, 'Phone must be at least 10 characters'),
    dateOfBirth: z.string().optional(),
    gender: z.enum(['male', 'female', 'other']).optional(),
    heightCm: z.number().min(50).max(300).optional(),
    currentWeightKg: z.number().min(10).max(500).optional(),
    targetWeightKg: z.number().min(10).max(500).optional(),
    activityLevel: z.enum(['sedentary', 'light', 'moderate', 'active', 'very_active']).optional(),
    primaryDietitianId: z.string().uuid().optional(),
    dietaryPreferences: z.array(z.string()).optional().default([]),
    allergies: z.array(z.string()).optional().default([]),
    medicalConditions: z.array(z.string()).optional().default([]),
    medications: z.array(z.string()).optional().default([]),
    healthNotes: z.string().optional()
});

export const updateClientSchema = createClientSchema.partial();

export const clientIdParamSchema = z.object({
    id: z.string().uuid('Invalid client ID')
});

export type CreateClientInput = z.infer<typeof createClientSchema>;
export type UpdateClientInput = z.infer<typeof updateClientSchema>;
</file>

<file path="backend/src/schemas/dietPlan.schema.ts">
import { z } from 'zod';

export const createDietPlanSchema = z.object({
    clientId: z.string().uuid('Invalid client ID'),
    name: z.string().min(2, 'Plan name must be at least 2 characters'),
    description: z.string().optional(),
    startDate: z.string().refine((val) => !isNaN(Date.parse(val)), 'Invalid start date'),
    endDate: z.string().refine((val) => !isNaN(Date.parse(val)), 'Invalid end date').optional(),
    targetCalories: z.number().min(500).max(10000).optional(),
    targetProteinG: z.number().min(0).max(500).optional(),
    targetCarbsG: z.number().min(0).max(1000).optional(),
    targetFatsG: z.number().min(0).max(500).optional(),
    targetFiberG: z.number().min(0).max(200).optional(),
    notesForClient: z.string().optional(),
    internalNotes: z.string().optional(),
    meals: z.array(z.object({
        dayIndex: z.number().min(0).max(6).optional(),
        mealDate: z.string().optional(),
        mealType: z.string(),
        timeOfDay: z.string().optional(),
        title: z.string(),
        description: z.string().optional(),
        instructions: z.string().optional(),
        foodItems: z.array(z.object({
            foodId: z.string().uuid(),
            quantity: z.number().min(0),
            notes: z.string().optional()
        })).optional()
    })).optional(),
    options: z.object({
        saveAsTemplate: z.boolean().optional(),
        templateCategory: z.string().optional()
    }).optional()
});

export const updateDietPlanSchema = createDietPlanSchema.partial().omit({ clientId: true });

export type CreateDietPlanInput = z.infer<typeof createDietPlanSchema>;
export type UpdateDietPlanInput = z.infer<typeof updateDietPlanSchema>;
</file>

<file path="backend/src/schemas/foodItem.schema.ts">
import { z } from 'zod';

// Create Food Item
export const createFoodItemSchema = z.object({
    name: z.string().min(1, 'Name is required').max(255),
    brand: z.string().max(100).optional(),
    category: z.string().min(1, 'Category is required'),
    subCategory: z.string().optional(),
    servingSizeG: z.number().positive().default(100),
    calories: z.number().int().min(0),
    proteinG: z.number().min(0).optional(),
    carbsG: z.number().min(0).optional(),
    fatsG: z.number().min(0).optional(),
    fiberG: z.number().min(0).optional(),
    sodiumMg: z.number().min(0).optional(),
    sugarG: z.number().min(0).optional(),
    barcode: z.string().optional(),
    allergenFlags: z.array(z.string()).default([]),
    dietaryTags: z.array(z.string()).default([])
});

export type CreateFoodItemInput = z.infer<typeof createFoodItemSchema>;

// Update Food Item
export const updateFoodItemSchema = createFoodItemSchema.partial();

export type UpdateFoodItemInput = z.infer<typeof updateFoodItemSchema>;

// Add Food to Meal
export const addFoodToMealSchema = z.object({
    foodId: z.string().uuid(),
    quantityG: z.number().positive(),
    notes: z.string().optional()
});

export type AddFoodToMealInput = z.infer<typeof addFoodToMealSchema>;

// Update Food in Meal
export const updateMealFoodItemSchema = z.object({
    quantityG: z.number().positive().optional(),
    notes: z.string().optional()
});

export type UpdateMealFoodItemInput = z.infer<typeof updateMealFoodItemSchema>;
</file>

<file path="backend/src/schemas/mealLog.schema.ts">
import { z } from 'zod';

export const createMealLogSchema = z.object({
    clientId: z.string().uuid('Invalid client ID'),
    mealId: z.string().uuid('Invalid meal ID'),
    scheduledDate: z.string().refine((val) => !isNaN(Date.parse(val)), 'Invalid scheduled date'),
    scheduledTime: z.string().optional()
});

export const updateMealLogSchema = z.object({
    status: z.enum(['pending', 'eaten', 'substituted', 'skipped']).optional(),
    photoUrl: z.string().url().optional(),
    clientNotes: z.string().optional(),
    substituteDescription: z.string().optional(),
    substituteCaloriesEst: z.number().optional()
});

export const reviewMealLogSchema = z.object({
    dietitianFeedback: z.string().optional(),
    status: z.enum(['pending', 'eaten', 'substituted', 'skipped']).optional(),
    overrideCalories: z.number().optional()
});

export const mealLogQuerySchema = z.object({
    clientId: z.string().uuid().optional(),
    dateFrom: z.string().optional(),
    dateTo: z.string().optional(),
    status: z.enum(['pending', 'eaten', 'substituted', 'skipped']).optional(),
    page: z.string().optional().default('1'),
    pageSize: z.string().optional().default('20'),
    sortBy: z.string().optional().default('scheduledDate')
});

export type CreateMealLogInput = z.infer<typeof createMealLogSchema>;
export type UpdateMealLogInput = z.infer<typeof updateMealLogSchema>;
export type ReviewMealLogInput = z.infer<typeof reviewMealLogSchema>;
</file>

<file path="backend/src/schemas/organization.schema.ts">
import { z } from 'zod';

export const createOrganizationSchema = z.object({
    name: z.string().min(2, 'Organization name must be at least 2 characters'),
    description: z.string().optional(),
    email: z.string().email('Invalid email format').optional(),
    phone: z.string().optional(),
    address: z.string().optional(),
    city: z.string().optional(),
    country: z.string().default('IN'),
    timezone: z.string().default('Asia/Kolkata')
});

export type CreateOrganizationInput = z.infer<typeof createOrganizationSchema>;
</file>

<file path="backend/src/schemas/weightLog.schema.ts">
import { z } from 'zod';

export const createWeightLogSchema = z.object({
    logDate: z.string().refine((val) => !isNaN(Date.parse(val)), 'Invalid log date'),
    logTime: z.string().optional(),
    weightKg: z.number().min(10, 'Weight must be at least 10kg').max(500, 'Weight must be less than 500kg'),
    notes: z.string().optional(),
    progressPhotoUrl: z.string().url().optional()
});

export const weightLogQuerySchema = z.object({
    clientId: z.string().uuid('Invalid client ID'),
    dateFrom: z.string().optional(),
    dateTo: z.string().optional(),
    page: z.string().optional().default('1'),
    pageSize: z.string().optional().default('100')
});

export type CreateWeightLogInput = z.infer<typeof createWeightLogSchema>;
</file>

<file path="backend/src/services/storage.service.ts">
import { S3Client, PutObjectCommand, DeleteObjectCommand, GetObjectCommand } from '@aws-sdk/client-s3';
import { getSignedUrl } from '@aws-sdk/s3-request-presigner';
import sharp from 'sharp';
import logger from '../utils/logger';

// S3/Garage Configuration
const s3Client = new S3Client({
    endpoint: process.env.S3_ENDPOINT || 'http://localhost:3900',
    region: process.env.S3_REGION || 'garage',
    credentials: {
        accessKeyId: process.env.S3_ACCESS_KEY || '',
        secretAccessKey: process.env.S3_SECRET_KEY || ''
    },
    forcePathStyle: true // Required for Garage/MinIO
});

const BUCKET = process.env.S3_BUCKET || 'dietkaro-media';

// Default presigned URL expiration (1 hour)
const PRESIGNED_URL_EXPIRY = 3600;

// Image processing options
const COMPRESSION_QUALITY = 80;
const THUMBNAIL_SIZE = 200;
const MAX_WIDTH = 1920;

/**
 * Compress image to JPEG with quality optimization
 */
export async function compressImage(buffer: Buffer): Promise<Buffer> {
    return sharp(buffer)
        .rotate() // Auto-rotate based on EXIF
        .resize(MAX_WIDTH, MAX_WIDTH, {
            fit: 'inside',
            withoutEnlargement: true
        })
        .jpeg({ quality: COMPRESSION_QUALITY, progressive: true })
        .toBuffer();
}

/**
 * Create thumbnail from image
 */
export async function createThumbnail(buffer: Buffer, size: number = THUMBNAIL_SIZE): Promise<Buffer> {
    return sharp(buffer)
        .rotate()
        .resize(size, size, {
            fit: 'cover',
            position: 'center'
        })
        .jpeg({ quality: 75 })
        .toBuffer();
}

/**
 * Upload buffer to S3/Garage and return the key
 */
export async function uploadToS3(
    buffer: Buffer,
    key: string,
    contentType: string = 'image/jpeg'
): Promise<string> {
    const command = new PutObjectCommand({
        Bucket: BUCKET,
        Key: key,
        Body: buffer,
        ContentType: contentType
    });

    await s3Client.send(command);
    logger.info('Uploaded to S3', { key });

    return key;
}

/**
 * Generate presigned URL for reading an object
 */
export async function getPresignedUrl(key: string, expiresIn: number = PRESIGNED_URL_EXPIRY): Promise<string> {
    const command = new GetObjectCommand({
        Bucket: BUCKET,
        Key: key
    });

    const url = await getSignedUrl(s3Client, command, { expiresIn });
    return url;
}

/**
 * Generate presigned URLs for multiple keys
 */
export async function getPresignedUrls(keys: string[], expiresIn: number = PRESIGNED_URL_EXPIRY): Promise<Record<string, string>> {
    const urls: Record<string, string> = {};

    await Promise.all(
        keys.map(async (key) => {
            if (key) {
                urls[key] = await getPresignedUrl(key, expiresIn);
            }
        })
    );

    return urls;
}

/**
 * Delete object from S3/Garage
 */
export async function deleteFromS3(key: string): Promise<void> {
    const command = new DeleteObjectCommand({
        Bucket: BUCKET,
        Key: key
    });

    await s3Client.send(command);
    logger.info('Deleted from S3', { key });
}

/**
 * Process and upload image with compression + thumbnail
 * Returns keys for generating presigned URLs later
 */
export async function processAndUploadImage(
    buffer: Buffer,
    prefix: 'meal-photos' | 'weight-photos',
    orgId: string,
    entityId: string
): Promise<{ fullUrl: string; thumbUrl: string; fullKey: string; thumbKey: string }> {
    // Generate keys
    const timestamp = Date.now();
    const fullKey = `${prefix}/${orgId}/${entityId}/${timestamp}-full.jpg`;
    const thumbKey = `${prefix}/${orgId}/${entityId}/${timestamp}-thumb.jpg`;

    // Process images
    const [compressedBuffer, thumbnailBuffer] = await Promise.all([
        compressImage(buffer),
        createThumbnail(buffer)
    ]);

    // Upload both
    await Promise.all([
        uploadToS3(compressedBuffer, fullKey),
        uploadToS3(thumbnailBuffer, thumbKey)
    ]);

    // Generate media proxy URLs (these work without presigning)
    const baseUrl = process.env.API_BASE_URL || 'http://localhost:3000';
    const fullUrl = `${baseUrl}/media/${fullKey}`;
    const thumbUrl = `${baseUrl}/media/${thumbKey}`;

    logger.info('Image processed and uploaded', {
        prefix,
        entityId,
        originalSize: buffer.length,
        compressedSize: compressedBuffer.length,
        thumbnailSize: thumbnailBuffer.length,
        compressionRatio: Math.round((1 - compressedBuffer.length / buffer.length) * 100) + '%'
    });

    return { fullUrl, thumbUrl, fullKey, thumbKey };
}

/**
 * Storage service interface for controllers
 */
export const StorageService = {
    uploadMealPhoto: async (buffer: Buffer, orgId: string, mealLogId: string) => {
        return processAndUploadImage(buffer, 'meal-photos', orgId, mealLogId);
    },

    uploadWeightPhoto: async (buffer: Buffer, orgId: string, weightLogId: string) => {
        return processAndUploadImage(buffer, 'weight-photos', orgId, weightLogId);
    },

    getPresignedUrl,
    getPresignedUrls,

    deleteImage: async (key: string) => {
        return deleteFromS3(key);
    }
};

export default StorageService;
</file>

<file path="backend/src/types/auth.types.ts">
import { Request } from 'express';
import { User } from '@prisma/client';

export interface AuthenticatedUser {
    id: string;
    clerkUserId: string;
    organizationId: string;
    role: string;
    email: string;
    fullName: string;
}

export interface AuthenticatedRequest extends Request {
    user?: AuthenticatedUser;
    dbUser?: User;
}
</file>

<file path="backend/src/utils/asyncHandler.ts">
import { Request, Response, NextFunction, RequestHandler } from 'express';

/**
 * Wraps async route handlers to catch errors and pass them to next()
 * Eliminates the need for try-catch in every controller
 */
export const asyncHandler = (fn: RequestHandler): RequestHandler => {
    return (req: Request, res: Response, next: NextFunction) => {
        Promise.resolve(fn(req, res, next)).catch(next);
    };
};
</file>

<file path="backend/src/utils/emailService.ts">
import nodemailer from 'nodemailer';
import logger from './logger';

interface EmailOptions {
    to: string;
    subject: string;
    html: string;
    attachments?: Array<{
        filename: string;
        content: Buffer | string;
        contentType?: string;
    }>;
}

// Create transporter - uses environment variables for configuration
const createTransporter = () => {
    // For production, use actual SMTP credentials
    if (process.env.SMTP_HOST) {
        return nodemailer.createTransport({
            host: process.env.SMTP_HOST,
            port: parseInt(process.env.SMTP_PORT || '587'),
            secure: process.env.SMTP_SECURE === 'true',
            auth: {
                user: process.env.SMTP_USER,
                pass: process.env.SMTP_PASS,
            },
        });
    }

    // For development, use ethereal email (fake SMTP for testing)
    logger.warn('No SMTP configuration found, emails will be logged only');
    return null;
};

export async function sendEmail(options: EmailOptions): Promise<boolean> {
    const transporter = createTransporter();

    const mailOptions = {
        from: process.env.EMAIL_FROM || '"DietKaro" <noreply@dietkaro.com>',
        to: options.to,
        subject: options.subject,
        html: options.html,
        attachments: options.attachments,
    };

    if (!transporter) {
        // Development mode - just log the email
        logger.info('Email would be sent (dev mode):', {
            to: options.to,
            subject: options.subject,
            hasAttachments: !!options.attachments?.length,
        });
        return true;
    }

    try {
        const info = await transporter.sendMail(mailOptions);
        logger.info('Email sent successfully', {
            messageId: info.messageId,
            to: options.to,
        });
        return true;
    } catch (error) {
        logger.error('Failed to send email', { error, to: options.to });
        return false;
    }
}

export function generateDietPlanEmailHtml(
    planName: string,
    clientName: string,
    dietitianName: string,
    previewUrl?: string
): string {
    return `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #111827; max-width: 600px; margin: 0 auto; padding: 20px;">
    <div style="text-align: center; padding: 20px 0;">
        <h1 style="color: #17cf54; margin: 0;">🥗 DietKaro</h1>
    </div>
    
    <div style="background: #f9fafb; border-radius: 12px; padding: 24px; margin: 20px 0;">
        <h2 style="margin-top: 0;">Hello ${clientName}! 👋</h2>
        <p>Your personalized diet plan <strong>"${planName}"</strong> is ready!</p>
        <p>Your dietitian ${dietitianName} has created this plan especially for you. Please find your detailed meal plan attached as a PDF.</p>
    </div>
    
    ${previewUrl ? `
    <div style="text-align: center; margin: 24px 0;">
        <a href="${previewUrl}" style="display: inline-block; background: #17cf54; color: #111827; text-decoration: none; padding: 12px 32px; border-radius: 8px; font-weight: 600;">View Online</a>
    </div>
    ` : ''}
    
    <div style="background: #f3f4f6; border-radius: 8px; padding: 16px; margin: 20px 0;">
        <h3 style="margin-top: 0; font-size: 14px; color: #6b7280;">Tips for Success:</h3>
        <ul style="margin: 0; padding-left: 20px; color: #374151;">
            <li>Follow the meal times as closely as possible</li>
            <li>Stay hydrated - drink at least 2-3 liters of water daily</li>
            <li>Log your meals in the app to track progress</li>
            <li>Reach out to your dietitian if you have questions</li>
        </ul>
    </div>
    
    <div style="text-align: center; padding: 20px 0; color: #9ca3af; font-size: 12px;">
        <p>This email was sent by DietKaro on behalf of ${dietitianName}</p>
        <p>If you have questions, contact your dietitian or reply to this email.</p>
    </div>
</body>
</html>`;
}
</file>

<file path="backend/src/utils/logger.ts">
import winston from 'winston';
import path from 'path';

const { combine, timestamp, printf, colorize, errors } = winston.format;

// Custom format for console output
const consoleFormat = printf(({ level, message, timestamp, stack, ...meta }) => {
    const metaStr = Object.keys(meta).length ? JSON.stringify(meta) : '';
    if (stack) {
        return `${timestamp} [${level}]: ${message}\n${stack}`;
    }
    return `${timestamp} [${level}]: ${message} ${metaStr}`;
});

// Custom format for file/JSON output
const jsonFormat = printf(({ level, message, timestamp, ...meta }) => {
    return JSON.stringify({ timestamp, level, message, ...meta });
});

// Create logger instance
const logger = winston.createLogger({
    level: process.env.LOG_LEVEL || 'info',
    format: combine(
        timestamp({ format: 'YYYY-MM-DD HH:mm:ss' }),
        errors({ stack: true })
    ),
    defaultMeta: { service: 'diet-connect-api' },
    transports: [
        // Console transport with colors
        new winston.transports.Console({
            format: combine(
                colorize(),
                consoleFormat
            )
        })
    ]
});

// Add file transport in production
if (process.env.NODE_ENV === 'production') {
    logger.add(new winston.transports.File({
        filename: path.join(process.cwd(), 'logs', 'error.log'),
        level: 'error',
        format: jsonFormat
    }));

    logger.add(new winston.transports.File({
        filename: path.join(process.cwd(), 'logs', 'combined.log'),
        format: jsonFormat
    }));
}

export default logger;
</file>

<file path="backend/src/utils/pdfGenerator.ts">
import PDFDocument from 'pdfkit';
import { DietPlan, Meal, MealFoodItem, FoodItem, Client } from '@prisma/client';

type MealWithFoodItems = Meal & {
    foodItems: (MealFoodItem & { foodItem: FoodItem })[];
};

type DietPlanWithRelations = DietPlan & {
    client: Pick<Client, 'fullName' | 'currentWeightKg' | 'targetWeightKg'> | null;
    meals: MealWithFoodItems[];
};

const COLORS = {
    primary: '#17cf54',
    dark: '#111827',
    gray: '#6b7280',
    lightGray: '#e5e7eb',
};

const MEAL_TYPE_LABELS: Record<string, string> = {
    breakfast: '🌅 Breakfast',
    lunch: '☀️ Lunch',
    snack: '🍎 Snack',
    dinner: '🌙 Dinner',
};

export function generateDietPlanPDF(plan: DietPlanWithRelations): PDFKit.PDFDocument {
    const doc = new PDFDocument({
        size: 'A4',
        margins: { top: 50, bottom: 50, left: 50, right: 50 },
        info: {
            Title: `Diet Plan - ${plan.name}`,
            Author: 'DietKaro',
            Subject: 'Personalized Diet Plan',
        },
    });

    // Header
    doc.fontSize(24)
        .fillColor(COLORS.dark)
        .text(plan.name, { align: 'center' });

    if (plan.client?.fullName) {
        doc.fontSize(14)
            .fillColor(COLORS.gray)
            .text(`Prepared for: ${plan.client.fullName}`, { align: 'center' });
    }

    doc.moveDown();

    // Date Range
    const startDate = new Date(plan.startDate).toLocaleDateString('en-IN', {
        day: 'numeric',
        month: 'long',
        year: 'numeric',
    });
    const endDate = plan.endDate
        ? new Date(plan.endDate).toLocaleDateString('en-IN', {
            day: 'numeric',
            month: 'long',
            year: 'numeric',
        })
        : 'Ongoing';

    doc.fontSize(11)
        .fillColor(COLORS.gray)
        .text(`Duration: ${startDate} - ${endDate}`, { align: 'center' });

    doc.moveDown(2);

    // Nutritional Targets Card
    if (plan.targetCalories) {
        doc.rect(50, doc.y, 495, 80).fill('#f3f4f6');
        const boxY = doc.y + 15;

        doc.fillColor(COLORS.dark)
            .fontSize(12)
            .text('Daily Nutritional Targets', 60, boxY, { underline: true });

        const targetY = boxY + 25;
        const colWidth = 120;

        doc.fontSize(10).fillColor(COLORS.gray);
        doc.text(`Calories: ${plan.targetCalories || '-'} kcal`, 60, targetY);
        doc.text(`Protein: ${plan.targetProteinG || '-'} g`, 60 + colWidth, targetY);
        doc.text(`Carbs: ${plan.targetCarbsG || '-'} g`, 60 + colWidth * 2, targetY);
        doc.text(`Fats: ${plan.targetFatsG || '-'} g`, 60 + colWidth * 3, targetY);

        if (plan.targetFiberG) {
            doc.text(`Fiber: ${plan.targetFiberG} g`, 60, targetY + 20);
        }

        doc.y = boxY + 80;
    }

    doc.moveDown(2);

    // Group meals by day
    const mealsByDay = new Map<number, MealWithFoodItems[]>();
    plan.meals.forEach((meal) => {
        const day = meal.dayOfWeek ?? 0;
        if (!mealsByDay.has(day)) {
            mealsByDay.set(day, []);
        }
        mealsByDay.get(day)!.push(meal);
    });

    const dayNames = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

    // Meals by Day
    Array.from(mealsByDay.entries())
        .sort(([a], [b]) => a - b)
        .forEach(([dayIndex, meals]) => {
            // Day Header
            doc.fontSize(16)
                .fillColor(COLORS.dark)
                .text(dayNames[dayIndex] || `Day ${dayIndex + 1}`, { underline: true });

            doc.moveDown(0.5);

            // Sort meals by type
            const mealOrder = ['breakfast', 'lunch', 'snack', 'dinner'];
            meals
                .sort((a, b) => mealOrder.indexOf(a.mealType) - mealOrder.indexOf(b.mealType))
                .forEach((meal) => {
                    // Meal Header
                    doc.fontSize(13)
                        .fillColor(COLORS.primary)
                        .text(MEAL_TYPE_LABELS[meal.mealType] || meal.mealType);

                    if (meal.timeOfDay) {
                        doc.fontSize(10)
                            .fillColor(COLORS.gray)
                            .text(`Time: ${meal.timeOfDay}`);
                    }

                    doc.fontSize(12)
                        .fillColor(COLORS.dark)
                        .text(meal.name);

                    if (meal.description) {
                        doc.fontSize(10)
                            .fillColor(COLORS.gray)
                            .text(meal.description);
                    }

                    // Food Items
                    if (meal.foodItems.length > 0) {
                        doc.moveDown(0.3);
                        meal.foodItems.forEach((item) => {
                            const foodName = item.foodItem?.name || 'Unknown food';
                            const quantity = item.quantityG ? `${item.quantityG}g` : '';
                            const calories = item.foodItem?.calories
                                ? `${Math.round((item.foodItem.calories * (Number(item.quantityG) || 100)) / 100)} kcal`
                                : '';

                            doc.fontSize(10)
                                .fillColor(COLORS.dark)
                                .text(`  • ${foodName} ${quantity}`, {
                                    continued: !!calories,
                                });

                            if (calories) {
                                doc.fillColor(COLORS.gray).text(` — ${calories}`);
                            }
                        });
                    }

                    // Instructions
                    if (meal.instructions) {
                        doc.moveDown(0.3)
                            .fontSize(9)
                            .fillColor(COLORS.gray)
                            .text(`📝 ${meal.instructions}`);
                    }

                    doc.moveDown();
                });

            doc.moveDown();

            // Page break check
            if (doc.y > 700) {
                doc.addPage();
            }
        });

    // Notes for Client
    if (plan.notesForClient) {
        doc.addPage();
        doc.fontSize(16)
            .fillColor(COLORS.dark)
            .text('Notes & Guidelines', { underline: true });

        doc.moveDown()
            .fontSize(11)
            .fillColor(COLORS.gray)
            .text(plan.notesForClient, { align: 'left', lineGap: 4 });
    }

    // Footer on last page
    doc.fontSize(8)
        .fillColor(COLORS.lightGray)
        .text(
            `Generated by DietKaro on ${new Date().toLocaleDateString('en-IN')}`,
            50,
            780,
            { align: 'center', width: 495 }
        );

    return doc;
}

export function generateMealPlanPrintHtml(plan: DietPlanWithRelations): string {
    const dayNames = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

    // Group meals by day
    const mealsByDay = new Map<number, MealWithFoodItems[]>();
    plan.meals.forEach((meal) => {
        const day = meal.dayOfWeek ?? 0;
        if (!mealsByDay.has(day)) {
            mealsByDay.set(day, []);
        }
        mealsByDay.get(day)!.push(meal);
    });

    const mealOrder = ['breakfast', 'lunch', 'snack', 'dinner'];

    let daysHtml = '';
    Array.from(mealsByDay.entries())
        .sort(([a], [b]) => a - b)
        .forEach(([dayIndex, meals]) => {
            let mealsHtml = '';
            meals
                .sort((a, b) => mealOrder.indexOf(a.mealType) - mealOrder.indexOf(b.mealType))
                .forEach((meal) => {
                    const foodItemsHtml = meal.foodItems
                        .map((item) => {
                            const foodName = item.foodItem?.name || 'Unknown';
                            const qty = item.quantityG ? `${item.quantityG}g` : '';
                            return `<li>${foodName} ${qty}</li>`;
                        })
                        .join('');

                    mealsHtml += `
                    <div class="meal">
                        <div class="meal-type">${MEAL_TYPE_LABELS[meal.mealType] || meal.mealType}</div>
                        <div class="meal-name">${meal.name}</div>
                        ${meal.description ? `<p class="description">${meal.description}</p>` : ''}
                        ${foodItemsHtml ? `<ul class="food-items">${foodItemsHtml}</ul>` : ''}
                        ${meal.instructions ? `<p class="instructions">📝 ${meal.instructions}</p>` : ''}
                    </div>
                `;
                });

            daysHtml += `
            <div class="day">
                <h2>${dayNames[dayIndex] || `Day ${dayIndex + 1}`}</h2>
                ${mealsHtml}
            </div>
        `;
        });

    return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diet Plan - ${plan.name}</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #111827; line-height: 1.5; padding: 40px; max-width: 800px; margin: 0 auto; }
        h1 { font-size: 28px; text-align: center; margin-bottom: 8px; }
        .subtitle { text-align: center; color: #6b7280; margin-bottom: 32px; }
        .targets { background: #f3f4f6; padding: 16px 24px; border-radius: 12px; display: flex; gap: 24px; justify-content: center; margin-bottom: 32px; flex-wrap: wrap; }
        .target { text-align: center; }
        .target-value { font-size: 24px; font-weight: 700; color: #17cf54; }
        .target-label { font-size: 12px; color: #6b7280; }
        .day { margin-bottom: 32px; page-break-inside: avoid; }
        .day h2 { font-size: 20px; border-bottom: 2px solid #17cf54; padding-bottom: 8px; margin-bottom: 16px; }
        .meal { background: #fff; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 12px; }
        .meal-type { font-size: 14px; color: #17cf54; font-weight: 600; }
        .meal-name { font-size: 16px; font-weight: 600; margin: 4px 0; }
        .description { font-size: 14px; color: #6b7280; margin: 8px 0; }
        .food-items { margin: 12px 0; padding-left: 20px; }
        .food-items li { font-size: 14px; margin: 4px 0; }
        .instructions { font-size: 13px; color: #6b7280; font-style: italic; }
        .notes { background: #f9fafb; padding: 20px; border-radius: 12px; margin-top: 32px; }
        .notes h3 { font-size: 16px; margin-bottom: 12px; }
        .notes p { font-size: 14px; color: #374151; }
        @media print { body { padding: 20px; } .day { page-break-inside: avoid; } }
    </style>
</head>
<body>
    <h1>${plan.name}</h1>
    ${plan.client?.fullName ? `<p class="subtitle">Prepared for: ${plan.client.fullName}</p>` : ''}
    
    ${plan.targetCalories ? `
    <div class="targets">
        <div class="target"><div class="target-value">${plan.targetCalories}</div><div class="target-label">Calories</div></div>
        ${plan.targetProteinG ? `<div class="target"><div class="target-value">${plan.targetProteinG}g</div><div class="target-label">Protein</div></div>` : ''}
        ${plan.targetCarbsG ? `<div class="target"><div class="target-value">${plan.targetCarbsG}g</div><div class="target-label">Carbs</div></div>` : ''}
        ${plan.targetFatsG ? `<div class="target"><div class="target-value">${plan.targetFatsG}g</div><div class="target-label">Fats</div></div>` : ''}
    </div>
    ` : ''}
    
    ${daysHtml}
    
    ${plan.notesForClient ? `<div class="notes"><h3>Notes & Guidelines</h3><p>${plan.notesForClient}</p></div>` : ''}
</body>
</html>`;
}
</file>

<file path="backend/src/utils/prisma.ts">
import { PrismaClient } from '@prisma/client';

const prismaClientSingleton = () => {
    return new PrismaClient({
        log: ['error', 'warn'],
    });
};

type PrismaClientSingleton = ReturnType<typeof prismaClientSingleton>;

const globalForPrisma = globalThis as unknown as {
    prisma: PrismaClientSingleton | undefined;
};

const prisma = globalForPrisma.prisma ?? prismaClientSingleton();

export default prisma;

if (process.env.NODE_ENV !== 'production') {
    globalForPrisma.prisma = prisma;
}
</file>

<file path="backend/src/app.ts">
import express from 'express';
import cors from 'cors';
import helmet from 'helmet';
import morgan from 'morgan';
import { clerkMiddleware } from '@clerk/express';
import { errorHandler, notFoundHandler } from './middleware/errorHandler';
import logger from './utils/logger';

const app = express();

// Middleware
app.use(express.json());
app.use(cors());
app.use(helmet());
app.use(morgan('dev'));

// Clerk middleware - adds auth info to every request
app.use(clerkMiddleware());

// Health check
app.get('/health', (req, res) => {
    res.status(200).json({ status: 'ok', timestamp: new Date().toISOString() });
});

import authRoutes from './routes/auth.routes';

import organizationRoutes from './routes/organization.routes';
import clientRoutes from './routes/client.routes';
import dietPlanRoutes from './routes/dietPlan.routes';
import mealRoutes from './routes/meal.routes';
import mealLogRoutes from './routes/mealLog.routes';
import weightLogRoutes from './routes/weightLog.routes';
import foodItemRoutes from './routes/foodItem.routes';
import mediaRoutes from './routes/media.routes';
import dashboardRoutes from './routes/dashboard.routes';
import teamRoutes from './routes/team.routes';
import clientAuthRoutes from './routes/clientAuth.routes';
import clientApiRoutes from './routes/clientApi.routes';
import referralRoutes from './routes/referral.routes';
import reportsRoutes from './routes/reports.routes';
import shareRoutes from './routes/share.routes';
import adminReferralRoutes from './routes/adminReferral.routes';

// Routes
app.use('/api/v1/auth', authRoutes);
app.use('/api/v1/organizations', organizationRoutes);
app.use('/api/v1/clients', clientRoutes);
app.use('/api/v1/diet-plans', dietPlanRoutes);
app.use('/api/v1/meals', mealRoutes);
app.use('/api/v1/meal-logs', mealLogRoutes);
app.use('/api/v1/weight-logs', weightLogRoutes);
app.use('/api/v1/food-items', foodItemRoutes);
app.use('/api/v1/dashboard', dashboardRoutes);
app.use('/api/v1/team', teamRoutes);
app.use('/api/v1/share', shareRoutes); // Diet plan sharing (PDF, email, etc)
app.use('/api/v1/referrals', adminReferralRoutes); // Admin referral management
app.use('/media', mediaRoutes); // Public media proxy (no auth required)

// Client Mobile App Routes
app.use('/api/v1/client-auth', clientAuthRoutes);
app.use('/api/v1/client', clientApiRoutes);
app.use('/api/v1/client/referral', referralRoutes);
app.use('/api/v1/client/reports', reportsRoutes);



// Test-only routes (for development testing without Clerk)
if (process.env.NODE_ENV !== 'production') {
    const testRouter = express.Router();
    const { testAuthBypass } = require('./middleware/testAuth.middleware');
    const prisma = require('./utils/prisma').default;

    // Import controllers directly for testing
    const clientController = require('./controllers/client.controller');
    const dietPlanController = require('./controllers/dietPlan.controller');
    const mealController = require('./controllers/meal.controller');
    const mealLogController = require('./controllers/mealLog.controller');
    const weightLogController = require('./controllers/weightLog.controller');

    // Create test user and org for testing
    testRouter.post('/setup', async (req: any, res: any) => {
        try {
            let org = await prisma.organization.findFirst({
                where: { name: 'Test Organization' }
            });

            if (!org) {
                org = await prisma.organization.create({
                    data: {
                        name: 'Test Organization',
                        email: 'test@test.com',
                        phone: '+919999999999',
                        city: 'Delhi'
                    }
                });
            }

            let user = await prisma.user.findFirst({
                where: { email: 'testuser@test.com' }
            });

            if (!user) {
                user = await prisma.user.create({
                    data: {
                        clerkUserId: 'test-clerk-id-123',
                        email: 'testuser@test.com',
                        fullName: 'Test Dietitian',
                        role: 'admin',
                        orgId: org.id
                    }
                });
            }

            res.json({
                success: true,
                data: {
                    organizationId: org.id,
                    userId: user.id,
                    message: 'Use X-Test-User-Id header with userId for authenticated requests'
                }
            });
        } catch (error) {
            console.error('Test setup error:', error);
            res.status(500).json({ success: false, error: 'Setup failed' });
        }
    });

    // Direct test routes - bypass auth middleware
    testRouter.post('/clients', testAuthBypass, clientController.createClient);
    testRouter.get('/clients', testAuthBypass, clientController.listClients);
    testRouter.get('/clients/:id', testAuthBypass, clientController.getClient);
    testRouter.patch('/clients/:id', testAuthBypass, clientController.updateClient);
    testRouter.get('/clients/:id/progress', testAuthBypass, clientController.getClientProgress);
    testRouter.post('/clients/:clientId/weight-logs', testAuthBypass, weightLogController.createWeightLog);
    testRouter.get('/clients/:clientId/weight-logs', testAuthBypass, weightLogController.listWeightLogs);

    testRouter.post('/diet-plans', testAuthBypass, dietPlanController.createDietPlan);
    testRouter.get('/diet-plans', testAuthBypass, dietPlanController.listDietPlans);
    testRouter.get('/diet-plans/:id', testAuthBypass, dietPlanController.getDietPlan);
    testRouter.patch('/diet-plans/:id', testAuthBypass, dietPlanController.updateDietPlan);
    testRouter.post('/diet-plans/:id/publish', testAuthBypass, dietPlanController.publishDietPlan);

    testRouter.post('/meals', testAuthBypass, mealController.addMealToPlan);
    testRouter.patch('/meals/:id', testAuthBypass, mealController.updateMeal);
    testRouter.delete('/meals/:id', testAuthBypass, mealController.deleteMeal);

    testRouter.post('/meal-logs', testAuthBypass, mealLogController.createMealLog);
    testRouter.get('/meal-logs', testAuthBypass, mealLogController.listMealLogs);
    testRouter.get('/meal-logs/:id', testAuthBypass, mealLogController.getMealLog);
    testRouter.patch('/meal-logs/:id', testAuthBypass, mealLogController.updateMealLog);
    testRouter.patch('/meal-logs/:id/review', testAuthBypass, mealLogController.reviewMealLog);

    // Photo upload routes (need multer middleware)
    const { uploadSinglePhoto } = require('./middleware/upload.middleware');
    testRouter.post('/meal-logs/:id/photo', testAuthBypass, uploadSinglePhoto, mealLogController.uploadMealPhoto);
    testRouter.post('/weight-logs/:id/photo', testAuthBypass, uploadSinglePhoto, weightLogController.uploadProgressPhoto);

    testRouter.post('/weight-logs', testAuthBypass, weightLogController.createWeightLogGeneral);
    testRouter.get('/weight-logs', testAuthBypass, weightLogController.listAllWeightLogs);

    // Food Items
    const foodItemController = require('./controllers/foodItem.controller');
    testRouter.post('/food-items', testAuthBypass, foodItemController.createFoodItem);
    testRouter.get('/food-items', testAuthBypass, foodItemController.listFoodItems);
    testRouter.get('/food-items/:id', testAuthBypass, foodItemController.getFoodItem);
    testRouter.patch('/food-items/:id', testAuthBypass, foodItemController.updateFoodItem);
    testRouter.delete('/food-items/:id', testAuthBypass, foodItemController.deleteFoodItem);

    // Meal Food Items
    testRouter.post('/meals/:mealId/food-items', testAuthBypass, foodItemController.addFoodToMeal);
    testRouter.patch('/meals/:mealId/food-items/:itemId', testAuthBypass, foodItemController.updateMealFoodItem);
    testRouter.delete('/meals/:mealId/food-items/:itemId', testAuthBypass, foodItemController.removeFoodFromMeal);

    app.use('/test', testRouter);
}

// 404 handler - must be after all routes
app.use(notFoundHandler);

// Global error handler - must be last
app.use(errorHandler);

export default app;
</file>

<file path="backend/src/server.ts">
import 'dotenv/config'; // Prevents hoisting issues
import app from './app';

const PORT = process.env.PORT || 3000;

app.listen(PORT, () => {
    console.log(`Server is running on port ${PORT}`);
});
</file>

<file path="backend/.env.example">
# Database
DATABASE_URL=postgresql://user:password@localhost:5432/dietkaro

# Clerk Authentication
CLERK_SECRET_KEY=sk_test_xxx
CLERK_PUBLISHABLE_KEY=pk_test_xxx

# Garage/S3 Storage
S3_ENDPOINT=http://localhost:3900
S3_REGION=garage
S3_BUCKET=dietkaro-media
S3_ACCESS_KEY=your-garage-access-key
S3_SECRET_KEY=your-garage-secret-key
S3_PUBLIC_URL=http://localhost:3900/dietkaro-media

# App
PORT=3000
NODE_ENV=development
LOG_LEVEL=info
</file>

<file path="backend/.gitignore">
node_modules
# Keep environment variables out of version control
.env

/src/generated/prisma
</file>

<file path="backend/package.json">
{
  "name": "backend",
  "version": "1.0.0",
  "main": "index.js",
  "scripts": {
    "dev": "tsx watch src/server.ts",
    "build": "tsc",
    "start": "node dist/server.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC",
  "description": "",
  "dependencies": {
    "@aws-sdk/client-s3": "^3.948.0",
    "@aws-sdk/s3-request-presigner": "^3.948.0",
    "@clerk/express": "^1.7.56",
    "@prisma/client": "6.16.0",
    "cors": "^2.8.5",
    "dotenv": "^17.2.3",
    "express": "^5.2.1",
    "helmet": "^8.1.0",
    "jsonwebtoken": "^9.0.3",
    "morgan": "^1.10.1",
    "multer": "^2.0.2",
    "nodemailer": "^7.0.12",
    "pdfkit": "^0.17.2",
    "prisma": "6.16.0",
    "sharp": "^0.34.5",
    "winston": "^3.19.0",
    "zod": "^4.1.13"
  },
  "devDependencies": {
    "@types/cors": "^2.8.19",
    "@types/express": "^5.0.6",
    "@types/jsonwebtoken": "^9.0.10",
    "@types/morgan": "^1.9.10",
    "@types/multer": "^2.0.0",
    "@types/node": "^24.10.1",
    "@types/nodemailer": "^7.0.5",
    "@types/pdfkit": "^0.17.4",
    "ts-node": "^10.9.2",
    "typescript": "^5.9.3"
  }
}
</file>

<file path="backend/prisma.config.ts">
import { defineConfig } from "@prisma/config";
import dotenv from "dotenv";

// Load .env file
dotenv.config();

export default defineConfig({
  schema: "./prisma/schema.prisma",

  datasource: {
    db: {
      provider: "postgresql",
      url: process.env.DATABASE_URL
    }
  }
});
</file>

<file path="backend/tsconfig.json">
{
    "compilerOptions": {
        "target": "es2020",
        "module": "commonjs",
        "outDir": "./dist",
        "rootDir": "./src",
        "strict": true,
        "esModuleInterop": true,
        "skipLibCheck": true,
        "forceConsistentCasingInFileNames": true
    },
    "include": [
        "src/**/*"
    ],
    "exclude": [
        "node_modules"
    ]
}
</file>

<file path="client-app/app/(auth)/_layout.tsx">
import { Slot } from 'expo-router';

export default function AuthLayout() {
    return <Slot />;
}
</file>

<file path="client-app/app/(auth)/login.tsx">
import { useState } from 'react';
import {
    View,
    Text,
    TextInput,
    TouchableOpacity,
    StyleSheet,
    KeyboardAvoidingView,
    Platform,
    ActivityIndicator,
    Alert,
} from 'react-native';
import { useRouter } from 'expo-router';
import { SafeAreaView } from 'react-native-safe-area-context';
import { Phone } from 'lucide-react-native';
import { useAuth } from '../../hooks/useAuth';

// Figma Design Colors
const colors = {
    background: '#f8fcf9',
    primary: '#13ec5b',
    text: '#0d1b12',
    textSecondary: '#4c9a66',
    border: '#cfe7d7',
    surface: '#e7f3eb',
    white: '#ffffff',
};

export default function LoginScreen() {
    const router = useRouter();
    const { requestOTP } = useAuth();
    const [phone, setPhone] = useState('');
    const [isLoading, setIsLoading] = useState(false);

    const handleRequestOTP = async () => {
        if (phone.length < 10) {
            Alert.alert('Invalid Phone', 'Please enter a valid 10-digit phone number');
            return;
        }

        setIsLoading(true);
        try {
            await requestOTP(phone);
            router.push({
                pathname: '/(auth)/verify',
                params: { phone },
            });
        } catch (error: unknown) {
            const message = error instanceof Error ? error.message : 'Failed to send OTP';
            Alert.alert('Error', message);
        } finally {
            setIsLoading(false);
        }
    };

    return (
        <SafeAreaView style={styles.container}>
            <KeyboardAvoidingView
                behavior={Platform.OS === 'ios' ? 'padding' : 'height'}
                style={styles.content}
            >
                <View style={styles.header}>
                    <View style={styles.iconContainer}>
                        <Phone size={32} color={colors.primary} />
                    </View>
                    <Text style={styles.title}>Welcome to DietConnect</Text>
                    <Text style={styles.subtitle}>
                        Enter your phone number to get started with your personalized diet plan
                    </Text>
                </View>

                <View style={styles.form}>
                    <Text style={styles.label}>Phone Number</Text>
                    <View style={styles.inputContainer}>
                        <Text style={styles.prefix}>+91</Text>
                        <TextInput
                            style={styles.input}
                            value={phone}
                            onChangeText={setPhone}
                            placeholder="9876543210"
                            placeholderTextColor={colors.textSecondary}
                            keyboardType="phone-pad"
                            maxLength={10}
                            autoFocus
                        />
                    </View>

                    <TouchableOpacity
                        style={[styles.button, phone.length < 10 && styles.buttonDisabled]}
                        onPress={handleRequestOTP}
                        disabled={isLoading || phone.length < 10}
                    >
                        {isLoading ? (
                            <ActivityIndicator color={colors.text} />
                        ) : (
                            <Text style={styles.buttonText}>Get OTP</Text>
                        )}
                    </TouchableOpacity>
                </View>

                <Text style={styles.footer}>
                    By continuing, you agree to our Terms of Service and Privacy Policy
                </Text>
            </KeyboardAvoidingView>
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: colors.background,
    },
    content: {
        flex: 1,
        padding: 24,
        justifyContent: 'center',
    },
    header: {
        alignItems: 'center',
        marginBottom: 48,
    },
    iconContainer: {
        width: 72,
        height: 72,
        borderRadius: 36,
        backgroundColor: colors.surface,
        justifyContent: 'center',
        alignItems: 'center',
        marginBottom: 24,
    },
    title: {
        fontSize: 28,
        fontWeight: '700',
        color: colors.text,
        marginBottom: 12,
        textAlign: 'center',
    },
    subtitle: {
        fontSize: 16,
        color: colors.textSecondary,
        textAlign: 'center',
        lineHeight: 24,
        paddingHorizontal: 16,
    },
    form: {
        marginBottom: 32,
    },
    label: {
        fontSize: 14,
        fontWeight: '600',
        color: colors.text,
        marginBottom: 8,
    },
    inputContainer: {
        flexDirection: 'row',
        alignItems: 'center',
        borderWidth: 1,
        borderColor: colors.border,
        borderRadius: 12,
        backgroundColor: colors.white,
        marginBottom: 24,
    },
    prefix: {
        paddingHorizontal: 16,
        fontSize: 16,
        color: colors.text,
        fontWeight: '500',
    },
    input: {
        flex: 1,
        height: 56,
        fontSize: 18,
        color: colors.text,
        letterSpacing: 1,
    },
    button: {
        backgroundColor: colors.primary,
        height: 56,
        borderRadius: 12,
        justifyContent: 'center',
        alignItems: 'center',
    },
    buttonDisabled: {
        backgroundColor: colors.border,
    },
    buttonText: {
        color: colors.text,
        fontSize: 16,
        fontWeight: '700',
    },
    footer: {
        fontSize: 12,
        color: colors.textSecondary,
        textAlign: 'center',
        lineHeight: 18,
    },
});
</file>

<file path="client-app/app/(auth)/verify.tsx">
import { useState, useRef } from 'react';
import {
    View,
    Text,
    TextInput,
    TouchableOpacity,
    StyleSheet,
    KeyboardAvoidingView,
    Platform,
    ActivityIndicator,
    Alert,
} from 'react-native';
import { useRouter, useLocalSearchParams } from 'expo-router';
import { SafeAreaView } from 'react-native-safe-area-context';
import { ShieldCheck, ArrowLeft } from 'lucide-react-native';
import { useAuth } from '../../hooks/useAuth';

// Figma Design Colors
const colors = {
    background: '#f8fcf9',
    primary: '#13ec5b',
    text: '#0d1b12',
    textSecondary: '#4c9a66',
    border: '#cfe7d7',
    surface: '#e7f3eb',
    white: '#ffffff',
};

const OTP_LENGTH = 6;

export default function VerifyScreen() {
    const router = useRouter();
    const { phone } = useLocalSearchParams<{ phone: string }>();
    const { login } = useAuth();
    const [otp, setOtp] = useState<string[]>(Array(OTP_LENGTH).fill(''));
    const [isLoading, setIsLoading] = useState(false);
    const inputRefs = useRef<(TextInput | null)[]>([]);

    const handleOtpChange = (value: string, index: number) => {
        const newOtp = [...otp];
        newOtp[index] = value;
        setOtp(newOtp);

        // Auto-focus next input
        if (value && index < OTP_LENGTH - 1) {
            inputRefs.current[index + 1]?.focus();
        }

        // Auto-submit when complete
        if (newOtp.every((digit) => digit) && newOtp.join('').length === OTP_LENGTH) {
            handleVerify(newOtp.join(''));
        }
    };

    const handleKeyPress = (e: { nativeEvent: { key: string } }, index: number) => {
        if (e.nativeEvent.key === 'Backspace' && !otp[index] && index > 0) {
            inputRefs.current[index - 1]?.focus();
        }
    };

    const handleVerify = async (otpCode: string) => {
        if (!phone) return;

        setIsLoading(true);
        try {
            await login(phone, otpCode);
            router.replace('/(tabs)/home');
        } catch (error: unknown) {
            const message = error instanceof Error ? error.message : 'Invalid OTP';
            Alert.alert('Verification Failed', message);
            setOtp(Array(OTP_LENGTH).fill(''));
            inputRefs.current[0]?.focus();
        } finally {
            setIsLoading(false);
        }
    };

    return (
        <SafeAreaView style={styles.container}>
            <TouchableOpacity style={styles.backButton} onPress={() => router.back()}>
                <ArrowLeft size={24} color={colors.text} />
            </TouchableOpacity>

            <KeyboardAvoidingView
                behavior={Platform.OS === 'ios' ? 'padding' : 'height'}
                style={styles.content}
            >
                <View style={styles.header}>
                    <View style={styles.iconContainer}>
                        <ShieldCheck size={32} color={colors.primary} />
                    </View>
                    <Text style={styles.title}>Verify OTP</Text>
                    <Text style={styles.subtitle}>
                        Enter the 6-digit code sent to{'\n'}
                        <Text style={styles.phone}>+91 {phone}</Text>
                    </Text>
                </View>

                <View style={styles.otpContainer}>
                    {otp.map((digit, index) => (
                        <TextInput
                            key={index}
                            ref={(ref) => { inputRefs.current[index] = ref; }}
                            style={[styles.otpInput, digit && styles.otpInputFilled]}
                            value={digit}
                            onChangeText={(value) => handleOtpChange(value.slice(-1), index)}
                            onKeyPress={(e) => handleKeyPress(e, index)}
                            keyboardType="number-pad"
                            maxLength={1}
                            selectTextOnFocus
                        />
                    ))}
                </View>

                <TouchableOpacity
                    style={[styles.button, otp.some((d) => !d) && styles.buttonDisabled]}
                    onPress={() => handleVerify(otp.join(''))}
                    disabled={isLoading || otp.some((d) => !d)}
                >
                    {isLoading ? (
                        <ActivityIndicator color={colors.text} />
                    ) : (
                        <Text style={styles.buttonText}>Verify & Continue</Text>
                    )}
                </TouchableOpacity>

                <TouchableOpacity style={styles.resendButton}>
                    <Text style={styles.resendText}>
                        Didn't receive code? <Text style={styles.resendLink}>Resend</Text>
                    </Text>
                </TouchableOpacity>
            </KeyboardAvoidingView>
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: colors.background,
    },
    backButton: {
        padding: 16,
    },
    content: {
        flex: 1,
        padding: 24,
        justifyContent: 'center',
    },
    header: {
        alignItems: 'center',
        marginBottom: 48,
    },
    iconContainer: {
        width: 72,
        height: 72,
        borderRadius: 36,
        backgroundColor: colors.surface,
        justifyContent: 'center',
        alignItems: 'center',
        marginBottom: 24,
    },
    title: {
        fontSize: 28,
        fontWeight: '700',
        color: colors.text,
        marginBottom: 12,
    },
    subtitle: {
        fontSize: 16,
        color: colors.textSecondary,
        textAlign: 'center',
        lineHeight: 24,
    },
    phone: {
        color: colors.text,
        fontWeight: '600',
    },
    otpContainer: {
        flexDirection: 'row',
        justifyContent: 'center',
        gap: 12,
        marginBottom: 32,
    },
    otpInput: {
        width: 48,
        height: 56,
        borderWidth: 1,
        borderColor: colors.border,
        borderRadius: 12,
        backgroundColor: colors.white,
        fontSize: 24,
        fontWeight: '700',
        textAlign: 'center',
        color: colors.text,
    },
    otpInputFilled: {
        borderColor: colors.primary,
        backgroundColor: colors.surface,
    },
    button: {
        backgroundColor: colors.primary,
        height: 56,
        borderRadius: 12,
        justifyContent: 'center',
        alignItems: 'center',
    },
    buttonDisabled: {
        backgroundColor: colors.border,
    },
    buttonText: {
        color: colors.text,
        fontSize: 16,
        fontWeight: '700',
    },
    resendButton: {
        marginTop: 24,
        alignItems: 'center',
    },
    resendText: {
        fontSize: 14,
        color: colors.textSecondary,
    },
    resendLink: {
        color: colors.primary,
        fontWeight: '600',
    },
});
</file>

<file path="client-app/app/(tabs)/home/meal/[id].tsx">
import { useState, useEffect } from 'react';
import {
    View,
    Text,
    StyleSheet,
    ScrollView,
    TouchableOpacity,
    TextInput,
    Image,
    Alert,
    ActivityIndicator,
} from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';
import { useLocalSearchParams, useRouter } from 'expo-router';
import * as ImagePicker from 'expo-image-picker';
import { X, Camera, Image as ImageIcon, Clock, MessageSquare, CheckCircle, User } from 'lucide-react-native';
import { useMealLog, useLogMeal } from '../../../../hooks/useMealLog';

// Figma Design Colors
const colors = {
    background: '#f8fcf9',
    primary: '#13ec5b',
    text: '#0d1b12',
    textSecondary: '#4c9a66',
    border: '#cfe7d7',
    surface: '#e7f3eb',
    white: '#ffffff',
};

const mealTypes = ['Breakfast', 'Lunch', 'Dinner', 'Snack', 'Substituted'] as const;

export default function MealDetailScreen() {
    const { id, status: paramStatus, mealName, mealType, scheduledTime, feedback } = useLocalSearchParams<{
        id: string;
        status?: string;
        mealName?: string;
        mealType?: string;
        scheduledTime?: string;
        feedback?: string;
    }>();
    const router = useRouter();

    // Check if this is a pending meal (not yet logged)
    const isPendingMeal = id?.startsWith('pending-');
    const isLoggedMeal = paramStatus === 'eaten' || paramStatus === 'skipped';

    // Only fetch if it's an existing meal log (not pending)
    const { data: mealLog, isLoading } = useMealLog(id ?? '');
    const logMutation = useLogMeal();

    const [selectedMealType, setSelectedMealType] = useState<string>('');
    const [notes, setNotes] = useState('');
    const [photoUri, setPhotoUri] = useState<string | null>(null);
    const [isSubmitting, setIsSubmitting] = useState(false);

    useEffect(() => {
        if (mealLog?.meal?.mealType) {
            setSelectedMealType(mealLog.meal.mealType.charAt(0).toUpperCase() + mealLog.meal.mealType.slice(1));
        } else if (mealType) {
            setSelectedMealType(mealType.charAt(0).toUpperCase() + mealType.slice(1));
        }
    }, [mealLog, mealType]);

    const handleClose = () => {
        router.back();
    };

    const handleTakePhoto = async () => {
        const { status } = await ImagePicker.requestCameraPermissionsAsync();
        if (status !== 'granted') {
            Alert.alert('Permission Required', 'Camera permission is needed to take photos.');
            return;
        }

        const result = await ImagePicker.launchCameraAsync({
            mediaTypes: 'images',
            allowsEditing: true,
            aspect: [3, 2],
            quality: 0.8,
        });

        if (!result.canceled && result.assets[0]) {
            setPhotoUri(result.assets[0].uri);
        }
    };

    const handlePickImage = async () => {
        const { status } = await ImagePicker.requestMediaLibraryPermissionsAsync();
        if (status !== 'granted') {
            Alert.alert('Permission Required', 'Photo library access is needed to select photos.');
            return;
        }

        const result = await ImagePicker.launchImageLibraryAsync({
            mediaTypes: 'images',
            allowsEditing: true,
            aspect: [3, 2],
            quality: 0.8,
        });

        if (!result.canceled && result.assets[0]) {
            setPhotoUri(result.assets[0].uri);
        }
    };

    const handleSubmit = async () => {
        if (!id) return;

        setIsSubmitting(true);
        try {
            await logMutation.mutateAsync({
                mealLogId: id,
                status: 'eaten',
                notes: notes || undefined,
                photoUri: photoUri || undefined,
            });
            Alert.alert('Success', 'Meal logged successfully!', [
                { text: 'OK', onPress: () => router.back() }
            ]);
        } catch (error) {
            console.error('Log meal error:', error);
            Alert.alert('Error', 'Failed to log meal. Please try again.');
        } finally {
            setIsSubmitting(false);
        }
    };

    // For pending meals, show the form immediately without loading
    if (!isPendingMeal && isLoading) {
        return (
            <SafeAreaView style={styles.loadingContainer}>
                <ActivityIndicator size="large" color={colors.primary} />
            </SafeAreaView>
        );
    }

    // Show logged meal view with feedback
    const currentMealLog = mealLog;
    const dietitianFeedback = currentMealLog?.dietitianFeedback || feedback;
    const mealPhoto = currentMealLog?.mealPhotoUrl;
    const clientNotes = currentMealLog?.clientNotes;
    const displayMealName = currentMealLog?.meal?.name || mealName || 'Meal';
    const displayMealType = currentMealLog?.meal?.mealType || mealType || 'meal';
    const displayTime = currentMealLog?.scheduledTime || scheduledTime;

    // If it's an already logged meal, show the feedback view
    if (!isPendingMeal && (currentMealLog?.status === 'eaten' || currentMealLog?.status === 'skipped' || isLoggedMeal)) {
        return (
            <SafeAreaView style={styles.container} edges={['top']}>
                {/* Header */}
                <View style={styles.header}>
                    <TouchableOpacity style={styles.closeButton} onPress={handleClose}>
                        <X size={24} color={colors.text} />
                    </TouchableOpacity>
                    <Text style={styles.headerTitle}>Meal Details</Text>
                    <View style={styles.headerSpacer} />
                </View>

                <ScrollView style={styles.scrollView} showsVerticalScrollIndicator={false}>
                    {/* Meal Photo or Status Icon */}
                    <View style={styles.photoSection}>
                        {mealPhoto ? (
                            <Image source={{ uri: mealPhoto }} style={styles.mealPhoto} />
                        ) : (
                            <View style={styles.statusIconContainer}>
                                <CheckCircle size={48} color={colors.primary} />
                            </View>
                        )}
                    </View>

                    {/* Meal Info */}
                    <View style={styles.mealInfoCard}>
                        <Text style={styles.mealTypeLabel}>{displayMealType.toUpperCase()}</Text>
                        <Text style={styles.mealNameLarge}>{displayMealName}</Text>
                        {displayTime && (
                            <View style={styles.timeRow}>
                                <Clock size={16} color={colors.textSecondary} />
                                <Text style={styles.timeText}>{displayTime}</Text>
                            </View>
                        )}

                        {/* Status Badge */}
                        <View style={styles.loggedBadge}>
                            <CheckCircle size={16} color={colors.primary} />
                            <Text style={styles.loggedBadgeText}>
                                Logged on {new Date(currentMealLog?.loggedAt || Date.now()).toLocaleDateString()}
                            </Text>
                        </View>
                    </View>

                    {/* Client Notes */}
                    {clientNotes && (
                        <View style={styles.notesCard}>
                            <Text style={styles.cardTitle}>Your Notes</Text>
                            <Text style={styles.notesText}>{clientNotes}</Text>
                        </View>
                    )}

                    {/* Dietitian Feedback */}
                    <View style={styles.feedbackCard}>
                        <View style={styles.feedbackHeader}>
                            <MessageSquare size={20} color={colors.primary} />
                            <Text style={styles.cardTitle}>Dietitian Feedback</Text>
                        </View>

                        {dietitianFeedback ? (
                            <View style={styles.feedbackContent}>
                                <View style={styles.dietitianInfo}>
                                    <View style={styles.dietitianAvatar}>
                                        <User size={16} color={colors.white} />
                                    </View>
                                    <Text style={styles.dietitianName}>Your Dietitian</Text>
                                </View>
                                <Text style={styles.feedbackText}>{dietitianFeedback}</Text>
                                {currentMealLog?.dietitianFeedbackAt && (
                                    <Text style={styles.feedbackTime}>
                                        {new Date(currentMealLog.dietitianFeedbackAt).toLocaleString()}
                                    </Text>
                                )}
                            </View>
                        ) : (
                            <View style={styles.noFeedback}>
                                <Text style={styles.noFeedbackText}>
                                    No feedback yet. Your dietitian will review this meal soon.
                                </Text>
                            </View>
                        )}
                    </View>
                </ScrollView>
            </SafeAreaView>
        );
    }

    // Show meal logging form for pending meals
    return (
        <SafeAreaView style={styles.container} edges={['top']}>
            {/* Header */}
            <View style={styles.header}>
                <TouchableOpacity style={styles.closeButton} onPress={handleClose}>
                    <X size={24} color={colors.text} />
                </TouchableOpacity>
                <Text style={styles.headerTitle}>Log Meal</Text>
                <View style={styles.headerSpacer} />
            </View>

            <ScrollView style={styles.scrollView} showsVerticalScrollIndicator={false}>
                {/* Photo Section */}
                <View style={styles.photoSection}>
                    {photoUri ? (
                        <TouchableOpacity onPress={handleTakePhoto} activeOpacity={0.8}>
                            <Image source={{ uri: photoUri }} style={styles.photoPreview} />
                            <Text style={styles.tapToChange}>Tap to change photo</Text>
                        </TouchableOpacity>
                    ) : (
                        <View style={styles.photoPlaceholder}>
                            <View style={styles.photoButtons}>
                                <TouchableOpacity style={styles.photoButton} onPress={handleTakePhoto}>
                                    <Camera size={28} color={colors.primary} />
                                    <Text style={styles.photoButtonText}>Camera</Text>
                                </TouchableOpacity>
                                <TouchableOpacity style={styles.photoButton} onPress={handlePickImage}>
                                    <ImageIcon size={28} color={colors.primary} />
                                    <Text style={styles.photoButtonText}>Gallery</Text>
                                </TouchableOpacity>
                            </View>
                        </View>
                    )}
                </View>

                {/* Meal Type Selection */}
                <Text style={styles.sectionTitle}>Meal Type</Text>
                <View style={styles.mealTypeContainer}>
                    {mealTypes.map((type) => (
                        <TouchableOpacity
                            key={type}
                            style={[
                                styles.mealTypeButton,
                                selectedMealType === type && styles.mealTypeButtonSelected,
                            ]}
                            onPress={() => setSelectedMealType(type)}
                        >
                            <Text
                                style={[
                                    styles.mealTypeText,
                                    selectedMealType === type && styles.mealTypeTextSelected,
                                ]}
                            >
                                {type}
                            </Text>
                        </TouchableOpacity>
                    ))}
                </View>

                {/* Scheduled Time */}
                {scheduledTime && (
                    <View style={styles.timeContainer}>
                        <Text style={styles.inputLabel}>Scheduled Time</Text>
                        <View style={styles.timeDisplay}>
                            <Clock size={18} color={colors.textSecondary} />
                            <Text style={styles.scheduledTimeText}>{scheduledTime}</Text>
                        </View>
                    </View>
                )}

                {/* Notes Input */}
                <View style={styles.notesContainer}>
                    <Text style={styles.inputLabel}>Notes (Optional)</Text>
                    <TextInput
                        style={styles.notesInput}
                        value={notes}
                        onChangeText={setNotes}
                        placeholder="Add any notes about your meal"
                        placeholderTextColor={colors.textSecondary}
                        multiline
                        numberOfLines={4}
                        textAlignVertical="top"
                    />
                </View>
            </ScrollView>

            {/* Submit Button */}
            <View style={styles.footer}>
                <TouchableOpacity
                    style={[styles.submitButton, isSubmitting && styles.submitButtonDisabled]}
                    onPress={handleSubmit}
                    disabled={isSubmitting}
                >
                    {isSubmitting ? (
                        <ActivityIndicator color={colors.text} />
                    ) : (
                        <Text style={styles.submitButtonText}>Submit</Text>
                    )}
                </TouchableOpacity>
            </View>
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: colors.background,
    },
    loadingContainer: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
        backgroundColor: colors.background,
    },
    header: {
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'space-between',
        paddingHorizontal: 16,
        paddingVertical: 12,
        borderBottomWidth: 1,
        borderBottomColor: colors.border,
    },
    closeButton: {
        width: 40,
        height: 40,
        alignItems: 'flex-start',
        justifyContent: 'center',
    },
    headerTitle: {
        fontSize: 18,
        fontWeight: '700',
        color: colors.text,
    },
    headerSpacer: {
        width: 40,
    },
    scrollView: {
        flex: 1,
    },
    photoSection: {
        paddingVertical: 16,
    },
    mealPhoto: {
        width: '100%',
        aspectRatio: 3 / 2,
        backgroundColor: colors.surface,
    },
    statusIconContainer: {
        width: '100%',
        aspectRatio: 3 / 2,
        backgroundColor: colors.surface,
        justifyContent: 'center',
        alignItems: 'center',
    },
    photoPreview: {
        width: '100%',
        aspectRatio: 3 / 2,
        backgroundColor: colors.surface,
    },
    tapToChange: {
        textAlign: 'center',
        color: colors.textSecondary,
        fontSize: 14,
        marginTop: 8,
    },
    photoPlaceholder: {
        width: '100%',
        aspectRatio: 3 / 2,
        backgroundColor: colors.surface,
        justifyContent: 'center',
        alignItems: 'center',
    },
    photoButtons: {
        flexDirection: 'row',
        gap: 48,
    },
    photoButton: {
        alignItems: 'center',
        gap: 8,
    },
    photoButtonText: {
        fontSize: 14,
        color: colors.text,
        fontWeight: '500',
    },
    mealInfoCard: {
        backgroundColor: colors.white,
        marginHorizontal: 16,
        marginBottom: 16,
        padding: 16,
        borderRadius: 12,
        borderWidth: 1,
        borderColor: colors.border,
    },
    mealTypeLabel: {
        fontSize: 12,
        fontWeight: '600',
        color: colors.textSecondary,
        marginBottom: 4,
    },
    mealNameLarge: {
        fontSize: 22,
        fontWeight: '700',
        color: colors.text,
        marginBottom: 8,
    },
    timeRow: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 6,
        marginBottom: 12,
    },
    timeText: {
        fontSize: 14,
        color: colors.textSecondary,
    },
    loggedBadge: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 8,
        backgroundColor: colors.surface,
        paddingHorizontal: 12,
        paddingVertical: 8,
        borderRadius: 8,
        alignSelf: 'flex-start',
    },
    loggedBadgeText: {
        fontSize: 13,
        color: colors.textSecondary,
    },
    notesCard: {
        backgroundColor: colors.white,
        marginHorizontal: 16,
        marginBottom: 16,
        padding: 16,
        borderRadius: 12,
        borderWidth: 1,
        borderColor: colors.border,
    },
    cardTitle: {
        fontSize: 16,
        fontWeight: '600',
        color: colors.text,
        marginBottom: 12,
    },
    notesText: {
        fontSize: 14,
        color: colors.textSecondary,
        lineHeight: 20,
    },
    feedbackCard: {
        backgroundColor: colors.white,
        marginHorizontal: 16,
        marginBottom: 24,
        padding: 16,
        borderRadius: 12,
        borderWidth: 1,
        borderColor: colors.border,
    },
    feedbackHeader: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 8,
        marginBottom: 12,
    },
    feedbackContent: {
        backgroundColor: colors.surface,
        padding: 12,
        borderRadius: 8,
    },
    dietitianInfo: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 8,
        marginBottom: 8,
    },
    dietitianAvatar: {
        width: 28,
        height: 28,
        borderRadius: 14,
        backgroundColor: colors.primary,
        justifyContent: 'center',
        alignItems: 'center',
    },
    dietitianName: {
        fontSize: 14,
        fontWeight: '600',
        color: colors.text,
    },
    feedbackText: {
        fontSize: 14,
        color: colors.text,
        lineHeight: 20,
    },
    feedbackTime: {
        fontSize: 12,
        color: colors.textSecondary,
        marginTop: 8,
    },
    noFeedback: {
        backgroundColor: colors.surface,
        padding: 16,
        borderRadius: 8,
        alignItems: 'center',
    },
    noFeedbackText: {
        fontSize: 14,
        color: colors.textSecondary,
        textAlign: 'center',
    },
    sectionTitle: {
        fontSize: 18,
        fontWeight: '700',
        color: colors.text,
        paddingHorizontal: 16,
        paddingTop: 16,
        paddingBottom: 8,
    },
    mealTypeContainer: {
        flexDirection: 'row',
        flexWrap: 'wrap',
        gap: 10,
        paddingHorizontal: 16,
        paddingVertical: 8,
    },
    mealTypeButton: {
        paddingHorizontal: 16,
        paddingVertical: 10,
        borderRadius: 8,
        borderWidth: 1,
        borderColor: colors.border,
        backgroundColor: colors.white,
    },
    mealTypeButtonSelected: {
        borderWidth: 2,
        borderColor: colors.primary,
    },
    mealTypeText: {
        fontSize: 14,
        fontWeight: '500',
        color: colors.text,
    },
    mealTypeTextSelected: {
        fontWeight: '600',
    },
    timeContainer: {
        paddingHorizontal: 16,
        paddingVertical: 12,
    },
    inputLabel: {
        fontSize: 16,
        fontWeight: '500',
        color: colors.text,
        marginBottom: 8,
    },
    timeDisplay: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 8,
        backgroundColor: colors.surface,
        padding: 16,
        borderRadius: 8,
    },
    scheduledTimeText: {
        fontSize: 16,
        color: colors.textSecondary,
    },
    notesContainer: {
        paddingHorizontal: 16,
        paddingVertical: 12,
    },
    notesInput: {
        backgroundColor: colors.white,
        borderRadius: 8,
        padding: 16,
        fontSize: 16,
        color: colors.text,
        minHeight: 100,
        borderWidth: 1,
        borderColor: colors.border,
    },
    footer: {
        paddingHorizontal: 16,
        paddingVertical: 12,
        paddingBottom: 24,
        borderTopWidth: 1,
        borderTopColor: colors.border,
    },
    submitButton: {
        backgroundColor: colors.primary,
        height: 52,
        borderRadius: 12,
        justifyContent: 'center',
        alignItems: 'center',
    },
    submitButtonDisabled: {
        opacity: 0.6,
    },
    submitButtonText: {
        fontSize: 16,
        fontWeight: '700',
        color: colors.text,
    },
});
</file>

<file path="client-app/app/(tabs)/home/_layout.tsx">
import { Slot } from 'expo-router';

export default function HomeLayout() {
    return <Slot />;
}
</file>

<file path="client-app/app/(tabs)/home/index.tsx">
import { View, Text, StyleSheet, ScrollView, TouchableOpacity, RefreshControl, Image } from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';
import { useRouter } from 'expo-router';
import { useTodayMeals, useClientStats } from '../../../hooks/useMeals';
import { Clock, Camera, Check, AlertCircle, MessageSquare } from 'lucide-react-native';
import { useState } from 'react';
import { MealLog } from '../../../types';

// Figma Design Colors
const colors = {
    background: '#f8fcf9',
    primary: '#13ec5b',
    text: '#0d1b12',
    textSecondary: '#4c9a66',
    border: '#cfe7d7',
    surface: '#e7f3eb',
    white: '#ffffff',
};

interface MealCardProps {
    mealLog: MealLog;
    onPress: () => void;
}

function MealCardV2({ mealLog, onPress }: MealCardProps) {
    const { meal, status, scheduledTime, dietitianFeedback } = mealLog;

    const getStatusInfo = () => {
        // If eaten but no feedback yet = Under Review
        // If eaten with feedback = Reviewed  
        // If skipped = Skipped
        // Otherwise = Pending
        if (status === 'eaten') {
            if (dietitianFeedback) {
                return { color: '#8b5cf6', icon: MessageSquare, label: 'Reviewed' };
            }
            return { color: '#f59e0b', icon: Clock, label: 'Under Review' };
        }
        if (status === 'skipped') {
            return { color: '#ef4444', icon: AlertCircle, label: 'Skipped' };
        }
        return { color: colors.textSecondary, icon: Clock, label: 'Pending' };
    };

    const statusInfo = getStatusInfo();

    return (
        <TouchableOpacity style={styles.mealCard} onPress={onPress} activeOpacity={0.8}>
            {/* Meal Image */}
            <View style={styles.mealImageContainer}>
                {mealLog.mealPhotoUrl ? (
                    <Image source={{ uri: mealLog.mealPhotoUrl }} style={styles.mealImage} />
                ) : (
                    <View style={styles.mealImagePlaceholder}>
                        <Camera size={32} color={colors.textSecondary} />
                    </View>
                )}
            </View>

            {/* Meal Info */}
            <View style={styles.mealInfo}>
                <View style={styles.mealHeader}>
                    <Text style={styles.mealType}>
                        {meal?.mealType?.charAt(0).toUpperCase() + meal?.mealType?.slice(1) || 'Meal'}
                    </Text>
                    <View style={[styles.statusBadge, { backgroundColor: statusInfo.color + '20' }]}>
                        <statusInfo.icon size={12} color={statusInfo.color} />
                        <Text style={[styles.statusText, { color: statusInfo.color }]}>
                            {statusInfo.label}
                        </Text>
                    </View>
                </View>

                <Text style={styles.mealName} numberOfLines={1}>{meal?.name || 'Meal'}</Text>

                {scheduledTime && (
                    <View style={styles.timeRow}>
                        <Clock size={14} color={colors.textSecondary} />
                        <Text style={styles.timeText}>{scheduledTime}</Text>
                    </View>
                )}

                {/* Macros */}
                <View style={styles.macrosRow}>
                    <Text style={styles.macroText}>{meal?.totalCalories || 0} kcal</Text>
                    <View style={styles.macroDot} />
                    <Text style={styles.macroText}>{meal?.totalProteinG || 0}g P</Text>
                    <View style={styles.macroDot} />
                    <Text style={styles.macroText}>{meal?.totalCarbsG || 0}g C</Text>
                </View>

                {/* Dietitian Feedback */}
                {dietitianFeedback && (
                    <View style={styles.feedbackRow}>
                        <MessageSquare size={14} color={colors.primary} />
                        <Text style={styles.feedbackText} numberOfLines={1}>{dietitianFeedback}</Text>
                    </View>
                )}
            </View>

            {/* Log Button for pending meals */}
            {status === 'pending' && (
                <TouchableOpacity style={styles.logButton} onPress={onPress}>
                    <Camera size={18} color={colors.text} />
                </TouchableOpacity>
            )}
        </TouchableOpacity>
    );
}

export default function HomeScreen() {
    const router = useRouter();
    const { data: meals, isLoading, refetch } = useTodayMeals();
    const { data: stats } = useClientStats();
    const [refreshing, setRefreshing] = useState(false);

    const onRefresh = async () => {
        setRefreshing(true);
        await refetch();
        setRefreshing(false);
    };

    const today = new Date().toLocaleDateString('en-US', {
        weekday: 'long',
        month: 'long',
        day: 'numeric',
    });

    const handleMealPress = (mealLog: MealLog) => {
        router.push({
            pathname: '/(tabs)/home/meal/[id]',
            params: {
                id: mealLog.id,
                status: mealLog.status,
                mealName: mealLog.meal?.name || '',
                mealType: mealLog.meal?.mealType || '',
                scheduledTime: mealLog.scheduledTime || '',
                feedback: mealLog.dietitianFeedback || '',
            },
        });
    };

    return (
        <SafeAreaView style={styles.container} edges={['top']}>
            <ScrollView
                style={styles.scrollView}
                refreshControl={<RefreshControl refreshing={refreshing} onRefresh={onRefresh} tintColor={colors.primary} />}
                showsVerticalScrollIndicator={false}
            >
                {/* Header */}
                <View style={styles.header}>
                    <Text style={styles.dateText}>{today}</Text>
                    <View style={styles.streakBadge}>
                        <Text style={styles.streakText}>🔥 {stats?.currentStreak || 0} day streak</Text>
                    </View>
                </View>

                {/* Stats Cards */}
                <View style={styles.statsRow}>
                    <View style={styles.statCard}>
                        <Text style={styles.statValue}>{stats?.currentStreak || 0}</Text>
                        <Text style={styles.statLabel}>Adherence streak</Text>
                    </View>
                    <View style={styles.statCard}>
                        <Text style={styles.statValue}>{stats?.weeklyAdherence || 0}%</Text>
                        <Text style={styles.statLabel}>On track this week</Text>
                    </View>
                </View>

                {/* Today's Meals */}
                <Text style={styles.sectionTitle}>Today's Meals</Text>

                {isLoading ? (
                    <View style={styles.loadingContainer}>
                        <Text style={styles.loadingText}>Loading meals...</Text>
                    </View>
                ) : meals && meals.length > 0 ? (
                    <View style={styles.mealsContainer}>
                        {meals.map((mealLog) => (
                            <MealCardV2
                                key={mealLog.id}
                                mealLog={mealLog}
                                onPress={() => handleMealPress(mealLog)}
                            />
                        ))}
                    </View>
                ) : (
                    <View style={styles.emptyContainer}>
                        <Text style={styles.emptyText}>No meals scheduled for today</Text>
                        <Text style={styles.emptySubtext}>Your dietitian will add your meal plan soon</Text>
                    </View>
                )}
            </ScrollView>
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: colors.background,
    },
    scrollView: {
        flex: 1,
    },
    header: {
        paddingHorizontal: 16,
        paddingVertical: 16,
    },
    dateText: {
        fontSize: 22,
        fontWeight: '700',
        color: colors.text,
        marginBottom: 8,
    },
    streakBadge: {
        alignSelf: 'flex-start',
    },
    streakText: {
        fontSize: 14,
        color: colors.textSecondary,
    },
    statsRow: {
        flexDirection: 'row',
        paddingHorizontal: 16,
        gap: 12,
        marginBottom: 24,
    },
    statCard: {
        flex: 1,
        backgroundColor: colors.white,
        borderWidth: 1,
        borderColor: colors.border,
        borderRadius: 12,
        padding: 16,
        alignItems: 'center',
    },
    statValue: {
        fontSize: 24,
        fontWeight: '700',
        color: colors.text,
    },
    statLabel: {
        fontSize: 14,
        color: colors.textSecondary,
        marginTop: 4,
        textAlign: 'center',
    },
    sectionTitle: {
        fontSize: 22,
        fontWeight: '700',
        color: colors.text,
        paddingHorizontal: 16,
        marginBottom: 16,
    },
    mealsContainer: {
        paddingHorizontal: 16,
        gap: 12,
        paddingBottom: 24,
    },
    mealCard: {
        backgroundColor: colors.white,
        borderRadius: 16,
        flexDirection: 'row',
        overflow: 'hidden',
        borderWidth: 1,
        borderColor: colors.border,
    },
    mealImageContainer: {
        width: 100,
        height: 100,
    },
    mealImage: {
        width: '100%',
        height: '100%',
    },
    mealImagePlaceholder: {
        width: '100%',
        height: '100%',
        backgroundColor: colors.surface,
        justifyContent: 'center',
        alignItems: 'center',
    },
    mealInfo: {
        flex: 1,
        padding: 12,
    },
    mealHeader: {
        flexDirection: 'row',
        justifyContent: 'space-between',
        alignItems: 'center',
        marginBottom: 4,
    },
    mealType: {
        fontSize: 12,
        fontWeight: '600',
        color: colors.textSecondary,
        textTransform: 'uppercase',
    },
    statusBadge: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 4,
        paddingHorizontal: 8,
        paddingVertical: 2,
        borderRadius: 10,
    },
    statusText: {
        fontSize: 10,
        fontWeight: '600',
    },
    mealName: {
        fontSize: 16,
        fontWeight: '700',
        color: colors.text,
        marginBottom: 4,
    },
    timeRow: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 4,
        marginBottom: 4,
    },
    timeText: {
        fontSize: 12,
        color: colors.textSecondary,
    },
    macrosRow: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 6,
    },
    macroText: {
        fontSize: 11,
        color: colors.textSecondary,
    },
    macroDot: {
        width: 3,
        height: 3,
        borderRadius: 1.5,
        backgroundColor: colors.border,
    },
    feedbackRow: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 4,
        marginTop: 6,
        padding: 6,
        backgroundColor: colors.surface,
        borderRadius: 6,
    },
    feedbackText: {
        fontSize: 11,
        color: colors.primary,
        flex: 1,
    },
    logButton: {
        width: 44,
        justifyContent: 'center',
        alignItems: 'center',
        backgroundColor: colors.primary,
    },
    loadingContainer: {
        padding: 40,
        alignItems: 'center',
    },
    loadingText: {
        color: colors.textSecondary,
    },
    emptyContainer: {
        padding: 40,
        alignItems: 'center',
    },
    emptyText: {
        fontSize: 16,
        fontWeight: '600',
        color: colors.text,
        marginBottom: 8,
    },
    emptySubtext: {
        fontSize: 14,
        color: colors.textSecondary,
        textAlign: 'center',
    },
});
</file>

<file path="client-app/app/(tabs)/notifications/_layout.tsx">
import { Slot } from 'expo-router';

export default function NotificationsLayout() {
    return <Slot />;
}
</file>

<file path="client-app/app/(tabs)/notifications/index.tsx">
import { View, Text, StyleSheet, ScrollView, TouchableOpacity, RefreshControl } from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';
import { useState, useCallback } from 'react';
import { useRouter } from 'expo-router';
import { Settings, MessageCircle, Utensils, Scale, Award } from 'lucide-react-native';

// Figma Design Colors
const colors = {
    background: '#f8fcf9',
    primary: '#13ec5b',
    text: '#0d1b12',
    textSecondary: '#4c9a66',
    border: '#cfe7d7',
    surface: '#e7f3eb',
    white: '#ffffff',
};

// Mock notification data - will be replaced with API integration
const mockNotifications = [
    {
        id: '1',
        type: 'feedback',
        title: 'Dr. Sharma commented on your lunch',
        message: 'Great portion control! Keep it up.',
        timestamp: '2h ago',
        read: false,
    },
    {
        id: '2',
        type: 'reminder',
        title: "Don't forget to log your dinner",
        message: 'You have a meal scheduled for 7:30 PM',
        timestamp: '4h ago',
        read: false,
    },
    {
        id: '3',
        type: 'weight',
        title: 'Weekly weight check-in',
        message: "It's time to log your weight!",
        timestamp: '1d ago',
        read: true,
    },
    {
        id: '4',
        type: 'achievement',
        title: 'New milestone achieved! 🎉',
        message: "You've completed 7 days streak",
        timestamp: '2d ago',
        read: true,
    },
    {
        id: '5',
        type: 'feedback',
        title: 'Dr. Sharma approved your meal plan',
        message: 'Your breakfast choices look perfect',
        timestamp: '3d ago',
        read: true,
    },
];

const getNotificationIcon = (type: string) => {
    switch (type) {
        case 'feedback':
            return MessageCircle;
        case 'reminder':
            return Utensils;
        case 'weight':
            return Scale;
        case 'achievement':
            return Award;
        default:
            return MessageCircle;
    }
};

export default function NotificationsScreen() {
    const router = useRouter();
    const [refreshing, setRefreshing] = useState(false);
    const [notifications] = useState(mockNotifications);

    const onRefresh = useCallback(async () => {
        setRefreshing(true);
        // TODO: Refetch notifications from API
        await new Promise(resolve => setTimeout(resolve, 1000));
        setRefreshing(false);
    }, []);

    return (
        <SafeAreaView style={styles.container} edges={['top']}>
            {/* Header */}
            <View style={styles.header}>
                <View style={styles.headerSpacer} />
                <Text style={styles.headerTitle}>Inbox</Text>
                <TouchableOpacity style={styles.settingsButton}>
                    <Settings size={24} color={colors.text} />
                </TouchableOpacity>
            </View>

            <ScrollView
                style={styles.scrollView}
                showsVerticalScrollIndicator={false}
                refreshControl={
                    <RefreshControl
                        refreshing={refreshing}
                        onRefresh={onRefresh}
                        tintColor={colors.primary}
                    />
                }
            >
                {notifications.length === 0 ? (
                    <View style={styles.emptyContainer}>
                        <MessageCircle size={48} color={colors.textSecondary} />
                        <Text style={styles.emptyTitle}>No notifications yet</Text>
                        <Text style={styles.emptySubtitle}>
                            You'll see updates from your dietitian here
                        </Text>
                    </View>
                ) : (
                    <View style={styles.notificationsList}>
                        {notifications.map((notification) => {
                            const IconComponent = getNotificationIcon(notification.type);
                            return (
                                <TouchableOpacity
                                    key={notification.id}
                                    style={[
                                        styles.notificationItem,
                                        !notification.read && styles.notificationUnread,
                                    ]}
                                    activeOpacity={0.7}
                                >
                                    <View style={styles.notificationIcon}>
                                        <IconComponent size={20} color={colors.primary} />
                                    </View>
                                    <View style={styles.notificationContent}>
                                        <Text
                                            style={[
                                                styles.notificationTitle,
                                                !notification.read && styles.notificationTitleUnread,
                                            ]}
                                            numberOfLines={2}
                                        >
                                            {notification.title}
                                        </Text>
                                        {notification.message && (
                                            <Text style={styles.notificationMessage} numberOfLines={1}>
                                                {notification.message}
                                            </Text>
                                        )}
                                        <Text style={styles.notificationTime}>
                                            {notification.timestamp}
                                        </Text>
                                    </View>
                                </TouchableOpacity>
                            );
                        })}
                    </View>
                )}
            </ScrollView>
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: colors.background,
    },
    header: {
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'space-between',
        paddingHorizontal: 16,
        paddingVertical: 8,
    },
    headerSpacer: {
        width: 48,
    },
    headerTitle: {
        fontSize: 18,
        fontWeight: '700',
        color: colors.text,
    },
    settingsButton: {
        width: 48,
        height: 48,
        alignItems: 'flex-end',
        justifyContent: 'center',
    },
    scrollView: {
        flex: 1,
    },
    emptyContainer: {
        flex: 1,
        alignItems: 'center',
        justifyContent: 'center',
        paddingTop: 100,
        paddingHorizontal: 24,
    },
    emptyTitle: {
        fontSize: 18,
        fontWeight: '700',
        color: colors.text,
        marginTop: 16,
    },
    emptySubtitle: {
        fontSize: 14,
        color: colors.textSecondary,
        textAlign: 'center',
        marginTop: 8,
    },
    notificationsList: {
        padding: 16,
    },
    notificationItem: {
        flexDirection: 'row',
        alignItems: 'flex-start',
        backgroundColor: colors.white,
        borderRadius: 12,
        padding: 16,
        marginBottom: 12,
        borderWidth: 1,
        borderColor: colors.border,
    },
    notificationUnread: {
        backgroundColor: colors.surface,
        borderColor: colors.primary,
    },
    notificationIcon: {
        width: 44,
        height: 44,
        borderRadius: 22,
        backgroundColor: colors.surface,
        alignItems: 'center',
        justifyContent: 'center',
        marginRight: 12,
    },
    notificationContent: {
        flex: 1,
    },
    notificationTitle: {
        fontSize: 16,
        fontWeight: '500',
        color: colors.text,
        marginBottom: 4,
    },
    notificationTitleUnread: {
        fontWeight: '700',
    },
    notificationMessage: {
        fontSize: 14,
        color: colors.textSecondary,
        marginBottom: 4,
    },
    notificationTime: {
        fontSize: 12,
        color: colors.textSecondary,
    },
});
</file>

<file path="client-app/app/(tabs)/profile/_layout.tsx">
import { Slot } from 'expo-router';

export default function ProfileLayout() {
    return <Slot />;
}
</file>

<file path="client-app/app/(tabs)/profile/index.tsx">
import { View, Text, StyleSheet, ScrollView, TouchableOpacity, Alert, Image } from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';
import { useRouter } from 'expo-router';
import { useAuth } from '../../../hooks/useAuth';
import { ChevronRight, Bell, Shield, HelpCircle, LogOut, Users, FileText, CreditCard, Gift } from 'lucide-react-native';

// Figma Design Colors
const colors = {
    background: '#f8fcf9',
    primary: '#13ec5b',
    text: '#0d1b12',
    textSecondary: '#4c9a66',
    border: '#cfe7d7',
    surface: '#e7f3eb',
    white: '#ffffff',
    error: '#ef4444',
};

interface MenuItemProps {
    icon: typeof Bell;
    title: string;
    subtitle?: string;
    onPress: () => void;
    showChevron?: boolean;
    danger?: boolean;
}

function MenuItem({ icon: Icon, title, subtitle, onPress, showChevron = true, danger = false }: MenuItemProps) {
    return (
        <TouchableOpacity style={styles.menuItem} onPress={onPress} activeOpacity={0.7}>
            <View style={[styles.menuIconContainer, danger && styles.menuIconDanger]}>
                <Icon size={20} color={danger ? colors.error : colors.primary} />
            </View>
            <View style={styles.menuTextContainer}>
                <Text style={[styles.menuTitle, danger && styles.menuTitleDanger]}>{title}</Text>
                {subtitle && <Text style={styles.menuSubtitle}>{subtitle}</Text>}
            </View>
            {showChevron && <ChevronRight size={20} color={colors.textSecondary} />}
        </TouchableOpacity>
    );
}

export default function ProfileScreen() {
    const router = useRouter();
    const { logout, client } = useAuth();

    const handleLogout = () => {
        Alert.alert(
            'Logout',
            'Are you sure you want to logout?',
            [
                { text: 'Cancel', style: 'cancel' },
                {
                    text: 'Logout',
                    style: 'destructive',
                    onPress: async () => {
                        await logout();
                        router.replace('/(auth)/login');
                    }
                },
            ]
        );
    };

    const getInitials = (name: string) => {
        return name
            .split(' ')
            .map(n => n[0])
            .join('')
            .toUpperCase()
            .slice(0, 2);
    };

    return (
        <SafeAreaView style={styles.container} edges={['top']}>
            <ScrollView style={styles.scrollView} showsVerticalScrollIndicator={false}>
                {/* Header */}
                <Text style={styles.headerTitle}>Profile</Text>

                {/* Profile Card */}
                <View style={styles.profileCard}>
                    <View style={styles.avatarContainer}>
                        {client?.profilePhotoUrl ? (
                            <Image source={{ uri: client.profilePhotoUrl }} style={styles.avatar} />
                        ) : (
                            <View style={styles.avatarPlaceholder}>
                                <Text style={styles.avatarText}>
                                    {client?.fullName ? getInitials(client.fullName) : 'U'}
                                </Text>
                            </View>
                        )}
                    </View>
                    <View style={styles.profileInfo}>
                        <Text style={styles.profileName}>{client?.fullName || 'User'}</Text>
                        <Text style={styles.profilePhone}>{client?.phone || '+91 XXXXXXXXXX'}</Text>
                        {client?.email && (
                            <Text style={styles.profileEmail}>{client.email}</Text>
                        )}
                    </View>
                </View>

                {/* Subscription Card */}
                <View style={styles.subscriptionCard}>
                    <View style={styles.subscriptionHeader}>
                        <CreditCard size={20} color={colors.primary} />
                        <Text style={styles.subscriptionTitle}>Subscription</Text>
                    </View>
                    <View style={styles.subscriptionDetails}>
                        <View style={styles.subscriptionRow}>
                            <Text style={styles.subscriptionLabel}>Status</Text>
                            <View style={styles.activeBadge}>
                                <Text style={styles.activeBadgeText}>Active</Text>
                            </View>
                        </View>
                        <View style={styles.subscriptionRow}>
                            <Text style={styles.subscriptionLabel}>Plan</Text>
                            <Text style={styles.subscriptionValue}>Monthly</Text>
                        </View>
                        <View style={styles.subscriptionRow}>
                            <Text style={styles.subscriptionLabel}>Renews</Text>
                            <Text style={styles.subscriptionValue}>-- / -- / ----</Text>
                        </View>
                    </View>
                </View>

                {/* Referral Card */}
                <TouchableOpacity
                    style={styles.referralCard}
                    onPress={() => router.push('/(tabs)/profile/referral')}
                    activeOpacity={0.8}
                >
                    <View style={styles.referralIconContainer}>
                        <Gift size={24} color="#fff" />
                    </View>
                    <View style={styles.referralContent}>
                        <Text style={styles.referralTitle}>Refer & Earn</Text>
                        <Text style={styles.referralSubtitle}>Get 1 month free for every 3 referrals!</Text>
                    </View>
                    <ChevronRight size={24} color={colors.primary} />
                </TouchableOpacity>

                {/* Menu Items */}
                <View style={styles.menuSection}>
                    <MenuItem
                        icon={Bell}
                        title="Notifications"
                        onPress={() => router.push('/(tabs)/notifications')}
                    />
                    <MenuItem
                        icon={FileText}
                        title="My Reports"
                        subtitle="Upload & view medical reports"
                        onPress={() => router.push('/(tabs)/profile/reports')}
                    />
                    <MenuItem
                        icon={Shield}
                        title="Privacy & Security"
                        onPress={() => Alert.alert('Coming Soon', 'This feature will be available soon.')}
                    />
                    <MenuItem
                        icon={HelpCircle}
                        title="Help & Support"
                        onPress={() => Alert.alert('Help', 'Contact us at support@dietconnect.com')}
                    />
                </View>

                {/* Logout */}
                <View style={styles.logoutSection}>
                    <MenuItem
                        icon={LogOut}
                        title="Logout"
                        onPress={handleLogout}
                        showChevron={false}
                        danger
                    />
                </View>

                {/* Version */}
                <Text style={styles.versionText}>Version 1.0.0</Text>
            </ScrollView>
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: colors.background,
    },
    scrollView: {
        flex: 1,
        padding: 16,
    },
    headerTitle: {
        fontSize: 22,
        fontWeight: '700',
        color: colors.text,
        marginBottom: 24,
    },
    profileCard: {
        flexDirection: 'row',
        alignItems: 'center',
        backgroundColor: colors.white,
        borderRadius: 16,
        padding: 16,
        marginBottom: 16,
        borderWidth: 1,
        borderColor: colors.border,
    },
    avatarContainer: {
        marginRight: 16,
    },
    avatar: {
        width: 64,
        height: 64,
        borderRadius: 32,
    },
    avatarPlaceholder: {
        width: 64,
        height: 64,
        borderRadius: 32,
        backgroundColor: colors.primary,
        justifyContent: 'center',
        alignItems: 'center',
    },
    avatarText: {
        fontSize: 24,
        fontWeight: '700',
        color: colors.text,
    },
    profileInfo: {
        flex: 1,
    },
    profileName: {
        fontSize: 20,
        fontWeight: '700',
        color: colors.text,
        marginBottom: 4,
    },
    profilePhone: {
        fontSize: 14,
        color: colors.textSecondary,
    },
    profileEmail: {
        fontSize: 14,
        color: colors.textSecondary,
        marginTop: 2,
    },
    // Subscription Card
    subscriptionCard: {
        backgroundColor: colors.white,
        borderRadius: 16,
        padding: 16,
        marginBottom: 16,
        borderWidth: 1,
        borderColor: colors.border,
    },
    subscriptionHeader: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 8,
        marginBottom: 12,
    },
    subscriptionTitle: {
        fontSize: 16,
        fontWeight: '600',
        color: colors.text,
    },
    subscriptionDetails: {
        gap: 8,
    },
    subscriptionRow: {
        flexDirection: 'row',
        justifyContent: 'space-between',
        alignItems: 'center',
    },
    subscriptionLabel: {
        fontSize: 14,
        color: colors.textSecondary,
    },
    subscriptionValue: {
        fontSize: 14,
        fontWeight: '500',
        color: colors.text,
    },
    activeBadge: {
        backgroundColor: '#d1fae5',
        paddingHorizontal: 10,
        paddingVertical: 4,
        borderRadius: 8,
    },
    activeBadgeText: {
        fontSize: 12,
        fontWeight: '600',
        color: '#065f46',
    },
    // Referral Card
    referralCard: {
        flexDirection: 'row',
        alignItems: 'center',
        backgroundColor: colors.surface,
        borderRadius: 16,
        padding: 16,
        marginBottom: 16,
        borderWidth: 1,
        borderColor: colors.primary,
    },
    referralIconContainer: {
        width: 48,
        height: 48,
        borderRadius: 24,
        backgroundColor: colors.primary,
        justifyContent: 'center',
        alignItems: 'center',
        marginRight: 12,
    },
    referralContent: {
        flex: 1,
    },
    referralTitle: {
        fontSize: 16,
        fontWeight: '700',
        color: colors.text,
    },
    referralSubtitle: {
        fontSize: 13,
        color: colors.textSecondary,
        marginTop: 2,
    },
    menuSection: {
        backgroundColor: colors.white,
        borderRadius: 16,
        borderWidth: 1,
        borderColor: colors.border,
        overflow: 'hidden',
        marginBottom: 16,
    },
    menuItem: {
        flexDirection: 'row',
        alignItems: 'center',
        padding: 16,
        borderBottomWidth: 1,
        borderBottomColor: colors.border,
    },
    menuIconContainer: {
        width: 40,
        height: 40,
        borderRadius: 20,
        backgroundColor: colors.surface,
        justifyContent: 'center',
        alignItems: 'center',
        marginRight: 12,
    },
    menuIconDanger: {
        backgroundColor: '#fee2e2',
    },
    menuTextContainer: {
        flex: 1,
    },
    menuTitle: {
        fontSize: 16,
        fontWeight: '500',
        color: colors.text,
    },
    menuSubtitle: {
        fontSize: 12,
        color: colors.textSecondary,
        marginTop: 2,
    },
    menuTitleDanger: {
        color: colors.error,
    },
    logoutSection: {
        backgroundColor: colors.white,
        borderRadius: 16,
        borderWidth: 1,
        borderColor: colors.border,
        overflow: 'hidden',
        marginBottom: 24,
    },
    versionText: {
        textAlign: 'center',
        fontSize: 12,
        color: colors.textSecondary,
        marginBottom: 24,
    },
});
</file>

<file path="client-app/app/(tabs)/profile/referral.tsx">
import { useState, useEffect } from 'react';
import {
    View,
    Text,
    StyleSheet,
    ScrollView,
    TouchableOpacity,
    Share,
    Alert,
    ActivityIndicator,
    Linking,
    Clipboard,
} from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';
import { useRouter } from 'expo-router';
import { ArrowLeft, Copy, Share2, Gift, Users, Award } from 'lucide-react-native';
import api from '../../../services/api';

const colors = {
    background: '#f8fcf9',
    primary: '#13ec5b',
    text: '#0d1b12',
    textSecondary: '#4c9a66',
    border: '#cfe7d7',
    surface: '#e7f3eb',
    white: '#ffffff',
};

interface ReferralData {
    referralCode: string;
    shareMessage: string;
    whatsappLink: string;
}

interface ReferralStats {
    referralCount: number;
    freeMonthsEarned: number;
    freeMonthsUsed: number;
    freeMonthsRemaining: number;
    referralsUntilNextReward: number;
    referredClients: { name: string; joinedAt: string }[];
}

export default function ReferralScreen() {
    const router = useRouter();
    const [loading, setLoading] = useState(true);
    const [referralData, setReferralData] = useState<ReferralData | null>(null);
    const [stats, setStats] = useState<ReferralStats | null>(null);
    const [copied, setCopied] = useState(false);

    useEffect(() => {
        fetchReferralData();
    }, []);

    const fetchReferralData = async () => {
        try {
            const [codeRes, statsRes] = await Promise.all([
                api.get('/client/referral/code'),
                api.get('/client/referral/stats'),
            ]);
            setReferralData(codeRes.data.data);
            setStats(statsRes.data.data);
        } catch (error) {
            Alert.alert('Error', 'Failed to load referral data');
        } finally {
            setLoading(false);
        }
    };

    const handleCopyCode = async () => {
        if (referralData?.referralCode) {
            Clipboard.setString(referralData.referralCode);
            setCopied(true);
            setTimeout(() => setCopied(false), 2000);
        }
    };

    const handleShareWhatsApp = async () => {
        if (referralData?.whatsappLink) {
            try {
                await Linking.openURL(referralData.whatsappLink);
            } catch (error) {
                Alert.alert('Error', 'WhatsApp is not installed');
            }
        }
    };

    const handleShare = async () => {
        if (referralData?.shareMessage) {
            try {
                await Share.share({
                    message: referralData.shareMessage,
                });
            } catch (error) {
                console.error('Share error:', error);
            }
        }
    };

    if (loading) {
        return (
            <SafeAreaView style={styles.container} edges={['top']}>
                <View style={styles.loadingContainer}>
                    <ActivityIndicator size="large" color={colors.primary} />
                </View>
            </SafeAreaView>
        );
    }

    return (
        <SafeAreaView style={styles.container} edges={['top']}>
            <ScrollView style={styles.scrollView} showsVerticalScrollIndicator={false}>
                {/* Header */}
                <View style={styles.header}>
                    <TouchableOpacity onPress={() => router.back()} style={styles.backButton}>
                        <ArrowLeft size={24} color={colors.text} />
                    </TouchableOpacity>
                    <Text style={styles.headerTitle}>Refer & Earn</Text>
                </View>

                {/* Hero Card */}
                <View style={styles.heroCard}>
                    <Gift size={48} color="#fff" />
                    <Text style={styles.heroTitle}>Invite Friends, Get Rewards!</Text>
                    <Text style={styles.heroSubtitle}>
                        Share your code with friends. When 3 friends join, you get 1 month FREE!
                    </Text>
                </View>

                {/* Referral Code Card */}
                <View style={styles.codeCard}>
                    <Text style={styles.codeLabel}>Your Referral Code</Text>
                    <View style={styles.codeContainer}>
                        <Text style={styles.codeText}>{referralData?.referralCode || '------'}</Text>
                        <TouchableOpacity style={styles.copyButton} onPress={handleCopyCode}>
                            <Copy size={20} color={copied ? colors.primary : colors.text} />
                            <Text style={[styles.copyText, copied && styles.copyTextActive]}>
                                {copied ? 'Copied!' : 'Copy'}
                            </Text>
                        </TouchableOpacity>
                    </View>
                </View>

                {/* Share Buttons */}
                <View style={styles.shareSection}>
                    <Text style={styles.shareSectionTitle}>Share via</Text>
                    <View style={styles.shareButtons}>
                        <TouchableOpacity style={styles.whatsappButton} onPress={handleShareWhatsApp}>
                            <Text style={styles.whatsappIcon}>💬</Text>
                            <Text style={styles.shareButtonText}>WhatsApp</Text>
                        </TouchableOpacity>
                        <TouchableOpacity style={styles.shareButton} onPress={handleShare}>
                            <Share2 size={20} color={colors.text} />
                            <Text style={styles.shareButtonText}>More</Text>
                        </TouchableOpacity>
                    </View>
                </View>

                {/* Stats Card */}
                <View style={styles.statsCard}>
                    <Text style={styles.statsTitle}>Your Referral Stats</Text>
                    <View style={styles.statsGrid}>
                        <View style={styles.statItem}>
                            <View style={styles.statIconContainer}>
                                <Users size={20} color={colors.primary} />
                            </View>
                            <Text style={styles.statValue}>{stats?.referralCount || 0}</Text>
                            <Text style={styles.statLabel}>Friends Invited</Text>
                        </View>
                        <View style={styles.statItem}>
                            <View style={styles.statIconContainer}>
                                <Award size={20} color={colors.primary} />
                            </View>
                            <Text style={styles.statValue}>{stats?.freeMonthsRemaining || 0}</Text>
                            <Text style={styles.statLabel}>Free Months</Text>
                        </View>
                    </View>

                    {/* Progress to next reward */}
                    <View style={styles.progressSection}>
                        <Text style={styles.progressText}>
                            {stats?.referralsUntilNextReward === 0
                                ? '🎉 You earned a free month!'
                                : `${stats?.referralsUntilNextReward || 3} more referrals to earn 1 free month`}
                        </Text>
                        <View style={styles.progressBar}>
                            <View
                                style={[
                                    styles.progressFill,
                                    {
                                        width: `${((3 - (stats?.referralsUntilNextReward || 3)) / 3) * 100}%`,
                                    },
                                ]}
                            />
                        </View>
                    </View>
                </View>

                {/* Recent Referrals */}
                {stats?.referredClients && stats.referredClients.length > 0 && (
                    <View style={styles.recentCard}>
                        <Text style={styles.recentTitle}>Recent Referrals</Text>
                        {stats.referredClients.map((client, index) => (
                            <View key={index} style={styles.recentItem}>
                                <Text style={styles.recentName}>{client.name}</Text>
                                <Text style={styles.recentDate}>
                                    {new Date(client.joinedAt).toLocaleDateString()}
                                </Text>
                            </View>
                        ))}
                    </View>
                )}
            </ScrollView>
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: colors.background,
    },
    loadingContainer: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
    },
    scrollView: {
        flex: 1,
        padding: 16,
    },
    header: {
        flexDirection: 'row',
        alignItems: 'center',
        marginBottom: 24,
    },
    backButton: {
        marginRight: 12,
    },
    headerTitle: {
        fontSize: 22,
        fontWeight: '700',
        color: colors.text,
    },
    heroCard: {
        backgroundColor: colors.primary,
        borderRadius: 20,
        padding: 24,
        alignItems: 'center',
        marginBottom: 16,
    },
    heroTitle: {
        fontSize: 24,
        fontWeight: '700',
        color: colors.text,
        marginTop: 16,
        textAlign: 'center',
    },
    heroSubtitle: {
        fontSize: 14,
        color: 'rgba(13,27,18,0.8)',
        textAlign: 'center',
        marginTop: 8,
        lineHeight: 20,
    },
    codeCard: {
        backgroundColor: colors.white,
        borderRadius: 16,
        padding: 20,
        marginBottom: 16,
        borderWidth: 1,
        borderColor: colors.border,
    },
    codeLabel: {
        fontSize: 14,
        color: colors.textSecondary,
        marginBottom: 12,
    },
    codeContainer: {
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'space-between',
    },
    codeText: {
        fontSize: 32,
        fontWeight: '700',
        color: colors.text,
        letterSpacing: 4,
    },
    copyButton: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 6,
        backgroundColor: colors.surface,
        paddingHorizontal: 16,
        paddingVertical: 10,
        borderRadius: 12,
    },
    copyText: {
        fontSize: 14,
        fontWeight: '600',
        color: colors.text,
    },
    copyTextActive: {
        color: colors.primary,
    },
    shareSection: {
        marginBottom: 16,
    },
    shareSectionTitle: {
        fontSize: 14,
        color: colors.textSecondary,
        marginBottom: 12,
    },
    shareButtons: {
        flexDirection: 'row',
        gap: 12,
    },
    whatsappButton: {
        flex: 1,
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'center',
        gap: 8,
        backgroundColor: '#25D366',
        paddingVertical: 16,
        borderRadius: 14,
    },
    whatsappIcon: {
        fontSize: 20,
    },
    shareButton: {
        flex: 1,
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'center',
        gap: 8,
        backgroundColor: colors.white,
        paddingVertical: 16,
        borderRadius: 14,
        borderWidth: 1,
        borderColor: colors.border,
    },
    shareButtonText: {
        fontSize: 16,
        fontWeight: '600',
        color: colors.text,
    },
    statsCard: {
        backgroundColor: colors.white,
        borderRadius: 16,
        padding: 20,
        marginBottom: 16,
        borderWidth: 1,
        borderColor: colors.border,
    },
    statsTitle: {
        fontSize: 16,
        fontWeight: '600',
        color: colors.text,
        marginBottom: 16,
    },
    statsGrid: {
        flexDirection: 'row',
        gap: 16,
    },
    statItem: {
        flex: 1,
        alignItems: 'center',
    },
    statIconContainer: {
        width: 48,
        height: 48,
        borderRadius: 24,
        backgroundColor: colors.surface,
        justifyContent: 'center',
        alignItems: 'center',
        marginBottom: 8,
    },
    statValue: {
        fontSize: 28,
        fontWeight: '700',
        color: colors.text,
    },
    statLabel: {
        fontSize: 12,
        color: colors.textSecondary,
        marginTop: 4,
    },
    progressSection: {
        marginTop: 20,
        paddingTop: 16,
        borderTopWidth: 1,
        borderTopColor: colors.border,
    },
    progressText: {
        fontSize: 14,
        color: colors.textSecondary,
        textAlign: 'center',
        marginBottom: 12,
    },
    progressBar: {
        height: 8,
        backgroundColor: colors.surface,
        borderRadius: 4,
        overflow: 'hidden',
    },
    progressFill: {
        height: '100%',
        backgroundColor: colors.primary,
        borderRadius: 4,
    },
    recentCard: {
        backgroundColor: colors.white,
        borderRadius: 16,
        padding: 20,
        marginBottom: 24,
        borderWidth: 1,
        borderColor: colors.border,
    },
    recentTitle: {
        fontSize: 16,
        fontWeight: '600',
        color: colors.text,
        marginBottom: 16,
    },
    recentItem: {
        flexDirection: 'row',
        justifyContent: 'space-between',
        alignItems: 'center',
        paddingVertical: 12,
        borderBottomWidth: 1,
        borderBottomColor: colors.border,
    },
    recentName: {
        fontSize: 14,
        fontWeight: '500',
        color: colors.text,
    },
    recentDate: {
        fontSize: 12,
        color: colors.textSecondary,
    },
});
</file>

<file path="client-app/app/(tabs)/profile/reports.tsx">
import { useState, useEffect } from 'react';
import {
    View,
    Text,
    StyleSheet,
    ScrollView,
    TouchableOpacity,
    Alert,
    ActivityIndicator,
    FlatList,
    RefreshControl,
} from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';
import { useRouter } from 'expo-router';
import { ArrowLeft, FileText, Upload, Trash2, Image as ImageIcon } from 'lucide-react-native';
import * as ImagePicker from 'expo-image-picker';
import * as DocumentPicker from 'expo-document-picker';
import api from '../../../services/api';

const colors = {
    background: '#f8fcf9',
    primary: '#13ec5b',
    text: '#0d1b12',
    textSecondary: '#4c9a66',
    border: '#cfe7d7',
    surface: '#e7f3eb',
    white: '#ffffff',
    error: '#ef4444',
};

interface Report {
    id: string;
    fileName: string;
    fileType: string;
    reportType: string;
    uploadedAt: string;
}

export default function ReportsScreen() {
    const router = useRouter();
    const [loading, setLoading] = useState(true);
    const [reports, setReports] = useState<Report[]>([]);
    const [uploading, setUploading] = useState(false);
    const [refreshing, setRefreshing] = useState(false);

    useEffect(() => {
        fetchReports();
    }, []);

    const fetchReports = async () => {
        try {
            const response = await api.get('/client/reports');
            setReports(response.data.data || []);
        } catch (error) {
            console.error('Failed to fetch reports:', error);
        } finally {
            setLoading(false);
            setRefreshing(false);
        }
    };

    const handleUpload = () => {
        Alert.alert(
            'Upload Report',
            'Choose how to upload your report',
            [
                {
                    text: 'Take Photo',
                    onPress: handleTakePhoto,
                },
                {
                    text: 'Choose from Gallery',
                    onPress: handlePickImage,
                },
                {
                    text: 'Select PDF',
                    onPress: handlePickDocument,
                },
                {
                    text: 'Cancel',
                    style: 'cancel',
                },
            ]
        );
    };

    const handleTakePhoto = async () => {
        const permission = await ImagePicker.requestCameraPermissionsAsync();
        if (!permission.granted) {
            Alert.alert('Permission Required', 'Camera access is needed to take photos');
            return;
        }

        const result = await ImagePicker.launchCameraAsync({
            mediaTypes: 'images',
            quality: 0.8,
        });

        if (!result.canceled && result.assets[0]) {
            uploadFile(result.assets[0].uri, 'photo.jpg', 'image/jpeg');
        }
    };

    const handlePickImage = async () => {
        const result = await ImagePicker.launchImageLibraryAsync({
            mediaTypes: 'images',
            quality: 0.8,
        });

        if (!result.canceled && result.assets[0]) {
            const uri = result.assets[0].uri;
            const fileName = uri.split('/').pop() || 'image.jpg';
            uploadFile(uri, fileName, 'image/jpeg');
        }
    };

    const handlePickDocument = async () => {
        try {
            const result = await DocumentPicker.getDocumentAsync({
                type: 'application/pdf',
            });

            if (!result.canceled && result.assets[0]) {
                const { uri, name, mimeType } = result.assets[0];
                uploadFile(uri, name, mimeType || 'application/pdf');
            }
        } catch (error) {
            Alert.alert('Error', 'Failed to pick document');
        }
    };

    const uploadFile = async (uri: string, fileName: string, fileType: string) => {
        setUploading(true);
        try {
            // Get presigned URL
            const urlResponse = await api.post('/client/reports/upload-url', {
                fileName,
                fileType,
                reportType: 'other',
            });

            const { uploadUrl, key } = urlResponse.data.data;

            // Upload to S3
            const fileResponse = await fetch(uri);
            const blob = await fileResponse.blob();

            await fetch(uploadUrl, {
                method: 'PUT',
                body: blob,
                headers: {
                    'Content-Type': fileType,
                },
            });

            // Save report metadata
            await api.post('/client/reports', {
                key,
                fileName,
                fileType,
                reportType: 'other',
            });

            Alert.alert('Success', 'Report uploaded successfully!');
            fetchReports();
        } catch (error) {
            console.error('Upload error:', error);
            Alert.alert('Error', 'Failed to upload report. Please try again.');
        } finally {
            setUploading(false);
        }
    };

    const handleDelete = (report: Report) => {
        Alert.alert(
            'Delete Report',
            `Are you sure you want to delete "${report.fileName}"?`,
            [
                { text: 'Cancel', style: 'cancel' },
                {
                    text: 'Delete',
                    style: 'destructive',
                    onPress: async () => {
                        try {
                            await api.delete(`/client/reports/${report.id}`);
                            setReports(reports.filter(r => r.id !== report.id));
                        } catch (error) {
                            Alert.alert('Error', 'Failed to delete report');
                        }
                    },
                },
            ]
        );
    };

    const renderReport = ({ item }: { item: Report }) => (
        <View style={styles.reportCard}>
            <View style={styles.reportIcon}>
                {item.fileType === 'pdf' ? (
                    <FileText size={24} color={colors.primary} />
                ) : (
                    <ImageIcon size={24} color={colors.primary} />
                )}
            </View>
            <View style={styles.reportInfo}>
                <Text style={styles.reportName} numberOfLines={1}>{item.fileName}</Text>
                <Text style={styles.reportMeta}>
                    {item.reportType} • {new Date(item.uploadedAt).toLocaleDateString()}
                </Text>
            </View>
            <TouchableOpacity
                style={styles.deleteButton}
                onPress={() => handleDelete(item)}
            >
                <Trash2 size={20} color={colors.error} />
            </TouchableOpacity>
        </View>
    );

    return (
        <SafeAreaView style={styles.container} edges={['top']}>
            {/* Header */}
            <View style={styles.header}>
                <TouchableOpacity onPress={() => router.back()} style={styles.backButton}>
                    <ArrowLeft size={24} color={colors.text} />
                </TouchableOpacity>
                <Text style={styles.headerTitle}>My Reports</Text>
            </View>

            {loading ? (
                <View style={styles.loadingContainer}>
                    <ActivityIndicator size="large" color={colors.primary} />
                </View>
            ) : (
                <FlatList
                    data={reports}
                    renderItem={renderReport}
                    keyExtractor={item => item.id}
                    contentContainerStyle={styles.listContent}
                    refreshControl={
                        <RefreshControl
                            refreshing={refreshing}
                            onRefresh={() => {
                                setRefreshing(true);
                                fetchReports();
                            }}
                            tintColor={colors.primary}
                        />
                    }
                    ListEmptyComponent={
                        <View style={styles.emptyContainer}>
                            <FileText size={48} color={colors.textSecondary} />
                            <Text style={styles.emptyTitle}>No Reports Yet</Text>
                            <Text style={styles.emptySubtitle}>
                                Upload your medical reports, blood tests, and other documents
                            </Text>
                        </View>
                    }
                    ListHeaderComponent={
                        <TouchableOpacity
                            style={[styles.uploadButton, uploading && styles.uploadButtonDisabled]}
                            onPress={handleUpload}
                            disabled={uploading}
                        >
                            {uploading ? (
                                <ActivityIndicator color={colors.text} />
                            ) : (
                                <>
                                    <Upload size={20} color={colors.text} />
                                    <Text style={styles.uploadButtonText}>Upload Report</Text>
                                </>
                            )}
                        </TouchableOpacity>
                    }
                />
            )}
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: colors.background,
    },
    header: {
        flexDirection: 'row',
        alignItems: 'center',
        paddingHorizontal: 16,
        paddingVertical: 16,
    },
    backButton: {
        marginRight: 12,
    },
    headerTitle: {
        fontSize: 22,
        fontWeight: '700',
        color: colors.text,
    },
    loadingContainer: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
    },
    listContent: {
        padding: 16,
        paddingTop: 0,
    },
    uploadButton: {
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'center',
        gap: 8,
        backgroundColor: colors.primary,
        paddingVertical: 16,
        borderRadius: 14,
        marginBottom: 24,
    },
    uploadButtonDisabled: {
        opacity: 0.7,
    },
    uploadButtonText: {
        fontSize: 16,
        fontWeight: '600',
        color: colors.text,
    },
    reportCard: {
        flexDirection: 'row',
        alignItems: 'center',
        backgroundColor: colors.white,
        borderRadius: 12,
        padding: 16,
        marginBottom: 12,
        borderWidth: 1,
        borderColor: colors.border,
    },
    reportIcon: {
        width: 48,
        height: 48,
        borderRadius: 12,
        backgroundColor: colors.surface,
        justifyContent: 'center',
        alignItems: 'center',
        marginRight: 12,
    },
    reportInfo: {
        flex: 1,
    },
    reportName: {
        fontSize: 16,
        fontWeight: '600',
        color: colors.text,
    },
    reportMeta: {
        fontSize: 12,
        color: colors.textSecondary,
        marginTop: 4,
    },
    deleteButton: {
        padding: 8,
    },
    emptyContainer: {
        alignItems: 'center',
        paddingVertical: 48,
    },
    emptyTitle: {
        fontSize: 18,
        fontWeight: '600',
        color: colors.text,
        marginTop: 16,
    },
    emptySubtitle: {
        fontSize: 14,
        color: colors.textSecondary,
        textAlign: 'center',
        marginTop: 8,
        paddingHorizontal: 32,
    },
});
</file>

<file path="client-app/app/(tabs)/progress/_layout.tsx">
import { Slot } from 'expo-router';

export default function ProgressLayout() {
    return <Slot />;
}
</file>

<file path="client-app/app/(tabs)/progress/index.tsx">
import { useState } from 'react';
import {
    View,
    Text,
    StyleSheet,
    ScrollView,
    TouchableOpacity,
    TextInput,
    Modal,
    Alert,
    ActivityIndicator,
} from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';
import { useRouter } from 'expo-router';
import { useClientStats } from '../../../hooks/useMeals';
import { useWeightLogs, useCreateWeightLog } from '../../../hooks/useWeight';
import { ArrowLeft, PencilLine } from 'lucide-react-native';

// Figma Design Colors
const colors = {
    background: '#f8fcf9',
    primary: '#13ec5b',
    text: '#0d1b12',
    textSecondary: '#4c9a66',
    border: '#cfe7d7',
    surface: '#e7f3eb',
    error: '#e72a08',
};

export default function ProgressScreen() {
    const router = useRouter();
    const { data: stats, refetch: refetchStats } = useClientStats();
    const { data: weightLogs, isLoading: loadingWeights, refetch: refetchWeight } = useWeightLogs(10);
    const createWeightMutation = useCreateWeightLog();

    const [showWeightModal, setShowWeightModal] = useState(false);
    const [weightInput, setWeightInput] = useState('');

    // Parse weightKg - Prisma Decimal comes as string from API
    const latestLog = weightLogs?.[0];
    const currentWeight = latestLog
        ? (typeof latestLog.weightKg === 'string' ? parseFloat(latestLog.weightKg) : latestLog.weightKg)
        : stats?.latestWeight;
    const targetWeight = stats?.targetWeight || 65;
    const progressPercent = currentWeight && targetWeight
        ? Math.min(100, Math.max(0, ((80 - currentWeight) / (80 - targetWeight)) * 100))
        : 0;

    const handleLogWeight = async () => {
        const weight = parseFloat(weightInput);
        if (isNaN(weight) || weight < 20 || weight > 300) {
            Alert.alert('Invalid Weight', 'Please enter a valid weight between 20-300 kg');
            return;
        }

        try {
            await createWeightMutation.mutateAsync({
                weightKg: weight,
                logDate: new Date().toISOString().split('T')[0],
            });
            setWeightInput('');
            setShowWeightModal(false);
            Alert.alert('Success', 'Weight logged successfully!');
        } catch (error) {
            Alert.alert('Error', 'Failed to log weight. Please try again.');
        }
    };

    return (
        <SafeAreaView style={styles.container} edges={['top']}>
            {/* Header */}
            <View style={styles.header}>
                <TouchableOpacity onPress={() => router.back()} style={styles.backButton}>
                    <ArrowLeft size={24} color={colors.text} />
                </TouchableOpacity>
                <Text style={styles.headerTitle}>Weight Tracking</Text>
                <View style={styles.headerSpacer} />
            </View>

            <ScrollView style={styles.scrollView} showsVerticalScrollIndicator={false}>
                {/* Current Weight Input */}
                <View style={styles.inputContainer}>
                    <Text style={styles.inputLabel}>Current Weight</Text>
                    <TouchableOpacity
                        style={styles.weightInputBox}
                        onPress={() => setShowWeightModal(true)}
                    >
                        <Text style={styles.weightInputText}>
                            {currentWeight ? `${currentWeight} kg` : 'Tap to enter'}
                        </Text>
                    </TouchableOpacity>
                </View>

                {/* Weight Progress Chart */}
                <View style={styles.chartSection}>
                    <Text style={styles.sectionLabel}>Weight Progress</Text>
                    <Text style={styles.currentWeightLarge}>{currentWeight || '--'} kg</Text>
                    <Text style={styles.chartPeriod}>Last 8 Weeks</Text>

                    {/* Simple chart placeholder - would need react-native-svg for real chart */}
                    <View style={styles.chartPlaceholder}>
                        <View style={styles.chartLine} />
                    </View>

                    <View style={styles.weekLabels}>
                        {['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6', 'Week 7'].map((week, i) => (
                            <Text key={i} style={styles.weekLabel}>{week}</Text>
                        ))}
                    </View>
                </View>

                {/* Goal Progress */}
                <View style={styles.goalSection}>
                    <Text style={styles.goalLabel}>Goal: {targetWeight} kg</Text>
                    <View style={styles.progressBarContainer}>
                        <View style={[styles.progressBar, { width: `${progressPercent}%` }]} />
                    </View>
                    <Text style={styles.toGoText}>
                        {currentWeight && targetWeight
                            ? `${Math.abs(currentWeight - targetWeight).toFixed(1)} kg to go`
                            : 'Set your goal weight'}
                    </Text>
                </View>
            </ScrollView>

            {/* Update Weight Button */}
            <View style={styles.buttonContainer}>
                <TouchableOpacity
                    style={styles.updateButton}
                    onPress={() => setShowWeightModal(true)}
                >
                    <PencilLine size={24} color={colors.text} />
                    <Text style={styles.updateButtonText}>Update Weight</Text>
                </TouchableOpacity>
            </View>

            {/* Weight Input Modal */}
            <Modal
                visible={showWeightModal}
                transparent
                animationType="slide"
                onRequestClose={() => setShowWeightModal(false)}
            >
                <View style={styles.modalOverlay}>
                    <View style={styles.modalContent}>
                        <Text style={styles.modalTitle}>Log Your Weight</Text>
                        <View style={styles.modalInputRow}>
                            <TextInput
                                style={styles.modalInput}
                                value={weightInput}
                                onChangeText={setWeightInput}
                                placeholder="0.0"
                                placeholderTextColor={colors.textSecondary}
                                keyboardType="decimal-pad"
                                autoFocus
                            />
                            <Text style={styles.modalUnit}>kg</Text>
                        </View>
                        <View style={styles.modalButtons}>
                            <TouchableOpacity
                                style={styles.modalCancelButton}
                                onPress={() => setShowWeightModal(false)}
                            >
                                <Text style={styles.modalCancelText}>Cancel</Text>
                            </TouchableOpacity>
                            <TouchableOpacity
                                style={styles.modalSubmitButton}
                                onPress={handleLogWeight}
                                disabled={createWeightMutation.isPending}
                            >
                                {createWeightMutation.isPending ? (
                                    <ActivityIndicator color={colors.text} />
                                ) : (
                                    <Text style={styles.modalSubmitText}>Save</Text>
                                )}
                            </TouchableOpacity>
                        </View>
                    </View>
                </View>
            </Modal>
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: colors.background,
    },
    header: {
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'space-between',
        paddingHorizontal: 16,
        paddingVertical: 8,
    },
    backButton: {
        width: 48,
        height: 48,
        justifyContent: 'center',
    },
    headerTitle: {
        fontSize: 18,
        fontWeight: '700',
        color: colors.text,
        letterSpacing: -0.015 * 18,
    },
    headerSpacer: {
        width: 48,
    },
    scrollView: {
        flex: 1,
    },
    inputContainer: {
        paddingHorizontal: 16,
        paddingVertical: 12,
    },
    inputLabel: {
        fontSize: 16,
        fontWeight: '500',
        color: colors.text,
        marginBottom: 8,
    },
    weightInputBox: {
        backgroundColor: colors.surface,
        borderRadius: 12,
        height: 56,
        justifyContent: 'center',
        paddingHorizontal: 16,
    },
    weightInputText: {
        fontSize: 16,
        color: colors.textSecondary,
    },
    chartSection: {
        paddingHorizontal: 16,
        paddingVertical: 24,
    },
    sectionLabel: {
        fontSize: 16,
        fontWeight: '500',
        color: colors.text,
    },
    currentWeightLarge: {
        fontSize: 32,
        fontWeight: '700',
        color: colors.text,
        marginTop: 8,
    },
    chartPeriod: {
        fontSize: 16,
        color: colors.textSecondary,
        marginBottom: 16,
    },
    chartPlaceholder: {
        height: 180,
        backgroundColor: colors.surface,
        borderRadius: 8,
        justifyContent: 'center',
        alignItems: 'center',
        marginBottom: 8,
    },
    chartLine: {
        width: '80%',
        height: 3,
        backgroundColor: colors.textSecondary,
        borderRadius: 2,
    },
    weekLabels: {
        flexDirection: 'row',
        justifyContent: 'space-around',
    },
    weekLabel: {
        fontSize: 13,
        fontWeight: '700',
        color: colors.textSecondary,
    },
    goalSection: {
        paddingHorizontal: 16,
        paddingVertical: 12,
    },
    goalLabel: {
        fontSize: 16,
        fontWeight: '500',
        color: colors.text,
        marginBottom: 8,
    },
    progressBarContainer: {
        height: 8,
        backgroundColor: colors.border,
        borderRadius: 4,
        overflow: 'hidden',
    },
    progressBar: {
        height: '100%',
        backgroundColor: colors.primary,
        borderRadius: 4,
    },
    toGoText: {
        fontSize: 14,
        color: colors.textSecondary,
        marginTop: 8,
    },
    buttonContainer: {
        padding: 20,
        paddingBottom: 40,
    },
    updateButton: {
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'center',
        gap: 16,
        backgroundColor: colors.primary,
        height: 56,
        borderRadius: 12,
    },
    updateButtonText: {
        fontSize: 16,
        fontWeight: '700',
        color: colors.text,
    },
    modalOverlay: {
        flex: 1,
        backgroundColor: 'rgba(0,0,0,0.5)',
        justifyContent: 'flex-end',
    },
    modalContent: {
        backgroundColor: '#fff',
        borderTopLeftRadius: 24,
        borderTopRightRadius: 24,
        padding: 24,
        paddingBottom: 40,
    },
    modalTitle: {
        fontSize: 20,
        fontWeight: '700',
        color: colors.text,
        marginBottom: 20,
        textAlign: 'center',
    },
    modalInputRow: {
        flexDirection: 'row',
        alignItems: 'center',
        borderWidth: 1,
        borderColor: colors.border,
        borderRadius: 12,
        paddingHorizontal: 16,
        marginBottom: 24,
    },
    modalInput: {
        flex: 1,
        fontSize: 32,
        fontWeight: '700',
        color: colors.text,
        paddingVertical: 16,
    },
    modalUnit: {
        fontSize: 18,
        color: colors.textSecondary,
    },
    modalButtons: {
        flexDirection: 'row',
        gap: 12,
    },
    modalCancelButton: {
        flex: 1,
        height: 48,
        justifyContent: 'center',
        alignItems: 'center',
        borderRadius: 12,
        borderWidth: 1,
        borderColor: colors.border,
    },
    modalCancelText: {
        fontSize: 16,
        fontWeight: '600',
        color: colors.text,
    },
    modalSubmitButton: {
        flex: 1,
        height: 48,
        justifyContent: 'center',
        alignItems: 'center',
        borderRadius: 12,
        backgroundColor: colors.primary,
    },
    modalSubmitText: {
        fontSize: 16,
        fontWeight: '700',
        color: colors.text,
    },
});
</file>

<file path="client-app/app/(tabs)/weight/_layout.tsx">
import { Slot } from 'expo-router';

export default function WeightLayout() {
    return <Slot />;
}
</file>

<file path="client-app/app/(tabs)/weight/index.tsx">
import { useState } from 'react';
import {
    View,
    Text,
    StyleSheet,
    ScrollView,
    TextInput,
    TouchableOpacity,
    Alert,
    ActivityIndicator,
    Dimensions,
} from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';
import { useWeightLogs, useCreateWeightLog } from '../../../hooks/useWeight';
import { useAuth } from '../../../hooks/useAuth';
import { Plus, TrendingDown, TrendingUp, Minus, Target, Award } from 'lucide-react-native';
import { LineChart } from 'react-native-chart-kit';

const screenWidth = Dimensions.get('window').width;

export default function WeightScreen() {
    const { data: weightLogs, isLoading } = useWeightLogs(10);
    const { client } = useAuth();
    const createMutation = useCreateWeightLog();
    const [weight, setWeight] = useState('');
    const [notes, setNotes] = useState('');
    const [showForm, setShowForm] = useState(false);

    const handleLogWeight = async () => {
        const weightNum = parseFloat(weight);
        if (isNaN(weightNum) || weightNum < 20 || weightNum > 300) {
            Alert.alert('Invalid Weight', 'Please enter a valid weight between 20-300 kg');
            return;
        }

        try {
            await createMutation.mutateAsync({
                weightKg: weightNum,
                logDate: new Date().toISOString().split('T')[0],
                notes: notes || undefined,
            });
            setWeight('');
            setNotes('');
            setShowForm(false);
            Alert.alert('Success', 'Weight logged successfully!');
        } catch (error) {
            Alert.alert('Error', 'Failed to log weight. Please try again.');
        }
    };

    const latestWeight = weightLogs?.[0]?.weightKg;
    const previousWeight = weightLogs?.[1]?.weightKg;
    const change = latestWeight && previousWeight ? latestWeight - previousWeight : null;
    const targetWeight = client?.targetWeightKg;

    // Calculate progress metrics
    const startWeight = weightLogs?.length ? weightLogs[weightLogs.length - 1]?.weightKg : null;
    const weightLost = startWeight && latestWeight ? startWeight - latestWeight : 0;
    const remainingToGoal = targetWeight && latestWeight ? latestWeight - targetWeight : null;
    const progressPercent = startWeight && targetWeight && latestWeight
        ? Math.min(100, Math.max(0, ((startWeight - latestWeight) / (startWeight - targetWeight)) * 100))
        : 0;

    // Prepare chart data (reverse to show oldest first)
    const chartData = weightLogs?.slice(0, 7).reverse() || [];
    const hasChartData = chartData.length >= 2;

    return (
        <SafeAreaView style={styles.container} edges={['top']}>
            <ScrollView style={styles.scrollView} showsVerticalScrollIndicator={false}>
                <Text style={styles.title}>Weight Tracking</Text>
                <Text style={styles.subtitle}>Monitor your progress over time</Text>

                {/* Current Weight Card */}
                <View style={styles.currentCard}>
                    <Text style={styles.currentLabel}>Current Weight</Text>
                    <View style={styles.currentValueRow}>
                        <Text style={styles.currentValue}>{latestWeight || '--'}</Text>
                        <Text style={styles.currentUnit}>kg</Text>
                        {change !== null && (
                            <View style={[styles.changeBadge, change < 0 ? styles.changeDown : change > 0 ? styles.changeUp : styles.changeNeutral]}>
                                {change < 0 ? <TrendingDown size={14} color="#065f46" /> : change > 0 ? <TrendingUp size={14} color="#991b1b" /> : <Minus size={14} color="#6b7280" />}
                                <Text style={[styles.changeText, change < 0 ? styles.changeTextDown : change > 0 ? styles.changeTextUp : styles.changeTextNeutral]}>
                                    {change > 0 ? '+' : ''}{change.toFixed(1)} kg
                                </Text>
                            </View>
                        )}
                    </View>
                </View>

                {/* Goal Progress Card */}
                {targetWeight && (
                    <View style={styles.goalCard}>
                        <View style={styles.goalHeader}>
                            <Target size={20} color="#17cf54" />
                            <Text style={styles.goalTitle}>Goal Progress</Text>
                        </View>

                        <View style={styles.goalStats}>
                            <View style={styles.goalStat}>
                                <Text style={styles.goalStatValue}>{targetWeight}</Text>
                                <Text style={styles.goalStatLabel}>Target (kg)</Text>
                            </View>
                            <View style={styles.goalStatDivider} />
                            <View style={styles.goalStat}>
                                <Text style={[styles.goalStatValue, weightLost > 0 && styles.goalStatPositive]}>
                                    {weightLost > 0 ? '-' : ''}{Math.abs(weightLost).toFixed(1)}
                                </Text>
                                <Text style={styles.goalStatLabel}>Lost (kg)</Text>
                            </View>
                            <View style={styles.goalStatDivider} />
                            <View style={styles.goalStat}>
                                <Text style={styles.goalStatValue}>
                                    {remainingToGoal !== null ? remainingToGoal.toFixed(1) : '--'}
                                </Text>
                                <Text style={styles.goalStatLabel}>To Go (kg)</Text>
                            </View>
                        </View>

                        {/* Progress Bar */}
                        <View style={styles.progressBarContainer}>
                            <View style={styles.progressBarBackground}>
                                <View style={[styles.progressBarFill, { width: `${Math.min(100, progressPercent)}%` }]} />
                            </View>
                            <Text style={styles.progressText}>{progressPercent.toFixed(0)}% to goal</Text>
                        </View>
                    </View>
                )}

                {/* Weight Trend Chart */}
                {hasChartData && (
                    <View style={styles.chartCard}>
                        <Text style={styles.chartTitle}>7-Day Trend</Text>
                        <LineChart
                            data={{
                                labels: chartData.map(log => {
                                    const date = new Date(log.logDate);
                                    return `${date.getDate()}/${date.getMonth() + 1}`;
                                }),
                                datasets: [
                                    {
                                        data: chartData.map(log => log.weightKg),
                                        color: (opacity = 1) => `rgba(23, 207, 84, ${opacity})`,
                                        strokeWidth: 2,
                                    },
                                    ...(targetWeight ? [{
                                        data: chartData.map(() => targetWeight),
                                        color: (opacity = 1) => `rgba(239, 68, 68, ${opacity * 0.5})`,
                                        strokeWidth: 1,
                                        withDots: false,
                                    }] : []),
                                ],
                            }}
                            width={screenWidth - 56}
                            height={180}
                            chartConfig={{
                                backgroundColor: '#ffffff',
                                backgroundGradientFrom: '#ffffff',
                                backgroundGradientTo: '#ffffff',
                                decimalPlaces: 1,
                                color: (opacity = 1) => `rgba(17, 24, 39, ${opacity})`,
                                labelColor: (opacity = 1) => `rgba(107, 114, 128, ${opacity})`,
                                style: { borderRadius: 16 },
                                propsForDots: {
                                    r: '5',
                                    strokeWidth: '2',
                                    stroke: '#17cf54',
                                },
                                propsForBackgroundLines: {
                                    strokeDasharray: '',
                                    stroke: '#e5e7eb',
                                },
                            }}
                            bezier
                            style={styles.chart}
                        />
                        {targetWeight && (
                            <View style={styles.chartLegend}>
                                <View style={styles.legendItem}>
                                    <View style={[styles.legendDot, { backgroundColor: '#17cf54' }]} />
                                    <Text style={styles.legendText}>Your Weight</Text>
                                </View>
                                <View style={styles.legendItem}>
                                    <View style={[styles.legendDot, { backgroundColor: '#ef4444' }]} />
                                    <Text style={styles.legendText}>Target</Text>
                                </View>
                            </View>
                        )}
                    </View>
                )}

                {/* Add Weight Button/Form */}
                {!showForm ? (
                    <TouchableOpacity style={styles.addButton} onPress={() => setShowForm(true)}>
                        <Plus size={20} color="#fff" />
                        <Text style={styles.addButtonText}>Log Today's Weight</Text>
                    </TouchableOpacity>
                ) : (
                    <View style={styles.formCard}>
                        <Text style={styles.formTitle}>Log Weight</Text>
                        <View style={styles.inputRow}>
                            <TextInput
                                style={styles.weightInput}
                                value={weight}
                                onChangeText={setWeight}
                                placeholder="0.0"
                                placeholderTextColor="#9ca3af"
                                keyboardType="decimal-pad"
                                autoFocus
                            />
                            <Text style={styles.inputUnit}>kg</Text>
                        </View>
                        <TextInput
                            style={styles.notesInput}
                            value={notes}
                            onChangeText={setNotes}
                            placeholder="Add notes (optional)"
                            placeholderTextColor="#9ca3af"
                            multiline
                        />
                        <View style={styles.formButtons}>
                            <TouchableOpacity style={styles.cancelButton} onPress={() => setShowForm(false)}>
                                <Text style={styles.cancelButtonText}>Cancel</Text>
                            </TouchableOpacity>
                            <TouchableOpacity
                                style={[styles.saveButton, createMutation.isPending && styles.saveButtonDisabled]}
                                onPress={handleLogWeight}
                                disabled={createMutation.isPending}
                            >
                                {createMutation.isPending ? (
                                    <ActivityIndicator color="#fff" size="small" />
                                ) : (
                                    <Text style={styles.saveButtonText}>Save</Text>
                                )}
                            </TouchableOpacity>
                        </View>
                    </View>
                )}

                {/* Weight History */}
                <Text style={styles.sectionTitle}>History</Text>
                {isLoading ? (
                    <ActivityIndicator style={styles.loader} color="#17cf54" />
                ) : weightLogs && weightLogs.length > 0 ? (
                    <View style={styles.historyList}>
                        {weightLogs.map((log, index) => {
                            const prevLog = weightLogs[index + 1];
                            const delta = prevLog ? log.weightKg - prevLog.weightKg : null;
                            return (
                                <View key={log.id} style={styles.historyItem}>
                                    <View>
                                        <Text style={styles.historyDate}>
                                            {new Date(log.logDate).toLocaleDateString('en-US', {
                                                weekday: 'short',
                                                month: 'short',
                                                day: 'numeric',
                                            })}
                                        </Text>
                                        {log.notes && <Text style={styles.historyNotes}>{log.notes}</Text>}
                                    </View>
                                    <View style={styles.historyRight}>
                                        <Text style={styles.historyWeight}>{log.weightKg} kg</Text>
                                        {delta !== null && (
                                            <Text style={[styles.historyDelta, delta < 0 ? styles.deltaDown : delta > 0 ? styles.deltaUp : styles.deltaNeutral]}>
                                                {delta > 0 ? '+' : ''}{delta.toFixed(1)}
                                            </Text>
                                        )}
                                    </View>
                                </View>
                            );
                        })}
                    </View>
                ) : (
                    <View style={styles.emptyContainer}>
                        <Text style={styles.emptyText}>No weight logs yet</Text>
                        <Text style={styles.emptySubtext}>Start tracking your weight to see progress</Text>
                    </View>
                )}
            </ScrollView>
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: '#f9fafb',
    },
    scrollView: {
        flex: 1,
        padding: 20,
    },
    title: {
        fontSize: 28,
        fontWeight: '700',
        color: '#111827',
        marginBottom: 4,
    },
    subtitle: {
        fontSize: 16,
        color: '#6b7280',
        marginBottom: 24,
    },
    currentCard: {
        backgroundColor: '#17cf54',
        borderRadius: 20,
        padding: 24,
        alignItems: 'center',
        marginBottom: 16,
    },
    currentLabel: {
        fontSize: 14,
        color: 'rgba(255,255,255,0.8)',
        marginBottom: 8,
    },
    currentValueRow: {
        flexDirection: 'row',
        alignItems: 'baseline',
    },
    currentValue: {
        fontSize: 56,
        fontWeight: '700',
        color: '#fff',
    },
    currentUnit: {
        fontSize: 24,
        fontWeight: '500',
        color: 'rgba(255,255,255,0.8)',
        marginLeft: 4,
    },
    changeBadge: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 4,
        paddingHorizontal: 10,
        paddingVertical: 4,
        borderRadius: 12,
        marginLeft: 12,
    },
    changeDown: { backgroundColor: '#d1fae5' },
    changeUp: { backgroundColor: '#fee2e2' },
    changeNeutral: { backgroundColor: '#f3f4f6' },
    changeText: { fontSize: 13, fontWeight: '600' },
    changeTextDown: { color: '#065f46' },
    changeTextUp: { color: '#991b1b' },
    changeTextNeutral: { color: '#6b7280' },
    // Goal Card Styles
    goalCard: {
        backgroundColor: '#fff',
        borderRadius: 16,
        padding: 20,
        marginBottom: 16,
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: 0.05,
        shadowRadius: 8,
        elevation: 2,
    },
    goalHeader: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 8,
        marginBottom: 16,
    },
    goalTitle: {
        fontSize: 18,
        fontWeight: '700',
        color: '#111827',
    },
    goalStats: {
        flexDirection: 'row',
        justifyContent: 'space-between',
        marginBottom: 16,
    },
    goalStat: {
        flex: 1,
        alignItems: 'center',
    },
    goalStatDivider: {
        width: 1,
        backgroundColor: '#e5e7eb',
    },
    goalStatValue: {
        fontSize: 24,
        fontWeight: '700',
        color: '#111827',
    },
    goalStatPositive: {
        color: '#17cf54',
    },
    goalStatLabel: {
        fontSize: 12,
        color: '#6b7280',
        marginTop: 4,
    },
    progressBarContainer: {
        marginTop: 8,
    },
    progressBarBackground: {
        height: 8,
        backgroundColor: '#e5e7eb',
        borderRadius: 4,
        overflow: 'hidden',
    },
    progressBarFill: {
        height: '100%',
        backgroundColor: '#17cf54',
        borderRadius: 4,
    },
    progressText: {
        fontSize: 12,
        color: '#6b7280',
        textAlign: 'center',
        marginTop: 8,
    },
    // Chart Styles
    chartCard: {
        backgroundColor: '#fff',
        borderRadius: 16,
        padding: 16,
        marginBottom: 16,
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: 0.05,
        shadowRadius: 8,
        elevation: 2,
    },
    chartTitle: {
        fontSize: 16,
        fontWeight: '600',
        color: '#111827',
        marginBottom: 12,
    },
    chart: {
        marginVertical: 8,
        borderRadius: 16,
    },
    chartLegend: {
        flexDirection: 'row',
        justifyContent: 'center',
        gap: 24,
        marginTop: 8,
    },
    legendItem: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 6,
    },
    legendDot: {
        width: 10,
        height: 10,
        borderRadius: 5,
    },
    legendText: {
        fontSize: 12,
        color: '#6b7280',
    },
    addButton: {
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'center',
        gap: 8,
        backgroundColor: '#111827',
        paddingVertical: 16,
        borderRadius: 14,
        marginBottom: 24,
    },
    addButtonText: {
        color: '#fff',
        fontSize: 16,
        fontWeight: '600',
    },
    formCard: {
        backgroundColor: '#fff',
        borderRadius: 16,
        padding: 20,
        marginBottom: 24,
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: 0.05,
        shadowRadius: 8,
        elevation: 2,
    },
    formTitle: {
        fontSize: 18,
        fontWeight: '700',
        color: '#111827',
        marginBottom: 16,
    },
    inputRow: {
        flexDirection: 'row',
        alignItems: 'center',
        borderWidth: 1,
        borderColor: '#e5e7eb',
        borderRadius: 12,
        paddingHorizontal: 16,
        marginBottom: 12,
    },
    weightInput: {
        flex: 1,
        fontSize: 32,
        fontWeight: '700',
        color: '#111827',
        paddingVertical: 12,
    },
    inputUnit: {
        fontSize: 18,
        color: '#6b7280',
    },
    notesInput: {
        borderWidth: 1,
        borderColor: '#e5e7eb',
        borderRadius: 12,
        padding: 12,
        fontSize: 14,
        color: '#111827',
        minHeight: 60,
        textAlignVertical: 'top',
        marginBottom: 16,
    },
    formButtons: {
        flexDirection: 'row',
        gap: 12,
    },
    cancelButton: {
        flex: 1,
        paddingVertical: 14,
        borderRadius: 12,
        borderWidth: 1,
        borderColor: '#e5e7eb',
        alignItems: 'center',
    },
    cancelButtonText: {
        color: '#374151',
        fontWeight: '600',
    },
    saveButton: {
        flex: 1,
        paddingVertical: 14,
        borderRadius: 12,
        backgroundColor: '#17cf54',
        alignItems: 'center',
    },
    saveButtonDisabled: {
        opacity: 0.6,
    },
    saveButtonText: {
        color: '#fff',
        fontWeight: '700',
    },
    sectionTitle: {
        fontSize: 18,
        fontWeight: '700',
        color: '#111827',
        marginBottom: 16,
    },
    loader: {
        marginTop: 20,
    },
    historyList: {
        gap: 12,
        paddingBottom: 24,
    },
    historyItem: {
        flexDirection: 'row',
        justifyContent: 'space-between',
        alignItems: 'center',
        backgroundColor: '#fff',
        padding: 16,
        borderRadius: 12,
    },
    historyDate: {
        fontSize: 14,
        fontWeight: '600',
        color: '#374151',
    },
    historyNotes: {
        fontSize: 12,
        color: '#9ca3af',
        marginTop: 2,
    },
    historyRight: {
        alignItems: 'flex-end',
    },
    historyWeight: {
        fontSize: 16,
        fontWeight: '700',
        color: '#111827',
    },
    historyDelta: {
        fontSize: 12,
        fontWeight: '600',
        marginTop: 2,
    },
    deltaDown: { color: '#17cf54' },
    deltaUp: { color: '#ef4444' },
    deltaNeutral: { color: '#6b7280' },
    emptyContainer: {
        alignItems: 'center',
        paddingVertical: 40,
    },
    emptyText: {
        fontSize: 16,
        fontWeight: '600',
        color: '#374151',
        marginBottom: 4,
    },
    emptySubtext: {
        fontSize: 14,
        color: '#9ca3af',
    },
});
</file>

<file path="client-app/app/(tabs)/_layout.tsx">
import { View, StyleSheet } from 'react-native';
import { Slot } from 'expo-router';
import { BottomTabBar } from '../../components/BottomTabBar';

export default function TabsLayout() {
    return (
        <View style={styles.container}>
            <View style={styles.content}>
                <Slot />
            </View>
            <BottomTabBar />
        </View>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
    },
    content: {
        flex: 1,
    },
});
</file>

<file path="client-app/app/_layout.tsx">
import { Slot } from 'expo-router';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';

const queryClient = new QueryClient({
    defaultOptions: {
        queries: {
            staleTime: 30 * 1000,
            retry: 2,
        },
    },
});

export default function RootLayout() {
    return (
        <QueryClientProvider client={queryClient}>
            <Slot />
        </QueryClientProvider>
    );
}
</file>

<file path="client-app/app/index.tsx">
import { Redirect } from 'expo-router';
import { useAuth } from '../hooks/useAuth';
import { View, ActivityIndicator, StyleSheet } from 'react-native';

export default function Index() {
    const { isAuthenticated, isLoading } = useAuth();

    if (isLoading) {
        return (
            <View style={styles.loader}>
                <ActivityIndicator size="large" color="#17cf54" />
            </View>
        );
    }

    if (isAuthenticated) {
        return <Redirect href="/(tabs)/home" />;
    }

    return <Redirect href="/(auth)/login" />;
}

const styles = StyleSheet.create({
    loader: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
        backgroundColor: '#fff',
    },
});
</file>

<file path="client-app/components/BottomTabBar.tsx">
import { View, TouchableOpacity, Text, StyleSheet } from 'react-native';
import { useRouter, usePathname } from 'expo-router';
import { Home, TrendingUp, Bell, User } from 'lucide-react-native';

// Figma Design Colors
const colors = {
    background: '#f8fcf9',
    primary: '#13ec5b',
    text: '#0d1b12',
    textSecondary: '#4c9a66',
    border: '#cfe7d7',
};

interface TabItemProps {
    title: string;
    icon: React.ComponentType<{ size: number; color: string }>;
    isActive: boolean;
    onPress: () => void;
}

function TabItem({ title, icon: Icon, isActive, onPress }: TabItemProps) {
    const color = isActive ? colors.text : colors.textSecondary;

    return (
        <TouchableOpacity style={styles.tabItem} onPress={onPress} activeOpacity={0.7}>
            <Icon size={24} color={color} />
            <Text style={[styles.tabLabel, { color }]}>{title}</Text>
            {isActive && <View style={styles.activeIndicator} />}
        </TouchableOpacity>
    );
}

const tabs = [
    { name: 'home', title: 'Home', icon: Home, path: '/(tabs)/home' },
    { name: 'progress', title: 'Progress', icon: TrendingUp, path: '/(tabs)/progress' },
    { name: 'notifications', title: 'Inbox', icon: Bell, path: '/(tabs)/notifications' },
    { name: 'profile', title: 'Profile', icon: User, path: '/(tabs)/profile' },
];

export function BottomTabBar() {
    const router = useRouter();
    const pathname = usePathname();

    const getActiveTab = () => {
        for (const tab of tabs) {
            if (pathname.includes(tab.name)) {
                return tab.name;
            }
        }
        return 'home';
    };

    const activeTab = getActiveTab();

    return (
        <View style={styles.container}>
            {tabs.map((tab) => (
                <TabItem
                    key={tab.name}
                    title={tab.title}
                    icon={tab.icon}
                    isActive={activeTab === tab.name}
                    onPress={() => router.push(tab.path as any)}
                />
            ))}
        </View>
    );
}

const styles = StyleSheet.create({
    container: {
        flexDirection: 'row',
        backgroundColor: colors.background,
        borderTopWidth: 1,
        borderTopColor: colors.border,
        paddingTop: 8,
        paddingBottom: 28,
        paddingHorizontal: 8,
    },
    tabItem: {
        flex: 1,
        alignItems: 'center',
        justifyContent: 'center',
        paddingVertical: 8,
        position: 'relative',
    },
    tabLabel: {
        fontSize: 12,
        fontWeight: '500',
        marginTop: 4,
    },
    activeIndicator: {
        position: 'absolute',
        bottom: -4,
        width: 20,
        height: 3,
        backgroundColor: colors.primary,
        borderRadius: 2,
    },
});
</file>

<file path="client-app/components/MealCard.tsx">
import { View, Text, TouchableOpacity, StyleSheet, Image } from 'react-native';
import { useRouter } from 'expo-router';
import { MealLog } from '../types';
import { Clock, Check, X, MessageCircle, Camera } from 'lucide-react-native';

interface MealCardProps {
    mealLog: MealLog;
}

const mealTypeEmoji: Record<string, string> = {
    breakfast: '🌅',
    lunch: '☀️',
    snack: '🍎',
    dinner: '🌙',
};

const statusConfig = {
    pending: { bg: '#fef3c7', text: '#92400e', label: 'Pending' },
    eaten: { bg: '#d1fae5', text: '#065f46', label: 'Logged' },
    skipped: { bg: '#fee2e2', text: '#991b1b', label: 'Skipped' },
    substituted: { bg: '#dbeafe', text: '#1e40af', label: 'Substituted' },
};

export function MealCard({ mealLog }: MealCardProps) {
    const router = useRouter();
    const { meal, status, dietitianFeedback, scheduledTime } = mealLog;
    const config = statusConfig[status];

    const handlePress = () => {
        // Navigate to meal detail/logging screen
        router.push({
            pathname: '/(tabs)/home/meal/[id]',
            params: { id: mealLog.id },
        });
    };

    return (
        <TouchableOpacity style={styles.container} onPress={handlePress} activeOpacity={0.7}>
            <View style={styles.header}>
                <View style={styles.mealTypeRow}>
                    <Text style={styles.emoji}>{mealTypeEmoji[meal.mealType] || '🍽️'}</Text>
                    <View>
                        <Text style={styles.mealType}>{meal.mealType.charAt(0).toUpperCase() + meal.mealType.slice(1)}</Text>
                        <Text style={styles.time}>{scheduledTime || meal.timeOfDay || '--:--'}</Text>
                    </View>
                </View>
                <View style={[styles.statusBadge, { backgroundColor: config.bg }]}>
                    <Text style={[styles.statusText, { color: config.text }]}>{config.label}</Text>
                </View>
            </View>

            <Text style={styles.mealName}>{meal.name}</Text>

            {meal.description && (
                <Text style={styles.description} numberOfLines={2}>{meal.description}</Text>
            )}

            {/* Macros */}
            <View style={styles.macrosRow}>
                <View style={styles.macroItem}>
                    <Text style={styles.macroValue}>{meal.totalCalories || 0}</Text>
                    <Text style={styles.macroLabel}>kcal</Text>
                </View>
                <View style={styles.macroDot} />
                <View style={styles.macroItem}>
                    <Text style={styles.macroValue}>{meal.totalProteinG || 0}g</Text>
                    <Text style={styles.macroLabel}>protein</Text>
                </View>
                <View style={styles.macroDot} />
                <View style={styles.macroItem}>
                    <Text style={styles.macroValue}>{meal.totalCarbsG || 0}g</Text>
                    <Text style={styles.macroLabel}>carbs</Text>
                </View>
                <View style={styles.macroDot} />
                <View style={styles.macroItem}>
                    <Text style={styles.macroValue}>{meal.totalFatsG || 0}g</Text>
                    <Text style={styles.macroLabel}>fats</Text>
                </View>
            </View>

            {/* Photo preview if logged */}
            {mealLog.mealPhotoUrl && (
                <Image source={{ uri: mealLog.mealPhotoUrl }} style={styles.photoPreview} />
            )}

            {/* Dietitian Feedback */}
            {dietitianFeedback && (
                <View style={styles.feedbackContainer}>
                    <MessageCircle size={14} color="#6366f1" />
                    <Text style={styles.feedbackText} numberOfLines={2}>{dietitianFeedback}</Text>
                </View>
            )}

            {/* Action Button for pending */}
            {status === 'pending' && (
                <TouchableOpacity style={styles.logButton} onPress={handlePress}>
                    <Camera size={18} color="#fff" />
                    <Text style={styles.logButtonText}>Log This Meal</Text>
                </TouchableOpacity>
            )}
        </TouchableOpacity>
    );
}

const styles = StyleSheet.create({
    container: {
        backgroundColor: '#fff',
        borderRadius: 16,
        padding: 16,
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: 0.05,
        shadowRadius: 8,
        elevation: 2,
    },
    header: {
        flexDirection: 'row',
        justifyContent: 'space-between',
        alignItems: 'flex-start',
        marginBottom: 12,
    },
    mealTypeRow: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 10,
    },
    emoji: {
        fontSize: 28,
    },
    mealType: {
        fontSize: 14,
        fontWeight: '600',
        color: '#374151',
    },
    time: {
        fontSize: 12,
        color: '#9ca3af',
    },
    statusBadge: {
        paddingHorizontal: 10,
        paddingVertical: 4,
        borderRadius: 12,
    },
    statusText: {
        fontSize: 12,
        fontWeight: '600',
    },
    mealName: {
        fontSize: 18,
        fontWeight: '700',
        color: '#111827',
        marginBottom: 4,
    },
    description: {
        fontSize: 14,
        color: '#6b7280',
        marginBottom: 12,
        lineHeight: 20,
    },
    macrosRow: {
        flexDirection: 'row',
        alignItems: 'center',
        gap: 8,
        marginBottom: 12,
    },
    macroItem: {
        flexDirection: 'row',
        alignItems: 'baseline',
        gap: 2,
    },
    macroValue: {
        fontSize: 14,
        fontWeight: '600',
        color: '#374151',
    },
    macroLabel: {
        fontSize: 11,
        color: '#9ca3af',
    },
    macroDot: {
        width: 3,
        height: 3,
        borderRadius: 1.5,
        backgroundColor: '#d1d5db',
    },
    photoPreview: {
        width: '100%',
        height: 120,
        borderRadius: 12,
        marginBottom: 12,
    },
    feedbackContainer: {
        flexDirection: 'row',
        alignItems: 'flex-start',
        gap: 8,
        backgroundColor: '#eef2ff',
        padding: 12,
        borderRadius: 12,
        marginTop: 8,
    },
    feedbackText: {
        flex: 1,
        fontSize: 13,
        color: '#4f46e5',
        lineHeight: 18,
    },
    logButton: {
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'center',
        gap: 8,
        backgroundColor: '#17cf54',
        paddingVertical: 12,
        borderRadius: 12,
        marginTop: 12,
    },
    logButtonText: {
        color: '#fff',
        fontSize: 14,
        fontWeight: '700',
    },
});
</file>

<file path="client-app/constants/theme.ts">
// DietConnect Design Theme Constants
// Based on Figma design reference

export const Colors = {
    // Primary colors
    primary: '#13ec5b',      // Bright green - main accent
    primaryDark: '#17cf54',  // Slightly darker green

    // Background colors
    background: '#f8fcf9',   // Light mint background
    surface: '#ffffff',      // White cards/surfaces
    surfaceSecondary: '#e7f3eb', // Light green surface

    // Text colors
    text: '#0d1b12',         // Dark green-black text
    textSecondary: '#4c9a66', // Muted green text
    textMuted: '#6b7280',    // Gray text

    // Border colors
    border: '#cfe7d7',       // Light green border
    borderLight: '#e7f3eb',  // Very light border

    // Status colors
    success: '#17cf54',
    warning: '#f59e0b',
    error: '#ef4444',
    info: '#6366f1',

    // Tab bar
    tabActive: '#0d1b12',
    tabInactive: '#4c9a66',
    tabBackground: '#f8fcf9',
};

export const Spacing = {
    xs: 4,
    sm: 8,
    md: 12,
    lg: 16,
    xl: 20,
    xxl: 24,
    xxxl: 32,
};

export const BorderRadius = {
    sm: 8,
    md: 12,
    lg: 16,
    xl: 20,
    full: 9999,
};

export const FontSizes = {
    xs: 12,
    sm: 13,
    md: 14,
    lg: 16,
    xl: 18,
    xxl: 22,
    xxxl: 28,
    display: 32,
};

export const FontWeights = {
    regular: '400' as const,
    medium: '500' as const,
    semibold: '600' as const,
    bold: '700' as const,
    extrabold: '800' as const,
};

// Shadow presets
export const Shadows = {
    sm: {
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 1 },
        shadowOpacity: 0.05,
        shadowRadius: 4,
        elevation: 1,
    },
    md: {
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: 0.05,
        shadowRadius: 8,
        elevation: 2,
    },
    lg: {
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 4 },
        shadowOpacity: 0.1,
        shadowRadius: 12,
        elevation: 4,
    },
};
</file>

<file path="client-app/hooks/useAuth.ts">
import { useState, useEffect, useCallback } from 'react';
import { authStore } from '../store/authStore';
import { clientAuthApi } from '../services/api';
import { Client } from '../types';

interface UseAuthReturn {
    isAuthenticated: boolean;
    isLoading: boolean;
    client: Client | null;
    login: (phone: string, otp: string) => Promise<void>;
    logout: () => Promise<void>;
    requestOTP: (phone: string) => Promise<void>;
}

export function useAuth(): UseAuthReturn {
    const [isAuthenticated, setIsAuthenticated] = useState(false);
    const [isLoading, setIsLoading] = useState(true);
    const [client, setClient] = useState<Client | null>(null);

    useEffect(() => {
        checkAuth();
    }, []);

    const checkAuth = async () => {
        try {
            const token = await authStore.getToken();
            const isExpired = await authStore.checkSessionExpiry();

            if (token && !isExpired) {
                const clientData = await authStore.getClientData();
                setClient(clientData as Client | null);
                setIsAuthenticated(true);
                await authStore.updateLastActivity();
            } else if (token && isExpired) {
                await authStore.removeToken();
                setIsAuthenticated(false);
            }
        } catch (error) {
            console.error('Auth check failed:', error);
        } finally {
            setIsLoading(false);
        }
    };

    const requestOTP = useCallback(async (phone: string) => {
        await clientAuthApi.requestOTP(phone);
    }, []);

    const login = useCallback(async (phone: string, otp: string) => {
        const response = await clientAuthApi.verifyOTP(phone, otp);
        const { token, client: clientData } = response.data.data;

        await authStore.setToken(token);
        await authStore.setClientData(clientData as Record<string, unknown>);

        setClient(clientData as Client);
        setIsAuthenticated(true);
    }, []);

    const logout = useCallback(async () => {
        await authStore.removeToken();
        setClient(null);
        setIsAuthenticated(false);
    }, []);

    return {
        isAuthenticated,
        isLoading,
        client,
        login,
        logout,
        requestOTP,
    };
}
</file>

<file path="client-app/hooks/useMealLog.ts">
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { mealLogsApi } from '../services/api';
import { MealLog } from '../types';

export function useMealLog(mealLogId: string) {
    // Don't fetch for pending meals - they don't exist in DB yet
    const isPending = mealLogId?.startsWith('pending-');

    return useQuery({
        queryKey: ['meal-log', mealLogId],
        queryFn: async () => {
            const { data } = await mealLogsApi.getMealLog(mealLogId);
            return data.data as MealLog;
        },
        enabled: !!mealLogId && !isPending, // Skip fetch for pending meals
        staleTime: 30 * 1000, // 30 seconds
    });
}

interface LogMealInput {
    mealLogId: string;
    status: 'eaten' | 'skipped' | 'substituted';
    notes?: string;
    photoUri?: string;
}

export function useLogMeal() {
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async ({ mealLogId, status, notes }: LogMealInput) => {
            const { data } = await mealLogsApi.logMeal(mealLogId, {
                status,
                notes,
            });
            return data.data;
        },
        onSuccess: async (_, { mealLogId }) => {
            // Force immediate refetch of today's meals
            await queryClient.invalidateQueries({ queryKey: ['meals', 'today'] });
            await queryClient.refetchQueries({ queryKey: ['meals', 'today'] });

            // Also invalidate other related queries
            queryClient.invalidateQueries({ queryKey: ['meal-log', mealLogId] });
            queryClient.invalidateQueries({ queryKey: ['client', 'stats'] });
        },
    });
}
</file>

<file path="client-app/hooks/useMeals.ts">
import { useQuery } from '@tanstack/react-query';
import { mealLogsApi, clientStatsApi } from '../services/api';
import { MealLog, ClientStats } from '../types';

export function useTodayMeals() {
    return useQuery({
        queryKey: ['meals', 'today'],
        queryFn: async () => {
            const { data } = await mealLogsApi.getTodayMeals();
            return data.data as MealLog[];
        },
        staleTime: 15 * 1000, // 15 seconds - reduced for faster updates
        refetchOnWindowFocus: true,
    });
}

export function useClientStats() {
    return useQuery({
        queryKey: ['client', 'stats'],
        queryFn: async () => {
            const { data } = await clientStatsApi.getStats();
            return data.data as ClientStats;
        },
        staleTime: 30 * 1000, // 30 seconds - reduced for faster updates
        refetchOnWindowFocus: true,
    });
}
</file>

<file path="client-app/hooks/useWeight.ts">
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { weightLogsApi } from '../services/api';
import { WeightLog } from '../types';

export function useWeightLogs(limit?: number) {
    return useQuery({
        queryKey: ['weight-logs', limit],
        queryFn: async () => {
            const { data } = await weightLogsApi.getWeightLogs({ limit });
            return data.data as WeightLog[];
        },
        staleTime: 0, // Always refetch fresh data
        gcTime: 30 * 1000, // Cache for 30 seconds (was cacheTime in v4)
    });
}

export function useCreateWeightLog() {
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async (input: { weightKg: number; logDate: string; notes?: string }) => {
            const { data } = await weightLogsApi.createWeightLog(input);
            return data.data as WeightLog;
        },
        onSuccess: async (newWeightLog) => {
            // Update the weight-logs cache directly with new data
            queryClient.setQueryData(['weight-logs', 10], (oldData: WeightLog[] | undefined) => {
                if (!oldData) return [newWeightLog];
                // Replace or add the new log
                const existingIndex = oldData.findIndex(
                    log => log.logDate === newWeightLog.logDate
                );
                if (existingIndex >= 0) {
                    const newData = [...oldData];
                    newData[existingIndex] = newWeightLog;
                    return newData;
                }
                return [newWeightLog, ...oldData].slice(0, 10);
            });

            // Also invalidate stats to update currentWeight
            await queryClient.invalidateQueries({ queryKey: ['client', 'stats'] });
        },
    });
}
</file>

<file path="client-app/services/api.ts">
import axios, { AxiosInstance, InternalAxiosRequestConfig } from 'axios';
import { authStore } from '../store/authStore';
import Constants from 'expo-constants';

// Use the local IP for development - change this for production
const API_BASE_URL = Constants.expoConfig?.extra?.apiUrl || 'http://localhost:3000/api/v1';

const api: AxiosInstance = axios.create({
    baseURL: API_BASE_URL,
    timeout: 15000,
    headers: {
        'Content-Type': 'application/json',
    },
});

// Request interceptor to add auth token
api.interceptors.request.use(
    async (config: InternalAxiosRequestConfig) => {
        const token = await authStore.getToken();
        if (token && config.headers) {
            config.headers.Authorization = `Bearer ${token}`;
        }
        return config;
    },
    (error) => Promise.reject(error)
);

// Response interceptor for error handling
api.interceptors.response.use(
    (response) => response,
    async (error) => {
        if (error.response?.status === 401) {
            await authStore.removeToken();
            // Navigation to login will be handled by useAuth hook
        }
        return Promise.reject(error);
    }
);

// Client Auth API - uses /client-auth endpoints
export const clientAuthApi = {
    requestOTP: (phone: string) =>
        api.post<{ success: boolean; message: string }>('/client-auth/request-otp', { phone }),

    verifyOTP: (phone: string, otp: string) =>
        api.post<{ success: boolean; data: { token: string; client: unknown } }>('/client-auth/verify-otp', { phone, otp }),

    getProfile: () =>
        api.get<{ success: boolean; data: unknown }>('/client-auth/me'),

    updateProfile: (data: { fullName?: string; email?: string }) =>
        api.patch<{ success: boolean; data: unknown }>('/client-auth/me', data),
};

// Meal Logs API - client's own meals
export const mealLogsApi = {
    getTodayMeals: () =>
        api.get<{ success: boolean; data: unknown[] }>('/client/meals/today'),

    getMealLog: (mealLogId: string) =>
        api.get<{ success: boolean; data: unknown }>(`/client/meals/${mealLogId}`),

    logMeal: (mealId: string, data: { status: string; photoUrl?: string; notes?: string }) =>
        api.patch<{ success: boolean; data: unknown }>(`/client/meals/${mealId}/log`, data),

    uploadPhoto: (mealId: string, formData: FormData) =>
        api.post<{ success: boolean; data: { url: string } }>(`/client/meals/${mealId}/photo`, formData, {
            headers: { 'Content-Type': 'multipart/form-data' },
        }),
};

// Weight Logs API - uses the client endpoint with clientId from token
export const weightLogsApi = {
    getWeightLogs: (params?: { limit?: number }) =>
        api.get<{ success: boolean; data: unknown[] }>('/client/weight-logs', { params }),

    createWeightLog: (data: { weightKg: number; logDate: string; notes?: string }) =>
        api.post<{ success: boolean; data: unknown }>('/client/weight-logs', data),
};

// Client Stats API
export const clientStatsApi = {
    getStats: () =>
        api.get<{ success: boolean; data: unknown }>('/client/stats'),
};

export default api;
</file>

<file path="client-app/store/authStore.ts">
import * as SecureStore from 'expo-secure-store';

const TOKEN_KEY = 'auth_token';
const CLIENT_KEY = 'client_data';
const LAST_ACTIVITY_KEY = 'last_activity';

export const authStore = {
    async getToken(): Promise<string | null> {
        try {
            return await SecureStore.getItemAsync(TOKEN_KEY);
        } catch {
            return null;
        }
    },

    async setToken(token: string): Promise<void> {
        await SecureStore.setItemAsync(TOKEN_KEY, token);
        await this.updateLastActivity();
    },

    async removeToken(): Promise<void> {
        await SecureStore.deleteItemAsync(TOKEN_KEY);
        await SecureStore.deleteItemAsync(CLIENT_KEY);
        await SecureStore.deleteItemAsync(LAST_ACTIVITY_KEY);
    },

    async getClientData(): Promise<Record<string, unknown> | null> {
        try {
            const data = await SecureStore.getItemAsync(CLIENT_KEY);
            return data ? JSON.parse(data) : null;
        } catch {
            return null;
        }
    },

    async setClientData(client: Record<string, unknown>): Promise<void> {
        await SecureStore.setItemAsync(CLIENT_KEY, JSON.stringify(client));
    },

    async updateLastActivity(): Promise<void> {
        await SecureStore.setItemAsync(LAST_ACTIVITY_KEY, Date.now().toString());
    },

    async checkSessionExpiry(): Promise<boolean> {
        try {
            const lastActivity = await SecureStore.getItemAsync(LAST_ACTIVITY_KEY);
            if (!lastActivity) return true;

            const thirtyDaysMs = 30 * 24 * 60 * 60 * 1000;
            const elapsed = Date.now() - parseInt(lastActivity, 10);
            return elapsed > thirtyDaysMs;
        } catch {
            return true;
        }
    },
};
</file>

<file path="client-app/types/index.ts">
// API Types for Client App

export interface Client {
    id: string;
    fullName: string;
    email: string;
    phone: string;
    profilePhotoUrl?: string;
    heightCm?: number;
    currentWeightKg?: number;
    targetWeightKg?: number;
    dietaryPreferences: string[];
    allergies: string[];
}

export interface Meal {
    id: string;
    planId: string;
    mealType: 'breakfast' | 'lunch' | 'snack' | 'dinner';
    name: string;
    description?: string;
    timeOfDay?: string;
    instructions?: string;
    totalCalories?: number;
    totalProteinG?: number;
    totalCarbsG?: number;
    totalFatsG?: number;
    foodItems: MealFoodItem[];
}

export interface MealFoodItem {
    id: string;
    foodId: string;
    foodName: string;
    quantityG: number;
    calories?: number;
}

export interface MealLog {
    id: string;
    mealId: string;
    scheduledDate: string;
    scheduledTime?: string;
    status: 'pending' | 'eaten' | 'skipped' | 'substituted';
    mealPhotoUrl?: string;
    clientNotes?: string;
    dietitianFeedback?: string;
    dietitianFeedbackAt?: string;
    loggedAt?: string;
    meal: Meal;
}

export interface WeightLog {
    id: string;
    weightKg: number;
    logDate: string;
    notes?: string;
    weightChangeFromPrevious?: number;
}

export interface ClientStats {
    weeklyAdherence: number;
    mealCompletionRate: number;
    weightTrend: 'up' | 'down' | 'stable';
    latestWeight?: number;
    targetWeight?: number;
    currentStreak: number;
}

export interface AuthResponse {
    success: boolean;
    data: {
        token: string;
        client: Client;
    };
}

export interface OTPRequestResponse {
    success: boolean;
    message: string;
}

export interface Notification {
    id: string;
    type: 'feedback' | 'reminder' | 'weight' | 'system';
    title: string;
    message?: string;
    timestamp: string;
    read: boolean;
    avatar?: string;
}
</file>

<file path="client-app/.gitignore">
# Learn more https://docs.github.com/en/get-started/getting-started-with-git/ignoring-files

# dependencies
node_modules/

# Expo
.expo/
dist/
web-build/
expo-env.d.ts

# Native
.kotlin/
*.orig.*
*.jks
*.p8
*.p12
*.key
*.mobileprovision

# Metro
.metro-health-check*

# debug
npm-debug.*
yarn-debug.*
yarn-error.*

# macOS
.DS_Store
*.pem

# local env files
.env*.local

# typescript
*.tsbuildinfo

# generated native folders
/ios
/android
</file>

<file path="client-app/.npmrc">
legacy-peer-deps=true
</file>

<file path="client-app/app.json">
{
  "expo": {
    "name": "DietConnect",
    "slug": "dietconnect-client",
    "version": "1.0.0",
    "orientation": "portrait",
    "icon": "./assets/icon.png",
    "scheme": "dietconnect",
    "userInterfaceStyle": "light",
    "newArchEnabled": true,
    "splash": {
      "image": "./assets/splash-icon.png",
      "resizeMode": "contain",
      "backgroundColor": "#17cf54"
    },
    "ios": {
      "supportsTablet": true,
      "bundleIdentifier": "com.dietconnect.client"
    },
    "android": {
      "adaptiveIcon": {
        "foregroundImage": "./assets/adaptive-icon.png",
        "backgroundColor": "#17cf54"
      },
      "package": "com.dietconnect.client",
      "edgeToEdgeEnabled": true
    },
    "web": {
      "favicon": "./assets/favicon.png",
      "bundler": "metro"
    },
    "plugins": [
      "expo-router"
    ],
    "experiments": {
      "typedRoutes": true
    }
  }
}
</file>

<file path="client-app/package.json">
{
  "name": "dietconnect-client",
  "version": "1.0.0",
  "main": "expo-router/entry",
  "scripts": {
    "start": "expo start",
    "android": "expo start --android",
    "ios": "expo start --ios",
    "web": "expo start --web"
  },
  "dependencies": {
    "@expo/metro-runtime": "^6.1.2",
    "@tanstack/react-query": "^5.90.12",
    "axios": "^1.13.2",
    "expo": "~54.0.30",
    "expo-camera": "^17.0.10",
    "expo-constants": "~18.0.12",
    "expo-document-picker": "^14.0.8",
    "expo-image-picker": "^17.0.10",
    "expo-linking": "~8.0.11",
    "expo-router": "^6.0.21",
    "expo-secure-store": "^15.0.8",
    "expo-splash-screen": "~31.0.13",
    "expo-status-bar": "~3.0.9",
    "lucide-react-native": "^0.562.0",
    "react": "19.1.0",
    "react-native": "0.81.5",
    "react-native-chart-kit": "^6.12.0",
    "react-native-gesture-handler": "^2.30.0",
    "react-native-safe-area-context": "^5.6.2",
    "react-native-screens": "^4.19.0",
    "react-native-svg": "^15.15.1",
    "react-native-web": "^0.21.2"
  },
  "devDependencies": {
    "@types/react": "~19.1.0",
    "typescript": "~5.9.2"
  },
  "private": true
}
</file>

<file path="client-app/tsconfig.json">
{
  "extends": "expo/tsconfig.base",
  "compilerOptions": {
    "strict": true
  },
  "include": [
    "**/*.ts",
    "**/*.tsx",
    ".expo/types/**/*.ts",
    "expo-env.d.ts"
  ]
}
</file>

<file path="Design/mobileapp/dietician's_remark_detail/code.html">
<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope%3Awght%40400%3B500%3B700%3B800&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div
      class="relative flex h-auto min-h-screen w-full flex-col bg-[#f8fcf9] justify-between group/design-root overflow-x-hidden"
      style='font-family: Manrope, "Noto Sans", sans-serif;'
    >
      <div>
        <div class="flex items-center bg-[#f8fcf9] p-4 pb-2 justify-between">
          <div class="text-[#0d1b12] flex size-12 shrink-0 items-center" data-icon="ArrowLeft" data-size="24px" data-weight="regular">
            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
              <path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path>
            </svg>
          </div>
          <h2 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center pr-12">Feedback</h2>
        </div>
        <h3 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">Today</h3>
        <div class="flex w-full flex-row items-start justify-start gap-3 p-4">
          <div
            class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 shrink-0"
            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuByCJqz3zSssqcysf4CwRTzdxxc9R0EoWlrQlSO2ju0MtzJ4V6UbrrLNZl0vgkjMen3bqcnAkgkX7IRDrmz1lqHNCjfONIrJBEZPFVBAXih_p7OqmZSR4WiOARxuRb7FEujfY_oHqE1DZJ0G7RUwmIFfuIiHLtDnSQn2W3lsns5nxWKPuPOqWLNqKUhArpn-GHod7TWlOr0bDK2wg8cbCBloWMhPa0shrJ7PQAPGCl_1K7q9l-sdU00s9kRsCSVtc9V6Spk4l73bWJ7");'
          ></div>
          <div class="flex h-full flex-1 flex-col items-start justify-start">
            <div class="flex w-full flex-row items-start justify-start gap-x-3">
              <p class="text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]">Dr. Anya Sharma</p>
              <p class="text-[#4c9a66] text-sm font-normal leading-normal">10:30 AM</p>
            </div>
            <p class="text-[#0d1b12] text-sm font-normal leading-normal">
              Your meal looks great! The portion size is perfect, and the variety of vegetables is commendable. Keep up the good work!
            </p>
          </div>
        </div>
        <div class="flex w-full grow bg-[#f8fcf9] @container py-3">
          <div class="w-full gap-1 overflow-hidden bg-[#f8fcf9] @[480px]:gap-2 aspect-[3/2] flex">
            <div
              class="w-full bg-center bg-no-repeat bg-cover aspect-auto rounded-none flex-1"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAQtfqbuCjtfgMyUtpj87dPy6dvMU0Xft3M2usehDJKQRrjXwBwPg0IkaJ395I5DeBAdsG1n2PriVH2ifAc8QHXUQgkpoFr1B65ZoF6JRYNkIWq3zaWVSMrl-j0dR3amJ5WevW7N7LxSJqS76ee5uxu6ca4GutQmk0JyrSvOwT142PGh-0OK3oWcCLkj3zKd6WmHkLIxWKQIKYZQYNoI03p_hjSFCi4mLthiaAYLFKWVYzi2s8P-dafkd_WhuqlxJzZxaHv55_32_1D");'
            ></div>
          </div>
        </div>
        <div class="flex flex-wrap gap-4 px-4 py-2 py-2">
          <div class="flex items-center justify-center gap-2 px-3 py-2">
            <div class="text-[#4c9a66]" data-icon="ThumbsUp" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M234,80.12A24,24,0,0,0,216,72H160V56a40,40,0,0,0-40-40,8,8,0,0,0-7.16,4.42L75.06,96H32a16,16,0,0,0-16,16v88a16,16,0,0,0,16,16H204a24,24,0,0,0,23.82-21l12-96A24,24,0,0,0,234,80.12ZM32,112H72v88H32ZM223.94,97l-12,96a8,8,0,0,1-7.94,7H88V105.89l36.71-73.43A24,24,0,0,1,144,56V80a8,8,0,0,0,8,8h64a8,8,0,0,1,7.94,9Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">12</p>
          </div>
          <div class="flex items-center justify-center gap-2 px-3 py-2">
            <div class="text-[#4c9a66]" data-icon="ThumbsDown" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M239.82,157l-12-96A24,24,0,0,0,204,40H32A16,16,0,0,0,16,56v88a16,16,0,0,0,16,16H75.06l37.78,75.58A8,8,0,0,0,120,240a40,40,0,0,0,40-40V184h56a24,24,0,0,0,23.82-27ZM72,144H32V56H72Zm150,21.29a7.88,7.88,0,0,1-6,2.71H152a8,8,0,0,0-8,8v24a24,24,0,0,1-19.29,23.54L88,150.11V56H204a8,8,0,0,1,7.94,7l12,96A7.87,7.87,0,0,1,222,165.29Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">2</p>
          </div>
          <div class="flex items-center justify-center gap-2 px-3 py-2">
            <div class="text-[#4c9a66]" data-icon="Smiley" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216ZM80,108a12,12,0,1,1,12,12A12,12,0,0,1,80,108Zm96,0a12,12,0,1,1-12-12A12,12,0,0,1,176,108Zm-1.07,48c-10.29,17.79-27.4,28-46.93,28s-36.63-10.2-46.92-28a8,8,0,1,1,13.84-8c7.47,12.91,19.21,20,33.08,20s25.61-7.1,33.07-20a8,8,0,0,1,13.86,8Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">5</p>
          </div>
        </div>
      </div>
      <div>
        <div class="flex gap-2 border-t border-[#e7f3eb] bg-[#f8fcf9] px-4 pb-3 pt-2">
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="House" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M218.83,103.77l-80-75.48a1.14,1.14,0,0,1-.11-.11,16,16,0,0,0-21.53,0l-.11.11L37.17,103.77A16,16,0,0,0,32,115.55V208a16,16,0,0,0,16,16H96a16,16,0,0,0,16-16V160h32v48a16,16,0,0,0,16,16h48a16,16,0,0,0,16-16V115.55A16,16,0,0,0,218.83,103.77ZM208,208H160V160a16,16,0,0,0-16-16H112a16,16,0,0,0-16,16v48H48V115.55l.11-.1L128,40l79.9,75.43.11.1Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Home</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="PresentationChart" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M216,40H136V24a8,8,0,0,0-16,0V40H40A16,16,0,0,0,24,56V176a16,16,0,0,0,16,16H79.36L57.75,219a8,8,0,0,0,12.5,10l29.59-37h56.32l29.59,37a8,8,0,1,0,12.5-10l-21.61-27H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,136H40V56H216V176ZM104,120v24a8,8,0,0,1-16,0V120a8,8,0,0,1,16,0Zm32-16v40a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm32-16v56a8,8,0,0,1-16,0V88a8,8,0,0,1,16,0Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Progress</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 rounded-full text-[#0d1b12]" href="#">
            <div class="text-[#0d1b12] flex h-8 items-center justify-center" data-icon="Bell" data-size="24px" data-weight="fill">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#0d1b12] text-xs font-medium leading-normal tracking-[0.015em]">Notifications</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="User" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Profile</p>
          </a>
        </div>
        <div class="h-5 bg-[#f8fcf9]"></div>
      </div>
    </div>
  </body>
</html>
</file>

<file path="Design/mobileapp/home_/_today’s_meals/code.html">
<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope%3Awght%40400%3B500%3B700%3B800&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div
      class="relative flex h-auto min-h-screen w-full flex-col bg-[#f8fcf9] justify-between group/design-root overflow-x-hidden"
      style="--select-button-svg: url('data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2724px%27 height=%2724px%27 fill=%27rgb(76,154,102)%27 viewBox=%270 0 256 256%27%3e%3cpath d=%27M181.66,170.34a8,8,0,0,1,0,11.32l-48,48a8,8,0,0,1-11.32,0l-48-48a8,8,0,0,1,11.32-11.32L128,212.69l42.34-42.35A8,8,0,0,1,181.66,170.34Zm-96-84.68L128,43.31l42.34,42.35a8,8,0,0,0,11.32-11.32l-48-48a8,8,0,0,0-11.32,0l-48,48A8,8,0,0,0,85.66,85.66Z%27%3e%3c/path%3e%3c/svg%3e'); font-family: Manrope, &quot;Noto Sans&quot;, sans-serif;"
    >
      <div>
        <div class="flex items-center bg-[#f8fcf9] p-4 pb-2 justify-between">
          <div class="flex size-12 shrink-0 items-center">
            <div
              class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-8"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBI6BZqDAVJILMHj1ollqNY2dXErmVVwy85KhGIahpmjJIC_5a5GGBDYSBCJq0q0Id8MHmTZ_14XhWgGib1j10n6CB7uZbmytwN1lmIxnQIEWiI7fDeRn_997q9mnqIzH-QI-1MgcclBMBSHIXq0mH-4LvCLquhZWXnp3ff2JiK0Es1qkz6sy0zzRe0vTSkjUdkApEauq2ePpN09JtWWzYDOtmODr7A-ab3706y9DIB3EAw4Uj_nsc9naakMtw4VES2-EzaID1rHzGE");'
            ></div>
          </div>
          <div class="flex w-12 items-center justify-end">
            <button
              class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-[#0d1b12] gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0"
            >
              <div class="text-[#0d1b12]" data-icon="Gear" data-size="24px" data-weight="regular">
                <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                  <path
                    d="M128,80a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160Zm88-29.84q.06-2.16,0-4.32l14.92-18.64a8,8,0,0,0,1.48-7.06,107.21,107.21,0,0,0-10.88-26.25,8,8,0,0,0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186,40.54a8,8,0,0,0-3.94-6,107.71,107.71,0,0,0-26.25-10.87,8,8,0,0,0-7.06,1.49L130.16,40Q128,40,125.84,40L107.2,25.11a8,8,0,0,0-7.06-1.48A107.6,107.6,0,0,0,73.89,34.51a8,8,0,0,0-3.93,6L67.32,64.27q-1.56,1.49-3,3L40.54,70a8,8,0,0,0-6,3.94,107.71,107.71,0,0,0-10.87,26.25,8,8,0,0,0,1.49,7.06L40,125.84Q40,128,40,130.16L25.11,148.8a8,8,0,0,0-1.48,7.06,107.21,107.21,0,0,0,10.88,26.25,8,8,0,0,0,6,3.93l23.72,2.64q1.49,1.56,3,3L70,215.46a8,8,0,0,0,3.94,6,107.71,107.71,0,0,0,26.25,10.87,8,8,0,0,0,7.06-1.49L125.84,216q2.16.06,4.32,0l18.64,14.92a8,8,0,0,0,7.06,1.48,107.21,107.21,0,0,0,26.25-10.88,8,8,0,0,0,3.93-6l2.64-23.72q1.56-1.48,3-3L215.46,186a8,8,0,0,0,6-3.94,107.71,107.71,0,0,0,10.87-26.25,8,8,0,0,0-1.49-7.06Zm-16.1-6.5a73.93,73.93,0,0,1,0,8.68,8,8,0,0,0,1.74,5.48l14.19,17.73a91.57,91.57,0,0,1-6.23,15L187,173.11a8,8,0,0,0-5.1,2.64,74.11,74.11,0,0,1-6.14,6.14,8,8,0,0,0-2.64,5.1l-2.51,22.58a91.32,91.32,0,0,1-15,6.23l-17.74-14.19a8,8,0,0,0-5-1.75h-.48a73.93,73.93,0,0,1-8.68,0,8,8,0,0,0-5.48,1.74L100.45,215.8a91.57,91.57,0,0,1-15-6.23L82.89,187a8,8,0,0,0-2.64-5.1,74.11,74.11,0,0,1-6.14-6.14,8,8,0,0,0-5.1-2.64L46.43,170.6a91.32,91.32,0,0,1-6.23-15l14.19-17.74a8,8,0,0,0,1.74-5.48,73.93,73.93,0,0,1,0-8.68,8,8,0,0,0-1.74-5.48L40.2,100.45a91.57,91.57,0,0,1,6.23-15L69,82.89a8,8,0,0,0,5.1-2.64,74.11,74.11,0,0,1,6.14-6.14A8,8,0,0,0,82.89,69L85.4,46.43a91.32,91.32,0,0,1,15-6.23l17.74,14.19a8,8,0,0,0,5.48,1.74,73.93,73.93,0,0,1,8.68,0,8,8,0,0,0,5.48-1.74L155.55,40.2a91.57,91.57,0,0,1,15,6.23L173.11,69a8,8,0,0,0,2.64,5.1,74.11,74.11,0,0,1,6.14,6.14,8,8,0,0,0,5.1,2.64l22.58,2.51a91.32,91.32,0,0,1,6.23,15l-14.19,17.74A8,8,0,0,0,199.87,123.66Z"
                  ></path>
                </svg>
              </div>
            </button>
          </div>
        </div>
        <h1 class="text-[#0d1b12] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 text-left pb-3 pt-5">Hello, Sarah!</h1>
        <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
          <label class="flex flex-col min-w-40 flex-1">
            <select
              class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0d1b12] focus:outline-0 focus:ring-0 border border-[#cfe7d7] bg-[#f8fcf9] focus:border-[#cfe7d7] h-14 bg-[image:--select-button-svg] placeholder:text-[#4c9a66] p-[15px] text-base font-normal leading-normal"
            >
              <option value="one"></option>
              <option value="two">two</option>
              <option value="three">three</option>
            </select>
          </label>
        </div>
        <h2 class="text-[#0d1b12] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Next Meals</h2>
        <div class="p-4">
          <div class="flex items-stretch justify-between gap-4 rounded-lg">
            <div class="flex flex-[2_2_0px] flex-col gap-4">
              <div class="flex flex-col gap-1">
                <p class="text-[#4c9a66] text-sm font-normal leading-normal">Breakfast</p>
                <p class="text-[#0d1b12] text-base font-bold leading-tight">Oatmeal with Berries</p>
                <p class="text-[#4c9a66] text-sm font-normal leading-normal">Planned for 8:00 AM</p>
              </div>
              <button
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-8 px-4 flex-row-reverse bg-[#e7f3eb] text-[#0d1b12] pr-2 gap-1 text-sm font-medium leading-normal w-fit"
              >
                <div class="text-[#0d1b12]" data-icon="Clock" data-size="18px" data-weight="regular">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 256 256">
                    <path
                      d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a8,8,0,0,1-8,8H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48A8,8,0,0,1,192,128Z"
                    ></path>
                  </svg>
                </div>
                <span class="truncate">Waiting</span>
              </button>
            </div>
            <div
              class="w-full bg-center bg-no-repeat aspect-video bg-cover rounded-lg flex-1"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBQz8Pv9KIh572IafeQ7APBZfy79qQm6qj-KYBMaV43sQCSIO54e_5wa6FU2eGl3xf-w0ueckUulKjqiMwWgKetH1GOi9k3q76_-HKkwVlvfQYVVG7o1dOCgoqxRoOxWGSLK4LM_JR8ngmNlWkxvT-HgQZXP8GWFBJ8jREZZXMYD6FElRa9u9IZs40Ft0Fn3MzLfKOYtr4mtIq7GwxBoVIo2jS9Pmx5gINmBR_TzjVuAENkM7ORV8JTLGPa5LjzH1LQ11zcGPVP8PhH");'
            ></div>
          </div>
        </div>
        <div class="flex justify-stretch">
          <div class="flex flex-1 gap-3 flex-wrap px-4 py-3 justify-between">
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Upload Photo</span>
            </button>
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Mark as Eaten</span>
            </button>
          </div>
        </div>
        <div class="flex justify-stretch">
          <div class="flex flex-1 gap-3 flex-wrap px-4 py-3 justify-between">
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Skipped</span>
            </button>
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Substitute</span>
            </button>
          </div>
        </div>
        <div class="p-4">
          <div class="flex items-stretch justify-between gap-4 rounded-lg">
            <div class="flex flex-[2_2_0px] flex-col gap-4">
              <div class="flex flex-col gap-1">
                <p class="text-[#4c9a66] text-sm font-normal leading-normal">Snack</p>
                <p class="text-[#0d1b12] text-base font-bold leading-tight">Apple Slices with Almond Butter</p>
                <p class="text-[#4c9a66] text-sm font-normal leading-normal">Planned for 10:30 AM</p>
              </div>
              <button
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-8 px-4 flex-row-reverse bg-[#e7f3eb] text-[#0d1b12] pr-2 gap-1 text-sm font-medium leading-normal w-fit"
              >
                <div class="text-[#0d1b12]" data-icon="Clock" data-size="18px" data-weight="regular">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 256 256">
                    <path
                      d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a8,8,0,0,1-8,8H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48A8,8,0,0,1,192,128Z"
                    ></path>
                  </svg>
                </div>
                <span class="truncate">Waiting</span>
              </button>
            </div>
            <div
              class="w-full bg-center bg-no-repeat aspect-video bg-cover rounded-lg flex-1"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuA9lftq20Q_sSt4-zUosxbvq_hqs1CBfNlRYZCvbK3r3sDXiYi1eHqdOoIZIrZCgbEh2cpizR9AR9v--ih267ab00inBhfI-zwXkUZ9Q2AGZ1BvPL9d3AdsVcydo9Q0Ty9Fh82wpD70JvJau2Qyoy3wiBpiKgtjfH3oxjHH0MuY_-R70LhGOq5fOjZKXatKL6ettjPHEfN1YbVw-ChsvTn-hoZW6JLyagjz56Vn5kQLcKxP5CW1Bg3p1Sb9KTA_299J-VBqk55a7vm6");'
            ></div>
          </div>
        </div>
        <div class="flex justify-stretch">
          <div class="flex flex-1 gap-3 flex-wrap px-4 py-3 justify-between">
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Upload Photo</span>
            </button>
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Mark as Eaten</span>
            </button>
          </div>
        </div>
        <div class="flex justify-stretch">
          <div class="flex flex-1 gap-3 flex-wrap px-4 py-3 justify-between">
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Skipped</span>
            </button>
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Substitute</span>
            </button>
          </div>
        </div>
        <div class="p-4">
          <div class="flex items-stretch justify-between gap-4 rounded-lg">
            <div class="flex flex-[2_2_0px] flex-col gap-4">
              <div class="flex flex-col gap-1">
                <p class="text-[#4c9a66] text-sm font-normal leading-normal">Lunch</p>
                <p class="text-[#0d1b12] text-base font-bold leading-tight">Grilled Chicken Salad</p>
                <p class="text-[#4c9a66] text-sm font-normal leading-normal">Planned for 1:00 PM</p>
              </div>
              <button
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-8 px-4 flex-row-reverse bg-[#e7f3eb] text-[#0d1b12] pr-2 gap-1 text-sm font-medium leading-normal w-fit"
              >
                <div class="text-[#0d1b12]" data-icon="Clock" data-size="18px" data-weight="regular">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 256 256">
                    <path
                      d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a8,8,0,0,1-8,8H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48A8,8,0,0,1,192,128Z"
                    ></path>
                  </svg>
                </div>
                <span class="truncate">Waiting</span>
              </button>
            </div>
            <div
              class="w-full bg-center bg-no-repeat aspect-video bg-cover rounded-lg flex-1"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBqY5Jo-t5RZuFLO-DmQQzke7DbIbBwHfG55B8nWXch3wqhWq2ABM1FJakRL--2Ec0K87SmnlGbU3nxyAnpgAE4CGDi466U2q3vHG0E5t711MR8lh-9TbJclJOmrelJZ2EI2gp_cPPiwuxE2PV6q7mJE2ASieeyVHDvI_ko3R0sdFzoRWrSdL3k7Lr2OyEusQrWMF1Vp6YVxuYT9TbvoL99FeXXNZaBjNnPbV4X_NxK-cpN5O_GHGtqXcLkq3hKJrfD0G-K3cjZTdX8");'
            ></div>
          </div>
        </div>
        <div class="flex justify-stretch">
          <div class="flex flex-1 gap-3 flex-wrap px-4 py-3 justify-between">
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Upload Photo</span>
            </button>
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Mark as Eaten</span>
            </button>
          </div>
        </div>
        <div class="flex justify-stretch">
          <div class="flex flex-1 gap-3 flex-wrap px-4 py-3 justify-between">
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Skipped</span>
            </button>
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
            >
              <span class="truncate">Substitute</span>
            </button>
          </div>
        </div>
        <h2 class="text-[#0d1b12] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Today's Progress</h2>
        <div class="flex flex-col gap-3 p-4">
          <div class="flex gap-6 justify-between">
            <p class="text-[#0d1b12] text-base font-medium leading-normal">Calories</p>
            <p class="text-[#0d1b12] text-sm font-normal leading-normal">1200/2000</p>
          </div>
          <div class="rounded bg-[#cfe7d7]"><div class="h-2 rounded bg-[#13ec5b]" style="width: 60%;"></div></div>
        </div>
        <div class="flex flex-col gap-3 p-4">
          <div class="flex gap-6 justify-between">
            <p class="text-[#0d1b12] text-base font-medium leading-normal">Protein</p>
            <p class="text-[#0d1b12] text-sm font-normal leading-normal">75g/100g</p>
          </div>
          <div class="rounded bg-[#cfe7d7]"><div class="h-2 rounded bg-[#13ec5b]" style="width: 75%;"></div></div>
        </div>
        <div class="flex flex-col gap-3 p-4">
          <div class="flex gap-6 justify-between">
            <p class="text-[#0d1b12] text-base font-medium leading-normal">Carbs</p>
            <p class="text-[#0d1b12] text-sm font-normal leading-normal">150g/300g</p>
          </div>
          <div class="rounded bg-[#cfe7d7]"><div class="h-2 rounded bg-[#13ec5b]" style="width: 50%;"></div></div>
        </div>
        <div class="flex flex-col gap-3 p-4">
          <div class="flex gap-6 justify-between">
            <p class="text-[#0d1b12] text-base font-medium leading-normal">Fat</p>
            <p class="text-[#0d1b12] text-sm font-normal leading-normal">40g/50g</p>
          </div>
          <div class="rounded bg-[#cfe7d7]"><div class="h-2 rounded bg-[#13ec5b]" style="width: 80%;"></div></div>
        </div>
      </div>
      <div>
        <div class="flex justify-end overflow-hidden px-5 pb-5">
          <button
            class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-14 px-5 bg-[#13ec5b] text-[#0d1b12] text-base font-bold leading-normal tracking-[0.015em] min-w-0 gap-4 pl-4 pr-6"
          >
            <div class="text-[#0d1b12]" data-icon="Plus" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path>
              </svg>
            </div>
            <span class="truncate">Log Next Meal</span>
          </button>
        </div>
        <div class="h-5 bg-[#f8fcf9]"></div>
      </div>
    </div>
  </body>
</html>
</file>

<file path="Design/mobileapp/log_meal_screen/code.html">
<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope%3Awght%40400%3B500%3B700%3B800&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div
      class="relative flex h-auto min-h-screen w-full flex-col bg-[#f8fcf9] justify-between group/design-root overflow-x-hidden"
      style="--select-button-svg: url('data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2724px%27 height=%2724px%27 fill=%27rgb(76,154,102)%27 viewBox=%270 0 256 256%27%3e%3cpath d=%27M181.66,170.34a8,8,0,0,1,0,11.32l-48,48a8,8,0,0,1-11.32,0l-48-48a8,8,0,0,1,11.32-11.32L128,212.69l42.34-42.35A8,8,0,0,1,181.66,170.34Zm-96-84.68L128,43.31l42.34,42.35a8,8,0,0,0,11.32-11.32l-48-48a8,8,0,0,0-11.32,0l-48,48A8,8,0,0,0,85.66,85.66Z%27%3e%3c/path%3e%3c/svg%3e'); font-family: Manrope, &quot;Noto Sans&quot;, sans-serif;"
    >
      <div>
        <div class="flex items-center bg-[#f8fcf9] p-4 pb-2 justify-between">
          <div class="text-[#0d1b12] flex size-12 shrink-0 items-center" data-icon="X" data-size="24px" data-weight="regular">
            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
              <path
                d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"
              ></path>
            </svg>
          </div>
          <h2 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center pr-12">Log Meal</h2>
        </div>
        <div class="flex w-full grow bg-[#f8fcf9] @container py-3">
          <div class="w-full gap-1 overflow-hidden bg-[#f8fcf9] @[480px]:gap-2 aspect-[3/2] flex">
            <div
              class="w-full bg-center bg-no-repeat bg-cover aspect-auto rounded-none flex-1"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuB0E5cY2MxeEHD4ZyzJkwwk8VYaNicPvPChIE4Ari5ne-ZWBckmoF4KNZK7Pf94e7v4i0Kz19CeZUIA8CE85SSvt_koxicW4TT4mdQpGIPWGrOw2xL88d7Hm_PZ4wrxUcDdvHyNamD2RR1M4J9Xn9mZwdf5xTpN0jz7DX3nGEkevJ3Pj6gUOwIvIUi_WtZm2-4dOvMubrS-TLLvzYPYIN4GqSgDOR6GDECxKMQamwk81cDyT-QuNfHUNQTlYKoE6SpON4vysAGCC1qx");'
            ></div>
          </div>
        </div>
        <h3 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">Meal Type</h3>
        <div class="flex flex-wrap gap-3 p-4">
          <label
            class="text-sm font-medium leading-normal flex items-center justify-center rounded-lg border border-[#cfe7d7] px-4 h-11 text-[#0d1b12] has-[:checked]:border-[3px] has-[:checked]:px-3.5 has-[:checked]:border-[#13ec5b] relative cursor-pointer"
          >
            Breakfast
            <input type="radio" class="invisible absolute" name="fdafd399-187f-4876-9181-7f211ec339ec" />
          </label>
          <label
            class="text-sm font-medium leading-normal flex items-center justify-center rounded-lg border border-[#cfe7d7] px-4 h-11 text-[#0d1b12] has-[:checked]:border-[3px] has-[:checked]:px-3.5 has-[:checked]:border-[#13ec5b] relative cursor-pointer"
          >
            Lunch
            <input type="radio" class="invisible absolute" name="fdafd399-187f-4876-9181-7f211ec339ec" />
          </label>
          <label
            class="text-sm font-medium leading-normal flex items-center justify-center rounded-lg border border-[#cfe7d7] px-4 h-11 text-[#0d1b12] has-[:checked]:border-[3px] has-[:checked]:px-3.5 has-[:checked]:border-[#13ec5b] relative cursor-pointer"
          >
            Dinner
            <input type="radio" class="invisible absolute" name="fdafd399-187f-4876-9181-7f211ec339ec" />
          </label>
          <label
            class="text-sm font-medium leading-normal flex items-center justify-center rounded-lg border border-[#cfe7d7] px-4 h-11 text-[#0d1b12] has-[:checked]:border-[3px] has-[:checked]:px-3.5 has-[:checked]:border-[#13ec5b] relative cursor-pointer"
          >
            Snack
            <input type="radio" class="invisible absolute" name="fdafd399-187f-4876-9181-7f211ec339ec" />
          </label>
          <label
            class="text-sm font-medium leading-normal flex items-center justify-center rounded-lg border border-[#cfe7d7] px-4 h-11 text-[#0d1b12] has-[:checked]:border-[3px] has-[:checked]:px-3.5 has-[:checked]:border-[#13ec5b] relative cursor-pointer"
          >
            Substituted
            <input type="radio" class="invisible absolute" name="fdafd399-187f-4876-9181-7f211ec339ec" />
          </label>
        </div>
        <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
          <label class="flex flex-col min-w-40 flex-1">
            <p class="text-[#0d1b12] text-base font-medium leading-normal pb-2">Scheduled Time</p>
            <select
              class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0d1b12] focus:outline-0 focus:ring-0 border-none bg-[#e7f3eb] focus:border-none h-14 bg-[image:--select-button-svg] placeholder:text-[#4c9a66] p-4 text-base font-normal leading-normal"
            >
              <option value="one">Select Time</option>
              <option value="two">two</option>
              <option value="three">three</option>
            </select>
          </label>
        </div>
        <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
          <label class="flex flex-col min-w-40 flex-1">
            <p class="text-[#0d1b12] text-base font-medium leading-normal pb-2">Notes (Optional)</p>
            <textarea
              placeholder="Add any notes about your meal"
              class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0d1b12] focus:outline-0 focus:ring-0 border-none bg-[#e7f3eb] focus:border-none min-h-36 placeholder:text-[#4c9a66] p-4 text-base font-normal leading-normal"
            ></textarea>
          </label>
        </div>
      </div>
      <div>
        <div class="flex px-4 py-3">
          <button
            class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 px-5 flex-1 bg-[#13ec5b] text-[#0d1b12] text-base font-bold leading-normal tracking-[0.015em]"
          >
            <span class="truncate">Submit</span>
          </button>
        </div>
        <p class="text-[#4c9a66] text-sm font-normal leading-normal pb-3 pt-1 px-4 text-center">Meal logged! Waiting for review.</p>
        <div class="flex gap-2 border-t border-[#e7f3eb] bg-[#f8fcf9] px-4 pb-3 pt-2">
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 rounded-full text-[#0d1b12]" href="#">
            <div class="text-[#0d1b12] flex h-8 items-center justify-center" data-icon="House" data-size="24px" data-weight="fill">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M224,115.55V208a16,16,0,0,1-16,16H168a16,16,0,0,1-16-16V168a8,8,0,0,0-8-8H112a8,8,0,0,0-8,8v40a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V115.55a16,16,0,0,1,5.17-11.78l80-75.48.11-.11a16,16,0,0,1,21.53,0,1.14,1.14,0,0,0,.11.11l80,75.48A16,16,0,0,1,224,115.55Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#0d1b12] text-xs font-medium leading-normal tracking-[0.015em]">Home</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="PresentationChart" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M216,40H136V24a8,8,0,0,0-16,0V40H40A16,16,0,0,0,24,56V176a16,16,0,0,0,16,16H79.36L57.75,219a8,8,0,0,0,12.5,10l29.59-37h56.32l29.59,37a8,8,0,1,0,12.5-10l-21.61-27H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,136H40V56H216V176ZM104,120v24a8,8,0,0,1-16,0V120a8,8,0,0,1,16,0Zm32-16v40a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm32-16v56a8,8,0,0,1-16,0V88a8,8,0,0,1,16,0Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Progress</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="Bell" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Notifications</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="User" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Profile</p>
          </a>
        </div>
        <div class="h-5 bg-[#f8fcf9]"></div>
      </div>
    </div>
  </body>
</html>
</file>

<file path="Design/mobileapp/notifications_(inbox)/code.html">
<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope%3Awght%40400%3B500%3B700%3B800&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div
      class="relative flex h-auto min-h-screen w-full flex-col bg-[#f8fcf9] justify-between group/design-root overflow-x-hidden"
      style='font-family: Manrope, "Noto Sans", sans-serif;'
    >
      <div>
        <div class="flex items-center bg-[#f8fcf9] p-4 pb-2 justify-between">
          <h2 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center pl-12">Inbox</h2>
          <div class="flex w-12 items-center justify-end">
            <button
              class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-[#0d1b12] gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0"
            >
              <div class="text-[#0d1b12]" data-icon="Gear" data-size="24px" data-weight="regular">
                <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                  <path
                    d="M128,80a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160Zm88-29.84q.06-2.16,0-4.32l14.92-18.64a8,8,0,0,0,1.48-7.06,107.21,107.21,0,0,0-10.88-26.25,8,8,0,0,0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186,40.54a8,8,0,0,0-3.94-6,107.71,107.71,0,0,0-26.25-10.87,8,8,0,0,0-7.06,1.49L130.16,40Q128,40,125.84,40L107.2,25.11a8,8,0,0,0-7.06-1.48A107.6,107.6,0,0,0,73.89,34.51a8,8,0,0,0-3.93,6L67.32,64.27q-1.56,1.49-3,3L40.54,70a8,8,0,0,0-6,3.94,107.71,107.71,0,0,0-10.87,26.25,8,8,0,0,0,1.49,7.06L40,125.84Q40,128,40,130.16L25.11,148.8a8,8,0,0,0-1.48,7.06,107.21,107.21,0,0,0,10.88,26.25,8,8,0,0,0,6,3.93l23.72,2.64q1.49,1.56,3,3L70,215.46a8,8,0,0,0,3.94,6,107.71,107.71,0,0,0,26.25,10.87,8,8,0,0,0,7.06-1.49L125.84,216q2.16.06,4.32,0l18.64,14.92a8,8,0,0,0,7.06,1.48,107.21,107.21,0,0,0,26.25-10.88,8,8,0,0,0,3.93-6l2.64-23.72q1.56-1.48,3-3L215.46,186a8,8,0,0,0,6-3.94,107.71,107.71,0,0,0,10.87-26.25,8,8,0,0,0-1.49-7.06Zm-16.1-6.5a73.93,73.93,0,0,1,0,8.68,8,8,0,0,0,1.74,5.48l14.19,17.73a91.57,91.57,0,0,1-6.23,15L187,173.11a8,8,0,0,0-5.1,2.64,74.11,74.11,0,0,1-6.14,6.14,8,8,0,0,0-2.64,5.1l-2.51,22.58a91.32,91.32,0,0,1-15,6.23l-17.74-14.19a8,8,0,0,0-5-1.75h-.48a73.93,73.93,0,0,1-8.68,0,8,8,0,0,0-5.48,1.74L100.45,215.8a91.57,91.57,0,0,1-15-6.23L82.89,187a8,8,0,0,0-2.64-5.1,74.11,74.11,0,0,1-6.14-6.14,8,8,0,0,0-5.1-2.64L46.43,170.6a91.32,91.32,0,0,1-6.23-15l14.19-17.74a8,8,0,0,0,1.74-5.48,73.93,73.93,0,0,1,0-8.68,8,8,0,0,0-1.74-5.48L40.2,100.45a91.57,91.57,0,0,1,6.23-15L69,82.89a8,8,0,0,0,5.1-2.64,74.11,74.11,0,0,1,6.14-6.14A8,8,0,0,0,82.89,69L85.4,46.43a91.32,91.32,0,0,1,15-6.23l17.74,14.19a8,8,0,0,0,5.48,1.74,73.93,73.93,0,0,1,8.68,0,8,8,0,0,0,5.48-1.74L155.55,40.2a91.57,91.57,0,0,1,15,6.23L173.11,69a8,8,0,0,0,2.64,5.1,74.11,74.11,0,0,1,6.14,6.14,8,8,0,0,0,5.1,2.64l22.58,2.51a91.32,91.32,0,0,1,6.23,15l-14.19,17.74A8,8,0,0,0,199.87,123.66Z"
                  ></path>
                </svg>
              </div>
            </button>
          </div>
        </div>
        <div class="flex items-center gap-4 bg-[#f8fcf9] px-4 min-h-[72px] py-2">
          <div
            class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-14 w-fit"
            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDUR03QGHhrh6KYbfte2s_-KxCSQ02mJFmec8r1bHD7nJdYsPP4MreRamZN5xs2yF_wM79uywvqasf8vgwq-ZOBjZVl8U8_nPp7-R1jdoPnc6XcLGmE-i0ZqY6K79h-gdJp0L8ZvnUlljoarp2OCNIOO60YWUqD-5vp0ib_ab02aepGzqkurCu_e-bXCiIsrN6FZjhart1OtXySzcpzR954HxqfkBDeLCxf6RqLNlEQg7hl_dsyZ5pPLhL7PyvnwwNwvnR_nYkMlliA");'
          ></div>
          <div class="flex flex-col justify-center">
            <p class="text-[#0d1b12] text-base font-medium leading-normal line-clamp-1">Dr. Anya approved your lunch photo</p>
            <p class="text-[#4c9a66] text-sm font-normal leading-normal line-clamp-2">1d</p>
          </div>
        </div>
        <div class="flex items-center gap-4 bg-[#f8fcf9] px-4 min-h-[72px] py-2">
          <div
            class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-14 w-fit"
            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBLinbjKwioKdKlgt3M8T7awHpni04x8J0G8Q0bEZsKor0YlCu4y9zL5iI3rutzpyuqzZrpXOMQBL0vxVOO8WriXnqm-w1rGd8RYeA6FCPRE8JCM9TaUDjR00YOXh0izF9KDFTCSF8t_KaUFkjtRx6_JJNpw6IKjGa6bQQ2o3qW_yFZlPkWC65FDFgDB0jHePNKZkN2LP3JP4LrV7bgp-YvRa4AH2AMuMZmcBquVIM2JnxrMWQJJZQqNSRHDdcKYn1fi7ESQVYN5pI8");'
          ></div>
          <div class="flex flex-col justify-center">
            <p class="text-[#0d1b12] text-base font-medium leading-normal line-clamp-1">Don't forget to log your dinner!</p>
            <p class="text-[#4c9a66] text-sm font-normal leading-normal line-clamp-2">2d</p>
          </div>
        </div>
        <div class="flex items-center gap-4 bg-[#f8fcf9] px-4 min-h-[72px] py-2">
          <div
            class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-14 w-fit"
            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBHMiPcUlZGutG7zHll46dBrGnqDNvXNAH4ghieAQ10UNhrir_igyLiSgooHaH6B11N_xRwg1DSQyBNFb6ySc9HGeRjHWMB1ZXoXt85dBiQm3j-liBPyLUwOhI2c5P96aE-vhY69QRa96j7bT85JaNtgiDEB6kLlHWIIp3BWoNxhkv6bm0gibeW84oGMXk-NrKLyklYSQSfsuHcPtxrZttv4OMtNurRbron5i-Oz6_4pAJg5v3VGsX5n7w7pNrkQB3kk15iKupgaVKy");'
          ></div>
          <div class="flex flex-col justify-center">
            <p class="text-[#0d1b12] text-base font-medium leading-normal line-clamp-1">Dr. Anya approved your breakfast photo</p>
            <p class="text-[#4c9a66] text-sm font-normal leading-normal line-clamp-2">3d</p>
          </div>
        </div>
        <div class="flex items-center gap-4 bg-[#f8fcf9] px-4 min-h-[72px] py-2">
          <div
            class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-14 w-fit"
            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDAyjPHyc-QjR2dUaoNvQAswzquRLoopXckA8eITsUOTNLBFbv17NPkVYurYvsswv4AbjlgEwpQrfKAH9CjMqUSs3TLWGGO1M-sExgHeiJeO8_20Hqyrlvyj1Ou9bgrI2q7WiFGAqVWfJCzia-vdJZseXWG8qMaAMnjc_MesAa8i4U40RXsEClltKFHC9htk5pnJilWuOmvlbFXfjeDswVDeZM3a3JyZg-Yl1bRjG2MntgB3RJynlYWQVZ8-LYPPgtgYoK3V8ZzgKRi");'
          ></div>
          <div class="flex flex-col justify-center">
            <p class="text-[#0d1b12] text-base font-medium leading-normal line-clamp-1">Don't forget to log your lunch!</p>
            <p class="text-[#4c9a66] text-sm font-normal leading-normal line-clamp-2">4d</p>
          </div>
        </div>
        <div class="flex items-center gap-4 bg-[#f8fcf9] px-4 min-h-[72px] py-2">
          <div
            class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-14 w-fit"
            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAkYqB5tbLH76yQg7B5v770Nl3EDpIWqEzKyJn5Z4MVOczNnY2QjjqDapZAkTxRdsz9LbP3zo5yuZhulSE0HRAEU7ASNO5M0NpZM6P0QSo6cooQpUAkP5Rq19XK-MPNuVbM0rdD6lO7d2Wxu4Z30LLJ6aQQTjbA2PYGQtDVJ_U2GiajMjJWfxm2iUfr-hd3S6f7dCKQXG2AXFVlu8Pv8dINs8hZZSCi3T_Pi1OnLuSLWoJAk0dcXm8WmMzjzAkf--wPytFxymxpG8r6");'
          ></div>
          <div class="flex flex-col justify-center">
            <p class="text-[#0d1b12] text-base font-medium leading-normal line-clamp-1">Dr. Anya approved your dinner photo</p>
            <p class="text-[#4c9a66] text-sm font-normal leading-normal line-clamp-2">5d</p>
          </div>
        </div>
      </div>
      <div>
        <div class="flex gap-2 border-t border-[#e7f3eb] bg-[#f8fcf9] px-4 pb-3 pt-2">
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="House" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M218.83,103.77l-80-75.48a1.14,1.14,0,0,1-.11-.11,16,16,0,0,0-21.53,0l-.11.11L37.17,103.77A16,16,0,0,0,32,115.55V208a16,16,0,0,0,16,16H96a16,16,0,0,0,16-16V160h32v48a16,16,0,0,0,16,16h48a16,16,0,0,0,16-16V115.55A16,16,0,0,0,218.83,103.77ZM208,208H160V160a16,16,0,0,0-16-16H112a16,16,0,0,0-16,16v48H48V115.55l.11-.1L128,40l79.9,75.43.11.1Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Home</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="PresentationChart" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M216,40H136V24a8,8,0,0,0-16,0V40H40A16,16,0,0,0,24,56V176a16,16,0,0,0,16,16H79.36L57.75,219a8,8,0,0,0,12.5,10l29.59-37h56.32l29.59,37a8,8,0,1,0,12.5-10l-21.61-27H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,136H40V56H216V176ZM104,120v24a8,8,0,0,1-16,0V120a8,8,0,0,1,16,0Zm32-16v40a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm32-16v56a8,8,0,0,1-16,0V88a8,8,0,0,1,16,0Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Progress</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 rounded-full text-[#0d1b12]" href="#">
            <div class="text-[#0d1b12] flex h-8 items-center justify-center" data-icon="Bell" data-size="24px" data-weight="fill">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#0d1b12] text-xs font-medium leading-normal tracking-[0.015em]">Notifications</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="User" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Profile</p>
          </a>
        </div>
        <div class="h-5 bg-[#f8fcf9]"></div>
      </div>
    </div>
  </body>
</html>
</file>

<file path="Design/mobileapp/progress_tab/code.html">
<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope%3Awght%40400%3B500%3B700%3B800&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div
      class="relative flex h-auto min-h-screen w-full flex-col bg-[#f8fcf9] justify-between group/design-root overflow-x-hidden"
      style='font-family: Manrope, "Noto Sans", sans-serif;'
    >
      <div>
        <div class="flex items-center bg-[#f8fcf9] p-4 pb-2 justify-between">
          <div class="text-[#0d1b12] flex size-12 shrink-0 items-center" data-icon="ArrowLeft" data-size="24px" data-weight="regular">
            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
              <path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path>
            </svg>
          </div>
          <h2 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center pr-12">Progress</h2>
        </div>
        <div class="flex flex-wrap gap-3 px-4 py-3">
          <div class="flex min-w-[111px] flex-1 basis-[fit-content] flex-col gap-2 rounded-lg border border-[#cfe7d7] p-3 items-center text-center">
            <p class="text-[#0d1b12] tracking-light text-2xl font-bold leading-tight">14</p>
            <div class="flex items-center gap-2"><p class="text-[#4c9a66] text-sm font-normal leading-normal">Adherence streak</p></div>
          </div>
          <div class="flex min-w-[111px] flex-1 basis-[fit-content] flex-col gap-2 rounded-lg border border-[#cfe7d7] p-3 items-center text-center">
            <p class="text-[#0d1b12] tracking-light text-2xl font-bold leading-tight">77%</p>
            <div class="flex items-center gap-2"><p class="text-[#4c9a66] text-sm font-normal leading-normal">On track this week</p></div>
          </div>
        </div>
        <h2 class="text-[#0d1b12] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Milestones</h2>
        <div class="flex overflow-y-auto [-ms-scrollbar-style:none] [scrollbar-width:none] [&amp;::-webkit-scrollbar]:hidden">
          <div class="flex items-stretch p-4 gap-3">
            <div class="flex h-full flex-1 flex-col gap-4 rounded-lg min-w-40">
              <div
                class="w-full bg-center bg-no-repeat aspect-square bg-cover rounded-lg flex flex-col"
                style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuC9GxNfO7srVvuJvM1h7kvU1HiuCR37cNAzW0JajLXckSv3vRNMA9ACuh3gYd44zcey0XiktM2YOkFW-1jc-VH5vp-MfhNxA0Lgb5XP3ZHNa-SRf6AlPqWbiAnI5VlyAagnUK2DhWX8aa1Ike83464p8WpRUYzkjKFLaQ0Qyv6l2AdwZvPXhZc38wPs5fmAMMk8awoBtYVlpYwdDTorNj5PLkd2QtrKYuOHmHhot_O22ZUFIymd210pzabADz95Wi20mjEcMABP_lUD");'
              ></div>
              <p class="text-[#0d1b12] text-base font-medium leading-normal">5kg lost</p>
            </div>
            <div class="flex h-full flex-1 flex-col gap-4 rounded-lg min-w-40">
              <div
                class="w-full bg-center bg-no-repeat aspect-square bg-cover rounded-lg flex flex-col"
                style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuC4iW3MZ0FXRPYTpr3kP0aOEPPpeoFzat9JkCRL3w1DAO1x55GlJJIH2PTedd5mq9EGCliovkPTee9clklaiSgff8vJ5Myvg9MH6waaIiWhBBoKN_d35kk69013tE6y3QpguiCNmQta2pYtY4ZTRE1ucyT6HY0s4ocfv0Ax2ZghVUNtDP7p6InjKBn6WCJR9VA59J43lhACiFLPlsyFkIPAYQR-6xyGkkok34w3DgR1rgHA18OgoAqbR9oTrwAOqpq8_Q3CHmzO9pbt");'
              ></div>
              <p class="text-[#0d1b12] text-base font-medium leading-normal">10kg lost</p>
            </div>
            <div class="flex h-full flex-1 flex-col gap-4 rounded-lg min-w-40">
              <div
                class="w-full bg-center bg-no-repeat aspect-square bg-cover rounded-lg flex flex-col"
                style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBlIfGuyeZYp0AuoFrfYhhzP9nOTd6cDO4uy0a3D2FnO3aCaAIO-uQ8gpo_4pvNbuxXFIAZ062oxlVlac6oGAyx4ojjxFCZKmYsvcQNuydL5eWfr51GwEZeewWrHawL1ryJvoh5yi7Y_3yMhwiLqKlY2pRFDpZzhAETWfRgeoi-1TXo46LDmr9NKlAPrCzYPcDnKw7oP_tPmDZBhDtcPwlQwn87spt07A4mc5UbhxXoBKVSlB7KCp8Fva81vvUWDudb6DtWvqZ-Ev8R");'
              ></div>
              <p class="text-[#0d1b12] text-base font-medium leading-normal">15kg lost</p>
            </div>
          </div>
        </div>
        <h2 class="text-[#0d1b12] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Weight history</h2>
        <div class="flex flex-wrap gap-4 px-4 py-6">
          <div class="flex min-w-72 flex-1 flex-col gap-2">
            <p class="text-[#0d1b12] text-base font-medium leading-normal">Weight</p>
            <p class="text-[#0d1b12] tracking-light text-[32px] font-bold leading-tight truncate">75kg</p>
            <div class="flex gap-1">
              <p class="text-[#4c9a66] text-base font-normal leading-normal">Last 30 days</p>
              <p class="text-[#e72a08] text-base font-medium leading-normal">-2%</p>
            </div>
            <div class="flex min-h-[180px] flex-1 flex-col gap-8 py-4">
              <svg width="100%" height="148" viewBox="-3 0 478 150" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
                <path
                  d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25V149H326.769H0V109Z"
                  fill="url(#paint0_linear_1131_5935)"
                ></path>
                <path
                  d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25"
                  stroke="#4c9a66"
                  stroke-width="3"
                  stroke-linecap="round"
                ></path>
                <defs>
                  <linearGradient id="paint0_linear_1131_5935" x1="236" y1="1" x2="236" y2="149" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#e7f3eb"></stop>
                    <stop offset="1" stop-color="#e7f3eb" stop-opacity="0"></stop>
                  </linearGradient>
                </defs>
              </svg>
              <div class="flex justify-around">
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">10/10</p>
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">10/17</p>
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">10/24</p>
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">10/31</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div><div class="h-5 bg-[#f8fcf9]"></div></div>
    </div>
  </body>
</html>
</file>

<file path="Design/mobileapp/settings/profile/code.html">
<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope%3Awght%40400%3B500%3B700%3B800&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div
      class="relative flex h-auto min-h-screen w-full flex-col bg-[#f8fcf9] justify-between group/design-root overflow-x-hidden"
      style='font-family: Manrope, "Noto Sans", sans-serif;'
    >
      <div>
        <div class="flex items-center bg-[#f8fcf9] p-4 pb-2 justify-between">
          <div class="text-[#0d1b12] flex size-12 shrink-0 items-center" data-icon="ArrowLeft" data-size="24px" data-weight="regular">
            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
              <path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path>
            </svg>
          </div>
          <h2 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center pr-12">Settings</h2>
        </div>
        <div class="flex p-4 @container">
          <div class="flex w-full flex-col gap-4 @[520px]:flex-row @[520px]:justify-between @[520px]:items-center">
            <div class="flex gap-4">
              <div
                class="bg-center bg-no-repeat aspect-square bg-cover rounded-full min-h-32 w-32"
                style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCtMLXSUFpEx1EAJjRQiReiqu58cetfxO6YnzIQps94P0EY0FHwSLVXExr9P52n9m_sIh_WSCcznR6-p-Fax5jYfvNzVyJ51K1aoYejX0JGJwLpaFNT-ndrLhVvwrfs6QFQn6NepKZg-WIp34jHZ2B7D_QvQ0DfRMUgaGM4JcLCVUn1wj67GsAsTkuDj9HIqWNKFZxykkWtNjVQDtMhd3w51IwGNsjk_ICXimGgPLaiaU83sz1ufayjQqSFOOrXHGeUyDPw3hjEDbHi");'
              ></div>
              <div class="flex flex-col justify-center">
                <p class="text-[#0d1b12] text-[22px] font-bold leading-tight tracking-[-0.015em]">Sophia Carter</p>
                <p class="text-[#4c9a66] text-base font-normal leading-normal">Client</p>
              </div>
            </div>
          </div>
        </div>
        <h3 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">Profile</h3>
        <div class="flex items-center gap-4 bg-[#f8fcf9] px-4 min-h-[72px] py-2">
          <div class="text-[#0d1b12] flex items-center justify-center rounded-lg bg-[#e7f3eb] shrink-0 size-12" data-icon="User" data-size="24px" data-weight="regular">
            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
              <path
                d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"
              ></path>
            </svg>
          </div>
          <div class="flex flex-col justify-center">
            <p class="text-[#0d1b12] text-base font-medium leading-normal line-clamp-1">Profile</p>
            <p class="text-[#4c9a66] text-sm font-normal leading-normal line-clamp-2">Edit your profile</p>
          </div>
        </div>
        <div class="flex items-center gap-4 bg-[#f8fcf9] px-4 min-h-[72px] py-2">
          <div class="text-[#0d1b12] flex items-center justify-center rounded-lg bg-[#e7f3eb] shrink-0 size-12" data-icon="Target" data-size="24px" data-weight="regular">
            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
              <path
                d="M221.87,83.16A104.1,104.1,0,1,1,195.67,49l22.67-22.68a8,8,0,0,1,11.32,11.32l-96,96a8,8,0,0,1-11.32-11.32l27.72-27.72a40,40,0,1,0,17.87,31.09,8,8,0,1,1,16-.9,56,56,0,1,1-22.38-41.65L184.3,60.39a87.88,87.88,0,1,0,23.13,29.67,8,8,0,0,1,14.44-6.9Z"
              ></path>
            </svg>
          </div>
          <div class="flex flex-col justify-center">
            <p class="text-[#0d1b12] text-base font-medium leading-normal line-clamp-1">Goal Weight</p>
            <p class="text-[#4c9a66] text-sm font-normal leading-normal line-clamp-2">Set your goal weight</p>
          </div>
        </div>
        <h3 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">Notifications</h3>
        <div class="flex items-center gap-4 bg-[#f8fcf9] px-4 min-h-[72px] py-2 justify-between">
          <div class="flex items-center gap-4">
            <div class="text-[#0d1b12] flex items-center justify-center rounded-lg bg-[#e7f3eb] shrink-0 size-12" data-icon="Bell" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z"
                ></path>
              </svg>
            </div>
            <div class="flex flex-col justify-center">
              <p class="text-[#0d1b12] text-base font-medium leading-normal line-clamp-1">Meal Reminders</p>
              <p class="text-[#4c9a66] text-sm font-normal leading-normal line-clamp-2">Remind me about meals</p>
            </div>
          </div>
          <div class="shrink-0">
            <label
              class="relative flex h-[31px] w-[51px] cursor-pointer items-center rounded-full border-none bg-[#e7f3eb] p-0.5 has-[:checked]:justify-end has-[:checked]:bg-[#13ec5b]"
            >
              <div class="h-full w-[27px] rounded-full bg-white" style="box-shadow: rgba(0, 0, 0, 0.15) 0px 3px 8px, rgba(0, 0, 0, 0.06) 0px 3px 1px;"></div>
              <input type="checkbox" class="invisible absolute" />
            </label>
          </div>
        </div>
        <h3 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">Support</h3>
        <div class="flex items-center gap-4 bg-[#f8fcf9] px-4 min-h-[72px] py-2">
          <div class="text-[#0d1b12] flex items-center justify-center rounded-lg bg-[#e7f3eb] shrink-0 size-12" data-icon="Question" data-size="24px" data-weight="regular">
            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
              <path
                d="M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"
              ></path>
            </svg>
          </div>
          <div class="flex flex-col justify-center">
            <p class="text-[#0d1b12] text-base font-medium leading-normal line-clamp-1">Help &amp; FAQ</p>
            <p class="text-[#4c9a66] text-sm font-normal leading-normal line-clamp-2">Get help with the app</p>
          </div>
        </div>
      </div>
      <div>
        <div class="flex px-4 py-3">
          <button
            class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 flex-1 bg-[#e7f3eb] text-[#0d1b12] text-sm font-bold leading-normal tracking-[0.015em]"
          >
            <span class="truncate">Logout</span>
          </button>
        </div>
        <div class="flex gap-2 border-t border-[#e7f3eb] bg-[#f8fcf9] px-4 pb-3 pt-2">
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="House" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M218.83,103.77l-80-75.48a1.14,1.14,0,0,1-.11-.11,16,16,0,0,0-21.53,0l-.11.11L37.17,103.77A16,16,0,0,0,32,115.55V208a16,16,0,0,0,16,16H96a16,16,0,0,0,16-16V160h32v48a16,16,0,0,0,16,16h48a16,16,0,0,0,16-16V115.55A16,16,0,0,0,218.83,103.77ZM208,208H160V160a16,16,0,0,0-16-16H112a16,16,0,0,0-16,16v48H48V115.55l.11-.1L128,40l79.9,75.43.11.1Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Home</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="PresentationChart" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M216,40H136V24a8,8,0,0,0-16,0V40H40A16,16,0,0,0,24,56V176a16,16,0,0,0,16,16H79.36L57.75,219a8,8,0,0,0,12.5,10l29.59-37h56.32l29.59,37a8,8,0,1,0,12.5-10l-21.61-27H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,136H40V56H216V176ZM104,120v24a8,8,0,0,1-16,0V120a8,8,0,0,1,16,0Zm32-16v40a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm32-16v56a8,8,0,0,1-16,0V88a8,8,0,0,1,16,0Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Progress</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="Bell" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Notifications</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 rounded-full text-[#0d1b12]" href="#">
            <div class="text-[#0d1b12] flex h-8 items-center justify-center" data-icon="User" data-size="24px" data-weight="fill">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M230.93,220a8,8,0,0,1-6.93,4H32a8,8,0,0,1-6.92-12c15.23-26.33,38.7-45.21,66.09-54.16a72,72,0,1,1,73.66,0c27.39,8.95,50.86,27.83,66.09,54.16A8,8,0,0,1,230.93,220Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#0d1b12] text-xs font-medium leading-normal tracking-[0.015em]">Profile</p>
          </a>
        </div>
        <div class="h-5 bg-[#f8fcf9]"></div>
      </div>
    </div>
  </body>
</html>
</file>

<file path="Design/mobileapp/weight_tracking/code.html">
<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope%3Awght%40400%3B500%3B700%3B800&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div
      class="relative flex h-auto min-h-screen w-full flex-col bg-[#f8fcf9] justify-between group/design-root overflow-x-hidden"
      style='font-family: Manrope, "Noto Sans", sans-serif;'
    >
      <div>
        <div class="flex items-center bg-[#f8fcf9] p-4 pb-2 justify-between">
          <div class="text-[#0d1b12] flex size-12 shrink-0 items-center" data-icon="ArrowLeft" data-size="24px" data-weight="regular">
            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
              <path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path>
            </svg>
          </div>
          <h2 class="text-[#0d1b12] text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center pr-12">Weight Tracking</h2>
        </div>
        <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
          <label class="flex flex-col min-w-40 flex-1">
            <p class="text-[#0d1b12] text-base font-medium leading-normal pb-2">Current Weight</p>
            <input
              class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0d1b12] focus:outline-0 focus:ring-0 border-none bg-[#e7f3eb] focus:border-none h-14 placeholder:text-[#4c9a66] p-4 text-base font-normal leading-normal"
              value=""
            />
          </label>
        </div>
        <div class="flex flex-wrap gap-4 px-4 py-6">
          <div class="flex min-w-72 flex-1 flex-col gap-2">
            <p class="text-[#0d1b12] text-base font-medium leading-normal">Weight Progress</p>
            <p class="text-[#0d1b12] tracking-light text-[32px] font-bold leading-tight truncate">72.5 kg</p>
            <p class="text-[#4c9a66] text-base font-normal leading-normal">Last 8 Weeks</p>
            <div class="flex min-h-[180px] flex-1 flex-col gap-8 py-4">
              <svg width="100%" height="148" viewBox="-3 0 478 150" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
                <path
                  d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25V149H326.769H0V109Z"
                  fill="url(#paint0_linear_1131_5935)"
                ></path>
                <path
                  d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25"
                  stroke="#4c9a66"
                  stroke-width="3"
                  stroke-linecap="round"
                ></path>
                <defs>
                  <linearGradient id="paint0_linear_1131_5935" x1="236" y1="1" x2="236" y2="149" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#e7f3eb"></stop>
                    <stop offset="1" stop-color="#e7f3eb" stop-opacity="0"></stop>
                  </linearGradient>
                </defs>
              </svg>
              <div class="flex justify-around">
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">Week 1</p>
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">Week 2</p>
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">Week 3</p>
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">Week 4</p>
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">Week 5</p>
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">Week 6</p>
                <p class="text-[#4c9a66] text-[13px] font-bold leading-normal tracking-[0.015em]">Week 7</p>
              </div>
            </div>
          </div>
        </div>
        <div class="flex flex-col gap-3 p-4">
          <div class="flex gap-6 justify-between"><p class="text-[#0d1b12] text-base font-medium leading-normal">Goal: 65 kg</p></div>
          <div class="rounded bg-[#cfe7d7]"><div class="h-2 rounded bg-[#13ec5b]" style="width: 75%;"></div></div>
          <p class="text-[#4c9a66] text-sm font-normal leading-normal">7.5 kg to go</p>
        </div>
      </div>
      <div>
        <div class="flex justify-end overflow-hidden px-5 pb-5">
          <button
            class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-14 px-5 bg-[#13ec5b] text-[#0d1b12] text-base font-bold leading-normal tracking-[0.015em] min-w-0 gap-4 pl-4 pr-6"
          >
            <div class="text-[#0d1b12]" data-icon="PencilSimple" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31l88-88L180.69,120ZM192,108.68,147.31,64l24-24L216,84.68Z"
                ></path>
              </svg>
            </div>
            <span class="truncate">Update Weight</span>
          </button>
        </div>
        <div class="flex gap-2 border-t border-[#e7f3eb] bg-[#f8fcf9] px-4 pb-3 pt-2">
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="House" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M218.83,103.77l-80-75.48a1.14,1.14,0,0,1-.11-.11,16,16,0,0,0-21.53,0l-.11.11L37.17,103.77A16,16,0,0,0,32,115.55V208a16,16,0,0,0,16,16H96a16,16,0,0,0,16-16V160h32v48a16,16,0,0,0,16,16h48a16,16,0,0,0,16-16V115.55A16,16,0,0,0,218.83,103.77ZM208,208H160V160a16,16,0,0,0-16-16H112a16,16,0,0,0-16,16v48H48V115.55l.11-.1L128,40l79.9,75.43.11.1Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Home</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 rounded-full text-[#0d1b12]" href="#">
            <div class="text-[#0d1b12] flex h-8 items-center justify-center" data-icon="PresentationChart" data-size="24px" data-weight="fill">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M216,40H136V24a8,8,0,0,0-16,0V40H40A16,16,0,0,0,24,56V176a16,16,0,0,0,16,16H79.36L57.75,219a8,8,0,0,0,12.5,10l29.59-37h56.32l29.59,37a8,8,0,1,0,12.5-10l-21.61-27H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM104,144a8,8,0,0,1-16,0V120a8,8,0,0,1,16,0Zm32,0a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm32,0a8,8,0,0,1-16,0V88a8,8,0,0,1,16,0Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#0d1b12] text-xs font-medium leading-normal tracking-[0.015em]">Progress</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="Bell" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Notifications</p>
          </a>
          <a class="just flex flex-1 flex-col items-center justify-end gap-1 text-[#4c9a66]" href="#">
            <div class="text-[#4c9a66] flex h-8 items-center justify-center" data-icon="User" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path
                  d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"
                ></path>
              </svg>
            </div>
            <p class="text-[#4c9a66] text-xs font-medium leading-normal tracking-[0.015em]">Profile</p>
          </a>
        </div>
        <div class="h-5 bg-[#f8fcf9]"></div>
      </div>
    </div>
  </body>
</html>
</file>

<file path="Design/website/Design/analytics/progress/code.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Dietician Dashboard</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#4A90E2",
              "secondary": "#50E3C2",
              "danger": "#F5A623",
              "background-light": "#F4F7FA",
              "background-dark": "#112116",
              "neutral-text": "#4A4A4A",
              "neutral-border": "#E0E0E0",
            },
            fontFamily: {
              "display": ["Inter", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
<style>
        .material-symbols-outlined {
            font-variation-settings:
            'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24
        }
    </style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-neutral-text dark:text-gray-200">
<div class="relative flex min-h-screen w-full flex-col">
<div class="flex h-full flex-1">
<!-- SideNavBar -->
<aside class="flex w-64 flex-col gap-8 border-r border-neutral-border/80 bg-white dark:bg-background-dark dark:border-neutral-border/20 p-4">
<div class="flex items-center gap-3 px-2">
<span class="material-symbols-outlined text-primary text-3xl">health_and_safety</span>
<h1 class="text-xl font-bold text-neutral-text dark:text-white">NutriTrack</h1>
</div>
<div class="flex h-full flex-col justify-between">
<div class="flex flex-col gap-2">
<a class="flex items-center gap-3 rounded-lg bg-primary/20 dark:bg-primary/30 px-3 py-2 text-primary dark:text-white" href="#">
<span class="material-symbols-outlined">dashboard</span>
<p class="text-sm font-semibold">Dashboard</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 text-neutral-text/80 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/10" href="#">
<span class="material-symbols-outlined">group</span>
<p class="text-sm font-medium">Clients</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 text-neutral-text/80 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/10" href="#">
<span class="material-symbols-outlined">chat_bubble</span>
<p class="text-sm font-medium">Messages</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 text-neutral-text/80 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/10" href="#">
<span class="material-symbols-outlined">settings</span>
<p class="text-sm font-medium">Settings</p>
</a>
</div>
<div class="flex flex-col">
<div class="mb-4 flex gap-3 border-t border-neutral-border/80 dark:border-neutral-border/20 pt-4">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Dr. Emily Carter" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuA96o5wzzpqKQwmSanszsJuVP8eH5xjp8ZNsLL7hXw8hJK01o9Amkz2ZoxXpeKj0XfzckJzsJ7uXIEznoSEYfNAoHjGxFRu-V_B1xP0E5yzRy44iBtBRIi3m3eSm35bzyCu5xgB44faAVd9OS9V3j6HdKomQCR6Sy1jPvt7LL0UKmH11dgtZVVvbcLMTZKNa2P6kAStJ-ektWtNo8FeLY6MnKqNK0H_bXLuUmCzGjbQ8h3r5y66nagMsh3Lt0nJQdNmVWbrSjjIsuZL");'></div>
<div class="flex flex-col">
<h1 class="text-neutral-text dark:text-white text-base font-medium leading-normal">Dr. Emily Carter</h1>
<p class="text-neutral-text/70 dark:text-gray-400 text-sm font-normal leading-normal">Dietician</p>
</div>
</div>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 text-neutral-text/80 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/10" href="#">
<span class="material-symbols-outlined">logout</span>
<p class="text-sm font-medium">Log Out</p>
</a>
</div>
</div>
</aside>
<!-- Main Content -->
<main class="flex-1 overflow-y-auto p-8">
<div class="mx-auto flex w-full max-w-7xl flex-col gap-8">
<!-- PageHeading & Chips -->
<div class="flex flex-wrap items-start justify-between gap-4">
<div class="flex flex-col gap-2">
<p class="text-3xl font-bold leading-tight tracking-tight text-neutral-text dark:text-white">Progress Overview</p>
<p class="text-base font-normal leading-normal text-neutral-text/70 dark:text-gray-400">Here is your clients' progress for this month.</p>
</div>
<div class="flex items-center gap-2">
<div class="flex gap-2">
<button class="flex h-10 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-white dark:bg-white/10 px-4 text-neutral-text dark:text-gray-200 shadow-sm border border-neutral-border dark:border-neutral-border/20">
<p class="text-sm font-medium leading-normal">This Month</p>
<span class="material-symbols-outlined text-lg">expand_more</span>
</button>
</div>
<button class="flex h-10 cursor-pointer items-center justify-center overflow-hidden rounded-lg bg-primary px-4 text-white text-sm font-bold shadow-sm">
<span class="truncate">Export Report</span>
</button>
</div>
</div>
<!-- Stats -->
<div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
<div class="flex flex-1 flex-col gap-2 rounded-xl bg-white dark:bg-background-dark p-6 shadow-sm border border-neutral-border dark:border-neutral-border/20">
<p class="text-base font-medium leading-normal text-neutral-text dark:text-gray-300">Total Clients This Month</p>
<p class="tracking-light text-3xl font-bold leading-tight text-neutral-text dark:text-white">42</p>
<div class="flex items-center gap-1 text-secondary">
<span class="material-symbols-outlined text-lg">arrow_upward</span>
<p class="text-sm font-medium leading-normal">+5%</p>
</div>
</div>
<div class="flex flex-1 flex-col gap-2 rounded-xl bg-white dark:bg-background-dark p-6 shadow-sm border border-neutral-border dark:border-neutral-border/20">
<p class="text-base font-medium leading-normal text-neutral-text dark:text-gray-300">Overall Adherence</p>
<p class="tracking-light text-3xl font-bold leading-tight text-neutral-text dark:text-white">85%</p>
<div class="flex items-center gap-1 text-secondary">
<span class="material-symbols-outlined text-lg">arrow_upward</span>
<p class="text-sm font-medium leading-normal">+2.1%</p>
</div>
</div>
<div class="flex flex-1 flex-col gap-2 rounded-xl bg-white dark:bg-background-dark p-6 shadow-sm border border-neutral-border dark:border-neutral-border/20">
<p class="text-base font-medium leading-normal text-neutral-text dark:text-gray-300">Avg. Weight Loss</p>
<p class="tracking-light text-3xl font-bold leading-tight text-neutral-text dark:text-white">2.5 lbs</p>
<div class="flex items-center gap-1 text-danger">
<span class="material-symbols-outlined text-lg">arrow_downward</span>
<p class="text-sm font-medium leading-normal">-0.5 lbs</p>
</div>
</div>
</div>
<!-- Charts -->
<div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
<div class="flex flex-1 flex-col gap-2 rounded-xl border border-neutral-border dark:border-neutral-border/20 bg-white dark:bg-background-dark p-6 shadow-sm">
<p class="text-base font-medium leading-normal text-neutral-text dark:text-gray-300">Meals Logged Per Week</p>
<p class="tracking-light text-3xl font-bold leading-tight truncate text-neutral-text dark:text-white">1,234</p>
<div class="flex items-center gap-1">
<p class="text-sm font-normal leading-normal text-neutral-text/70 dark:text-gray-400">Last 8 Weeks</p>
<p class="text-sm font-medium leading-normal text-secondary">+12%</p>
</div>
<div class="flex min-h-[180px] flex-1 flex-col gap-8 py-4">
<svg fill="none" height="100%" preserveaspectratio="none" viewbox="-3 0 478 150" width="100%" xmlns="http://www.w3.org/2000/svg">
<path d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25V149H326.769H0V109Z" fill="url(#chart-gradient-1)"></path>
<path d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25" stroke="#4A90E2" stroke-linecap="round" stroke-width="3"></path>
<defs>
<lineargradient gradientunits="userSpaceOnUse" id="chart-gradient-1" x1="236" x2="236" y1="1" y2="149">
<stop stop-color="#4A90E2" stop-opacity="0.2"></stop>
<stop offset="1" stop-color="#4A90E2" stop-opacity="0"></stop>
</lineargradient>
</defs>
</svg>
</div>
</div>
<div class="flex flex-1 flex-col gap-2 rounded-xl border border-neutral-border dark:border-neutral-border/20 bg-white dark:bg-background-dark p-6 shadow-sm">
<p class="text-base font-medium leading-normal text-neutral-text dark:text-gray-300">Adherence Over Time</p>
<p class="tracking-light text-3xl font-bold leading-tight truncate text-neutral-text dark:text-white">85%</p>
<div class="flex items-center gap-1">
<p class="text-sm font-normal leading-normal text-neutral-text/70 dark:text-gray-400">Last 90 Days</p>
<p class="text-sm font-medium leading-normal text-secondary">+2.1%</p>
</div>
<div class="flex min-h-[180px] flex-1 flex-col gap-8 py-4">
<svg fill="none" height="100%" preserveaspectratio="none" viewbox="-3 0 478 150" width="100%" xmlns="http://www.w3.org/2000/svg">
<path d="M0 81C18.1538 81 18.1538 121 36.3077 121C54.4615 121 54.4615 101 72.6154 101C90.7692 101 90.7692 61 108.923 61C127.077 61 127.077 33 145.231 33C163.385 33 163.385 41 181.538 41C199.692 41 199.692 21 217.846 21C236 21 236 45 254.154 45C272.308 45 272.308 1 290.462 1C308.615 1 308.615 25 326.769 25C344.923 25 344.923 81 363.077 81C381.231 81 381.231 109 399.385 109C417.538 109 417.538 129 435.692 129C453.846 129 453.846 149 472 149V149H0V81Z" fill="url(#chart-gradient-2)"></path>
<path d="M0 81C18.1538 81 18.1538 121 36.3077 121C54.4615 121 54.4615 101 72.6154 101C90.7692 101 90.7692 61 108.923 61C127.077 61 127.077 33 145.231 33C163.385 33 163.385 41 181.538 41C199.692 41 199.692 21 217.846 21C236 21 236 45 254.154 45C272.308 45 272.308 1 290.462 1C308.615 1 308.615 25 326.769 25C344.923 25 344.923 81 363.077 81C381.231 81 381.231 109 399.385 109C417.538 109 417.538 129 435.692 129C453.846 129 453.846 149 472 149" stroke="#4A90E2" stroke-linecap="round" stroke-width="3"></path>
<defs>
<lineargradient gradientunits="userSpaceOnUse" id="chart-gradient-2" x1="236" x2="236" y1="1" y2="149">
<stop stop-color="#4A90E2" stop-opacity="0.2"></stop>
<stop offset="1" stop-color="#4A90E2" stop-opacity="0"></stop>
</lineargradient>
</defs>
</svg>
</div>
</div>
</div>
<!-- Client Tables -->
<div class="grid grid-cols-1 gap-6 xl:grid-cols-2">
<div class="flex flex-col gap-4 rounded-xl border border-neutral-border dark:border-neutral-border/20 bg-white dark:bg-background-dark p-6 shadow-sm">
<h3 class="text-lg font-semibold text-neutral-text dark:text-white">Top Clients by Progress</h3>
<div class="overflow-x-auto">
<table class="w-full text-left">
<thead>
<tr class="border-b border-neutral-border dark:border-neutral-border/20">
<th class="p-3 text-sm font-semibold text-neutral-text/70 dark:text-gray-400">Client Name</th>
<th class="p-3 text-sm font-semibold text-neutral-text/70 dark:text-gray-400">Progress</th>
<th class="p-3 text-sm font-semibold text-neutral-text/70 dark:text-gray-400">Adherence</th>
</tr>
</thead>
<tbody>
<tr class="border-b border-neutral-border dark:border-neutral-border/20">
<td class="p-3 whitespace-nowrap"><div class="flex items-center gap-3"><img class="size-8 rounded-full object-cover" data-alt="Client avatar" src="https://lh3.googleusercontent.com/aida-public/AB6AXuDoQBH58-UOFb0Rve-570SZJHw1vywLmyD9bBbGA8r8yRZL1mefbhhG_ZWz1vtoh7Xz7oMO20OhnWAStn4MlFVxGdmCXduy9BICGw-C4qTsSTyXb5mLI8kY-PiTQsu1Mh3YeeBNUp6j40CcGHSOOcz9dwZ8mJAy5G-yg118GiDa1te_CWf6kQ85NnGQxDdTArPD2FHccLUcjZQ2RWS01COkPyfPwwNXV4HCwGml86o4O5gA2YBEoZ-zehhddqazpsdkBKTo3CDzdEed"/><span class="font-medium text-neutral-text dark:text-gray-200">Olivia Martinez</span></div></td>
<td class="p-3 text-sm text-secondary font-medium">-8 lbs</td>
<td class="p-3 text-sm text-neutral-text dark:text-gray-300">95%</td>
</tr>
<tr class="border-b border-neutral-border dark:border-neutral-border/20">
<td class="p-3 whitespace-nowrap"><div class="flex items-center gap-3"><img class="size-8 rounded-full object-cover" data-alt="Client avatar" src="https://lh3.googleusercontent.com/aida-public/AB6AXuBsevW0g05AmLMZmT39Kvmun2gqseQGYbSJpkMgrVn7jn3Fuy0Lw_UQodlK7uiRbtbolVuocHp8Igm51E8asjsFb8FLC8f1I5CeAlQ9ryhSmDWnQ1tW3IVjfE6ahrehdQm7crHK9N-fF8VgqRUs7_xC0YkiNo44EX7ycOPr00INSkWlOpErD_FEAb0pePAhWsjonBmoZeGxCjofR1z3KMrtT7JeLw7qOseZ1sUH2t4moJRAaALDkq0jSFv1eB3YiP_3pIvsc2xceNUg"/><span class="font-medium text-neutral-text dark:text-gray-200">Liam Wilson</span></div></td>
<td class="p-3 text-sm text-secondary font-medium">-7.5 lbs</td>
<td class="p-3 text-sm text-neutral-text dark:text-gray-300">92%</td>
</tr>
<tr>
<td class="p-3 whitespace-nowrap"><div class="flex items-center gap-3"><img class="size-8 rounded-full object-cover" data-alt="Client avatar" src="https://lh3.googleusercontent.com/aida-public/AB6AXuBuJr8JpLuLZFYFIC5zGyoB09MhvwSiktgyQxCyqTxnwJCBna4H-XozQm2NkT_XmatpfO7GgPG_-sUXtbSKxpBze4Tx8eTwx70X4ZShfv_e4R-eJY82twmGjnMJqBLr3hdiXKDHIMpRK0WqcJG2ir7B-IEzMk45yvfzyWEtmcqrikGYhn0CBhDKxZvB4zeS2rVkejxDgpJkM_xrrAv_-IIDbUsQbKNyF58plDfVrmkFI4vUGJEeDK2_71ndZakWOsb3aeay9h0eaMJo"/><span class="font-medium text-neutral-text dark:text-gray-200">Sophia Garcia</span></div></td>
<td class="p-3 text-sm text-secondary font-medium">-6 lbs</td>
<td class="p-3 text-sm text-neutral-text dark:text-gray-300">88%</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="flex flex-col gap-4 rounded-xl border border-neutral-border dark:border-neutral-border/20 bg-white dark:bg-background-dark p-6 shadow-sm">
<h3 class="text-lg font-semibold text-neutral-text dark:text-white">At-Risk Clients</h3>
<div class="overflow-x-auto">
<table class="w-full text-left">
<thead>
<tr class="border-b border-neutral-border dark:border-neutral-border/20">
<th class="p-3 text-sm font-semibold text-neutral-text/70 dark:text-gray-400">Client Name</th>
<th class="p-3 text-sm font-semibold text-neutral-text/70 dark:text-gray-400">Last Logged</th>
<th class="p-3 text-sm font-semibold text-neutral-text/70 dark:text-gray-400">Action</th>
</tr>
</thead>
<tbody>
<tr class="border-b border-neutral-border dark:border-neutral-border/20">
<td class="p-3 whitespace-nowrap"><div class="flex items-center gap-3"><img class="size-8 rounded-full object-cover" data-alt="Client avatar" src="https://lh3.googleusercontent.com/aida-public/AB6AXuDvfeBZRNDokJuyigYOf7swYYkUhcZeq8Xa__GY1nx6LPsRIBkKOlm-X3S7CCX9TkVhl50-V4XS5_A8paBFtAwCvhjQJr0y6s7CMQBVw5YLwOHBysOvxVZi_68LD9nk2jz4bov0dRPbT_bKffz_dM8MEl2HfxLPSjVkOA-wZ3pKD25NciXlckzsqa7HR9hQqn5gLPd3z6ZH2zqSpffTGClkOHqPk8_tF7y-SFjW19J2ixpk6UZDKuEeJQun3yB7i0emQuAeiFNuOpT_"/><span class="font-medium text-neutral-text dark:text-gray-200">Noah Rodriguez</span></div></td>
<td class="p-3"><span class="rounded-full bg-danger/20 px-2 py-1 text-xs font-medium text-danger dark:bg-danger/30 dark:text-yellow-300">5 days ago</span></td>
<td class="p-3"><button class="h-8 rounded-lg border border-primary px-3 text-xs font-bold text-primary hover:bg-primary/10">Contact</button></td>
</tr>
<tr class="border-b border-neutral-border dark:border-neutral-border/20">
<td class="p-3 whitespace-nowrap"><div class="flex items-center gap-3"><img class="size-8 rounded-full object-cover" data-alt="Client avatar" src="https://lh3.googleusercontent.com/aida-public/AB6AXuBcaW5B33q5kD_u9KGU3AmSxrvuahqJcGW6n9otbtVf88GpP8aicI8-eJU_L2uxIrmjxYYF-HsJ4rOIU16cHSq4VShtus50x3FchpFU5qgnHissAlF4UUa9am4VBvRQ6cP0jZ2BYkwSHFaUVeCFtgvNkYIXu8rH1rEX7LBN0CaQ1PXePQ2-GZhg9BwMAUawPHKdHVS85pvHELEF0KNPHW31XAiD_1Huk-FyVfc5B9TxLfkfuFXyqcn5MrQkxJ-yQGOFHXk-CjvrMkkF"/><span class="font-medium text-neutral-text dark:text-gray-200">Isabella Lee</span></div></td>
<td class="p-3"><span class="rounded-full bg-danger/20 px-2 py-1 text-xs font-medium text-danger dark:bg-danger/30 dark:text-yellow-300">8 days ago</span></td>
<td class="p-3"><button class="h-8 rounded-lg border border-primary px-3 text-xs font-bold text-primary hover:bg-primary/10">Contact</button></td>
</tr>
<tr>
<td class="p-3 whitespace-nowrap"><div class="flex items-center gap-3"><img class="size-8 rounded-full object-cover" data-alt="Client avatar" src="https://lh3.googleusercontent.com/aida-public/AB6AXuBly7oECncXOyMEjr6iphhmrneD1AviVdZkSUpLQA2lkn74vpCkxrCpQFQ67rmXAuCivi006wjpKgz27JIm2Y0aSnM_XeQrKvT3jBNwdgHdquAMoQ0arCckvwvW3Z76evPk8qKbI4Ae8Zkbk1_8_UVlzdp1MBl1W1Y4K-YkKeImSU7MoKgODtdkfD-TGmGxFEeTzRDxARqW3xLoSie2G5tHzo2xlwQxDHD7FHrJ3PntCtppTtQlj8-_XrYOFHlAcBLgT_1XovuBL7sJ"/><span class="font-medium text-neutral-text dark:text-gray-200">James Walker</span></div></td>
<td class="p-3"><span class="rounded-full bg-danger/20 px-2 py-1 text-xs font-medium text-danger dark:bg-danger/30 dark:text-yellow-300">12 days ago</span></td>
<td class="p-3"><button class="h-8 rounded-lg border border-primary px-3 text-xs font-bold text-primary hover:bg-primary/10">Contact</button></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</main>
</div>
</div>
</body></html>
</file>

<file path="Design/website/Design/client_list/code.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Clients Dashboard</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#2E8B57",
                        "background-light": "#f6f8f6",
                        "background-dark": "#112116",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style>
        .material-symbols-outlined {
            font-variation-settings:
                'FILL' 0,
                'wght' 400,
                'GRAD' 0,
                'opsz' 24;
            font-size: 24px;
        }

        .material-symbols-outlined.fill {
            font-variation-settings:
                'FILL' 1,
                'wght' 400,
                'GRAD' 0,
                'opsz' 24
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-[#333333] dark:text-gray-200">
<div class="relative flex min-h-screen w-full">
<!-- SideNavBar -->
<aside class="flex flex-col w-64 bg-background-light dark:bg-background-dark border-r border-gray-200 dark:border-gray-700 p-4">
<div class="flex flex-col gap-4">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Dr. Evelyn Reed" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCVKYm04hSTTeeF3YO6cfvZlMYr1q04JowA4yldgWIrDtLeAt4sMI9U0aXqoDOePN7ZIe8rRe-Fa6Bm-tGrQlkdpOYzox3JUw-bfj2v1G0D8vTudIUoXSmjj06sKkvj2juoov0_vWpK-OgEOu6mL-IeGEPHlV21lH1vSyetcobaoyXbty1cWjlxSOOiCAYFqHsKXoAGeTq7gyALhozqZU8KvRR5UYL41Jy-VYOMtukDUi_f9B5BwtBv-IJsJ9lMmIEgYDahCDGBfdXi");'></div>
<div class="flex flex-col">
<h1 class="text-[#333333] dark:text-gray-100 text-base font-medium leading-normal">Dr. Evelyn Reed</h1>
<p class="text-primary text-sm font-normal leading-normal">Dietician</p>
</div>
</div>
<nav class="flex flex-col gap-2 mt-4">
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-[#333333] dark:text-gray-300 hover:bg-primary/20 dark:hover:bg-primary/30" href="#">
<span class="material-symbols-outlined">dashboard</span>
<p class="text-sm font-medium leading-normal">Dashboard</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg bg-primary/20 dark:bg-primary/30 text-primary font-bold" href="#">
<span class="material-symbols-outlined fill">group</span>
<p class="text-sm font-medium leading-normal">Clients</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-[#333333] dark:text-gray-300 hover:bg-primary/20 dark:hover:bg-primary/30" href="#">
<span class="material-symbols-outlined">mail</span>
<p class="text-sm font-medium leading-normal">Messages</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-[#333333] dark:text-gray-300 hover:bg-primary/20 dark:hover:bg-primary/30" href="#">
<span class="material-symbols-outlined">calendar_month</span>
<p class="text-sm font-medium leading-normal">Appointments</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-[#333333] dark:text-gray-300 hover:bg-primary/20 dark:hover:bg-primary/30" href="#">
<span class="material-symbols-outlined">bar_chart</span>
<p class="text-sm font-medium leading-normal">Reports</p>
</a>
</nav>
</div>
<div class="mt-auto flex flex-col gap-1">
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-[#333333] dark:text-gray-300 hover:bg-primary/20 dark:hover:bg-primary/30" href="#">
<span class="material-symbols-outlined">settings</span>
<p class="text-sm font-medium leading-normal">Settings</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-[#333333] dark:text-gray-300 hover:bg-primary/20 dark:hover:bg-primary/30" href="#">
<span class="material-symbols-outlined">help</span>
<p class="text-sm font-medium leading-normal">Help</p>
</a>
</div>
</aside>
<!-- Main Content -->
<main class="flex-1 p-8 overflow-y-auto">
<div class="max-w-7xl mx-auto">
<!-- PageHeading -->
<header class="flex flex-wrap justify-between items-center gap-4 mb-6">
<h1 class="text-[#333333] dark:text-gray-100 text-4xl font-black leading-tight tracking-[-0.033em]">Clients</h1>
<button class="flex items-center justify-center gap-2 h-10 px-4 bg-primary text-white rounded-lg text-sm font-medium shadow-sm hover:bg-primary/90 transition-colors">
<span class="material-symbols-outlined">add</span>
                        Add New Client
                    </button>
</header>
<!-- Search and Filters -->
<div class="flex flex-col md:flex-row gap-4 mb-6">
<!-- SearchBar -->
<div class="flex-grow">
<label class="flex flex-col h-12 w-full">
<div class="flex w-full flex-1 items-stretch rounded-lg h-full bg-gray-100 dark:bg-gray-800">
<div class="text-primary flex items-center justify-center pl-4">
<span class="material-symbols-outlined">search</span>
</div>
<input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden text-[#333333] dark:text-gray-200 focus:outline-0 focus:ring-0 border-none bg-transparent h-full placeholder:text-gray-500 dark:placeholder:text-gray-400 pl-2 text-base font-normal leading-normal" placeholder="Search by name, phone, or email..." value=""/>
</div>
</label>
</div>
<!-- Chips -->
<div class="flex gap-2 p-2 items-center flex-wrap">
<button class="flex h-8 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-primary text-white px-4">
<p class="text-sm font-medium leading-normal">All</p>
</button>
<button class="flex h-8 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-gray-200 dark:bg-gray-700 px-4 text-[#333333] dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600">
<p class="text-sm font-medium leading-normal">Active</p>
</button>
<button class="flex h-8 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-gray-200 dark:bg-gray-700 px-4 text-[#333333] dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600">
<p class="text-sm font-medium leading-normal">At risk</p>
</button>
<button class="flex h-8 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-gray-200 dark:bg-gray-700 px-4 text-[#333333] dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600">
<p class="text-sm font-medium leading-normal">Completed</p>
</button>
</div>
</div>
<!-- Table -->
<div class="overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700 bg-background-light dark:bg-background-dark">
<div class="overflow-x-auto">
<table class="w-full">
<thead>
<tr class="bg-gray-50 dark:bg-gray-800">
<th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Client</th>
<th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Phone</th>
<th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Weight (current/goal)</th>
<th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Dietician</th>
<th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Last Activity</th>
<th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
</tr>
</thead>
<tbody class="divide-y divide-gray-200 dark:divide-gray-700">
<tr class="hover:bg-gray-50 dark:hover:bg-gray-800/50">
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Liam Johnson" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuClpPYXi8g_JHAhR2x5GUM2eOMNTlq9zyAkLAxumUuxoG2g-daiIuVU0KkukCkEJkCCPViwSSTZYT-q3TRXuV_uYbnIhzZgKnDMhnC38JIrqViDc2xPN7meycyowvPFec9W2fdlPbqfwLcjXGsZNx_gcovpjuMSyrlqCR-SBpKZvtAHFEB0KwG1mrfN2cBxTzJTDGuG-6R9rUPLKw3nj7iHuqUvyspTNg_6NqOsrvfW7vMErxFKG_PVt37_XLZH-5YPVok2svg_69Ja");'></div>
<span class="font-medium">Liam Johnson</span>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">(555) 123-4567</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">155 lbs / 150 lbs</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">Dr. Reed</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">2 days ago</td>
<td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
<div class="flex items-center gap-2">
<button class="text-primary hover:underline">View</button>
<button class="text-primary hover:underline">Message</button>
<button class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"><span class="material-symbols-outlined">more_vert</span></button>
</div>
</td>
</tr>
<tr class="hover:bg-gray-50 dark:hover:bg-gray-800/50">
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Olivia Smith" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCRkdQpFiXZdrd2gCSIwJISAKEwTt4rLdkzgH7gFGmAjzEyyzmAg5Fjr-QEA139Ucmo1d9SYuaSvoEIooB5MatX2cKZCQmyqmq_Wk7Rw6jX-rgn3qO6t6rMIT2LFmhX_S15hx2ppXx11AMwCOnq0R3N4zOb-VCh4dvwJC22p5YDMS27t5qa21xZ0RzKc5ZC-_T4v0cXqZ3xF5hxacE3tV18yUl059ff7BQLiI3nuKA8JSg_zVOc9bmFulmrO9MOWzBk3O0g-BM2Guza");'></div>
<div class="flex items-center gap-2">
<span class="font-medium">Olivia Smith</span>
<div class="size-2.5 rounded-full bg-[#F5A623]" data-alt="At risk status indicator"></div>
</div>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">(555) 987-6543</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">130 lbs / 125 lbs</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">Dr. Reed</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">1 day ago</td>
<td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
<div class="flex items-center gap-2">
<button class="text-primary hover:underline">View</button>
<button class="text-primary hover:underline">Message</button>
<button class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"><span class="material-symbols-outlined">more_vert</span></button>
</div>
</td>
</tr>
<tr class="hover:bg-gray-50 dark:hover:bg-gray-800/50">
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Noah Brown" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCQNLWfd8V00kqcYfX5nTyRd92GGtqAqz6x-M02AwjIonTgK0Eh9M6jMrcwaUfFqilM2UI8EOxB4gOGrfzuaS8dbDQE9suhVpYEj7N_MBEr3i-ZSN-yzX8AdfR3hpOdnO70SjAu4dpsrTGt4cCQRkDH7pjcOgZ2lln7mAMgdk7ai476WszDe2Z5VL44iGGaG5c3wi7yt8HBa35Ai3iMpJUmdau-SCRfasQnQhgXVUy83P27gwIERA3E9_rBEdoDheESznzC2poQox_L");'></div>
<span class="font-medium">Noah Brown</span>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">(555) 234-5678</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">180 lbs / 170 lbs</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">Dr. Singh</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">5 days ago</td>
<td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
<div class="flex items-center gap-2">
<button class="text-primary hover:underline">View</button>
<button class="text-primary hover:underline">Message</button>
<button class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"><span class="material-symbols-outlined">more_vert</span></button>
</div>
</td>
</tr>
<tr class="hover:bg-gray-50 dark:hover:bg-gray-800/50">
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Emma Davis" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBnjMX4DmGvAS29EbxSzQYEZjxHy-eM9BOPRQ4gWnYGbvjvINY2ISuzCIi0n9IpgPJC0eze--mOIYEdei2MVwpu7MB2JAhUpgL0I4VDuBErBiPA8CmlIsXSAQQ86a2jQZeDf9nB8x6S34OaTifpDwpqo6OBDq4IslVPXXiJxB2YzcH382_MA_V_x067EC3hdQN7xJ9BqkhKZKJLIeEcZ939x1apYskf21NeDetpQYcLKsu04GVj6Aw5hCgx98EIzqJvVoFz4AvPzSeJ");'></div>
<span class="font-medium">Emma Davis</span>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">(555) 876-5432</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">145 lbs / 140 lbs</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">Dr. Reed</td>
<td class="px-6 py-4 whitespace-nowrap text-gray-600 dark:text-gray-300">1 week ago</td>
<td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
<div class="flex items-center gap-2">
<button class="text-primary hover:underline">View</button>
<button class="text-primary hover:underline">Message</button>
<button class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"><span class="material-symbols-outlined">more_vert</span></button>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<!-- Pagination -->
<div class="flex items-center justify-between mt-6 px-1">
<p class="text-sm text-gray-600 dark:text-gray-400">
                        Showing <span class="font-medium">1</span>-<span class="font-medium">10</span> of <span class="font-medium">86</span> clients
                    </p>
<div class="flex items-center gap-2">
<button class="flex items-center justify-center size-9 rounded-lg border border-gray-300 dark:border-gray-600 bg-background-light dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50" disabled="">
<span class="material-symbols-outlined text-lg">chevron_left</span>
</button>
<button class="flex items-center justify-center size-9 rounded-lg border border-gray-300 dark:border-gray-600 bg-background-light dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700">
<span class="material-symbols-outlined text-lg">chevron_right</span>
</button>
</div>
</div>
</div>
</main>
</div>
</body></html>
</file>

<file path="Design/website/Design/client_profile_view/code.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Client Profile Dashboard</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#17cf54",
              "background-light": "#f6f8f6",
              "background-dark": "#112116",
              "surface-light": "#ffffff",
              "surface-dark": "#1a2c20",
              "text-primary-light": "#0e1b12",
              "text-primary-dark": "#e8f3ec",
              "text-secondary-light": "#4e9767",
              "text-secondary-dark": "#a3d3b3",
            },
            fontFamily: {
              "display": ["Inter", "sans-serif"]
            },
            borderRadius: {
              "DEFAULT": "0.25rem",
              "lg": "0.5rem",
              "xl": "0.75rem",
              "full": "9999px"
            },
          },
        },
      }
    </script>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            font-size: 24px;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-text-primary-light dark:text-text-primary-dark">
<div class="relative flex min-h-screen w-full flex-col">
<div class="flex h-full grow flex-row">
<!-- SideNavBar -->
<aside class="flex w-64 flex-col justify-between border-r border-gray-200/50 dark:border-white/10 bg-surface-light dark:bg-surface-dark p-4">
<div class="flex flex-col gap-4">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Dr. Emily Carter" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBeuNG6PVKxJgMaU8p57o3Zf3xoBswZ9iiX-l7Y-1MJ4PoFjqP0647K7fs-mEW3NdVeDw48VyGfgL8d4knMqShcWyrkf1GBkHmeSj7ARnkJTmGtj3P61fJsgjL3QVEIz1_SO06yTWzKqPVRtYEjSY68ADIPe8JzQFJJXMJtvxIPzvJSaM1fRqkWYj9VH4A_GU5dT02o6FiQwuz3GC77mXhqyGSX6xtz0fcXaRMdLcnpkCfL9NvC_4XnyXb7s8IUApqSIqq_UUzDmgNO");'></div>
<div class="flex flex-col">
<h1 class="text-text-primary-light dark:text-text-primary-dark text-base font-medium leading-normal">Dr. Emily Carter</h1>
<p class="text-text-secondary-light dark:text-text-secondary-dark text-sm font-normal leading-normal">Dietician</p>
</div>
</div>
<nav class="flex flex-col gap-2">
<a class="flex items-center gap-3 rounded-lg px-3 py-2 text-text-primary-light dark:text-text-primary-dark hover:bg-primary/10" href="#">
<span class="material-symbols-outlined">dashboard</span>
<p class="text-sm font-medium leading-normal">Dashboard</p>
</a>
<a class="flex items-center gap-3 rounded-lg bg-primary/20 px-3 py-2 text-text-primary-light dark:text-text-primary-dark" href="#">
<span class="material-symbols-outlined" style="font-variation-settings: 'FILL' 1;">group</span>
<p class="text-sm font-medium leading-normal">Clients</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 text-text-primary-light dark:text-text-primary-dark hover:bg-primary/10" href="#">
<span class="material-symbols-outlined">chat_bubble</span>
<p class="text-sm font-medium leading-normal">Messages</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 text-text-primary-light dark:text-text-primary-dark hover:bg-primary/10" href="#">
<span class="material-symbols-outlined">menu_book</span>
<p class="text-sm font-medium leading-normal">Meal Plans</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 text-text-primary-light dark:text-text-primary-dark hover:bg-primary/10" href="#">
<span class="material-symbols-outlined">settings</span>
<p class="text-sm font-medium leading-normal">Settings</p>
</a>
</nav>
</div>
<div class="flex flex-col gap-1">
<a class="flex items-center gap-3 rounded-lg px-3 py-2 text-text-primary-light dark:text-text-primary-dark hover:bg-primary/10" href="#">
<span class="material-symbols-outlined">help</span>
<p class="text-sm font-medium leading-normal">Help Center</p>
</a>
</div>
</aside>
<!-- Main Content -->
<main class="flex-1 overflow-y-auto">
<div class="mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8">
<!-- ToolBar & ProfileHeader -->
<header class="flex flex-col gap-6">
<div class="flex flex-wrap items-center justify-between gap-4">
<button class="flex items-center gap-2 p-2 text-text-secondary-light dark:text-text-secondary-dark hover:text-text-primary-light dark:hover:text-text-primary-dark">
<span class="material-symbols-outlined">arrow_back</span>
<span class="text-sm font-medium">Back to Clients</span>
</button>
<button class="flex items-center justify-center gap-2 rounded-lg bg-primary px-4 h-10 text-sm font-bold leading-normal text-white hover:opacity-90">
<span class="material-symbols-outlined" style="font-size: 20px; font-variation-settings: 'FILL' 1;">send</span>
<span>Send Message</span>
</button>
</div>
<div class="flex w-full flex-col gap-4 @container md:flex-row md:items-center md:justify-between">
<div class="flex items-center gap-4">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-24 w-24 md:h-32 md:w-32" data-alt="Profile picture of Jessica Williams" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCjxoEAsPbVDDUJ8ik9VOO2la8Ji7KmbvWzMTY9siKHHBAhFQ3_ETlPgiD74BvHpYTbafsVCIHi-H1jaSkc5y1iGkoQU-1ssp1qUBSO3JYD8Ryqvo1QHBuXING_xj8THqMEB3S3o-ZTjK4O2cfNk_renQ1EQtmCxejE4CeH2I8INEojOtdzSQUIECfdvuDVVcjY18ELEDBfGGCGe1ArAZZ7K_HqWdjjK_FM9p_OqTCif5GJvsoorI8LQXNxy2wEWqq0xwgw7OfHD3k5");'></div>
<div class="flex flex-col justify-center">
<p class="text-text-primary-light dark:text-text-primary-dark text-2xl md:text-[28px] font-bold leading-tight tracking-[-0.015em]">Jessica Williams</p>
<p class="text-text-secondary-light dark:text-text-secondary-dark text-base font-normal leading-normal">Age: 32, Gender: Female</p>
<p class="text-text-secondary-light dark:text-text-secondary-dark text-base font-normal leading-normal">Last login: 2 hours ago</p>
</div>
</div>
</div>
</header>
<!-- Key Metrics: Charts & ProgressBar -->
<section class="mt-6 grid grid-cols-1 gap-6 md:grid-cols-2">
<div class="flex flex-col gap-2 rounded-xl bg-surface-light dark:bg-surface-dark p-4 shadow-sm">
<p class="text-text-primary-light dark:text-text-primary-dark text-base font-medium leading-normal">Weight Trend</p>
<div class="flex items-baseline gap-2">
<p class="text-text-primary-light dark:text-text-primary-dark tracking-light text-3xl font-bold leading-tight truncate">155.2 lbs</p>
<div class="flex gap-1">
<p class="text-text-secondary-light dark:text-text-secondary-dark text-sm font-normal">Last 30 Days</p>
<p class="text-red-600 dark:text-red-400 text-sm font-medium">-1.8 lbs</p>
</div>
</div>
<div class="flex h-32 flex-1 flex-col justify-end">
<svg fill="none" preserveaspectratio="none" viewbox="0 0 472 100" width="100%" xmlns="http://www.w3.org/2000/svg">
<path d="M0 72.6667C18.1538 72.6667 18.1538 14 36.3077 14C54.4615 14 54.4615 27.3333 72.6154 27.3333C90.7692 27.3333 90.7692 62 108.923 62C127.077 62 127.077 22 145.231 22C163.385 22 163.385 67.3333 181.538 67.3333C199.692 67.3333 199.692 40.6667 217.846 40.6667C236 40.6667 236 30 254.154 30C272.308 30 272.308 80.6667 290.462 80.6667C308.615 80.6667 308.615 99.3333 326.769 99.3333C344.923 99.3333 344.923 0.666667 363.077 0.666667C381.231 0.666667 381.231 54 399.385 54C417.538 54 417.538 86 435.692 86C453.846 86 453.846 16.6667 472 16.6667" stroke="#17cf54" stroke-linecap="round" stroke-width="3"></path>
</svg>
</div>
</div>
<div class="flex flex-col gap-3 rounded-xl bg-surface-light dark:bg-surface-dark p-4 shadow-sm">
<div class="flex items-center justify-between gap-6">
<p class="text-text-primary-light dark:text-text-primary-dark text-base font-medium leading-normal">Adherence Score</p>
<p class="text-primary text-2xl font-bold">85%</p>
</div>
<div class="h-2 rounded-full bg-primary/20"><div class="h-2 rounded-full bg-primary" style="width: 85%;"></div></div>
<p class="text-text-secondary-light dark:text-text-secondary-dark text-sm">Jessica has logged 18 of 21 meals this week.</p>
<div class="mt-auto flex flex-col gap-2">
<h3 class="font-medium text-base text-text-primary-light dark:text-text-primary-dark">Weekly Goal</h3>
<p class="text-text-secondary-light dark:text-text-secondary-dark text-sm">Increase daily water intake to 8 glasses.</p>
</div>
</div>
</section>
<!-- Tab Navigation and Content -->
<section class="mt-8">
<div class="border-b border-gray-200/80 dark:border-white/10">
<nav aria-label="Tabs" class="-mb-px flex space-x-6">
<a class="whitespace-nowrap border-b-2 border-primary px-1 pb-3 text-sm font-semibold text-primary" href="#">Overview</a>
<a class="whitespace-nowrap border-b-2 border-transparent px-1 pb-3 text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark hover:border-gray-300 dark:hover:border-gray-500 hover:text-text-primary-light dark:hover:text-text-primary-dark" href="#">Diet Plan</a>
<a class="whitespace-nowrap border-b-2 border-transparent px-1 pb-3 text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark hover:border-gray-300 dark:hover:border-gray-500 hover:text-text-primary-light dark:hover:text-text-primary-dark" href="#">Meal Logs</a>
<a class="whitespace-nowrap border-b-2 border-transparent px-1 pb-3 text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark hover:border-gray-300 dark:hover:border-gray-500 hover:text-text-primary-light dark:hover:text-text-primary-dark" href="#">Progress</a>
</nav>
</div>
<!-- Tab Content Panel -->
<div class="mt-6 grid grid-cols-1 gap-6 lg:grid-cols-3">
<div class="flex flex-col gap-4 rounded-xl bg-surface-light dark:bg-surface-dark p-4 shadow-sm">
<div class="flex items-center gap-3">
<div class="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary">
<span class="material-symbols-outlined">restaurant</span>
</div>
<h3 class="text-base font-semibold text-text-primary-light dark:text-text-primary-dark">Next Meal</h3>
</div>
<p class="text-text-secondary-light dark:text-text-secondary-dark">Lunch (12:30 PM)</p>
<p class="text-lg font-medium text-text-primary-light dark:text-text-primary-dark">Grilled Chicken Salad</p>
<p class="text-sm text-text-secondary-light dark:text-text-secondary-dark">with mixed greens, cherry tomatoes, and a light vinaigrette.</p>
</div>
<div class="flex flex-col gap-4 rounded-xl bg-surface-light dark:bg-surface-dark p-4 shadow-sm">
<div class="flex items-center gap-3">
<div class="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary">
<span class="material-symbols-outlined">flag</span>
</div>
<h3 class="text-base font-semibold text-text-primary-light dark:text-text-primary-dark">Current Diet Plan</h3>
</div>
<p class="text-text-secondary-light dark:text-text-secondary-dark">Active since Oct 24, 2023</p>
<p class="text-lg font-medium text-text-primary-light dark:text-text-primary-dark">Week 3 - High Protein</p>
<p class="text-sm text-text-secondary-light dark:text-text-secondary-dark">Focused on muscle retention during caloric deficit.</p>
</div>
<div class="flex flex-col gap-4 rounded-xl bg-surface-light dark:bg-surface-dark p-4 shadow-sm">
<div class="flex items-center gap-3">
<div class="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary">
<span class="material-symbols-outlined">rate_review</span>
</div>
<h3 class="text-base font-semibold text-text-primary-light dark:text-text-primary-dark">Latest Feedback</h3>
</div>
<p class="text-text-secondary-light dark:text-text-secondary-dark">From Yesterday's Dinner Log</p>
<blockquote class="border-l-4 border-primary/30 pl-4">
<p class="text-sm italic text-text-primary-light dark:text-text-primary-dark">"Felt a bit hungry after this meal. Maybe I can add more vegetables next time?"</p>
</blockquote>
</div>
</div>
</section>
</div>
</main>
</div>
</div>
</body></html>
</file>

<file path="Design/website/Design/dashboard_home/code.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>HealthTrack Dashboard</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#4A90E2",
              "accent": "#50E3C2",
              "background-light": "#F8F9FA",
              "background-dark": "#1a1a1a",
              "text-light": "#333333",
              "text-dark": "#E0E0E0",
              "border-light": "#E0E0E0",
              "border-dark": "#333333",
              "card-light": "#ffffff",
              "card-dark": "#2c2c2c",
            },
            fontFamily: {
              "display": ["Inter", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-text-light dark:text-text-dark">
<div class="flex h-screen">
<!-- SideNavBar -->
<aside class="flex w-64 flex-col border-r border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark">
<div class="flex h-full flex-col justify-between p-4">
<div class="flex flex-col gap-8">
<div class="flex items-center gap-3 px-3 py-2">
<div class="text-primary size-8">
<svg fill="none" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_6_535)">
<path clip-rule="evenodd" d="M47.2426 24L24 47.2426L0.757355 24L24 0.757355L47.2426 24ZM12.2426 21H35.7574L24 9.24264L12.2426 21Z" fill="currentColor" fill-rule="evenodd"></path>
</g>
<defs>
<clippath id="clip0_6_535"><rect fill="white" height="48" width="48"></rect></clippath>
</defs>
</svg>
</div>
<h1 class="text-text-light dark:text-text-dark text-xl font-bold">HealthTrack</h1>
</div>
<nav class="flex flex-col gap-2">
<a class="flex items-center gap-3 rounded-lg bg-primary/20 px-3 py-2 text-primary" href="#">
<span class="material-symbols-outlined">dashboard</span>
<p class="text-sm font-medium">Dashboard</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800" href="#">
<span class="material-symbols-outlined">group</span>
<p class="text-sm font-medium">Clients</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800" href="#">
<span class="material-symbols-outlined">description</span>
<p class="text-sm font-medium">Diet Plans</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800" href="#">
<span class="material-symbols-outlined">restaurant_menu</span>
<p class="text-sm font-medium">Meals Library</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800" href="#">
<span class="material-symbols-outlined">pie_chart</span>
<p class="text-sm font-medium">Progress &amp; Analytics</p>
</a>
<a class="flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800" href="#">
<span class="material-symbols-outlined">settings</span>
<p class="text-sm font-medium">Settings</p>
</a>
</nav>
</div>
</div>
</aside>
<!-- Main Content -->
<div class="flex flex-1 flex-col overflow-y-auto">
<!-- TopNavBar -->
<header class="flex items-center justify-between border-b border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark px-6 py-3 sticky top-0 z-10">
<div class="flex-1">
<label class="relative flex min-w-40 max-w-sm items-center">
<span class="material-symbols-outlined absolute left-3 text-gray-500">search</span>
<input class="form-input h-10 w-full rounded-lg border-border-light bg-background-light dark:border-border-dark dark:bg-background-dark pl-10 pr-4 text-sm focus:border-primary focus:ring-primary" placeholder="Search clients, plans..." type="search"/>
</label>
</div>
<div class="flex items-center gap-4">
<button class="relative flex h-10 w-10 cursor-pointer items-center justify-center rounded-full bg-background-light hover:bg-gray-200 dark:bg-background-dark dark:hover:bg-gray-700">
<span class="material-symbols-outlined">notifications</span>
<span class="absolute top-1 right-1 flex h-2 w-2">
<span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-primary opacity-75"></span>
<span class="relative inline-flex h-2 w-2 rounded-full bg-primary"></span>
</span>
</button>
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="User avatar of Dr. Carter" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuC3H8R1akagJMY-o-httrLYn4iU7d8h-acf1hmjRiN0q2e_dRtFFcfulw6fiOInvX0R6PLkV_FA5mtde6uC-2BgZQN8204hXZNNlOnDatSLD0gPcfbI4vOWE09zKPNkJewZGnD2AhTiOaTaucRjsL0-Ka3czDucJDSHUTwD76mxR47RNXHwrmSKJeUfPJL_XwFUz1oNm_xpL7pAIvAgYjMlUqd6R7KHAt76ZRhzumCOeR9XEPDSsUT_QAyQw3tWBeWclOV7cr-0tpAl");'></div>
<div class="flex flex-col text-sm">
<span class="font-semibold">Dr. Olivia Carter</span>
<span class="text-gray-500 dark:text-gray-400">Dietician</span>
</div>
</div>
</div>
</header>
<!-- Main Panel Content -->
<main class="flex-1 p-6 lg:p-8">
<div class="flex flex-col gap-6">
<!-- Page Heading and Actions -->
<div class="flex flex-wrap items-center justify-between gap-4">
<p class="text-3xl font-bold tracking-tight">Welcome back, Dr. Carter!</p>
<div class="flex flex-wrap gap-3">
<button class="flex h-10 cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg bg-primary px-4 text-sm font-bold text-white transition-colors hover:bg-primary/90">
<span class="material-symbols-outlined" style="font-size: 20px;">add</span>
<span class="truncate">Add New Client</span>
</button>
<button class="flex h-10 cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg border border-border-light dark:border-border-dark bg-card-light px-4 text-sm font-bold text-text-light hover:bg-gray-100 dark:bg-card-dark dark:text-text-dark dark:hover:bg-gray-700">
<span class="material-symbols-outlined" style="font-size: 20px;">add</span>
<span class="truncate">Create New Diet Plan</span>
</button>
</div>
</div>
<!-- Stats -->
<div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4">
<div class="flex flex-col gap-2 rounded-xl border border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark p-6">
<p class="text-base font-medium text-gray-600 dark:text-gray-300">Total Active Clients</p>
<p class="text-3xl font-bold">42</p>
</div>
<div class="flex flex-col gap-2 rounded-xl border border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark p-6">
<p class="text-base font-medium text-gray-600 dark:text-gray-300">Meals Awaiting Review</p>
<p class="text-3xl font-bold">15</p>
</div>
<div class="flex flex-col gap-2 rounded-xl border border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark p-6">
<p class="text-base font-medium text-gray-600 dark:text-gray-300">Average Client Adherence</p>
<p class="text-3xl font-bold text-accent">82%</p>
</div>
<div class="flex flex-col gap-2 rounded-xl border border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark p-6">
<p class="text-base font-medium text-gray-600 dark:text-gray-300">Upcoming Appointments</p>
<p class="text-3xl font-bold">3</p>
</div>
</div>
<!-- Chart/Graph Widget -->
<div class="rounded-xl border border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark p-6">
<h3 class="mb-4 text-lg font-semibold">Weekly Adherence Overview</h3>
<div class="flex h-64 items-end justify-between gap-4">
<div class="flex h-full flex-col-reverse items-center gap-2">
<p class="text-xs text-gray-500">Mon</p>
<div class="w-8 rounded bg-primary/20" style="height: 70%;">
<div class="h-full w-full rounded bg-primary transition-all duration-300 hover:opacity-80" style="height: 100%;"></div>
</div>
</div>
<div class="flex h-full flex-col-reverse items-center gap-2">
<p class="text-xs text-gray-500">Tue</p>
<div class="w-8 rounded bg-primary/20" style="height: 85%;">
<div class="h-full w-full rounded bg-primary transition-all duration-300 hover:opacity-80" style="height: 100%;"></div>
</div>
</div>
<div class="flex h-full flex-col-reverse items-center gap-2">
<p class="text-xs text-gray-500">Wed</p>
<div class="w-8 rounded bg-primary/20" style="height: 60%;">
<div class="h-full w-full rounded bg-primary transition-all duration-300 hover:opacity-80" style="height: 100%;"></div>
</div>
</div>
<div class="flex h-full flex-col-reverse items-center gap-2">
<p class="text-xs text-gray-500">Thu</p>
<div class="w-8 rounded bg-accent/20" style="height: 95%;">
<div class="h-full w-full rounded bg-accent transition-all duration-300 hover:opacity-80" style="height: 100%;"></div>
</div>
</div>
<div class="flex h-full flex-col-reverse items-center gap-2">
<p class="text-xs text-gray-500">Fri</p>
<div class="w-8 rounded bg-primary/20" style="height: 75%;">
<div class="h-full w-full rounded bg-primary transition-all duration-300 hover:opacity-80" style="height: 100%;"></div>
</div>
</div>
<div class="flex h-full flex-col-reverse items-center gap-2">
<p class="text-xs text-gray-500">Sat</p>
<div class="w-8 rounded bg-primary/20" style="height: 80%;">
<div class="h-full w-full rounded bg-primary transition-all duration-300 hover:opacity-80" style="height: 100%;"></div>
</div>
</div>
<div class="flex h-full flex-col-reverse items-center gap-2">
<p class="text-xs text-gray-500">Sun</p>
<div class="w-8 rounded bg-primary/20" style="height: 55%;">
<div class="h-full w-full rounded bg-primary transition-all duration-300 hover:opacity-80" style="height: 100%;"></div>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
</div>
</body></html>
</file>

<file path="Design/website/Design/diet_options_library/code.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Diet Options Library</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
    </style>
<script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#17cf54",
              "background-light": "#f6f8f6",
              "background-dark": "#112116",
            },
            fontFamily: {
              "display": ["Inter", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
</head>
<body class="font-display bg-background-light dark:bg-background-dark">
<div class="relative flex min-h-screen w-full">
<!-- SideNavBar -->
<aside class="flex w-64 flex-col border-r border-slate-200 dark:border-slate-800 bg-white dark:bg-background-dark p-4">
<div class="flex flex-col gap-4">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Dr. Emily Carter" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuClMAlm2rDfkBJlvgRRhspUKlMyAjhHEzn7GjuLDvjfESo4qyQOVVs3Imf-vVBRypCY-mHWt_Xme_XzCbZT2pLKxr2OOGLK641TEbN_gQOQc1lg8x8aJ_Mvsc1bk6zMVZN0hgehO7iFTM_TG7WLUDmmWitI69LH8qTVZVNAJECfbC1G5BmJfbXxqO4O3QiVUO91QeYkDhq8I-hUX5ns9u7sZNib71UlZPjU61Bau5ZdLidtuEzmLZ-zeBfqiBucJZnEnqW7I006nNMz");'></div>
<div class="flex flex-col">
<h1 class="text-[#0e1b12] dark:text-white text-base font-medium leading-normal">Dr. Emily Carter</h1>
<p class="text-[#4e9767] text-sm font-normal leading-normal">Dietician</p>
</div>
</div>
<div class="flex flex-col gap-2 mt-4">
<a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary/20 text-[#0e1b12] dark:text-white" href="#">
<span class="material-symbols-outlined">dashboard</span>
<p class="text-sm font-medium leading-normal">Dashboard</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary/20 text-[#0e1b12] dark:text-white" href="#">
<span class="material-symbols-outlined">group</span>
<p class="text-sm font-medium leading-normal">Clients</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary/20 text-[#0e1b12] dark:text-white" href="#">
<span class="material-symbols-outlined">restaurant_menu</span>
<p class="text-sm font-medium leading-normal">Meal Plans</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg bg-primary/20 text-[#0e1b12] dark:text-white" href="#">
<span class="material-symbols-outlined" style="font-variation-settings: 'FILL' 1;">menu_book</span>
<p class="text-sm font-medium leading-normal">Diet Library</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary/20 text-[#0e1b12] dark:text-white" href="#">
<span class="material-symbols-outlined">settings</span>
<p class="text-sm font-medium leading-normal">Settings</p>
</a>
</div>
</div>
<div class="mt-auto">
<button class="flex w-full min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">New Client</span>
</button>
</div>
</aside>
<!-- Main Content -->
<main class="flex-1 p-8">
<div class="w-full max-w-7xl mx-auto">
<!-- PageHeading -->
<div class="flex flex-wrap justify-between items-center gap-4 mb-6">
<div class="flex flex-col gap-1">
<p class="text-[#0e1b12] dark:text-white text-4xl font-black leading-tight tracking-[-0.033em]">Diet Options Library</p>
<p class="text-[#4e9767] text-base font-normal leading-normal">Browse, search, and utilize pre-defined diet plans for your clients.</p>
</div>
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">Add New Diet</span>
</button>
</div>
<!-- Search and Filters -->
<div class="flex flex-col sm:flex-row gap-4 mb-4">
<!-- SearchBar -->
<div class="flex-grow">
<label class="flex flex-col min-w-40 h-12 w-full">
<div class="flex w-full flex-1 items-stretch rounded-lg h-full">
<div class="text-[#4e9767] flex border-none bg-white dark:bg-slate-800 items-center justify-center pl-4 rounded-l-lg border-r-0">
<span class="material-symbols-outlined">search</span>
</div>
<input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0e1b12] dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border-none bg-white dark:bg-slate-800 h-full placeholder:text-[#4e9767] px-4 rounded-l-none border-l-0 pl-2 text-base font-normal leading-normal" placeholder="Search diets by name or keyword..." value=""/>
</div>
</label>
</div>
<!-- ToolBar -->
<div class="flex justify-between items-center gap-2">
<div class="flex gap-2 items-center bg-white dark:bg-slate-800 rounded-lg p-1">
<button class="p-2 text-[#0e1b12] dark:text-white rounded-md bg-primary/20">
<span class="material-symbols-outlined">grid_view</span>
</button>
<button class="p-2 text-[#0e1b12] dark:text-white rounded-md hover:bg-primary/20">
<span class="material-symbols-outlined">view_list</span>
</button>
<button class="p-2 text-[#0e1b12] dark:text-white rounded-md hover:bg-primary/20">
<span class="material-symbols-outlined">filter_list</span>
</button>
</div>
</div>
</div>
<!-- Chips -->
<div class="flex gap-3 mb-6 overflow-x-auto pb-2">
<div class="flex h-8 shrink-0 cursor-pointer items-center justify-center gap-x-2 rounded-full bg-primary/20 px-4">
<p class="text-[#0e1b12] dark:text-white text-sm font-medium leading-normal">All</p>
</div>
<div class="flex h-8 shrink-0 cursor-pointer items-center justify-center gap-x-2 rounded-full bg-white dark:bg-slate-800 px-4 hover:bg-primary/20">
<p class="text-[#0e1b12] dark:text-white text-sm font-medium leading-normal">Goal-based</p>
</div>
<div class="flex h-8 shrink-0 cursor-pointer items-center justify-center gap-x-2 rounded-full bg-white dark:bg-slate-800 px-4 hover:bg-primary/20">
<p class="text-[#0e1b12] dark:text-white text-sm font-medium leading-normal">Condition-specific</p>
</div>
<div class="flex h-8 shrink-0 cursor-pointer items-center justify-center gap-x-2 rounded-full bg-white dark:bg-slate-800 px-4 hover:bg-primary/20">
<p class="text-[#0e1b12] dark:text-white text-sm font-medium leading-normal">Lifestyle</p>
</div>
<div class="flex h-8 shrink-0 cursor-pointer items-center justify-center gap-x-2 rounded-full bg-white dark:bg-slate-800 px-4 hover:bg-primary/20">
<p class="text-[#0e1b12] dark:text-white text-sm font-medium leading-normal">Popular</p>
</div>
</div>
<!-- Diet Cards Grid -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
<!-- Card 1: Mediterranean -->
<div class="flex flex-col bg-white dark:bg-slate-800 rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition-shadow duration-300">
<img class="h-40 w-full object-cover" data-alt="A vibrant salad with fresh vegetables, olives, and feta cheese, representing the Mediterranean diet." src="https://lh3.googleusercontent.com/aida-public/AB6AXuBvwMLtaqynlIDsBSd0YKS54HvGJkwt_MaeCc0CE1A2fU_Miywe2ls_fJcYBv6rWQ53tPvgGJNBM8ojS42XUlTpS-Uplv-QfweHsQgXHoLEIymqviOagwfgxTEARacdYdZlZCGyyY93yGX0D3-4_rxQh7jmzIU3CEDV8wrsjPO-bbTN9rV-Dd2B4iUOuo6dIygQvU9zP7K8iGA1wataaJ85B4BjV6MQ1URh6txrugGkvqXVrFcQOvBVNeYLERwQ9WtDC1i3ZybQZXa_"/>
<div class="p-5 flex flex-col flex-grow">
<h3 class="text-xl font-bold text-[#0e1b12] dark:text-white mb-2">Mediterranean Diet</h3>
<p class="text-sm text-slate-600 dark:text-slate-300 mb-4 flex-grow">A heart-healthy eating plan inspired by the traditional foods of Greece, Italy, and other countries that border the Mediterranean Sea.</p>
<div class="flex flex-wrap gap-2 mb-4">
<span class="text-xs font-semibold text-green-800 bg-green-100 rounded-full px-3 py-1">Heart-Healthy</span>
<span class="text-xs font-semibold text-blue-800 bg-blue-100 rounded-full px-3 py-1">Plant-Based</span>
<span class="text-xs font-semibold text-yellow-800 bg-yellow-100 rounded-full px-3 py-1">Rich in Omega-3s</span>
</div>
<div class="mt-auto flex flex-col sm:flex-row gap-2">
<button class="flex-1 text-center text-sm font-bold py-2 px-4 rounded-lg bg-primary/20 hover:bg-primary/30 text-[#0e1b12] dark:text-white">View Details</button>
<button class="flex-1 text-center text-sm font-bold py-2 px-4 rounded-lg bg-primary text-white hover:bg-primary/90">Apply Template</button>
</div>
</div>
</div>
<!-- Card 2: Keto -->
<div class="flex flex-col bg-white dark:bg-slate-800 rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition-shadow duration-300">
<img class="h-40 w-full object-cover" data-alt="Grilled salmon with asparagus and lemon, a typical meal for a Ketogenic diet." src="https://lh3.googleusercontent.com/aida-public/AB6AXuDpSqmE6B0PS8KI4mdUhA9GJUNKwU7MvVAtfCJxive-aSjbztVTFCjXo9zuE0_Qw3slltVFBBlo3vCuo6xi24FnOccyw1u4L4eto2IS2tEHD-kdNwlGWnvJT9c0pu4N0a3kXZs95gXsNyAZO64ebJLIRrNtr5jsqpjCQbnaK2lc0hvhGJbjVwgrdN-A-LNJBX-nk_jvlaxyMUwbR40R9xHQWaQ69YUAkmNzO9RvLGxk9IuThKIBnXyFjezFi1kHM8XApqg6hHoDRja4"/>
<div class="p-5 flex flex-col flex-grow">
<h3 class="text-xl font-bold text-[#0e1b12] dark:text-white mb-2">Ketogenic Diet</h3>
<p class="text-sm text-slate-600 dark:text-slate-300 mb-4 flex-grow">A very low-carb, high-fat diet that involves drastically reducing carbohydrate intake and replacing it with fat to put your body into ketosis.</p>
<div class="flex flex-wrap gap-2 mb-4">
<span class="text-xs font-semibold text-red-800 bg-red-100 rounded-full px-3 py-1">Low-Carb</span>
<span class="text-xs font-semibold text-orange-800 bg-orange-100 rounded-full px-3 py-1">High-Fat</span>
<span class="text-xs font-semibold text-purple-800 bg-purple-100 rounded-full px-3 py-1">Weight Loss</span>
</div>
<div class="mt-auto flex flex-col sm:flex-row gap-2">
<button class="flex-1 text-center text-sm font-bold py-2 px-4 rounded-lg bg-primary/20 hover:bg-primary/30 text-[#0e1b12] dark:text-white">View Details</button>
<button class="flex-1 text-center text-sm font-bold py-2 px-4 rounded-lg bg-primary text-white hover:bg-primary/90">Apply Template</button>
</div>
</div>
</div>
<!-- Card 3: Vegan -->
<div class="flex flex-col bg-white dark:bg-slate-800 rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition-shadow duration-300">
<img class="h-40 w-full object-cover" data-alt="A colorful bowl of various vegetables, grains, and legumes, representing a Vegan diet." src="https://lh3.googleusercontent.com/aida-public/AB6AXuB6dzbqTSRAVzukFPsAAV5P0fXKMH3u8FO8ZY_uou_lzMHOVR0FFIc3M11TaJ33h7434IUDGdMwlhAH3T8aHLrKdTdPmXplnIy46qUSSQCGokLhSUUFtaUNV6rxDsjhB1emXUvsuWtllS0zOl45k9_gKnZmTK2OanGo965QEBVYXGPUyqxiy6P69BQiPXxaVyFNlX3etHvGISmuPzpoKbNKeJrziBmOaXa9sBndCvz6IBwAXjES7fbcYaBJ7NqGKR_O_Pv7AF4lLGec"/>
<div class="p-5 flex flex-col flex-grow">
<h3 class="text-xl font-bold text-[#0e1b12] dark:text-white mb-2">Vegan Diet</h3>
<p class="text-sm text-slate-600 dark:text-slate-300 mb-4 flex-grow">Excludes all animal products, including meat, dairy, and eggs. It is based on plants (such as vegetables, grains, nuts and fruits).</p>
<div class="flex flex-wrap gap-2 mb-4">
<span class="text-xs font-semibold text-green-800 bg-green-100 rounded-full px-3 py-1">Plant-Based</span>
<span class="text-xs font-semibold text-indigo-800 bg-indigo-100 rounded-full px-3 py-1">Dairy-Free</span>
<span class="text-xs font-semibold text-pink-800 bg-pink-100 rounded-full px-3 py-1">Ethical</span>
</div>
<div class="mt-auto flex flex-col sm:flex-row gap-2">
<button class="flex-1 text-center text-sm font-bold py-2 px-4 rounded-lg bg-primary/20 hover:bg-primary/30 text-[#0e1b12] dark:text-white">View Details</button>
<button class="flex-1 text-center text-sm font-bold py-2 px-4 rounded-lg bg-primary text-white hover:bg-primary/90">Apply Template</button>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
</body></html>
</file>

<file path="Design/website/Design/diet_plan_builder_flow/code.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Diet Plan Builder</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<style>
        .material-symbols-outlined {
            font-variation-settings:
            'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24
        }
    </style>
<script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#17cf54",
              "background-light": "#f6f8f6",
              "background-dark": "#112116",
              "success": "#7ED321",
              "warning": "#F5A623",
              "error": "#D0021B",
              "text-light": "#0e1b12",
              "text-dark": "#e1e3e2",
              "surface-light": "#f8fcf9",
              "surface-dark": "#1a2c20",
              "border-light": "#d0e7d7",
              "border-dark": "#2a3f30",
              "muted-light": "#4e9767",
              "muted-dark": "#8a9f90",
            },
            fontFamily: {
              "display": ["Inter", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
</head>
<body class="font-display bg-background-light dark:bg-background-dark">
<div class="flex min-h-screen">
<!-- SideNavBar -->
<aside class="w-64 flex-shrink-0 bg-surface-light dark:bg-surface-dark border-r border-border-light dark:border-border-dark hidden lg:flex flex-col">
<div class="flex h-full min-h-[700px] flex-col justify-between p-4">
<div class="flex flex-col gap-4">
<div class="flex items-center gap-3 p-2">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Dr. Evelyn Reed" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBsAuKZx2sD-s02Grb1ZKJgvOIP1JaGBO2hXtstwkcx7_8SwtA1j_g_9i96dLJFqR8Z1956tMD2dwkAhzaJ2gD_NHEyuP4U2IWpu29ivjf_R2es5cgaPPtmT9yKT_v7ZKEl6MyTbHWg-XOmH2uvgRES5X49T0NbLc9ToRtqs4SXrtrjtgVt-f4x-TFQJdfwpKUwanL2Jg4iUdnitC6jc1-jcx6RM3wexpUmBIbjYM0x8vka1nyW0K4Uh8SGw6UOavnMRakN_COX9w9Q");'></div>
<div class="flex flex-col">
<h1 class="text-text-light dark:text-text-dark text-base font-medium leading-normal">Dr. Evelyn Reed</h1>
<p class="text-muted-light dark:text-muted-dark text-sm font-normal leading-normal">Dietician</p>
</div>
</div>
<nav class="flex flex-col gap-2">
<a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary/20 transition-colors" href="#">
<span class="material-symbols-outlined text-text-light dark:text-text-dark">dashboard</span>
<p class="text-text-light dark:text-text-dark text-sm font-medium leading-normal">Dashboard</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary/20 transition-colors" href="#">
<span class="material-symbols-outlined text-text-light dark:text-text-dark">group</span>
<p class="text-text-light dark:text-text-dark text-sm font-medium leading-normal">Clients</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg bg-primary/20" href="#">
<span class="material-symbols-outlined text-text-light dark:text-text-dark !font-bold">description</span>
<p class="text-text-light dark:text-text-dark text-sm font-bold leading-normal">Diet Plans</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary/20 transition-colors" href="#">
<span class="material-symbols-outlined text-text-light dark:text-text-dark">book</span>
<p class="text-text-light dark:text-text-dark text-sm font-medium leading-normal">Templates</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary/20 transition-colors" href="#">
<span class="material-symbols-outlined text-text-light dark:text-text-dark">pie_chart</span>
<p class="text-text-light dark:text-text-dark text-sm font-medium leading-normal">Analytics</p>
</a>
</nav>
</div>
<div class="flex flex-col gap-4">
<button class="flex w-full cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-text-light text-sm font-bold leading-normal tracking-[0.015em] hover:opacity-90 transition-opacity">
<span class="truncate">New Plan</span>
</button>
<div class="flex flex-col gap-1">
<a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary/20 transition-colors" href="#">
<span class="material-symbols-outlined text-text-light dark:text-text-dark">settings</span>
<p class="text-text-light dark:text-text-dark text-sm font-medium leading-normal">Settings</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary/20 transition-colors" href="#">
<span class="material-symbols-outlined text-text-light dark:text-text-dark">help</span>
<p class="text-text-light dark:text-text-dark text-sm font-medium leading-normal">Help</p>
</a>
</div>
</div>
</div>
</aside>
<!-- Main Content -->
<main class="flex-1 p-4 sm:p-6 lg:p-8">
<div class="max-w-7xl mx-auto">
<!-- PageHeading -->
<div class="flex flex-wrap justify-between gap-4 mb-6">
<div class="flex min-w-72 flex-col gap-2">
<p class="text-text-light dark:text-text-dark text-3xl md:text-4xl font-black leading-tight tracking-[-0.033em]">Create New Diet Plan</p>
<p class="text-muted-light dark:text-muted-dark text-base font-normal leading-normal">Follow the steps to build a personalized weekly diet plan for your client.</p>
</div>
</div>
<!-- ProgressBar -->
<div class="flex flex-col gap-2 mb-8">
<div class="flex gap-6 justify-between"><p class="text-text-light dark:text-text-dark text-base font-medium leading-normal">Step 1 of 3: Plan Setup</p></div>
<div class="rounded-full bg-border-light dark:bg-border-dark h-2"><div class="h-2 rounded-full bg-primary" style="width: 33%;"></div></div>
</div>
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
<div class="lg:col-span-2">
<div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-border-light dark:border-border-dark">
<!-- SectionHeader -->
<h2 class="text-text-light dark:text-text-dark text-xl font-bold leading-tight tracking-[-0.015em] pb-4 border-b border-border-light dark:border-border-dark">Plan Details</h2>
<!-- Form: Step 1 -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6 pt-6">
<div class="md:col-span-2">
<label class="flex flex-col">
<p class="text-text-light dark:text-text-dark text-sm font-medium leading-normal pb-2">Select Client</p>
<div class="relative">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-muted-light dark:text-muted-dark">search</span>
<select class="form-select w-full rounded-lg text-text-light dark:text-text-dark bg-background-light dark:bg-background-dark border-border-light dark:border-border-dark focus:ring-primary focus:border-primary h-12 pl-10 placeholder:text-muted-light dark:placeholder:text-muted-dark text-base font-normal leading-normal">
<option selected="">Search for a client by name...</option>
<option>James Rodriguez</option>
<option>Maria Garcia</option>
</select>
</div>
</label>
</div>
<div class="md:col-span-2">
<label class="flex flex-col">
<p class="text-text-light dark:text-text-dark text-sm font-medium leading-normal pb-2">Plan Name</p>
<input class="form-input w-full rounded-lg text-text-light dark:text-text-dark bg-background-light dark:bg-background-dark border-border-light dark:border-border-dark focus:ring-primary focus:border-primary h-12 placeholder:text-muted-light dark:placeholder:text-muted-dark text-base font-normal leading-normal" placeholder="e.g., High-Protein Weight Loss" type="text"/>
</label>
</div>
<div>
<label class="flex flex-col">
<p class="text-text-light dark:text-text-dark text-sm font-medium leading-normal pb-2">Start Date</p>
<input class="form-input w-full rounded-lg text-text-light dark:text-text-dark bg-background-light dark:bg-background-dark border-border-light dark:border-border-dark focus:ring-primary focus:border-primary h-12 placeholder:text-muted-light dark:placeholder:text-muted-dark text-base font-normal leading-normal" type="date"/>
</label>
</div>
<div>
<label class="flex flex-col">
<p class="text-text-light dark:text-text-dark text-sm font-medium leading-normal pb-2">End Date</p>
<input class="form-input w-full rounded-lg text-text-light dark:text-text-dark bg-background-light dark:bg-background-dark border-border-light dark:border-border-dark focus:ring-primary focus:border-primary h-12 placeholder:text-muted-light dark:placeholder:text-muted-dark text-base font-normal leading-normal" type="date"/>
</label>
</div>
</div>
<div class="flex justify-end mt-8">
<button class="flex items-center justify-center gap-2 h-11 px-6 bg-primary text-text-light font-bold rounded-lg hover:opacity-90 transition-opacity">
<span>Next Step</span>
<span class="material-symbols-outlined">arrow_forward</span>
</button>
</div>
</div>
</div>
<!-- Summary Sidebar -->
<div class="lg:col-span-1 row-start-1 lg:row-start-auto">
<div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-border-light dark:border-border-dark sticky top-8">
<h3 class="text-text-light dark:text-text-dark text-xl font-bold leading-tight tracking-[-0.015em] pb-4 border-b border-border-light dark:border-border-dark">Plan Summary</h3>
<div class="flex flex-col gap-5 pt-6">
<div class="text-center py-8 text-muted-light dark:text-muted-dark">
<p>Summary will appear once meals are added in the next step.</p>
</div>
<!-- Example of populated summary, hidden for now -->
<div class="hidden flex-col gap-5">
<div>
<div class="flex justify-between items-baseline mb-1">
<p class="text-text-light dark:text-text-dark font-medium">Avg. Daily Calories</p>
<p class="text-muted-light dark:text-muted-dark text-sm"><span class="text-success font-bold">1850</span> / 2000 kcal</p>
</div>
<div class="h-2 rounded-full bg-border-light dark:bg-border-dark"><div class="h-2 rounded-full bg-success" style="width: 92.5%;"></div></div>
</div>
<div>
<div class="flex justify-between items-baseline mb-1">
<p class="text-text-light dark:text-text-dark font-medium">Protein</p>
<p class="text-muted-light dark:text-muted-dark text-sm"><span class="text-warning font-bold">140g</span> / 150g</p>
</div>
<div class="h-2 rounded-full bg-border-light dark:bg-border-dark"><div class="h-2 rounded-full bg-warning" style="width: 93%;"></div></div>
</div>
<div>
<div class="flex justify-between items-baseline mb-1">
<p class="text-text-light dark:text-text-dark font-medium">Carbohydrates</p>
<p class="text-muted-light dark:text-muted-dark text-sm"><span class="text-success font-bold">205g</span> / 220g</p>
</div>
<div class="h-2 rounded-full bg-border-light dark:bg-border-dark"><div class="h-2 rounded-full bg-success" style="width: 93%;"></div></div>
</div>
<div>
<div class="flex justify-between items-baseline mb-1">
<p class="text-text-light dark:text-text-dark font-medium">Fat</p>
<p class="text-muted-light dark:text-muted-dark text-sm"><span class="text-error font-bold">75g</span> / 60g</p>
</div>
<div class="h-2 rounded-full bg-border-light dark:bg-border-dark"><div class="h-2 rounded-full bg-error" style="width: 100%;"></div></div>
</div>
</div>
</div>
<div class="flex flex-col gap-3 mt-8 pt-6 border-t border-border-light dark:border-border-dark">
<button class="w-full h-11 px-6 bg-primary text-text-light font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed" disabled="">
                                    Publish Plan
                                </button>
<button class="w-full h-11 px-6 bg-primary/20 text-text-light dark:text-text-dark font-bold rounded-lg hover:bg-primary/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled="">
                                    Save as Template
                                </button>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
</body></html>
</file>

<file path="Design/website/Design/diet_plan_creation_page_1/code.html">
<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Diet Plan Creation - Sarah Singh</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #e0e0e0;
            border-radius: 3px;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #4a5568;
        }
    </style>
<script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#17cf54",
              "background-light": "#f6f8f6",
              "background-dark": "#112116",
              "success": "#7ED321",
              "warning": "#F5A623",
              "error": "#D0021B",
            },
            fontFamily: {
              "display": ["Inter", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-gray-800 dark:text-gray-200">
<div class="flex flex-col h-screen">
<header class="flex items-center justify-between whitespace-nowrap border-b border-gray-200 dark:border-gray-700 px-6 py-3 bg-white dark:bg-gray-800 flex-shrink-0">
<div class="flex items-center gap-9">
<a class="flex items-center gap-2 text-gray-700 dark:text-gray-300 text-sm font-medium leading-normal" href="#">
<span class="material-symbols-outlined text-lg">arrow_back</span>
                    Back to Client
                </a>
<span class="text-gray-900 dark:text-white text-sm font-medium leading-normal">Client: Sarah Singh (28F)</span>
</div>
<div class="flex gap-2">
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-3">
<span class="material-symbols-outlined text-xl">visibility</span>
<span class="hidden sm:inline">Preview</span>
</button>
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-3">
<span class="material-symbols-outlined text-xl">download</span>
<span class="hidden sm:inline">Export</span>
</button>
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-gray-200 dark:bg-gray-600 text-gray-900 dark:text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">Save as Draft</span>
</button>
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">Publish</span>
</button>
</div>
</header>
<main class="flex-grow grid grid-cols-12 gap-4 p-4 overflow-auto">
<aside class="col-span-3 flex flex-col gap-4 overflow-y-auto pr-2">
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-12" data-alt="Photo of Sarah Singh" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuA_mfGBlTQqbqWv8MiukpmpcdMKyoot_7VGTR9C8fop9lNumZzgPYbCu-QiZjXw6-RWx5hru5ihyNxKq2ttqVv2FZmOCeNblDNZb4lNdfRIVPfXXtrQEUb2FSfZq3m461r8eugVlFRScfL8MoqNwzgVFKNd-8EMeg5HvSQknPL05tPwV2bbWMekciSamP4BbVZ9eyfdQKkK3Xa2xiLM3Nwlbcu8JI3uVvb6e5wAOJ68-QfGk7bUE-evRyxiK2CMLt2-sQ6lA1rrw5HT");'></div>
<div class="flex flex-col">
<h1 class="text-gray-900 dark:text-white text-base font-medium leading-normal">Sarah Singh</h1>
<p class="text-gray-500 dark:text-gray-400 text-sm font-normal leading-normal">28F, 165cm, 70kg</p>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<p class="text-gray-900 dark:text-white text-base font-medium leading-normal">Weight Trend</p>
<p class="text-gray-900 dark:text-white tracking-light text-[32px] font-bold leading-tight truncate">70kg <span class="text-gray-400 text-xl font-medium">/ Goal 65kg</span></p>
<div class="flex gap-1 items-center">
<p class="text-gray-500 dark:text-gray-400 text-sm font-normal leading-normal">Last 30 Days</p>
<p class="text-error text-sm font-medium leading-normal flex items-center gap-1"><span class="material-symbols-outlined text-base">trending_down</span> -2kg</p>
</div>
<div class="flex min-h-[100px] flex-1 flex-col pt-4">
<svg fill="none" height="100" preserveAspectRatio="none" viewBox="-3 0 478 150" width="100%" xmlns="http://www.w3.org/2000/svg">
<path d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25V149H326.769H0V109Z" fill="url(#paint0_linear_1131_5935_light)"></path>
<path d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25" stroke="#4e9767" stroke-linecap="round" stroke-width="3"></path>
<defs>
<linearGradient gradientUnits="userSpaceOnUse" id="paint0_linear_1131_5935_light" x1="236" x2="236" y1="1" y2="149">
<stop stop-color="#e7f3eb"></stop>
<stop offset="1" stop-color="#e7f3eb" stop-opacity="0"></stop>
</linearGradient>
</defs>
</svg>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-3">Previous Plans</h3>
<div class="flex flex-col gap-1">
<div class="flex items-center gap-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 p-2 rounded-lg cursor-pointer">
<div class="text-gray-800 dark:text-gray-200 flex items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-700 shrink-0 size-10">
<span class="material-symbols-outlined text-xl">description</span>
</div>
<div class="flex flex-col justify-center">
<p class="text-gray-800 dark:text-gray-100 text-sm font-medium leading-normal line-clamp-1">High Protein Plan</p>
<p class="text-gray-500 dark:text-gray-400 text-xs font-normal leading-normal line-clamp-2">Created by Dr. Evans</p>
</div>
<p class="text-gray-400 dark:text-gray-500 text-xs font-normal leading-normal ml-auto">Nov 15, 2023</p>
</div>
<div class="flex items-center gap-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 p-2 rounded-lg cursor-pointer">
<div class="text-gray-800 dark:text-gray-200 flex items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-700 shrink-0 size-10">
<span class="material-symbols-outlined text-xl">description</span>
</div>
<div class="flex flex-col justify-center">
<p class="text-gray-800 dark:text-gray-100 text-sm font-medium leading-normal line-clamp-1">Keto Diet Start</p>
<p class="text-gray-500 dark:text-gray-400 text-xs font-normal leading-normal line-clamp-2">Created by You</p>
</div>
<p class="text-gray-400 dark:text-gray-500 text-xs font-normal leading-normal ml-auto">Oct 21, 2023</p>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-3">Medical Summary</h3>
<div class="flex flex-col gap-2">
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Diagnoses</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Hypertension, Pre-diabetic</p>
</details>
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group" open="">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Allergies</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Dairy, Peanuts, Shellfish</p>
</details>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-2">Notes &amp; Alerts</h3>
<textarea class="w-full h-24 p-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add a note for this client...">Client reports feeling bloated after high-carb meals. Monitor closely.</textarea>
</div>
</aside>
<section class="col-span-6 flex flex-col gap-4 overflow-y-auto">
<div class="flex-shrink-0 bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center text-center">
<button class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400">chevron_left</span>
</button>
<div class="flex gap-1">
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 1 (Mon)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-white bg-primary">Dec 2 (Tue)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 3 (Wed)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 4 (Thu)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 5 (Fri)</button>
</div>
<button class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400">chevron_right</span>
</button>
</div>
</div>
<div class="space-y-4">
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<div class="flex items-center gap-2">
<h3 class="text-lg font-semibold text-gray-900 dark:text-white">Breakfast</h3>
<input class="text-sm p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="time" value="08:00"/>
</div>
<p class="text-xs font-medium text-gray-500 dark:text-gray-400">350 Kcal | P:20g, C:45g, F:10g</p>
</div>
<div class="space-y-2 mb-3">
<div class="flex items-center gap-2 p-2 rounded-md bg-gray-50 dark:bg-gray-700/50">
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Oatmeal</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="1 cup"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
<div class="flex items-center gap-2 p-2 rounded-md bg-gray-50 dark:bg-gray-700/50">
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Blueberries</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="1/2 cup"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
</div>
<div class="flex gap-2">
<div class="relative flex-grow">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add food item..." type="text"/>
</div>
<button class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600">
<span class="material-symbols-outlined text-lg">menu_book</span>
<span>Templates</span>
</button>
</div>
<textarea class="mt-3 w-full p-2 text-xs border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add a note for the client..."></textarea>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<div class="flex items-center gap-2">
<h3 class="text-lg font-semibold text-gray-900 dark:text-white">Lunch</h3>
<input class="text-sm p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="time" value="13:00"/>
</div>
<p class="text-xs font-medium text-gray-500 dark:text-gray-400">650 Kcal | P:40g, C:60g, F:28g</p>
</div>
<div class="space-y-2 mb-3">
<div class="flex items-center gap-2 p-2 rounded-md bg-red-50 dark:bg-red-900/20 border border-error">
<span class="text-error mr-2"><span class="material-symbols-outlined text-lg">warning</span></span>
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Paneer Tikka</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="150g"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
<div class="flex items-center gap-2 p-2 rounded-md bg-gray-50 dark:bg-gray-700/50">
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Brown Rice</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="1 cup"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
</div>
<div class="flex gap-2">
<div class="relative flex-grow">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add food item..." type="text"/>
</div>
<button class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600">
<span class="material-symbols-outlined text-lg">menu_book</span>
<span>Templates</span>
</button>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<div class="flex items-center gap-2">
<h3 class="text-lg font-semibold text-gray-900 dark:text-white">Dinner</h3>
<input class="text-sm p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="time" value="19:30"/>
</div>
<p class="text-xs font-medium text-gray-500 dark:text-gray-400">0 Kcal | P:0g, C:0g, F:0g</p>
</div>
<div class="flex gap-2">
<div class="relative flex-grow">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add food item..." type="text"/>
</div>
<button class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600">
<span class="material-symbols-outlined text-lg">menu_book</span>
<span>Templates</span>
</button>
</div>
</div>
<button class="w-full flex items-center justify-center gap-2 py-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700/50 hover:border-primary dark:hover:border-primary hover:text-primary dark:hover:text-primary transition-colors">
<span class="material-symbols-outlined">add_circle</span>
<span class="text-sm font-medium">Add meal +</span>
</button>
</div>
</section>
<aside class="col-span-3 flex flex-col gap-4 overflow-y-auto pl-2">
<div class="bg-error/10 dark:bg-error/20 border border-error p-4 rounded-lg">
<div class="flex items-start gap-3">
<span class="material-symbols-outlined text-error text-xl mt-0.5">error</span>
<div>
<h4 class="font-bold text-error">Allergy Warning</h4>
<p class="text-sm text-error/80 dark:text-error/90">You added Paneer (dairy). This client has a <span class="font-semibold">Dairy</span> allergy.</p>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal">Plan At-a-Glance</h3>
<span class="text-xs text-gray-500">Target: 1800 Kcal</span>
</div>
<div class="space-y-4">
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Today's Calories</span>
<span class="font-medium text-gray-600 dark:text-gray-400">1000 / 1800 kcal</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 55%"></div>
</div>
</div>
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Protein</span>
<span class="font-medium text-gray-600 dark:text-gray-400">60 / 90 g</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 66%"></div>
</div>
</div>
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Carbohydrates</span>
<span class="font-medium text-gray-600 dark:text-gray-400">105 / 200 g</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 52%"></div>
</div>
</div>
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Fat</span>
<span class="font-medium text-gray-600 dark:text-gray-400">38 / 60 g</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 63%"></div>
</div>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-3">Medical History</h3>
<div class="flex flex-col gap-2">
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Synopsis</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Client presents with hypertension and is classified as pre-diabetic. Key focus is on weight management and reducing sodium intake. Multiple food allergies require careful planning...</p>
</details>
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Recent Labs</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Fasting Glucose: 115 mg/dL (High)<br/>A1c: 5.9% (Elevated)</p>
</details>
</div>
</div>
</aside>
</main>
</div>
<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50">
<div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl flex flex-col h-[90vh] overflow-hidden">
<header class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
<h2 class="text-lg font-semibold text-gray-900 dark:text-white">Add to Plan</h2>
<button class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400">close</span>
</button>
</header>
<div class="p-4 flex-shrink-0">
<div class="flex gap-4">
<div class="relative flex-grow">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input class="w-full pl-10 pr-4 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Search food, meals, or templates..." type="text"/>
</div>
<select class="text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 focus:ring-primary focus:border-primary dark:text-gray-300">
<option>Meal Type</option>
<option>Breakfast</option>
<option>Lunch</option>
<option>Dinner</option>
<option>Snack</option>
</select>
<select class="text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 focus:ring-primary focus:border-primary dark:text-gray-300">
<option>Cuisine</option>
<option>Italian</option>
<option>Indian</option>
<option>Mexican</option>
<option>Chinese</option>
</select>
</div>
<div class="flex gap-2 mt-4 text-sm">
<button class="px-3 py-1.5 rounded-full bg-primary/10 text-primary dark:bg-primary/20 font-medium">All</button>
<button class="px-3 py-1.5 rounded-full bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600">Food Items</button>
<button class="px-3 py-1.5 rounded-full bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600">My Meals</button>
<button class="px-3 py-1.5 rounded-full bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600">Templates</button>
</div>
</div>
<main class="flex-grow overflow-y-auto px-4">
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
<div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3 flex flex-col hover:border-primary dark:hover:border-primary cursor-pointer transition-colors">
<div class="flex justify-between items-start mb-2">
<div>
<p class="font-semibold text-gray-900 dark:text-white">High-Protein Breakfast</p>
<span class="text-xs text-primary bg-primary/10 dark:bg-primary/20 px-2 py-0.5 rounded-full">Template</span>
</div>
<button class="p-1 text-gray-500 hover:text-primary"><span class="material-symbols-outlined">add_circle</span></button>
</div>
<p class="text-sm text-gray-500 dark:text-gray-400 mb-3 flex-grow">Scrambled eggs, turkey sausage, and whole wheat toast.</p>
<div class="text-xs text-gray-500 dark:text-gray-400 flex justify-between items-center">
<span>450 Kcal</span>
<span>P: 35g</span>
<span>C: 30g</span>
<span>F: 20g</span>
</div>
</div>
<div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3 flex flex-col hover:border-primary dark:hover:border-primary cursor-pointer transition-colors">
<div class="flex justify-between items-start mb-2">
<div>
<p class="font-semibold text-gray-900 dark:text-white">Chicken Salad Lunch</p>
<span class="text-xs text-blue-600 bg-blue-100 dark:bg-blue-900/40 dark:text-blue-300 px-2 py-0.5 rounded-full">My Meal</span>
</div>
<button class="p-1 text-gray-500 hover:text-primary"><span class="material-symbols-outlined">add_circle</span></button>
</div>
<p class="text-sm text-gray-500 dark:text-gray-400 mb-3 flex-grow">Grilled chicken breast, mixed greens, cherry tomatoes, cucumbers, with a light vinaigrette.</p>
<div class="text-xs text-gray-500 dark:text-gray-400 flex justify-between items-center">
<span>350 Kcal</span>
<span>P: 40g</span>
<span>C: 10g</span>
<span>F: 18g</span>
</div>
</div>
<div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3 flex flex-col hover:border-primary dark:hover:border-primary cursor-pointer transition-colors">
<div class="flex justify-between items-start mb-2">
<div>
<p class="font-semibold text-gray-900 dark:text-white">Apple</p>
<span class="text-xs text-purple-600 bg-purple-100 dark:bg-purple-900/40 dark:text-purple-300 px-2 py-0.5 rounded-full">Food Item</span>
</div>
<button class="p-1 text-gray-500 hover:text-primary"><span class="material-symbols-outlined">add_circle</span></button>
</div>
<p class="text-sm text-gray-500 dark:text-gray-400 mb-3 flex-grow">1 medium (approx. 182g)</p>
<div class="text-xs text-gray-500 dark:text-gray-400 flex justify-between items-center">
<span>95 Kcal</span>
<span>P: 0.5g</span>
<span>C: 25g</span>
<span>F: 0.3g</span>
</div>
</div>
<div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3 flex flex-col hover:border-primary dark:hover:border-primary cursor-pointer transition-colors">
<div class="flex justify-between items-start mb-2">
<div>
<p class="font-semibold text-gray-900 dark:text-white">Almonds</p>
<span class="text-xs text-purple-600 bg-purple-100 dark:bg-purple-900/40 dark:text-purple-300 px-2 py-0.5 rounded-full">Food Item</span>
</div>
<button class="p-1 text-gray-500 hover:text-primary"><span class="material-symbols-outlined">add_circle</span></button>
</div>
<p class="text-sm text-gray-500 dark:text-gray-400 mb-3 flex-grow">1 ounce (approx. 23 nuts)</p>
<div class="text-xs text-gray-500 dark:text-gray-400 flex justify-between items-center">
<span>164 Kcal</span>
<span>P: 6g</span>
<span>C: 6g</span>
<span>F: 14g</span>
</div>
</div>
<div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3 flex flex-col hover:border-primary dark:hover:border-primary cursor-pointer transition-colors">
<div class="flex justify-between items-start mb-2">
<div>
<p class="font-semibold text-gray-900 dark:text-white">Keto Dinner</p>
<span class="text-xs text-primary bg-primary/10 dark:bg-primary/20 px-2 py-0.5 rounded-full">Template</span>
</div>
<button class="p-1 text-gray-500 hover:text-primary"><span class="material-symbols-outlined">add_circle</span></button>
</div>
<p class="text-sm text-gray-500 dark:text-gray-400 mb-3 flex-grow">Salmon with asparagus and lemon-butter sauce.</p>
<div class="text-xs text-gray-500 dark:text-gray-400 flex justify-between items-center">
<span>550 Kcal</span>
<span>P: 45g</span>
<span>C: 15g</span>
<span>F: 35g</span>
</div>
</div>
<div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3 flex flex-col hover:border-primary dark:hover:border-primary cursor-pointer transition-colors">
<div class="flex justify-between items-start mb-2">
<div>
<p class="font-semibold text-gray-900 dark:text-white">Greek Yogurt</p>
<span class="text-xs text-purple-600 bg-purple-100 dark:bg-purple-900/40 dark:text-purple-300 px-2 py-0.5 rounded-full">Food Item</span>
</div>
<button class="p-1 text-gray-500 hover:text-primary"><span class="material-symbols-outlined">add_circle</span></button>
</div>
<p class="text-sm text-gray-500 dark:text-gray-400 mb-3 flex-grow">1 container (170g), plain, non-fat</p>
<div class="text-xs text-gray-500 dark:text-gray-400 flex justify-between items-center">
<span>100 Kcal</span>
<span>P: 17g</span>
<span>C: 6g</span>
<span>F: 0g</span>
</div>
</div>
</div>
</main>
<footer class="flex-shrink-0 p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800">
<div class="flex justify-end gap-2">
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-gray-200 dark:bg-gray-600 text-gray-900 dark:text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">Cancel</span>
</button>
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">Add to Plan</span>
</button>
</div>
</footer>
</div>
</div>
</body></html>
</file>

<file path="Design/website/Design/diet_plan_creation_page_2/code.html">
<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Diet Plan Creation - Sarah Singh</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #e0e0e0;
            border-radius: 3px;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #4a5568;
        }
    </style>
<script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#17cf54",
              "background-light": "#f6f8f6",
              "background-dark": "#112116",
              "success": "#7ED321",
              "warning": "#F5A623",
              "error": "#D0021B",
            },
            fontFamily: {
              "display": ["Inter", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-gray-800 dark:text-gray-200">
<div class="flex flex-col h-screen">
<header class="flex items-center justify-between whitespace-nowrap border-b border-gray-200 dark:border-gray-700 px-6 py-3 bg-white dark:bg-gray-800 flex-shrink-0">
<div class="flex items-center gap-9">
<a class="flex items-center gap-2 text-gray-700 dark:text-gray-300 text-sm font-medium leading-normal" href="#">
<span class="material-symbols-outlined text-lg">arrow_back</span>
                    Back to Client
                </a>
<span class="text-gray-900 dark:text-white text-sm font-medium leading-normal">Client: Sarah Singh (28F)</span>
</div>
<div class="flex gap-2">
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-3">
<span class="material-symbols-outlined text-xl">visibility</span>
<span class="hidden sm:inline">Preview</span>
</button>
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-3">
<span class="material-symbols-outlined text-xl">download</span>
<span class="hidden sm:inline">Export</span>
</button>
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-gray-200 dark:bg-gray-600 text-gray-900 dark:text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">Save as Draft</span>
</button>
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">Publish</span>
</button>
</div>
</header>
<main class="flex-grow grid grid-cols-12 gap-4 p-4 overflow-auto">
<aside class="col-span-3 flex flex-col gap-4 overflow-y-auto pr-2">
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-12" data-alt="Photo of Sarah Singh" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuA_mfGBlTQqbqWv8MiukpmpcdMKyoot_7VGTR9C8fop9lNumZzgPYbCu-QiZjXw6-RWx5hru5ihyNxKq2ttqVv2FZmOCeNblDNZb4lNdfRIVPfXXtrQEUb2FSfZq3m461r8eugVlFRScfL8MoqNwzgVFKNd-8EMeg5HvSQknPL05tPwV2bbWMekciSamP4BbVZ9eyfdQKkK3Xa2xiLM3Nwlbcu8JI3uVvb6e5wAOJ68-QfGk7bUE-evRyxiK2CMLt2-sQ6lA1rrw5HT");'></div>
<div class="flex flex-col">
<h1 class="text-gray-900 dark:text-white text-base font-medium leading-normal">Sarah Singh</h1>
<p class="text-gray-500 dark:text-gray-400 text-sm font-normal leading-normal">28F, 165cm, 70kg</p>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<p class="text-gray-900 dark:text-white text-base font-medium leading-normal">Weight Trend</p>
<p class="text-gray-900 dark:text-white tracking-light text-[32px] font-bold leading-tight truncate">70kg <span class="text-gray-400 text-xl font-medium">/ Goal 65kg</span></p>
<div class="flex gap-1 items-center">
<p class="text-gray-500 dark:text-gray-400 text-sm font-normal leading-normal">Last 30 Days</p>
<p class="text-error text-sm font-medium leading-normal flex items-center gap-1"><span class="material-symbols-outlined text-base">trending_down</span> -2kg</p>
</div>
<div class="flex min-h-[100px] flex-1 flex-col pt-4">
<svg fill="none" height="100" preserveAspectRatio="none" viewBox="-3 0 478 150" width="100%" xmlns="http://www.w3.org/2000/svg">
<path d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25V149H326.769H0V109Z" fill="url(#paint0_linear_1131_5935_light)"></path>
<path d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25" stroke="#4e9767" stroke-linecap="round" stroke-width="3"></path>
<defs>
<linearGradient gradientUnits="userSpaceOnUse" id="paint0_linear_1131_5935_light" x1="236" x2="236" y1="1" y2="149">
<stop stop-color="#e7f3eb"></stop>
<stop offset="1" stop-color="#e7f3eb" stop-opacity="0"></stop>
</linearGradient>
</defs>
</svg>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-3">Previous Plans</h3>
<div class="flex flex-col gap-1">
<div class="flex items-center gap-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 p-2 rounded-lg cursor-pointer">
<div class="text-gray-800 dark:text-gray-200 flex items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-700 shrink-0 size-10">
<span class="material-symbols-outlined text-xl">description</span>
</div>
<div class="flex flex-col justify-center">
<p class="text-gray-800 dark:text-gray-100 text-sm font-medium leading-normal line-clamp-1">High Protein Plan</p>
<p class="text-gray-500 dark:text-gray-400 text-xs font-normal leading-normal line-clamp-2">Created by Dr. Evans</p>
</div>
<p class="text-gray-400 dark:text-gray-500 text-xs font-normal leading-normal ml-auto">Nov 15, 2023</p>
</div>
<div class="flex items-center gap-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 p-2 rounded-lg cursor-pointer">
<div class="text-gray-800 dark:text-gray-200 flex items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-700 shrink-0 size-10">
<span class="material-symbols-outlined text-xl">description</span>
</div>
<div class="flex flex-col justify-center">
<p class="text-gray-800 dark:text-gray-100 text-sm font-medium leading-normal line-clamp-1">Keto Diet Start</p>
<p class="text-gray-500 dark:text-gray-400 text-xs font-normal leading-normal line-clamp-2">Created by You</p>
</div>
<p class="text-gray-400 dark:text-gray-500 text-xs font-normal leading-normal ml-auto">Oct 21, 2023</p>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-3">Medical Summary</h3>
<div class="flex flex-col gap-2">
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Diagnoses</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Hypertension, Pre-diabetic</p>
</details>
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group" open="">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Allergies</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Dairy, Peanuts, Shellfish</p>
</details>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-2">Notes &amp; Alerts</h3>
<textarea class="w-full h-24 p-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add a note for this client...">Client reports feeling bloated after high-carb meals. Monitor closely.</textarea>
</div>
</aside>
<section class="col-span-6 flex flex-col gap-4 overflow-y-auto">
<div class="flex-shrink-0 bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center text-center">
<button class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400">chevron_left</span>
</button>
<div class="flex gap-1">
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 1 (Mon)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-white bg-primary">Dec 2 (Tue)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 3 (Wed)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 4 (Thu)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 5 (Fri)</button>
</div>
<button class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400">chevron_right</span>
</button>
</div>
</div>
<div class="space-y-4">
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<div class="flex items-center gap-2">
<h3 class="text-lg font-semibold text-gray-900 dark:text-white">Breakfast</h3>
<input class="text-sm p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="time" value="08:00"/>
</div>
<p class="text-xs font-medium text-gray-500 dark:text-gray-400">350 Kcal | P:20g, C:45g, F:10g</p>
</div>
<div class="space-y-2 mb-3">
<div class="flex items-center gap-2 p-2 rounded-md bg-gray-50 dark:bg-gray-700/50">
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Oatmeal</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="1 cup"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
<div class="flex items-center gap-2 p-2 rounded-md bg-gray-50 dark:bg-gray-700/50">
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Blueberries</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="1/2 cup"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
</div>
<div class="flex gap-2">
<div class="relative flex-grow">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add food item..." type="text"/>
</div>
<button class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600">
<span class="material-symbols-outlined text-lg">menu_book</span>
<span>Templates</span>
</button>
</div>
<textarea class="mt-3 w-full p-2 text-xs border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add a note for the client..."></textarea>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<div class="flex items-center gap-2">
<h3 class="text-lg font-semibold text-gray-900 dark:text-white">Lunch</h3>
<input class="text-sm p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="time" value="13:00"/>
</div>
<p class="text-xs font-medium text-gray-500 dark:text-gray-400">650 Kcal | P:40g, C:60g, F:28g</p>
</div>
<div class="space-y-2 mb-3">
<div class="flex items-center gap-2 p-2 rounded-md bg-red-50 dark:bg-red-900/20 border border-error">
<span class="text-error mr-2"><span class="material-symbols-outlined text-lg">warning</span></span>
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Paneer Tikka</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="150g"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
<div class="flex items-center gap-2 p-2 rounded-md bg-gray-50 dark:bg-gray-700/50">
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Brown Rice</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="1 cup"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
</div>
<div class="flex gap-2">
<div class="relative flex-grow">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add food item..." type="text"/>
</div>
<button class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600">
<span class="material-symbols-outlined text-lg">menu_book</span>
<span>Templates</span>
</button>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<div class="flex items-center gap-2">
<h3 class="text-lg font-semibold text-gray-900 dark:text-white">Dinner</h3>
<input class="text-sm p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="time" value="19:30"/>
</div>
<p class="text-xs font-medium text-gray-500 dark:text-gray-400">0 Kcal | P:0g, C:0g, F:0g</p>
</div>
<div class="flex gap-2">
<div class="relative flex-grow">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add food item..." type="text"/>
</div>
<button class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600">
<span class="material-symbols-outlined text-lg">menu_book</span>
<span>Templates</span>
</button>
</div>
</div>
</div>
</section>
<aside class="col-span-3 flex flex-col gap-4 overflow-y-auto pl-2">
<div class="bg-error/10 dark:bg-error/20 border border-error p-4 rounded-lg">
<div class="flex items-start gap-3">
<span class="material-symbols-outlined text-error text-xl mt-0.5">error</span>
<div>
<h4 class="font-bold text-error">Allergy Warning</h4>
<p class="text-sm text-error/80 dark:text-error/90">You added Paneer (dairy). This client has a <span class="font-semibold">Dairy</span> allergy.</p>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal">Plan At-a-Glance</h3>
<span class="text-xs text-gray-500">Target: 1800 Kcal</span>
</div>
<div class="space-y-4">
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Today's Calories</span>
<span class="font-medium text-gray-600 dark:text-gray-400">1000 / 1800 kcal</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 55%"></div>
</div>
</div>
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Protein</span>
<span class="font-medium text-gray-600 dark:text-gray-400">60 / 90 g</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 66%"></div>
</div>
</div>
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Carbohydrates</span>
<span class="font-medium text-gray-600 dark:text-gray-400">105 / 200 g</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 52%"></div>
</div>
</div>
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Fat</span>
<span class="font-medium text-gray-600 dark:text-gray-400">38 / 60 g</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 63%"></div>
</div>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-3">Medical History</h3>
<div class="flex flex-col gap-2">
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Synopsis</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Client presents with hypertension and is classified as pre-diabetic. Key focus is on weight management and reducing sodium intake. Multiple food allergies require careful planning...</p>
</details>
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Recent Labs</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Fasting Glucose: 115 mg/dL (High)<br/>A1c: 5.9% (Elevated)</p>
</details>
</div>
</div>
</aside>
</main>
</div>
</body></html>
</file>

<file path="Design/website/Design/diet_plan_creation_page_3/code.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Diet Plan Creation - Sarah Singh</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        /* Simple scrollbar styling for a cleaner look */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #e0e0e0;
            border-radius: 3px;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #4a5568;
        }
    </style>
<script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#17cf54",
              "background-light": "#f6f8f6",
              "background-dark": "#112116",
              "success": "#7ED321",
              "warning": "#F5A623",
              "error": "#D0021B",
            },
            fontFamily: {
              "display": ["Inter", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-gray-800 dark:text-gray-200">
<div class="flex flex-col h-screen">
<!-- Top Nav Bar -->
<header class="flex items-center justify-between whitespace-nowrap border-b border-gray-200 dark:border-gray-700 px-6 py-3 bg-white dark:bg-gray-800 flex-shrink-0">
<div class="flex items-center gap-9">
<a class="flex items-center gap-2 text-gray-700 dark:text-gray-300 text-sm font-medium leading-normal" href="#">
<span class="material-symbols-outlined text-lg">arrow_back</span>
                    Back to Client
                </a>
<span class="text-gray-900 dark:text-white text-sm font-medium leading-normal">Client: Sarah Singh (28F)</span>
</div>
<div class="flex gap-2">
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-3">
<span class="material-symbols-outlined text-xl">visibility</span>
<span class="hidden sm:inline">Preview</span>
</button>
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-3">
<span class="material-symbols-outlined text-xl">download</span>
<span class="hidden sm:inline">Export</span>
</button>
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-gray-200 dark:bg-gray-600 text-gray-900 dark:text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">Save as Draft</span>
</button>
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">Publish</span>
</button>
</div>
</header>
<!-- Main Content Area -->
<main class="flex-grow grid grid-cols-12 gap-4 p-4 overflow-auto">
<!-- Left Sidebar Info Panel -->
<aside class="col-span-3 flex flex-col gap-4 overflow-y-auto pr-2">
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-12" data-alt="Photo of Sarah Singh" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuA_mfGBlTQqbqWv8MiukpmpcdMKyoot_7VGTR9C8fop9lNumZzgPYbCu-QiZjXw6-RWx5hru5ihyNxKq2ttqVv2FZmOCeNblDNZb4lNdfRIVPfXXtrQEUb2FSfZq3m461r8eugVlFRScfL8MoqNwzgVFKNd-8EMeg5HvSQknPL05tPwV2bbWMekciSamP4BbVZ9eyfdQKkK3Xa2xiLM3Nwlbcu8JI3uVvb6e5wAOJ68-QfGk7bUE-evRyxiK2CMLt2-sQ6lA1rrw5HT");'></div>
<div class="flex flex-col">
<h1 class="text-gray-900 dark:text-white text-base font-medium leading-normal">Sarah Singh</h1>
<p class="text-gray-500 dark:text-gray-400 text-sm font-normal leading-normal">28F, 165cm, 70kg</p>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<p class="text-gray-900 dark:text-white text-base font-medium leading-normal">Weight Trend</p>
<p class="text-gray-900 dark:text-white tracking-light text-[32px] font-bold leading-tight truncate">70kg <span class="text-gray-400 text-xl font-medium">/ Goal 65kg</span></p>
<div class="flex gap-1 items-center">
<p class="text-gray-500 dark:text-gray-400 text-sm font-normal leading-normal">Last 30 Days</p>
<p class="text-error text-sm font-medium leading-normal flex items-center gap-1"><span class="material-symbols-outlined text-base">trending_down</span> -2kg</p>
</div>
<div class="flex min-h-[100px] flex-1 flex-col pt-4">
<svg fill="none" height="100" preserveaspectratio="none" viewbox="-3 0 478 150" width="100%" xmlns="http://www.w3.org/2000/svg">
<path d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25V149H326.769H0V109Z" fill="url(#paint0_linear_1131_5935_light)"></path>
<path d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25" stroke="#4e9767" stroke-linecap="round" stroke-width="3"></path>
<defs>
<lineargradient gradientunits="userSpaceOnUse" id="paint0_linear_1131_5935_light" x1="236" x2="236" y1="1" y2="149">
<stop stop-color="#e7f3eb"></stop>
<stop offset="1" stop-color="#e7f3eb" stop-opacity="0"></stop>
</lineargradient>
</defs>
</svg>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-3">Previous Plans</h3>
<div class="flex flex-col gap-1">
<div class="flex items-center gap-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 p-2 rounded-lg cursor-pointer">
<div class="text-gray-800 dark:text-gray-200 flex items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-700 shrink-0 size-10">
<span class="material-symbols-outlined text-xl">description</span>
</div>
<div class="flex flex-col justify-center">
<p class="text-gray-800 dark:text-gray-100 text-sm font-medium leading-normal line-clamp-1">High Protein Plan</p>
<p class="text-gray-500 dark:text-gray-400 text-xs font-normal leading-normal line-clamp-2">Created by Dr. Evans</p>
</div>
<p class="text-gray-400 dark:text-gray-500 text-xs font-normal leading-normal ml-auto">Nov 15, 2023</p>
</div>
<div class="flex items-center gap-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 p-2 rounded-lg cursor-pointer">
<div class="text-gray-800 dark:text-gray-200 flex items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-700 shrink-0 size-10">
<span class="material-symbols-outlined text-xl">description</span>
</div>
<div class="flex flex-col justify-center">
<p class="text-gray-800 dark:text-gray-100 text-sm font-medium leading-normal line-clamp-1">Keto Diet Start</p>
<p class="text-gray-500 dark:text-gray-400 text-xs font-normal leading-normal line-clamp-2">Created by You</p>
</div>
<p class="text-gray-400 dark:text-gray-500 text-xs font-normal leading-normal ml-auto">Oct 21, 2023</p>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-3">Medical Summary</h3>
<div class="flex flex-col gap-2">
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Diagnoses</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Hypertension, Pre-diabetic</p>
</details>
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group" open="">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Allergies</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Dairy, Peanuts, Shellfish</p>
</details>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-2">Notes &amp; Alerts</h3>
<textarea class="w-full h-24 p-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add a note for this client...">Client reports feeling bloated after high-carb meals. Monitor closely.</textarea>
</div>
</aside>
<!-- Center Diet Plan Canvas -->
<section class="col-span-6 flex flex-col gap-4 overflow-y-auto">
<div class="flex-shrink-0 bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center text-center">
<button class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400">chevron_left</span>
</button>
<div class="flex gap-1">
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 1 (Mon)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-white bg-primary">Dec 2 (Tue)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 3 (Wed)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 4 (Thu)</button>
<button class="px-3 py-2 text-sm font-medium rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Dec 5 (Fri)</button>
</div>
<button class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400">chevron_right</span>
</button>
</div>
</div>
<!-- Meal Cards -->
<div class="space-y-4">
<!-- Breakfast -->
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<div class="flex items-center gap-2">
<h3 class="text-lg font-semibold text-gray-900 dark:text-white">Breakfast</h3>
<input class="text-sm p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="time" value="08:00"/>
</div>
<p class="text-xs font-medium text-gray-500 dark:text-gray-400">350 Kcal | P:20g, C:45g, F:10g</p>
</div>
<div class="space-y-2 mb-3">
<div class="flex items-center gap-2 p-2 rounded-md bg-gray-50 dark:bg-gray-700/50">
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Oatmeal</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="1 cup"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
<div class="flex items-center gap-2 p-2 rounded-md bg-gray-50 dark:bg-gray-700/50">
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Blueberries</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="1/2 cup"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
</div>
<div class="relative">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add food item..." type="text"/>
</div>
<textarea class="mt-3 w-full p-2 text-xs border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add a note for the client..."></textarea>
</div>
<!-- Lunch -->
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<div class="flex items-center gap-2">
<h3 class="text-lg font-semibold text-gray-900 dark:text-white">Lunch</h3>
<input class="text-sm p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="time" value="13:00"/>
</div>
<p class="text-xs font-medium text-gray-500 dark:text-gray-400">650 Kcal | P:40g, C:60g, F:28g</p>
</div>
<div class="space-y-2 mb-3">
<div class="flex items-center gap-2 p-2 rounded-md bg-red-50 dark:bg-red-900/20 border border-error">
<span class="text-error mr-2"><span class="material-symbols-outlined text-lg">warning</span></span>
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Paneer Tikka</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="150g"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
<div class="flex items-center gap-2 p-2 rounded-md bg-gray-50 dark:bg-gray-700/50">
<span class="text-gray-800 dark:text-gray-200 text-sm font-medium flex-grow">Brown Rice</span>
<input class="w-20 text-sm text-right p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="text" value="1 cup"/>
<button class="p-1 text-gray-500 dark:text-gray-400 hover:text-error"><span class="material-symbols-outlined text-lg">delete</span></button>
</div>
</div>
<div class="relative">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add food item..." type="text"/>
</div>
</div>
<!-- Dinner -->
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<div class="flex items-center gap-2">
<h3 class="text-lg font-semibold text-gray-900 dark:text-white">Dinner</h3>
<input class="text-sm p-1 border border-gray-200 dark:border-gray-600 rounded-md bg-transparent dark:text-gray-300" type="time" value="19:30"/>
</div>
<p class="text-xs font-medium text-gray-500 dark:text-gray-400">0 Kcal | P:0g, C:0g, F:0g</p>
</div>
<div class="relative">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-md bg-transparent focus:ring-primary focus:border-primary dark:text-gray-300" placeholder="Add food item..." type="text"/>
</div>
</div>
</div>
</section>
<!-- Right Plan/Client Context -->
<aside class="col-span-3 flex flex-col gap-4 overflow-y-auto pl-2">
<div class="bg-error/10 dark:bg-error/20 border border-error p-4 rounded-lg">
<div class="flex items-start gap-3">
<span class="material-symbols-outlined text-error text-xl mt-0.5">error</span>
<div>
<h4 class="font-bold text-error">Allergy Warning</h4>
<p class="text-sm text-error/80 dark:text-error/90">You added Paneer (dairy). This client has a <span class="font-semibold">Dairy</span> allergy.</p>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<div class="flex justify-between items-center mb-3">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal">Plan At-a-Glance</h3>
<span class="text-xs text-gray-500">Target: 1800 Kcal</span>
</div>
<div class="space-y-4">
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Today's Calories</span>
<span class="font-medium text-gray-600 dark:text-gray-400">1000 / 1800 kcal</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 55%"></div>
</div>
</div>
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Protein</span>
<span class="font-medium text-gray-600 dark:text-gray-400">60 / 90 g</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 66%"></div>
</div>
</div>
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Carbohydrates</span>
<span class="font-medium text-gray-600 dark:text-gray-400">105 / 200 g</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 52%"></div>
</div>
</div>
<div>
<div class="flex justify-between text-sm mb-1">
<span class="font-medium text-gray-800 dark:text-gray-200">Fat</span>
<span class="font-medium text-gray-600 dark:text-gray-400">38 / 60 g</span>
</div>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
<div class="bg-primary h-2 rounded-full" style="width: 63%"></div>
</div>
</div>
</div>
</div>
<div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
<h3 class="text-gray-900 dark:text-white text-base font-medium leading-normal mb-3">Medical History</h3>
<div class="flex flex-col gap-2">
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Synopsis</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Client presents with hypertension and is classified as pre-diabetic. Key focus is on weight management and reducing sodium intake. Multiple food allergies require careful planning...</p>
</details>
<details class="flex flex-col rounded-lg bg-gray-50 dark:bg-gray-900/50 px-4 py-1 group">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-2">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Recent Labs</p>
<span class="material-symbols-outlined text-gray-600 dark:text-gray-400 group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<p class="text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal pb-2">Fasting Glucose: 115 mg/dL (High)<br/>A1c: 5.9% (Elevated)</p>
</details>
</div>
</div>
</aside>
</main>
</div>
</body></html>
</file>

<file path="Design/website/Design/landingpage/code.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>NutriDash - Intelligent Nutrition Management</title>
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&amp;display=swap" rel="stylesheet"/>
<!-- Material Symbols -->
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#17cf54",
                        "background-light": "#f6f8f6",
                        "background-dark": "#112116",
                        "text-main": "#0e1b12",
                        "text-secondary": "#4e9767",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
                },
            },
        }
    </script>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-text-main dark:text-white font-display overflow-x-hidden antialiased">
<!-- Navigation -->
<nav class="sticky top-0 z-50 w-full border-b border-[#e7f3eb] dark:border-white/10 bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-md">
<div class="max-w-[1280px] mx-auto px-4 sm:px-10 py-3">
<div class="flex items-center justify-between whitespace-nowrap">
<div class="flex items-center gap-3 text-text-main dark:text-white">
<div class="flex items-center justify-center size-8 rounded-lg bg-primary/20 text-primary">
<span class="material-symbols-outlined text-[24px]">nutrition</span>
</div>
<h2 class="text-lg font-bold leading-tight tracking-[-0.015em]">NutriDash</h2>
</div>
<div class="hidden md:flex flex-1 justify-end gap-8 items-center">
<div class="flex items-center gap-9">
<a class="text-sm font-medium hover:text-primary transition-colors" href="#">Features</a>
<a class="text-sm font-medium hover:text-primary transition-colors" href="#">Pricing</a>
<a class="text-sm font-medium hover:text-primary transition-colors" href="#">About</a>
</div>
<div class="flex gap-2">
<button class="flex items-center justify-center overflow-hidden rounded-lg h-9 px-4 bg-transparent hover:bg-black/5 dark:hover:bg-white/5 text-sm font-bold transition-colors">
<span>Login</span>
</button>
<button class="flex items-center justify-center overflow-hidden rounded-lg h-9 px-4 bg-primary hover:bg-primary/90 text-text-main text-sm font-bold transition-colors shadow-sm shadow-primary/20">
<span>Get Started</span>
</button>
</div>
</div>
<!-- Mobile Menu Icon -->
<div class="md:hidden flex items-center">
<button class="p-2 text-text-main dark:text-white">
<span class="material-symbols-outlined">menu</span>
</button>
</div>
</div>
</div>
</nav>
<!-- Hero Section -->
<div class="relative w-full">
<!-- Background decorative elements -->
<div class="absolute top-0 right-0 -z-10 w-1/2 h-full bg-gradient-to-l from-primary/5 to-transparent"></div>
<div class="layout-container flex flex-col justify-center">
<div class="px-4 md:px-10 lg:px-40 flex flex-1 justify-center py-10 lg:py-20">
<div class="layout-content-container flex flex-col max-w-[1280px] flex-1">
<div class="@container">
<div class="flex flex-col gap-10 lg:gap-16 lg:flex-row items-center">
<!-- Hero Content -->
<div class="flex flex-col gap-6 flex-1 text-center lg:text-left">
<div class="flex flex-col gap-4">
<div class="inline-flex items-center gap-2 self-center lg:self-start px-3 py-1 rounded-full bg-primary/10 border border-primary/20 text-xs font-bold text-primary uppercase tracking-wide">
<span class="size-2 rounded-full bg-primary animate-pulse"></span>
                                        New: AI Meal Planning
                                    </div>
<h1 class="text-4xl sm:text-5xl lg:text-6xl font-black leading-tight tracking-[-0.033em] text-text-main dark:text-white">
                                        Empower Your Practice with <span class="text-primary">Intelligent</span> Nutrition.
                                    </h1>
<h2 class="text-text-main/70 dark:text-white/70 text-lg font-normal leading-relaxed max-w-2xl mx-auto lg:mx-0">
                                        Streamline client tracking, automate meal plans, and visualize patient progress in one secure dashboard tailored for modern dieticians.
                                    </h2>
</div>
<div class="flex flex-wrap gap-3 justify-center lg:justify-start">
<button class="flex min-w-[140px] items-center justify-center rounded-lg h-12 px-6 bg-primary hover:bg-primary/90 text-text-main text-base font-bold transition-all shadow-lg shadow-primary/25">
                                        Start Free Trial
                                    </button>
<button class="flex min-w-[140px] items-center justify-center rounded-lg h-12 px-6 bg-white dark:bg-white/10 border border-[#e7f3eb] dark:border-white/10 hover:bg-[#f0fdf4] dark:hover:bg-white/20 text-text-main dark:text-white text-base font-bold transition-all">
                                        Book a Demo
                                    </button>
</div>
<div class="flex items-center justify-center lg:justify-start gap-4 pt-2">
<div class="flex -space-x-2">
<div class="size-8 rounded-full bg-gray-200 border-2 border-white dark:border-[#112116] bg-cover" data-alt="Portrait of a female user" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuDghaDbjhAACb4EFl89i7zRxRK_Xudncr1reOFU4g6FLr0np0HclB3D2nyT8R3-fqeXI6JShZkNtx7shPUfXvEL7TyZSZKJp17qhLWwLgBholLEsyg9uySAcUUuRoIlhUv6dvH3-N0xCcEa2cVzgt1tsFi1vPGkVBPwpnW1C-txADm_OglB9TWMfXtQkPKwu0Y7c32o0KVlcVeFDr4MZMMaTJ6n1f3GgiOZt9V2aISqH47Pm5zI5TWlgTf9QemEn0PTgHGFKzgpvomQ');"></div>
<div class="size-8 rounded-full bg-gray-200 border-2 border-white dark:border-[#112116] bg-cover" data-alt="Portrait of a male user" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuAmtu7nsCZYduF9h10m3RlVcX4taNbLEQdsfffBXXEbw9uYy6N7NkMhxnJwHOzwY-1ow9lCSLjv3zFff5hYFNXlfgiPO2ZxF7fWVg66dlOeemCdBMlggIqApYY_w5X37fXtlIpKJaSychF6KtvqI3asmNRSXtoMm-lNUVH-KkhPBl4z2sUvGD7n2FH5MXZlAspJimCCmdxV2UspZNRp4JxaeFjFk_pK0in1oGGORrd8Ar2gWVAYbDf7Cbr2wfZneKOdpJvzy8onL-Rt');"></div>
<div class="size-8 rounded-full bg-gray-200 border-2 border-white dark:border-[#112116] bg-cover" data-alt="Portrait of a male user" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuDqv4YdpwwhTTTQ61jVQRfzlKVMxLLsqeYOYbCONfc7BQu3SdtkA53EhJmI2f9cSOtUp3ohEEAJ2szccWN56lTcwY6Xf5eA1zYu6bcDEqLHxvaALVH_1gC1pO08Cl7UIrf-pWlSGgOcetsLDB58IvgpzPTgynl2RBK7IJNLO2C5wFUBWLdYqyiOmFhHFEu0qMWmansPpBvxdSlFfjwQZ-wK4PD2BPKATY4yTNRcbJO1ZTB1PvjwcNJGe8NoDD7Q9CT1wL16lveGeDu7');"></div>
<div class="flex items-center justify-center size-8 rounded-full bg-primary text-text-main text-[10px] font-bold border-2 border-white dark:border-[#112116]">+2k</div>
</div>
<p class="text-sm font-medium text-text-main/60 dark:text-white/60">Professionals trust us</p>
</div>
</div>
<!-- Hero Image -->
<div class="w-full lg:w-1/2 flex justify-center lg:justify-end relative">
<div class="absolute -inset-4 bg-primary/20 blur-3xl rounded-full opacity-30"></div>
<div class="relative w-full aspect-[4/3] rounded-xl overflow-hidden shadow-2xl border border-black/5 dark:border-white/10 bg-white dark:bg-[#1a2e20]">
<!-- Abstract UI representation -->
<div class="w-full h-full bg-cover bg-center bg-no-repeat" data-alt="Dashboard interface displaying charts and health metrics on a laptop screen" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuBih9ymp3pJ4iQWQgZ4sgBoYEVcsmjOrXJxGVB_skTJbzoNdCtlgvnbIjTbGppGfLTnr_YxQyJtwWVZkVyIFNmICeQyYXJxDE1UCNVBzMG34C8n-4wm92zW3_lC45VOKShAKWb1BUvYbtaA2ZubFvfiM_zFpCSMXmDGF_jxO4y-jsNTCn5sxuuJbZmkx0wevS5Tzr85-CBmilXthV-F629fzCWsdeSki_wbabjgmIMMjxNFEFPgIzdK7Gr7Nd940TjIiw2sUbGrPZNn');"></div>
<!-- Floating Element 1 -->
<div class="absolute bottom-6 left-6 p-4 bg-white dark:bg-[#1e3324] rounded-lg shadow-lg border border-primary/10 flex items-center gap-3 animate-bounce" style="animation-duration: 3s;">
<div class="size-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center text-primary">
<span class="material-symbols-outlined">check_circle</span>
</div>
<div>
<p class="text-xs text-text-main/50 dark:text-white/50 font-medium">Daily Goal</p>
<p class="text-sm font-bold text-text-main dark:text-white">Meal Plan Added</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- Section Header: Features -->
<div class="w-full bg-white dark:bg-[#16291d] py-16">
<div class="layout-container flex flex-col items-center">
<div class="px-4 md:px-10 max-w-[960px] text-center mb-12">
<span class="text-primary font-bold tracking-wider text-sm uppercase mb-2 block">Core Features</span>
<h2 class="text-3xl md:text-4xl font-bold leading-tight tracking-[-0.015em] text-text-main dark:text-white">
                    Everything you need to run a modern clinic
                </h2>
<p class="mt-4 text-text-main/60 dark:text-white/60 max-w-2xl mx-auto">
                    Focus on your patients while we handle the administration, planning, and tracking.
                </p>
</div>
<!-- Features Grid -->
<div class="px-4 md:px-10 max-w-[1280px] w-full">
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
<!-- Feature 1 -->
<div class="group flex flex-col gap-4 rounded-xl border border-[#d0e7d7] dark:border-white/10 bg-background-light dark:bg-background-dark p-6 transition-all hover:shadow-lg hover:border-primary/50">
<div class="size-12 rounded-lg bg-primary/10 flex items-center justify-center text-primary group-hover:bg-primary group-hover:text-text-main transition-colors">
<span class="material-symbols-outlined text-[28px]">restaurant_menu</span>
</div>
<div class="flex flex-col gap-2">
<h3 class="text-xl font-bold text-text-main dark:text-white">Smart Meal Planning</h3>
<p class="text-text-secondary dark:text-white/60 text-sm leading-relaxed">
                                AI-assisted drag-and-drop diet creation. Create balanced plans in seconds, not hours.
                            </p>
</div>
</div>
<!-- Feature 2 -->
<div class="group flex flex-col gap-4 rounded-xl border border-[#d0e7d7] dark:border-white/10 bg-background-light dark:bg-background-dark p-6 transition-all hover:shadow-lg hover:border-primary/50">
<div class="size-12 rounded-lg bg-primary/10 flex items-center justify-center text-primary group-hover:bg-primary group-hover:text-text-main transition-colors">
<span class="material-symbols-outlined text-[28px]">chat_bubble_outline</span>
</div>
<div class="flex flex-col gap-2">
<h3 class="text-xl font-bold text-text-main dark:text-white">Patient Portal</h3>
<p class="text-text-secondary dark:text-white/60 text-sm leading-relaxed">
                                Secure direct messaging, document sharing, and progress tracking for your clients.
                            </p>
</div>
</div>
<!-- Feature 3 -->
<div class="group flex flex-col gap-4 rounded-xl border border-[#d0e7d7] dark:border-white/10 bg-background-light dark:bg-background-dark p-6 transition-all hover:shadow-lg hover:border-primary/50">
<div class="size-12 rounded-lg bg-primary/10 flex items-center justify-center text-primary group-hover:bg-primary group-hover:text-text-main transition-colors">
<span class="material-symbols-outlined text-[28px]">monitoring</span>
</div>
<div class="flex flex-col gap-2">
<h3 class="text-xl font-bold text-text-main dark:text-white">Data Analytics</h3>
<p class="text-text-secondary dark:text-white/60 text-sm leading-relaxed">
                                Visualize health trends, weight changes, and adherence rates instantly with beautiful charts.
                            </p>
</div>
</div>
<!-- Feature 4 -->
<div class="group flex flex-col gap-4 rounded-xl border border-[#d0e7d7] dark:border-white/10 bg-background-light dark:bg-background-dark p-6 transition-all hover:shadow-lg hover:border-primary/50">
<div class="size-12 rounded-lg bg-primary/10 flex items-center justify-center text-primary group-hover:bg-primary group-hover:text-text-main transition-colors">
<span class="material-symbols-outlined text-[28px]">event_available</span>
</div>
<div class="flex flex-col gap-2">
<h3 class="text-xl font-bold text-text-main dark:text-white">Scheduling &amp; Booking</h3>
<p class="text-text-secondary dark:text-white/60 text-sm leading-relaxed">
                                Integrated calendar that syncs with Google and Outlook. Reduce no-shows with automated reminders.
                            </p>
</div>
</div>
<!-- Feature 5 -->
<div class="group flex flex-col gap-4 rounded-xl border border-[#d0e7d7] dark:border-white/10 bg-background-light dark:bg-background-dark p-6 transition-all hover:shadow-lg hover:border-primary/50">
<div class="size-12 rounded-lg bg-primary/10 flex items-center justify-center text-primary group-hover:bg-primary group-hover:text-text-main transition-colors">
<span class="material-symbols-outlined text-[28px]">verified_user</span>
</div>
<div class="flex flex-col gap-2">
<h3 class="text-xl font-bold text-text-main dark:text-white">HIPAA Compliant</h3>
<p class="text-text-secondary dark:text-white/60 text-sm leading-relaxed">
                                Enterprise-grade security keeps your patient data safe and compliant with global regulations.
                            </p>
</div>
</div>
<!-- Feature 6 -->
<div class="group flex flex-col gap-4 rounded-xl border border-[#d0e7d7] dark:border-white/10 bg-background-light dark:bg-background-dark p-6 transition-all hover:shadow-lg hover:border-primary/50">
<div class="size-12 rounded-lg bg-primary/10 flex items-center justify-center text-primary group-hover:bg-primary group-hover:text-text-main transition-colors">
<span class="material-symbols-outlined text-[28px]">smartphone</span>
</div>
<div class="flex flex-col gap-2">
<h3 class="text-xl font-bold text-text-main dark:text-white">Mobile Companion App</h3>
<p class="text-text-secondary dark:text-white/60 text-sm leading-relaxed">
                                Give patients a dedicated app to log meals, view plans, and stay connected on the go.
                            </p>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- Stats Section -->
<div class="w-full bg-primary/5 border-y border-primary/10 py-12">
<div class="max-w-[1280px] mx-auto px-4 sm:px-10">
<div class="flex flex-wrap justify-around items-center gap-8 text-center">
<div class="flex flex-col gap-1">
<span class="text-4xl font-black text-text-main dark:text-white tracking-tight">10k+</span>
<span class="text-sm font-medium text-text-secondary uppercase tracking-wider">Professionals</span>
</div>
<div class="w-px h-12 bg-primary/20 hidden md:block"></div>
<div class="flex flex-col gap-1">
<span class="text-4xl font-black text-text-main dark:text-white tracking-tight">2M+</span>
<span class="text-sm font-medium text-text-secondary uppercase tracking-wider">Meal Plans Created</span>
</div>
<div class="w-px h-12 bg-primary/20 hidden md:block"></div>
<div class="flex flex-col gap-1">
<span class="text-4xl font-black text-text-main dark:text-white tracking-tight">98%</span>
<span class="text-sm font-medium text-text-secondary uppercase tracking-wider">Customer Satisfaction</span>
</div>
</div>
</div>
</div>
<!-- Testimonials Section -->
<div class="w-full py-20 bg-background-light dark:bg-background-dark">
<div class="layout-container flex flex-col items-center">
<div class="px-4 md:px-10 max-w-[960px] text-center mb-16">
<h2 class="text-3xl font-bold leading-tight tracking-[-0.015em] text-text-main dark:text-white">
                    Trusted by Top Nutritionists
                </h2>
</div>
<div class="px-4 md:px-10 max-w-[1280px] w-full">
<div class="grid grid-cols-1 md:grid-cols-3 gap-8">
<!-- Card 1 -->
<div class="flex flex-col justify-between p-8 bg-white dark:bg-[#16291d] rounded-2xl shadow-sm border border-[#e7f3eb] dark:border-white/5">
<div class="mb-6 text-primary">
<span class="material-symbols-outlined text-4xl">format_quote</span>
</div>
<p class="text-lg text-text-main dark:text-white/90 font-medium leading-relaxed mb-8">
                            "NutriDash cut my administrative time in half. The meal planning tool is intuitive and my clients love the mobile app. It's a game changer."
                        </p>
<div class="flex items-center gap-4">
<div class="size-12 rounded-full bg-cover bg-center" data-alt="Portrait of Dr. Sarah Chen" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuCHeRzfG33d56VwzPgXHjPSZfDmpbBeNW8QIToEJlAU_x5BggfpDJIOmgM2sTy5hx_52BJbxFlWgxjfmZs9X1d7tDJ_2fawJIzEjK1VcNu--eQcgJ6Elxh8KD-m8Z7gIR52dt4IxrpLygyCha3Lxaod_gVmvtm_E3xhKK77Ni4QDKeCEqLZuEC0946UT_rcYoxprS75x6Z7rmqXjvo7ekP2RmtY9acajYQ6R8PmWewLdKD_EJDrg7SJk644S1LpeQTB0R-f31On4X_i');"></div>
<div>
<h4 class="font-bold text-text-main dark:text-white">Dr. Sarah Chen</h4>
<p class="text-sm text-text-secondary">Clinical Dietician</p>
</div>
</div>
</div>
<!-- Card 2 -->
<div class="flex flex-col justify-between p-8 bg-white dark:bg-[#16291d] rounded-2xl shadow-sm border border-[#e7f3eb] dark:border-white/5 relative">
<!-- Decorative bg -->
<div class="absolute top-0 right-0 p-8 opacity-10 pointer-events-none">
<svg fill="none" height="100" viewbox="0 0 100 100" width="100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" fill="#17cf54" r="50"></circle></svg>
</div>
<div class="mb-6 text-primary">
<span class="material-symbols-outlined text-4xl">format_quote</span>
</div>
<p class="text-lg text-text-main dark:text-white/90 font-medium leading-relaxed mb-8">
                            "Finally, a dashboard that looks good and works even better. The analytics feature helps me show tangible progress to my patients, which boosts retention."
                        </p>
<div class="flex items-center gap-4">
<div class="size-12 rounded-full bg-cover bg-center" data-alt="Portrait of Marcus Johnson" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuAEERF2__oRF6h6ghkZZbHEEV3mVFinYWtHLAz2lUaeddS1dGFxDCVMozBMWYyPDwgY3EYOnduJfKJKK4tw-cP92W-P3BbZV4FOxiDQJS-1Vu9ddQoeT9fhqunK8l3XVKxretCID8RzJF_c-qurlOzvBOqDswlA0YntPNlz-7Ga9mS3DjfCFn1xgtqFkRkC7KsnA-rdT-2Sf8MHwZyFe8z0rGfffj2i339TtL45XZG47MH_oBsLfjx_P_04Rno32xztjIp_22UBuPFm');"></div>
<div>
<h4 class="font-bold text-text-main dark:text-white">Marcus Johnson</h4>
<p class="text-sm text-text-secondary">Sports Nutritionist</p>
</div>
</div>
</div>
<!-- Card 3 -->
<div class="flex flex-col justify-between p-8 bg-white dark:bg-[#16291d] rounded-2xl shadow-sm border border-[#e7f3eb] dark:border-white/5">
<div class="mb-6 text-primary">
<span class="material-symbols-outlined text-4xl">format_quote</span>
</div>
<p class="text-lg text-text-main dark:text-white/90 font-medium leading-relaxed mb-8">
                            "The automated compliance features give me peace of mind. I can manage more clients without feeling overwhelmed. Highly recommended."
                        </p>
<div class="flex items-center gap-4">
<div class="size-12 rounded-full bg-cover bg-center" data-alt="Portrait of Elena Rodriguez" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuBdV4njegtYcL_wJtNPYa-zXNit1bvvCKI7d-6jVcKxH3R86HnI-mH6HHTtQotMGLjL0VJDKi4jpWgmId_OmApxs47lp5m3Pm-njXMBWSqJKj377T3SYQISSFt5Ptpt5XtBN-IrCtB6c_senI6q-oYjCCTMAIGPG_aO38UOii5_-WRSH3heK2_qAegJ8dVwFI8y_nXJm66uYbCRQUVSs8DxQB1ebPpaKkUutH3ONjk4HXI_71P9VweFBAndI9-WeJalmbwM_2EiW1aN');"></div>
<div>
<h4 class="font-bold text-text-main dark:text-white">Elena Rodriguez</h4>
<p class="text-sm text-text-secondary">Private Practice Owner</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- CTA Section -->
<div class="py-20 px-4">
<div class="max-w-[1280px] mx-auto bg-[#0e1b12] rounded-3xl overflow-hidden relative">
<!-- Background Pattern -->
<div class="absolute inset-0 opacity-20" style="background-image: radial-gradient(#17cf54 1px, transparent 1px); background-size: 30px 30px;"></div>
<div class="relative z-10 flex flex-col md:flex-row items-center justify-between p-10 md:p-16 gap-10">
<div class="flex flex-col gap-6 max-w-2xl">
<h2 class="text-3xl md:text-5xl font-bold text-white leading-tight">Ready to modernize your practice?</h2>
<p class="text-white/80 text-lg">Join thousands of health professionals using NutriDash to deliver better care.</p>
<div class="flex flex-col sm:flex-row gap-4 pt-4">
<button class="flex items-center justify-center rounded-lg h-12 px-8 bg-primary hover:bg-primary/90 text-[#0e1b12] text-base font-bold transition-all shadow-lg shadow-primary/30">
                            Get Started Now
                        </button>
<button class="flex items-center justify-center rounded-lg h-12 px-8 bg-white/10 hover:bg-white/20 text-white text-base font-bold transition-all border border-white/20">
                            Contact Sales
                        </button>
</div>
</div>
<div class="hidden lg:block relative">
<div class="size-64 bg-primary/20 rounded-full blur-3xl absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></div>
<span class="material-symbols-outlined text-[200px] text-primary/30 rotate-12">spa</span>
</div>
</div>
</div>
</div>
<!-- Footer -->
<footer class="bg-white dark:bg-[#0e1b12] border-t border-[#e7f3eb] dark:border-white/10 pt-16 pb-8">
<div class="max-w-[1280px] mx-auto px-4 sm:px-10">
<div class="grid grid-cols-2 md:grid-cols-4 gap-10 mb-16">
<!-- Brand Col -->
<div class="col-span-2 md:col-span-1 flex flex-col gap-6">
<div class="flex items-center gap-2 text-text-main dark:text-white">
<div class="size-6 rounded bg-primary/20 text-primary flex items-center justify-center">
<span class="material-symbols-outlined text-[18px]">nutrition</span>
</div>
<span class="font-bold text-lg">NutriDash</span>
</div>
<p class="text-sm text-text-main/60 dark:text-white/60">
                        The all-in-one platform for nutrition professionals to manage clients, plans, and payments.
                    </p>
<div class="flex gap-4">
<a class="text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#"><span class="material-symbols-outlined">public</span></a>
<a class="text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#"><span class="material-symbols-outlined">mail</span></a>
</div>
</div>
<!-- Links Col 1 -->
<div class="flex flex-col gap-4">
<h4 class="font-bold text-text-main dark:text-white">Product</h4>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">Features</a>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">Pricing</a>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">Case Studies</a>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">Reviews</a>
</div>
<!-- Links Col 2 -->
<div class="flex flex-col gap-4">
<h4 class="font-bold text-text-main dark:text-white">Company</h4>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">About</a>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">Careers</a>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">Contact</a>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">Partners</a>
</div>
<!-- Links Col 3 -->
<div class="flex flex-col gap-4">
<h4 class="font-bold text-text-main dark:text-white">Legal</h4>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">Privacy Policy</a>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">Terms of Service</a>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">Cookie Policy</a>
<a class="text-sm text-text-main/60 hover:text-primary dark:text-white/60 transition-colors" href="#">HIPAA</a>
</div>
</div>
<div class="border-t border-[#e7f3eb] dark:border-white/10 pt-8 flex flex-col md:flex-row justify-between items-center gap-4">
<p class="text-sm text-text-main/40 dark:text-white/40">© 2024 NutriDash Inc. All rights reserved.</p>
<div class="flex gap-6">
<!-- Simple language selector -->
<button class="flex items-center gap-2 text-sm text-text-main/60 dark:text-white/60 hover:text-primary">
<span class="material-symbols-outlined text-[18px]">language</span>
                        English (US)
                    </button>
</div>
</div>
</div>
</footer>
</body></html>
</file>

<file path="Design/website/Design/meal_photo_review_queue/code.html">
<!DOCTYPE html>

<html lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Meal Photo Review Dashboard</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#17cf54",
              "background-light": "#f6f8f6",
              "background-dark": "#112116",
            },
            fontFamily: {
              "display": ["Inter"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
<style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display">
<div class="relative flex min-h-screen w-full">
<!-- Side Navigation Bar -->
<aside class="flex h-screen w-64 flex-col border-r border-gray-200 dark:border-gray-800 bg-white dark:bg-[#1C2C21] p-4 flex-shrink-0">
<div class="flex flex-col gap-4">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Dr. Emily Carter" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuD0BKf2DiCvuew6HJWeI-8vqPhXF3AaVuYv5mpo7BXXwTP69BXWa7Iq1PzzKKmxwWWBzde8jIAHwm42yv_xTIup7AoZzKb3v8sRx8giqBz61t5NlMpC4aKggcxGfZ9FkrjXXI6RUf1TCBH6ysK0FAjdegojotBcEBUfUFw0qZYwDEiCaD9bqpQX_FkbWZH4cXMs6DfxQDC61DsbRwj65GInAqV8gb8tO_RoW58_BSfIPdVxDDXzIJGFVuWC32CIHAB5DXoAoIsCXNkD");'></div>
<div class="flex flex-col">
<h1 class="text-[#0e1b12] dark:text-gray-100 text-base font-medium leading-normal">Dr. Emily Carter</h1>
<p class="text-[#4e9767] dark:text-primary/80 text-sm font-normal leading-normal">Dietician</p>
</div>
</div>
<div class="flex flex-col gap-2 mt-4">
<a class="flex items-center gap-3 px-3 py-2 text-[#0e1b12] dark:text-gray-300 hover:bg-primary/10 rounded-lg" href="#">
<span class="material-symbols-outlined text-2xl">dashboard</span>
<p class="text-sm font-medium leading-normal">Dashboard</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 text-[#0e1b12] dark:text-gray-300 hover:bg-primary/10 rounded-lg" href="#">
<span class="material-symbols-outlined text-2xl">group</span>
<p class="text-sm font-medium leading-normal">Clients</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg bg-primary/20 dark:bg-primary/30 text-[#0e1b12] dark:text-white" href="#">
<span class="material-symbols-outlined text-2xl">photo_camera</span>
<p class="text-sm font-medium leading-normal">Meal Review</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 text-[#0e1b12] dark:text-gray-300 hover:bg-primary/10 rounded-lg" href="#">
<span class="material-symbols-outlined text-2xl">mail</span>
<p class="text-sm font-medium leading-normal">Messages</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 text-[#0e1b12] dark:text-gray-300 hover:bg-primary/10 rounded-lg" href="#">
<span class="material-symbols-outlined text-2xl">bar_chart</span>
<p class="text-sm font-medium leading-normal">Reports</p>
</a>
</div>
</div>
<div class="mt-auto flex flex-col gap-4">
<button class="flex w-full cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">New Client</span>
</button>
<div class="flex flex-col gap-1">
<a class="flex items-center gap-3 px-3 py-2 text-[#0e1b12] dark:text-gray-300 hover:bg-primary/10 rounded-lg" href="#">
<span class="material-symbols-outlined text-2xl">settings</span>
<p class="text-sm font-medium leading-normal">Settings</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 text-[#0e1b12] dark:text-gray-300 hover:bg-primary/10 rounded-lg" href="#">
<span class="material-symbols-outlined text-2xl">help</span>
<p class="text-sm font-medium leading-normal">Help</p>
</a>
</div>
</div>
</aside>
<!-- Main Content Area -->
<main class="flex-1 grid grid-cols-1 xl:grid-cols-2 h-screen overflow-hidden">
<!-- Left Column: Meal Queue -->
<div class="flex flex-col bg-white dark:bg-[#1C2C21] border-r border-gray-200 dark:border-gray-800 h-screen overflow-y-auto">
<!-- Header -->
<div class="p-6 border-b border-gray-200 dark:border-gray-800 sticky top-0 bg-white dark:bg-[#1C2C21] z-10">
<div class="flex flex-wrap justify-between gap-3">
<p class="text-[#0e1b12] dark:text-white text-3xl font-black leading-tight tracking-[-0.033em]">Meal Photo Review</p>
</div>
</div>
<!-- Filters -->
<div class="px-6 py-4 border-b border-gray-200 dark:border-gray-800">
<div class="flex h-10 w-full items-center justify-center rounded-lg bg-primary/10 dark:bg-primary/20 p-1">
<label class="flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-md px-2 has-[:checked]:bg-white dark:has-[:checked]:bg-background-dark has-[:checked]:shadow-sm has-[:checked]:text-[#0e1b12] dark:has-[:checked]:text-white text-[#4e9767] dark:text-primary/80 text-sm font-medium leading-normal">
<span class="truncate">All</span>
<input class="invisible w-0" name="meal-filter" type="radio" value="All"/>
</label>
<label class="flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-md px-2 has-[:checked]:bg-white dark:has-[:checked]:bg-background-dark has-[:checked]:shadow-sm has-[:checked]:text-[#0e1b12] dark:has-[:checked]:text-white text-[#4e9767] dark:text-primary/80 text-sm font-medium leading-normal">
<span class="truncate">Unreviewed</span>
<input checked="" class="invisible w-0" name="meal-filter" type="radio" value="Unreviewed"/>
</label>
<label class="flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-md px-2 has-[:checked]:bg-white dark:has-[:checked]:bg-background-dark has-[:checked]:shadow-sm has-[:checked]:text-[#0e1b12] dark:has-[:checked]:text-white text-[#4e9767] dark:text-primary/80 text-sm font-medium leading-normal">
<span class="truncate">Recent</span>
<input class="invisible w-0" name="meal-filter" type="radio" value="Recent"/>
</label>
</div>
</div>
<!-- Meal List -->
<div class="flex flex-col divide-y divide-gray-200 dark:divide-gray-800">
<div class="flex items-center gap-4 bg-primary/10 dark:bg-primary/20 px-6 min-h-[72px] py-3 justify-between cursor-pointer">
<div class="flex items-center gap-4">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-14 w-14 flex-shrink-0" data-alt="Profile picture of Jane Doe" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBrsn_NnWgsnxHTkkPVqQwNvgx4mhmrLTQVNYrGkfSEyZc8IgX2glCc8-CXaa9YEjsXmG4gCczwrguyFkBRHVhn37MzKAZte8bfbFnbiFlrn22aJq0nYuRAWY1EeUcGy9EMWVM0_hm6-fyrR8ysqE3OXKYJKos8YEmhWvDjjKj25ZH4Xm7W8IMRtM-4Z4_uErN9zrQCDeumubUCNdo0SoO47UXwWgmMTG3fDArMG56fzxahjAUIiJU6Yw6J-nKIkUNaMFvN8uLYDWLR");'></div>
<div class="flex flex-col justify-center">
<p class="text-[#0e1b12] dark:text-white text-base font-medium leading-normal line-clamp-1">Jane Doe</p>
<p class="text-[#4e9767] dark:text-primary/80 text-sm font-normal leading-normal line-clamp-2">Breakfast - Oct 26, 9:00 AM</p>
</div>
</div>
<div class="shrink-0">
<div class="flex size-7 items-center justify-center"><div class="size-3 rounded-full bg-yellow-500 animate-pulse"></div></div>
</div>
</div>
<div class="flex items-center gap-4 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800/50 px-6 min-h-[72px] py-3 justify-between cursor-pointer">
<div class="flex items-center gap-4">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-14 w-14 flex-shrink-0" data-alt="Profile picture of John Smith" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAo9fKgH9Z_NmfI5xplTs2weKlqSQ25oaLL7HDW8xXeOfymMmMXc6lO5gVO4io_uZ8kwVrjDEx_gOnMF6Ji2q63cBmvrr-A7OUSFfjhjq16sBe0Tetvm_UxEpDplk0CTYUrGsezZ6XYaIQAgawu04KFm_fAD4zDp5G1FnMYb_36eZHP6lXG4CUaAduuybi48yIt93EBTHfnkG3bbH8UcBvR16ooQkaUAeBsuOnFG--9Okf-3yJ1ftXuKld-ktsxRR7n2hPcAA-8wkbk");'></div>
<div class="flex flex-col justify-center">
<p class="text-[#0e1b12] dark:text-white text-base font-medium leading-normal line-clamp-1">John Smith</p>
<p class="text-[#4e9767] dark:text-primary/80 text-sm font-normal leading-normal line-clamp-2">Lunch - Oct 26, 1:15 PM</p>
</div>
</div>
<div class="shrink-0">
<div class="flex size-7 items-center justify-center"><div class="size-3 rounded-full bg-yellow-500"></div></div>
</div>
</div>
<div class="flex items-center gap-4 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800/50 px-6 min-h-[72px] py-3 justify-between cursor-pointer">
<div class="flex items-center gap-4">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-14 w-14 flex-shrink-0" data-alt="Profile picture of Sarah Johnson" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDjCNZE9oFQRF1A5125fb45KfRREjHyMuyC5FFKfAqPgbpltA5_vXCX32Mm9FjzX5qUkxKwuCKO9pK_9cTWZrV2RR6MZB9ZgHrtL29qJ9YXb3siW0IQhOcK410Pth0ijAClKQdohAjXun45kTqPGsc4nAa5bCbbVHUcFJMnpv1eLNRj73Z34ndtDYzvDvq2RiUrtlW-nBu1fZTcvK5zQBKiYbdXWznN9dGlYuZmo5pOKbtdBLB23VNlofKS5DHNd8TqmrLDI0GdLfkW");'></div>
<div class="flex flex-col justify-center">
<p class="text-[#0e1b12] dark:text-white text-base font-medium leading-normal line-clamp-1">Sarah Johnson</p>
<p class="text-[#4e9767] dark:text-primary/80 text-sm font-normal leading-normal line-clamp-2">Dinner - Oct 25, 7:30 PM</p>
</div>
</div>
<div class="shrink-0">
<div class="flex size-7 items-center justify-center"><div class="size-3 rounded-full bg-yellow-500"></div></div>
</div>
</div>
<div class="flex items-center gap-4 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800/50 px-6 min-h-[72px] py-3 justify-between cursor-pointer">
<div class="flex items-center gap-4">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-14 w-14 flex-shrink-0" data-alt="Profile picture of Michael Brown" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBAXMbk4TW4T1z5b7fBr7eJwTt-_zs2LFptokHpQRHduZ4EXBgpdcUXTik_vCB4YxUoLz-Iao8q-SgJVbR2L0e3hw5L8hiZtvtybFq8GBd_SNpH5aN_frx6Hjy4SezEF1EspxPiGAcM1aQHx1vZQhYch3nz9s7Ja3AtTEdftWNjSqrmBAdi7-7P2Pue6hza5jgAjn3OHpJLv7_XxsNhp91YnwoHf3ShjZ-OJTUFX_eYEu2scMuGQNtovXIAylYqgCR164n-v7cOZTgH");'></div>
<div class="flex flex-col justify-center">
<p class="text-[#0e1b12] dark:text-white text-base font-medium leading-normal line-clamp-1">Michael Brown</p>
<p class="text-[#4e9767] dark:text-primary/80 text-sm font-normal leading-normal line-clamp-2">Breakfast - Oct 25, 8:45 AM</p>
</div>
</div>
<div class="shrink-0">
<div class="flex size-7 items-center justify-center"><div class="size-3 rounded-full bg-green-600"></div></div>
</div>
</div>
</div>
</div>
<!-- Right Column: Review Panel -->
<div class="flex flex-col p-8 h-screen overflow-y-auto bg-background-light dark:bg-background-dark">
<div class="flex flex-col gap-6">
<!-- Image -->
<div class="w-full aspect-4/3 bg-gray-200 dark:bg-gray-800 rounded-xl bg-cover bg-center" data-alt="A healthy breakfast of avocado toast with a poached egg" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDpO5N3sfiBC2qP8m-MkHR8o7dhm1o8jZkh455PdnvcPAf4Gp-FRxiqnjKYdc-YzThjYg916ECqcSqAqMOt8rRcCpdyBzyeYBf-tM7J9PhKTHH41v09141gLmgjXcRHdEgDkMoVLGeVbSD56VvUcynflVqK9TY-oOjXYrNcnQCQw_TxHCbH0wXBEfDn7o-XfOHzyvhwA0eWvgcIsA0VLeFKRH5Pjc3d-lFcqSSgc1P-tCfqO9EwzyQE6OJsFj1HQjzuMkFV4lNQz4mw");'></div>
<!-- Client Info -->
<div>
<p class="text-sm text-gray-500 dark:text-gray-400">Reviewing Jane Doe's Breakfast</p>
<h2 class="text-2xl font-bold text-gray-800 dark:text-white mt-1">Avocado Toast with Egg</h2>
</div>
<!-- Action Radio Group -->
<div class="space-y-2">
<p class="text-sm font-medium text-gray-700 dark:text-gray-300">Mark as:</p>
<div class="grid grid-cols-3 gap-3">
<label class="flex cursor-pointer items-center justify-center rounded-lg p-3 text-center border has-[:checked]:bg-primary/20 dark:has-[:checked]:bg-primary/30 has-[:checked]:border-primary dark:border-gray-700 dark:text-white">
<input class="sr-only" name="meal_status" type="radio" value="eaten"/>
<span class="text-sm font-medium">Eaten</span>
</label>
<label class="flex cursor-pointer items-center justify-center rounded-lg p-3 text-center border has-[:checked]:bg-primary/20 dark:has-[:checked]:bg-primary/30 has-[:checked]:border-primary dark:border-gray-700 dark:text-white">
<input class="sr-only" name="meal_status" type="radio" value="skipped"/>
<span class="text-sm font-medium">Skipped</span>
</label>
<label class="flex cursor-pointer items-center justify-center rounded-lg p-3 text-center border has-[:checked]:bg-primary/20 dark:has-[:checked]:bg-primary/30 has-[:checked]:border-primary dark:border-gray-700 dark:text-white">
<input class="sr-only" name="meal_status" type="radio" value="substituted"/>
<span class="text-sm font-medium">Substituted</span>
</label>
</div>
</div>
<!-- Feedback Text Area -->
<div class="space-y-2">
<label class="text-sm font-medium text-gray-700 dark:text-gray-300" for="feedback">Feedback</label>
<textarea class="w-full p-3 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-[#1C2C21] text-gray-800 dark:text-white focus:ring-primary focus:border-primary placeholder-gray-400 dark:placeholder-gray-500" id="feedback" placeholder="Provide feedback or suggestions..." rows="5"></textarea>
</div>
<!-- Action Button -->
<button class="flex w-full min-w-[84px] cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg h-12 px-4 bg-primary text-white text-base font-bold leading-normal tracking-[0.015em] hover:bg-green-600">
<span>Mark as Reviewed &amp; Next</span>
<span class="material-symbols-outlined">arrow_forward</span>
</button>
</div>
</div>
</main>
</div>
</body></html>
</file>

<file path="Design/website/Design/team_dieticians/code.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Team Dieticians</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#17cf54",
                        "background-light": "#f6f8f6",
                        "background-dark": "#112116",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style>
        .material-symbols-outlined {
            font-variation-settings:
                'FILL' 0,
                'wght' 400,
                'GRAD' 0,
                'opsz' 24
        }
    </style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark">
<div class="relative flex min-h-screen w-full">
<!-- Side Navigation Bar -->
<aside class="flex w-64 flex-col border-r border-gray-200/50 dark:border-gray-700/50 bg-background-light dark:bg-background-dark p-4">
<div class="flex flex-col gap-4">
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="Profile picture of Dr. Evelyn Reed" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDvkuzl67-V7FqioCauKs4Wlz_2btTl6qJbp5oKHgLgwPCgw5VyTxPdJyq7m79QY372mb6zVF7XW7gAT_9wQV8UDZpF8dM8HtIq9lCkKng9yeunOvf7llDjp4TfmRCT_sbTshNNe-yPx6sOQ14eJQereepuI4QmaJxRcgWJa2djfQWVZ-tyheID6uRoCXxLnHENasQraGqZ0QALTa20T026a4tY4vrGoOrpz4l5RtfCwmq4cOoYRGmabC8B5TrW8RNbFDDYkRTvrsbP");'></div>
<div class="flex flex-col">
<h1 class="text-gray-900 dark:text-gray-100 text-base font-medium leading-normal">Dr. Evelyn Reed</h1>
<p class="text-primary/80 dark:text-primary/70 text-sm font-normal leading-normal">e.reed@nutriwell.com</p>
</div>
</div>
</div>
<nav class="flex flex-col gap-2 mt-8">
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200/60 dark:hover:bg-gray-800/60" href="#">
<span class="material-symbols-outlined text-gray-800 dark:text-gray-200">dashboard</span>
<p class="text-sm font-medium leading-normal">Dashboard</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200/60 dark:hover:bg-gray-800/60" href="#">
<span class="material-symbols-outlined text-gray-800 dark:text-gray-200">groups</span>
<p class="text-sm font-medium leading-normal">My Clients</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg bg-primary/20 dark:bg-primary/30" href="#">
<span class="material-symbols-outlined text-gray-900 dark:text-gray-50" style="font-variation-settings: 'FILL' 1;">group</span>
<p class="text-gray-900 dark:text-gray-50 text-sm font-medium leading-normal">Team Dieticians</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200/60 dark:hover:bg-gray-800/60" href="#">
<span class="material-symbols-outlined text-gray-800 dark:text-gray-200">folder</span>
<p class="text-sm font-medium leading-normal">Resources</p>
</a>
</nav>
<div class="mt-auto flex flex-col gap-4">
<div class="flex flex-col gap-1">
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200/60 dark:hover:bg-gray-800/60" href="#">
<span class="material-symbols-outlined text-gray-800 dark:text-gray-200">settings</span>
<p class="text-sm font-medium leading-normal">Settings</p>
</a>
<a class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200/60 dark:hover:bg-gray-800/60" href="#">
<span class="material-symbols-outlined text-gray-800 dark:text-gray-200">help</span>
<p class="text-sm font-medium leading-normal">Help</p>
</a>
</div>
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-gray-900 text-sm font-bold leading-normal tracking-[0.015em]">
<span class="truncate">Log Out</span>
</button>
</div>
</aside>
<!-- Main Content -->
<main class="flex-1 p-8 overflow-y-auto">
<div class="max-w-7xl mx-auto">
<!-- Page Heading -->
<header class="flex flex-wrap justify-between items-center gap-4 mb-8">
<div class="flex flex-col gap-2">
<h1 class="text-gray-900 dark:text-gray-50 text-4xl font-black leading-tight tracking-[-0.033em]">Team Dieticians</h1>
<p class="text-gray-600 dark:text-gray-400 text-base font-normal leading-normal">Manage and collaborate with other dieticians in your organization.</p>
</div>
<button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary/20 dark:bg-primary/30 text-gray-900 dark:text-gray-50 text-sm font-bold leading-normal tracking-[0.015em] hover:bg-primary/30 dark:hover:bg-primary/40">
<span class="truncate">Add New Dietician</span>
</button>
</header>
<!-- Search and Filter Section -->
<div class="mb-6">
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<!-- Search Bar -->
<div class="md:col-span-3">
<label class="flex flex-col min-w-40 h-12 w-full">
<div class="flex w-full flex-1 items-stretch rounded-lg h-full">
<div class="text-gray-600 dark:text-gray-400 flex border-none bg-gray-200/60 dark:bg-gray-800/60 items-center justify-center pl-4 rounded-l-lg border-r-0">
<span class="material-symbols-outlined">search</span>
</div>
<input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-gray-900 dark:text-gray-100 focus:outline-0 focus:ring-2 focus:ring-primary/50 border-none bg-gray-200/60 dark:bg-gray-800/60 h-full placeholder:text-gray-500 dark:placeholder:text-gray-400 px-4 rounded-l-none border-l-0 pl-2 text-base font-normal leading-normal" placeholder="Search by name or email..." value=""/>
</div>
</label>
</div>
<!-- Filter Chips -->
<div class="md:col-span-3 flex gap-3 overflow-x-auto pb-2">
<button class="flex h-8 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-gray-200/60 dark:bg-gray-800/60 pl-4 pr-2 hover:bg-gray-300/60 dark:hover:bg-gray-700/60">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Specialty</p>
<span class="material-symbols-outlined text-gray-800 dark:text-gray-200 text-base">expand_more</span>
</button>
<button class="flex h-8 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-gray-200/60 dark:bg-gray-800/60 pl-4 pr-2 hover:bg-gray-300/60 dark:hover:bg-gray-700/60">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Status</p>
<span class="material-symbols-outlined text-gray-800 dark:text-gray-200 text-base">expand_more</span>
</button>
<button class="flex h-8 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-gray-200/60 dark:bg-gray-800/60 pl-4 pr-2 hover:bg-gray-300/60 dark:hover:bg-gray-700/60">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">Location</p>
<span class="material-symbols-outlined text-gray-800 dark:text-gray-200 text-base">expand_more</span>
</button>
<button class="flex h-8 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-gray-200/60 dark:bg-gray-800/60 pl-4 pr-2 hover:bg-gray-300/60 dark:hover:bg-gray-700/60">
<p class="text-gray-800 dark:text-gray-200 text-sm font-medium leading-normal">More Filters</p>
<span class="material-symbols-outlined text-gray-800 dark:text-gray-200 text-base">expand_more</span>
</button>
</div>
</div>
</div>
<!-- Dieticians Table -->
<div class="overflow-x-auto bg-background-light dark:bg-background-dark">
<div class="flex overflow-hidden rounded-lg border border-gray-200/50 dark:border-gray-700/50">
<table class="w-full text-left">
<thead class="bg-gray-100/50 dark:bg-gray-900/50">
<tr>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Name</th>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Client Load</th>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Contact</th>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
</tr>
</thead>
<tbody class="divide-y divide-gray-200/50 dark:divide-gray-700/50">
<tr class="hover:bg-gray-100/50 dark:hover:bg-gray-800/50">
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center">
<div class="flex-shrink-0 h-10 w-10">
<img class="h-10 w-10 rounded-full" data-alt="Profile picture of Dr. Alisha Grant" src="https://lh3.googleusercontent.com/aida-public/AB6AXuDze53LkHF-SEL9QSQeFA8a5LdR55qW5VracK3RkXkLiVqZZmhFUPWBjO2anWaJXRYcEI4kMGZbgLzTbgRqXD17ofkPh4NsPHF6w-n8_QzoGFkB8w8C_qJ8cJukkZeD0JcIFWIVJ3zPpRCPOKoOYSJgVIXV4L1mYPfo_uALoDULFTrAhjZtHGq8pCBR-kx-DyuZ70y4zx7wqs8002sRJOSBO62IPHSiEOTcPXAtagEg5LdVo6YU5AAyZ03akzaTZdlLmEPeu-askG4V"/>
</div>
<div class="ml-4">
<div class="text-sm font-medium text-gray-900 dark:text-gray-100">Dr. Alisha Grant</div>
<div class="text-sm text-gray-500 dark:text-gray-400">Sports Nutrition</div>
</div>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center gap-3">
<div class="w-24 overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700"><div class="h-2 rounded-full bg-primary" style="width: 85%;"></div></div>
<p class="text-gray-900 dark:text-gray-100 text-sm font-medium leading-normal">75 / 90</p>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary/20 text-primary-800 dark:bg-primary/30 dark:text-primary-200">
<span class="w-2 h-2 mr-1.5 bg-primary rounded-full"></span> Active
                                        </span>
</td>
<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400">a.grant@nutriwell.com</td>
<td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
<a class="text-primary hover:text-primary/80 dark:text-primary-400 dark:hover:text-primary-300" href="#">View Profile</a>
</td>
</tr>
<tr class="hover:bg-gray-100/50 dark:hover:bg-gray-800/50">
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center">
<div class="flex-shrink-0 h-10 w-10">
<img class="h-10 w-10 rounded-full" data-alt="Profile picture of Dr. Ben Carter" src="https://lh3.googleusercontent.com/aida-public/AB6AXuDjK9YGdAzmMtoVqCx-0B6APQ32vMB1pjk_VXdGI4kmFo96M3Zafn2GFrnHkckQn8zzlauYvFJuhrsTw-OehyFngWmTp7Tw2zzjXyCt-dzBQXLJ4oB7vjp5Fs8-yrmcWH2hv_a2mMMo8oKtLQdzaFs5uMLQ_-L6W5CEiCZHF5VMb3sND84cLmpxsqfiIoWOAiDPceYMJ26CksiO37r9LPpcDHrs1IHKeKmxwcAtgVlWdO1smEICPtQY4f_M1HbVu8OulyqJqYjqNdgr"/>
</div>
<div class="ml-4">
<div class="text-sm font-medium text-gray-900 dark:text-gray-100">Dr. Ben Carter</div>
<div class="text-sm text-gray-500 dark:text-gray-400">Pediatric Nutrition</div>
</div>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center gap-3">
<div class="w-24 overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700"><div class="h-2 rounded-full bg-primary" style="width: 100%;"></div></div>
<p class="text-gray-900 dark:text-gray-100 text-sm font-medium leading-normal">95 / 95</p>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary/20 text-primary-800 dark:bg-primary/30 dark:text-primary-200">
<span class="w-2 h-2 mr-1.5 bg-primary rounded-full"></span> Active
                                        </span>
</td>
<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400">b.carter@nutriwell.com</td>
<td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
<a class="text-primary hover:text-primary/80 dark:text-primary-400 dark:hover:text-primary-300" href="#">View Profile</a>
</td>
</tr>
<tr class="hover:bg-gray-100/50 dark:hover:bg-gray-800/50">
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center">
<div class="flex-shrink-0 h-10 w-10">
<img class="h-10 w-10 rounded-full" data-alt="Profile picture of Dr. Chloe Davis" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCXIxd6Dl9w36AZdbANOHqGut5Em0VjPxUiJV5CmGJlHux2qlKwbtZeVvjYUR_Xk7JisbcrD7cwG6BUbN5M63xK-50JBf9IZK57uizxz3FuAhtxP0akIDX5gjnO0a6B0pWsSPnMkx2UmP-xp91n190mOauZyCvR4vH6ImU0r1Dp38-m-As0fTau9OThrgGaH-nhhBM8LuGNFPharnTaw4ZuQlqmAgFhc-G_7-Ynhky3-LCf73OavvY-grKcCFLXiPY1nI_U-GuuEVZX"/>
</div>
<div class="ml-4">
<div class="text-sm font-medium text-gray-900 dark:text-gray-100">Dr. Chloe Davis</div>
<div class="text-sm text-gray-500 dark:text-gray-400">Clinical Nutrition</div>
</div>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center gap-3">
<div class="w-24 overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700"><div class="h-2 rounded-full bg-primary" style="width: 45%;"></div></div>
<p class="text-gray-900 dark:text-gray-100 text-sm font-medium leading-normal">40 / 90</p>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary/20 text-primary-800 dark:bg-primary/30 dark:text-primary-200">
<span class="w-2 h-2 mr-1.5 bg-primary rounded-full"></span> Active
                                        </span>
</td>
<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400">c.davis@nutriwell.com</td>
<td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
<a class="text-primary hover:text-primary/80 dark:text-primary-400 dark:hover:text-primary-300" href="#">View Profile</a>
</td>
</tr>
<tr class="hover:bg-gray-100/50 dark:hover:bg-gray-800/50">
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center">
<div class="flex-shrink-0 h-10 w-10">
<img class="h-10 w-10 rounded-full" data-alt="Profile picture of Dr. David Evans" src="https://lh3.googleusercontent.com/aida-public/AB6AXuDG9scHKbt2RVSRNFetEUcqyMCyU-isCO8v3MDK8YKFBVNPzfgRhTqRbGBKn-c7ngK8n70HUjWhHBJuWFsgVbNG_vm0Z5_Qiau-1Kgq80TQ8LtJqrJfVHXPuAgMVMR0nTkUAMRWGXh0EKpNTuloZEvNa7ut8_wp2LzXJBxTV7CbjyM3GHGRAUS_f66yL2RQynNGKOLCtQKWoGzJl_yomZ2M3VRuDxVubyJSpD1S51yJgEYCr8A240WTzs9umXyTI8s9iiw2GrR2p7Au"/>
</div>
<div class="ml-4">
<div class="text-sm font-medium text-gray-900 dark:text-gray-100">Dr. David Evans</div>
<div class="text-sm text-gray-500 dark:text-gray-400">Geriatric Nutrition</div>
</div>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center gap-3">
<div class="w-24 overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700"><div class="h-2 rounded-full bg-yellow-500" style="width: 100%;"></div></div>
<p class="text-gray-900 dark:text-gray-100 text-sm font-medium leading-normal">100 / 100</p>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200">
<span class="w-2 h-2 mr-1.5 bg-gray-500 rounded-full"></span> Inactive
                                        </span>
</td>
<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400">d.evans@nutriwell.com</td>
<td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
<a class="text-primary hover:text-primary/80 dark:text-primary-400 dark:hover:text-primary-300" href="#">View Profile</a>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</main>
</div>
</body></html>
</file>

<file path="Docs/APIroutes.md">
# DietConnect API v1 Documentation

**Version:** 1.0.0  
**Last Updated:** December 4, 2025  
**Status:** MVP

***

## Table of Contents

1. [Overview & Core Concepts](#overview)
2. [Authentication & Authorization](#auth)
3. [Base Patterns & Conventions](#patterns)
4. [Organizations](#organizations)
5. [Users (Dietitians/Admins)](#users)
6. [Clients & Medical Profiles](#clients)
7. [Diet Plans](#diet-plans)
8. [Meals](#meals)
9. [Food Items & Database](#food-items)
10. [Meal Logs (Tracking)](#meal-logs)
11. [Weight Logs](#weight-logs)
12. [Body Measurements](#body-measurements)
13. [Session Notes (SOAP/DAP)](#session-notes)
14. [Notifications](#notifications)
15. [Activity Logs (Audit)](#activity-logs)
16. [Grocery Lists](#grocery-lists)
17. [Invoices & Billing](#invoices)
18. [Error Handling](#errors)
19. [Rate Limiting & Pagination](#limits)

***

## Overview & Core Concepts {#overview}

### Base URL
```
https://api.dietconnect.com/v1
```

### Environment
- Development: `https://dev-api.dietconnect.com/v1`
- Staging: `https://staging-api.dietconnect.com/v1`
- Production: `https://api.dietconnect.com/v1`

### Multi-Tenancy Model
- Every authenticated request is scoped to an `organization_id` derived from the JWT token.
- **No `organization_id` in URLs** — it's extracted from the token server-side.
- Row-Level Security (RLS) enforced at the database layer ensures data isolation.

### API Philosophy
- **Thin, focused endpoints** per screen/use-case (not "one mega-object").
- **Structured responses** with nested entities only where logically grouped.
- **Immutable audit trails** for all critical operations.
- **Soft deletes** by default (deleted_at timestamp).

***

## Authentication & Authorization {#auth}

### Roles
- `owner` — Organization creator; can manage billing, team, all data.
- `admin` — Can manage team, all clients, but not billing.
- `dietitian` — Can manage assigned clients, create diet plans, log reviews.
- `client` — End user; read-only to own data.

### JWT Token Structure

**Dietitian/Admin token:**
```json
{
  "sub": "user-uuid",
  "organizationId": "org-uuid",
  "role": "dietitian",
  "email": "priya@clinic.com",
  "fullName": "Dr. Priya",
  "iat": 1733332800,
  "exp": 1733336400
}
```

**Client token:**
```json
{
  "sub": "client-uuid",
  "organizationId": "org-uuid",
  "role": "client",
  "email": "sarah@example.com",
  "iat": 1733332800,
  "exp": 1733336400
}
```

### Login Endpoints

#### POST `/auth/dietitian/login`
Dietitian/admin login via email + password (Clerk integration handles).

**Request**
```json
{
  "email": "priya@clinic.com",
  "password": "secure_password"
}
```

**Response (200 OK)**
```json
{
  "accessToken": "eyJhbGc...",
  "refreshToken": "eyJhbGc...",
  "user": {
    "id": "user-uuid-1",
    "organizationId": "org-uuid-1",
    "role": "dietitian",
    "email": "priya@clinic.com",
    "fullName": "Dr. Priya",
    "profilePhotoUrl": "https://cdn.dietconnect.com/user-uuid-1.jpg",
    "specialization": "Weight Loss, PCOS"
  }
}
```

**Error (401 Unauthorized)**
```json
{
  "code": "INVALID_CREDENTIALS",
  "message": "Email or password is incorrect."
}
```

***

#### POST `/auth/client/login`
Client OTP-based login.

**Request**
```json
{
  "phone": "+919876543210"
}
```

**Response (200 OK)** — OTP sent via SMS/email
```json
{
  "message": "OTP sent to phone",
  "sessionToken": "session-token-for-verification"
}
```

#### POST `/auth/client/verify-otp`
Verify OTP and get tokens.

**Request**
```json
{
  "sessionToken": "session-token-from-above",
  "otp": "123456"
}
```

**Response (200 OK)**
```json
{
  "accessToken": "eyJhbGc...",
  "refreshToken": "eyJhbGc...",
  "client": {
    "id": "client-uuid-1",
    "organizationId": "org-uuid-1",
    "fullName": "Sarah Sharma",
    "email": "sarah@example.com",
    "phone": "+919876543210"
  }
}
```

***

#### POST `/auth/refresh`
Refresh access token using refresh token.

**Request**
```json
{
  "refreshToken": "eyJhbGc..."
}
```

**Response (200 OK)**
```json
{
  "accessToken": "eyJhbGc...",
  "expiresIn": 3600
}
```

***

#### POST `/auth/logout`
Invalidate tokens (optional, mainly for audit).

**Request** (authenticated)
```
No body
```

**Response (204 No Content)**

***

## Base Patterns & Conventions {#patterns}

### Standard Headers

**Request**
```
Authorization: Bearer <accessToken>
Content-Type: application/json
X-Request-ID: unique-request-id (optional, for tracing)
```

**Response**
```
Content-Type: application/json
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 999
X-RateLimit-Reset: 1733336400
```

### Standard Response Envelope

**Success (200, 201, etc.)**
```json
{
  "success": true,
  "data": { /* actual payload */ },
  "meta": { /* pagination, counts, etc. */ }
}
```

**Error (4xx, 5xx)**
```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "Human-readable error message",
    "details": { /* optional additional context */ }
  }
}
```

### Timestamps
- All timestamps in **ISO 8601 UTC** format: `2025-12-04T14:30:00Z`.
- Client should assume UTC; never include timezone offset in request body unless explicitly needed.

### IDs
- All IDs are **UUIDs v4** (e.g., `550e8400-e29b-41d4-a716-446655440000`).
- IDs are immutable and never reused.

### Pagination

**Query Parameters**
```
?page=1&pageSize=20&sortBy=createdAt&sortOrder=desc
```

**Response Meta**
```json
{
  "success": true,
  "data": [ /* array of items */ ],
  "meta": {
    "page": 1,
    "pageSize": 20,
    "total": 150,
    "totalPages": 8,
    "hasNextPage": true,
    "hasPreviousPage": false
  }
}
```

Defaults: `page=1`, `pageSize=20`, `sortOrder=asc`.

### Filtering & Search

**Query Parameters**
```
?search=sarah&status=active&sortBy=createdAt
```

Field-specific filters are per-endpoint; `search` is a general text search on relevant fields.

### Soft Delete Pattern

Every entity has `deletedAt` (nullable TIMESTAMP).

- Active records: `deletedAt IS NULL`.
- Deleted records: `deletedAt IS NOT NULL`.
- List endpoints by default exclude deleted records unless `?includeDeleted=true`.

### Audit Fields (on all entities)

```json
{
  "id": "uuid",
  "createdAt": "2025-12-01T10:00:00Z",
  "updatedAt": "2025-12-04T14:30:00Z",
  "createdByUserId": "user-uuid",
  "isActive": true,
  "deletedAt": null
}
```

***

## Organizations {#organizations}

### GET `/organization`
Get current organization (authenticated user's org).

**Query Parameters**
None

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "org-uuid-1",
    "name": "HealthFirst Nutrition Clinic",
    "ownerUserId": "user-uuid-1",
    "subscriptionTier": "clinic",
    "subscriptionStatus": "active",
    "subscriptionExpiresAt": "2026-01-01T00:00:00Z",
    "maxClients": 250,
    "currentClientCount": 120,
    "logoUrl": "https://cdn.dietconnect.com/org-uuid-1-logo.png",
    "description": "Leading nutrition clinic in Mumbai",
    "phone": "+91-9876543210",
    "email": "contact@healthfirst.com",
    "address": "123 Medical Plaza, Bandra, Mumbai",
    "city": "Mumbai",
    "country": "IN",
    "timezone": "Asia/Kolkata",
    "createdAt": "2025-01-15T10:00:00Z",
    "updatedAt": "2025-12-04T14:30:00Z",
    "isActive": true
  }
}
```

***

### PATCH `/organization`
Update organization settings (owner/admin only).

**Request**
```json
{
  "name": "HealthFirst Nutrition Clinic",
  "description": "Updated description",
  "phone": "+91-9876543211",
  "email": "newemail@healthfirst.com",
  "address": "456 Medical Plaza, Bandra, Mumbai",
  "timezone": "Asia/Kolkata"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    /* updated organization object */
  }
}
```

***

### GET `/organization/subscription`
Get detailed subscription info (owner only).

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "sub-uuid-1",
    "organizationId": "org-uuid-1",
    "planTier": "clinic",
    "status": "active",
    "billingCycleStart": "2025-11-01",
    "billingCycleEnd": "2025-12-01",
    "amountPerMonth": 4999,
    "currency": "INR",
    "paymentMethodId": "pm-xyz",
    "autoRenew": true,
    "cancelledAt": null,
    "createdAt": "2025-11-01T00:00:00Z",
    "updatedAt": "2025-12-04T14:30:00Z"
  }
}
```

***

## Users (Dietitians/Admins) {#users}

### GET `/me`
Get current authenticated user.

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "user-uuid-1",
    "organizationId": "org-uuid-1",
    "role": "dietitian",
    "email": "priya@clinic.com",
    "fullName": "Dr. Priya Sharma",
    "phone": "+91-9876543210",
    "profilePhotoUrl": "https://cdn.dietconnect.com/user-uuid-1.jpg",
    "licenseNumber": "DAN-12345",
    "specialization": "Weight Loss, PCOS Management",
    "bio": "10+ years of clinical experience",
    "isActive": true,
    "mfaEnabled": false,
    "lastLoginAt": "2025-12-04T14:00:00Z",
    "createdAt": "2025-01-15T10:00:00Z",
    "updatedAt": "2025-12-04T14:30:00Z"
  }
}
```

***

### PATCH `/me`
Update current user profile.

**Request**
```json
{
  "fullName": "Dr. Priya Sharma",
  "phone": "+91-9876543211",
  "specialization": "Weight Loss, PCOS, Diabetes",
  "bio": "Certified nutritionist with 10+ years experience"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated user object */ }
}
```

***

### POST `/me/profile-photo`
Upload profile photo (multipart form-data).

**Request**
```
Content-Type: multipart/form-data

file: <image file, max 5MB>
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "profilePhotoUrl": "https://cdn.dietconnect.com/user-uuid-1-new.jpg"
  }
}
```

***

### GET `/organization/users`
List all users in organization (admin/owner only).

**Query Parameters**
```
?page=1&pageSize=20&sortBy=createdAt&role=dietitian&search=priya
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "user-uuid-1",
      "role": "dietitian",
      "email": "priya@clinic.com",
      "fullName": "Dr. Priya",
      "phone": "+91-9876543210",
      "specialization": "Weight Loss",
      "isActive": true,
      "lastLoginAt": "2025-12-04T14:00:00Z",
      "createdAt": "2025-01-15T10:00:00Z"
    }
  ],
  "meta": {
    "page": 1,
    "pageSize": 20,
    "total": 5,
    "totalPages": 1,
    "hasNextPage": false
  }
}
```

***

### POST `/organization/users/invite`
Invite a new user to the organization (admin/owner only).

**Request**
```json
{
  "email": "newdietitian@clinic.com",
  "fullName": "Dr. Amit Kumar",
  "role": "dietitian"
}
```

**Response (201 Created)**
```json
{
  "success": true,
  "data": {
    "id": "user-uuid-2",
    "email": "newdietitian@clinic.com",
    "fullName": "Dr. Amit Kumar",
    "role": "dietitian",
    "inviteSent": true,
    "invitedAt": "2025-12-04T14:30:00Z"
  }
}
```

An invite email is sent to the email with a sign-up link.

***

### PATCH `/organization/users/{userId}`
Update a user (admin/owner only).

**Request**
```json
{
  "role": "admin",
  "isActive": true
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated user object */ }
}
```

***

### DELETE `/organization/users/{userId}`
Remove user from organization (soft delete, admin/owner only).

**Response (204 No Content)**

***

## Clients & Medical Profiles {#clients}

### POST `/clients`
Create a new client (dietitian/admin).

**Request**
```json
{
  "fullName": "Sarah Sharma",
  "email": "sarah@example.com",
  "phone": "+919876543210",
  "dateOfBirth": "1997-06-10",
  "gender": "female",
  "heightCm": 162,
  "currentWeightKg": 75,
  "targetWeightKg": 65,
  "activityLevel": "moderately_active",
  "primaryDietitianId": "user-uuid-1",
  "dietaryPreferences": ["vegetarian"],
  "allergies": ["peanuts", "dairy"],
  "medicalConditions": ["PCOS", "Type 2 Diabetes"],
  "medications": ["Metformin 500mg (morning)", "Atorvastatin 10mg (night)"],
  "healthNotes": "Prefers Indian cuisine, eats out twice weekly"
}
```

**Response (201 Created)**
```json
{
  "success": true,
  "data": {
    "id": "client-uuid-1",
    "organizationId": "org-uuid-1",
    "fullName": "Sarah Sharma",
    "email": "sarah@example.com",
    "phone": "+919876543210",
    "dateOfBirth": "1997-06-10",
    "gender": "female",
    "heightCm": 162,
    "currentWeightKg": 75,
    "targetWeightKg": 65,
    "activityLevel": "moderately_active",
    "primaryDietitian": {
      "id": "user-uuid-1",
      "fullName": "Dr. Priya"
    },
    "dietaryPreferences": ["vegetarian"],
    "allergies": ["peanuts", "dairy"],
    "medicalConditions": ["PCOS", "Type 2 Diabetes"],
    "medications": ["Metformin 500mg (morning)", "Atorvastatin 10mg (night)"],
    "healthNotes": "Prefers Indian cuisine, eats out twice weekly",
    "onboardingCompleted": false,
    "isActive": true,
    "createdAt": "2025-12-04T14:30:00Z",
    "updatedAt": "2025-12-04T14:30:00Z",
    "createdByUserId": "user-uuid-1"
  }
}
```

***

### GET `/clients`
List all clients in organization (dietitian/admin).

**Query Parameters**
```
?page=1&pageSize=20&search=sarah&status=active&primaryDietitianId=user-uuid-1&sortBy=createdAt
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "client-uuid-1",
      "fullName": "Sarah Sharma",
      "email": "sarah@example.com",
      "phone": "+919876543210",
      "currentWeightKg": 73.5,
      "targetWeightKg": 65,
      "primaryDietitian": {
        "id": "user-uuid-1",
        "fullName": "Dr. Priya"
      },
      "isActive": true,
      "createdAt": "2025-12-04T14:30:00Z"
    }
  ],
  "meta": {
    "page": 1,
    "pageSize": 20,
    "total": 120,
    "totalPages": 6,
    "hasNextPage": true
  }
}
```

***

### GET `/clients/{clientId}`
Get client summary (demographics + medical overview).

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "client-uuid-1",
    "organizationId": "org-uuid-1",
    "fullName": "Sarah Sharma",
    "email": "sarah@example.com",
    "phone": "+919876543210",
    "dateOfBirth": "1997-06-10",
    "gender": "female",
    "heightCm": 162,
    "currentWeightKg": 73.5,
    "targetWeightKg": 65,
    "bmi": 22.2,
    "activityLevel": "moderately_active",
    "primaryDietitian": {
      "id": "user-uuid-1",
      "fullName": "Dr. Priya"
    },
    "dietaryPreferences": ["vegetarian"],
    "onboardingCompleted": true,
    "isActive": true,
    "createdAt": "2025-12-01T10:00:00Z",
    "updatedAt": "2025-12-04T14:30:00Z",
    "createdByUserId": "user-uuid-1"
  }
}
```

***

### PATCH `/clients/{clientId}`
Update client demographics or assignment.

**Request**
```json
{
  "currentWeightKg": 73.2,
  "targetWeightKg": 64,
  "primaryDietitianId": "user-uuid-2",
  "activityLevel": "lightly_active",
  "healthNotes": "Updated notes after consultation"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated client */ }
}
```

***

### GET `/clients/{clientId}/medical-profile`
Get full medical history (diagnoses, allergies, medications, notes).

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "clientId": "client-uuid-1",
    "diagnoses": ["PCOS (diagnosed 2019)", "Type 2 Diabetes (diagnosed 2022)"],
    "allergies": ["peanuts", "dairy", "shellfish"],
    "intolerances": ["lactose"],
    "medications": [
      "Metformin 500mg (morning, for diabetes)",
      "Atorvastatin 10mg (night, for cholesterol)"
    ],
    "supplements": ["Vitamin D 2000IU (daily)", "Inositol 2g (daily)"],
    "surgeries": ["Appendectomy (2015)"],
    "familyHistory": "Mother: diabetes, Father: hypertension",
    "healthNotes": "Prefers Indian cuisine, eats out twice weekly, limited time for cooking.",
    "dietaryRestrictions": "No beef (cultural), no pork",
    "updatedAt": "2025-12-04T14:30:00Z",
    "updatedByUserId": "user-uuid-1"
  }
}
```

***

### PATCH `/clients/{clientId}/medical-profile`
Update medical information (dietitian only).

**Request**
```json
{
  "diagnoses": ["PCOS", "Type 2 Diabetes"],
  "allergies": ["peanuts", "dairy"],
  "medications": ["Metformin 500mg (morning)"],
  "healthNotes": "Updated after recent consultation"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated medical profile */ }
}
```

***

### DELETE `/clients/{clientId}`
Soft delete a client (admin only).

**Response (204 No Content)**

***

## Diet Plans {#diet-plans}

### POST `/diet-plans`
Create a new diet plan for a client (with nested meals and items).

**Request**
```json
{
  "clientId": "client-uuid-1",
  "name": "Week 1 – PCOS & Diabetes Control",
  "description": "Focus on blood sugar stability and weight management.",
  "startDate": "2025-12-01",
  "endDate": "2025-12-07",
  "targetsPerDay": {
    "calories": 1800,
    "proteinG": 90,
    "carbsG": 200,
    "fatsG": 60,
    "fiberG": 25
  },
  "meals": [
    {
      "dayIndex": 1,
      "mealType": "breakfast",
      "timeOfDay": "08:00",
      "title": "Besan Chilla + Curd + Apple",
      "instructions": "Use minimal oil. Avoid sugar in tea.",
      "foodItems": [
        {
          "foodId": "food-uuid-1",
          "quantity": 2,
          "unit": "piece"
        },
        {
          "foodId": "food-uuid-2",
          "quantity": 100,
          "unit": "g"
        }
      ]
    }
  ],
  "options": {
    "saveAsTemplate": false,
    "templateCategory": null
  }
}
```

**Response (201 Created)**
```json
{
  "success": true,
  "data": {
    "id": "plan-uuid-1",
    "organizationId": "org-uuid-1",
    "client": {
      "id": "client-uuid-1",
      "fullName": "Sarah Sharma"
    },
    "createdByUser": {
      "id": "user-uuid-1",
      "fullName": "Dr. Priya"
    },
    "name": "Week 1 – PCOS & Diabetes Control",
    "description": "Focus on blood sugar stability and weight management.",
    "startDate": "2025-12-01",
    "endDate": "2025-12-07",
    "durationDays": 7,
    "status": "draft",
    "targetsPerDay": {
      "calories": 1800,
      "proteinG": 90,
      "carbsG": 200,
      "fatsG": 60,
      "fiberG": 25
    },
    "isTemplate": false,
    "publishedAt": null,
    "createdAt": "2025-12-04T14:30:00Z",
    "updatedAt": "2025-12-04T14:30:00Z"
  }
}
```

***

### GET `/diet-plans/{planId}`
Get full diet plan with all meals and food items.

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "plan-uuid-1",
    "organizationId": "org-uuid-1",
    "client": {
      "id": "client-uuid-1",
      "fullName": "Sarah Sharma",
      "currentWeightKg": 73.5,
      "targetWeightKg": 65
    },
    "createdByUser": {
      "id": "user-uuid-1",
      "fullName": "Dr. Priya"
    },
    "name": "Week 1 – PCOS & Diabetes Control",
    "description": "Focus on blood sugar stability and weight management.",
    "startDate": "2025-12-01",
    "endDate": "2025-12-07",
    "status": "active",
    "targetsPerDay": {
      "calories": 1800,
      "proteinG": 90,
      "carbsG": 200,
      "fatsG": 60,
      "fiberG": 25
    },
    "meals": [
      {
        "id": "meal-uuid-1",
        "dayIndex": 1,
        "mealDate": "2025-12-01",
        "mealType": "breakfast",
        "timeOfDay": "08:00",
        "title": "Besan Chilla + Curd + Apple",
        "instructions": "Use minimal oil. Avoid sugar in tea.",
        "items": [
          {
            "foodId": "food-uuid-1",
            "foodName": "Besan Chilla",
            "quantity": 2,
            "unit": "piece",
            "nutritionPerItem": {
              "calories": 100,
              "proteinG": 5,
              "carbsG": 12.5,
              "fatsG": 3
            },
            "totalNutrition": {
              "calories": 200,
              "proteinG": 10,
              "carbsG": 25,
              "fatsG": 6
            }
          }
        ],
        "totals": {
          "calories": 360,
          "proteinG": 14,
          "carbsG": 51,
          "fatsG": 9,
          "fiberG": 3
        }
      }
    ],
    "dailyTotalsIfFollowed": {
      "calories": 1750,
      "proteinG": 92,
      "carbsG": 185,
      "fatsG": 58,
      "fiberG": 24
    },
    "isTemplate": false,
    "publishedAt": "2025-12-01T10:00:00Z",
    "createdAt": "2025-12-01T10:00:00Z",
    "updatedAt": "2025-12-04T14:30:00Z"
  }
}
```

***

### GET `/clients/{clientId}/diet-plans`
List all diet plans for a client (with basic details only).

**Query Parameters**
```
?status=active&sortBy=createdAt&page=1&pageSize=20
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "plan-uuid-1",
      "name": "Week 1 – PCOS & Diabetes Control",
      "startDate": "2025-12-01",
      "endDate": "2025-12-07",
      "status": "active",
      "createdByUser": {
        "id": "user-uuid-1",
        "fullName": "Dr. Priya"
      },
      "mealCount": 35,
      "publishedAt": "2025-12-01T10:00:00Z",
      "createdAt": "2025-12-01T10:00:00Z"
    }
  ],
  "meta": {
    "page": 1,
    "pageSize": 20,
    "total": 5,
    "totalPages": 1
  }
}
```

***

### PATCH `/diet-plans/{planId}`
Update diet plan metadata (name, dates, targets).

**Request**
```json
{
  "name": "Week 1 – Updated Plan",
  "description": "Revised targets",
  "startDate": "2025-12-01",
  "endDate": "2025-12-07",
  "targetsPerDay": {
    "calories": 1750,
    "proteinG": 95
  }
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated plan */ }
}
```

***

### POST `/diet-plans/{planId}/publish`
Mark plan as active and generate meal logs.

**Request**
```json
{
  "publishDate": "2025-12-01"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "planId": "plan-uuid-1",
    "status": "active",
    "publishedAt": "2025-12-04T14:30:00Z",
    "mealLogsCreated": 35
  }
}
```

***

### POST `/diet-plans/{planId}/save-as-template`
Save plan as a reusable template (dietitian/admin).

**Request**
```json
{
  "templateCategory": "pcos_weight_loss",
  "templateName": "PCOS Weight Loss – 1800 kcal",
  "visibility": "org_shared"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "planId": "plan-uuid-1",
    "isTemplate": true,
    "templateCategory": "pcos_weight_loss"
  }
}
```

***

### DELETE `/diet-plans/{planId}`
Soft delete a plan (admin only).

**Response (204 No Content)**

***

## Meals {#meals}

### GET `/diet-plans/{planId}/meals`
Get all meals for a plan (nested in plan details, but available separately if needed).

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "meal-uuid-1",
      "dayIndex": 1,
      "mealDate": "2025-12-01",
      "mealType": "breakfast",
      "timeOfDay": "08:00",
      "title": "Besan Chilla + Curd + Apple",
      "instructions": "Use minimal oil.",
      "totals": {
        "calories": 360,
        "proteinG": 14
      }
    }
  ]
}
```

***

### PATCH `/meals/{mealId}`
Update meal details (title, instructions, time).

**Request**
```json
{
  "title": "Masala Dosa + Sambhar",
  "instructions": "Use coconut oil, low salt.",
  "timeOfDay": "08:30"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated meal */ }
}
```

***

### POST `/meals/{mealId}/add-food-item`
Add a food item to a meal.

**Request**
```json
{
  "foodId": "food-uuid-3",
  "quantity": 150,
  "unit": "g"
}
```

**Response (201 Created)**
```json
{
  "success": true,
  "data": {
    "mealId": "meal-uuid-1",
    "foodId": "food-uuid-3",
    "quantity": 150,
    "unit": "g",
    "nutrition": {
      "calories": 150,
      "proteinG": 12
    }
  }
}
```

***

### PATCH `/meals/{mealId}/food-items/{foodItemId}`
Update quantity of a food in a meal.

**Request**
```json
{
  "quantity": 200,
  "unit": "g"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated meal-food-item */ }
}
```

***

### DELETE `/meals/{mealId}/food-items/{foodItemId}`
Remove a food item from a meal.

**Response (204 No Content)**

***

## Food Items & Database {#food-items}

### GET `/food-items`
Search and list food items (global + org-specific).

**Query Parameters**
```
?q=paneer&category=protein&orgScope=all&isVerified=true&page=1&pageSize=20
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "food-uuid-1",
      "name": "Paneer (cottage cheese)",
      "category": "protein",
      "subCategory": "dairy",
      "servingSize": "100 g",
      "brand": "Amul",
      "isGlobal": true,
      "isVerified": true,
      "nutrition": {
        "calories": 265,
        "proteinG": 18,
        "carbsG": 6,
        "fatsG": 20,
        "fiberG": 0,
        "sodiumMg": 200,
        "sugarG": 1
      },
      "allergenFlags": ["dairy"],
      "dietaryTags": ["vegetarian"],
      "barcode": "8901234567890"
    }
  ],
  "meta": {
    "page": 1,
    "pageSize": 20,
    "total": 45,
    "totalPages": 3
  }
}
```

***

### POST `/food-items`
Create organization-specific food (dietitian/admin).

**Request**
```json
{
  "name": "Priya's Special Dal Mix",
  "category": "legumes",
  "servingSize": "100 g",
  "nutrition": {
    "calories": 150,
    "proteinG": 12,
    "carbsG": 20,
    "fatsG": 2
  },
  "allergenFlags": [],
  "dietaryTags": ["vegan", "organic"]
}
```

**Response (201 Created)**
```json
{
  "success": true,
  "data": {
    "id": "food-uuid-custom-1",
    "organizationId": "org-uuid-1",
    "name": "Priya's Special Dal Mix",
    "category": "legumes",
    "isGlobal": false,
    "isVerified": false,
    "createdByUserId": "user-uuid-1",
    "createdAt": "2025-12-04T14:30:00Z"
  }
}
```

***

### GET `/food-items/{foodId}`
Get single food item details.

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "food-uuid-1",
    "name": "Paneer (cottage cheese)",
    "category": "protein",
    "subCategory": "dairy",
    "servingSize": "100 g",
    "brand": "Amul",
    "isGlobal": true,
    "isVerified": true,
    "nutrition": {
      "calories": 265,
      "proteinG": 18,
      "carbsG": 6,
      "fatsG": 20,
      "fiberG": 0,
      "sodiumMg": 200,
      "sugarG": 1
    },
    "allergenFlags": ["dairy"],
    "dietaryTags": ["vegetarian"],
    "barcode": "8901234567890",
    "createdAt": "2025-06-01T00:00:00Z"
  }
}
```

***

### PATCH `/food-items/{foodId}`
Update food item (org-specific only).

**Request**
```json
{
  "name": "Updated name",
  "nutrition": {
    "calories": 160,
    "proteinG": 13
  }
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated food item */ }
}
```

***

### DELETE `/food-items/{foodId}`
Delete org-specific food (soft delete).

**Response (204 No Content)**

***

## Meal Logs (Tracking) {#meal-logs}

### GET `/clients/{clientId}/meal-logs`
List meal logs for a client (dietitian view).

**Query Parameters**
```
?dateFrom=2025-12-01&dateTo=2025-12-07&status=pending&sortBy=scheduledDate
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "meal-log-uuid-1",
      "mealId": "meal-uuid-1",
      "scheduledDate": "2025-12-01",
      "scheduledTime": "08:00",
      "meal": {
        "title": "Besan Chilla + Curd + Apple",
        "mealType": "breakfast"
      },
      "status": "pending",
      "photoUrl": null,
      "photoThumbnailUrl": null,
      "clientNotes": null,
      "dietitianFeedback": null,
      "reviewedByUser": null,
      "dietitianReviewedAt": null,
      "substituteDescription": null,
      "loggedAt": null,
      "createdAt": "2025-12-01T00:00:00Z"
    }
  ],
  "meta": {
    "page": 1,
    "pageSize": 20,
    "total": 35
  }
}
```

***

### GET `/meal-logs/{mealLogId}`
Get full meal log details (with photos, feedback).

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "meal-log-uuid-1",
    "organizationId": "org-uuid-1",
    "client": {
      "id": "client-uuid-1",
      "fullName": "Sarah Sharma"
    },
    "mealId": "meal-uuid-1",
    "scheduledDate": "2025-12-01",
    "scheduledTime": "08:00",
    "meal": {
      "title": "Besan Chilla + Curd + Apple",
      "mealType": "breakfast",
      "instructions": "Use minimal oil.",
      "items": [ /* food items */ ],
      "totals": {
        "calories": 360,
        "proteinG": 14
      }
    },
    "status": "eaten",
    "photoUrl": "https://cdn.dietconnect.com/meal-logs/meal-log-uuid-1.jpg",
    "photoThumbnailUrl": "https://cdn.dietconnect.com/meal-logs/meal-log-uuid-1-thumb.jpg",
    "photoUploadedAt": "2025-12-01T08:35:00Z",
    "clientNotes": "Used less oil, added extra veggies.",
    "dietitianFeedback": "Great choice! Good portion control.",
    "reviewedByUser": {
      "id": "user-uuid-1",
      "fullName": "Dr. Priya"
    },
    "dietitianReviewedAt": "2025-12-01T09:00:00Z",
    "substituteDescription": null,
    "loggedAt": "2025-12-01T08:35:00Z",
    "createdAt": "2025-12-01T00:00:00Z",
    "updatedAt": "2025-12-01T09:00:00Z"
  }
}
```

***

### POST `/meal-logs/{mealLogId}/photo-upload-url`
Get presigned S3 URL for photo upload (client).

**Request**
```json
{
  "fileName": "breakfast-2025-12-01.jpg",
  "fileType": "image/jpeg",
  "fileSizeBytes": 1500000
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "uploadUrl": "https://s3.amazonaws.com/bucket/presigned-url?...",
    "fileUrl": "https://cdn.dietconnect.com/meal-logs/meal-log-uuid-1.jpg",
    "expiresIn": 900
  }
}
```

Client uploads directly to `uploadUrl`, then calls `/meal-logs/{id}` to confirm.

***

### PATCH `/meal-logs/{mealLogId}`
Client logs/updates meal status (client app).

**Request**
```json
{
  "status": "eaten",
  "photoUrl": "https://cdn.dietconnect.com/meal-logs/meal-log-uuid-1.jpg",
  "clientNotes": "Used less oil, added extra veggies.",
  "substituteDescription": null
}
```

If status = "substituted":
```json
{
  "status": "substituted",
  "photoUrl": "https://cdn.dietconnect.com/meal-logs/meal-log-uuid-2.jpg",
  "clientNotes": "Had upma instead",
  "substituteDescription": "1 bowl vegetable upma, no chutney"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "meal-log-uuid-1",
    "status": "eaten",
    "photoUrl": "https://cdn.dietconnect.com/meal-logs/meal-log-uuid-1.jpg",
    "clientNotes": "Used less oil, added extra veggies.",
    "loggedAt": "2025-12-01T08:35:00Z"
  }
}
```

***

### PATCH `/meal-logs/{mealLogId}/review`
Dietitian reviews and provides feedback (dietitian app).

**Request**
```json
{
  "status": "eaten",
  "dietitianFeedback": "Great choice! Good portion control and macro balance.",
  "overrideCalories": null
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "meal-log-uuid-1",
    "status": "eaten",
    "dietitianFeedback": "Great choice! Good portion control and macro balance.",
    "reviewedByUser": {
      "id": "user-uuid-1",
      "fullName": "Dr. Priya"
    },
    "dietitianReviewedAt": "2025-12-01T09:00:00Z"
  }
}
```

***

## Weight Logs {#weight-logs}

### POST `/clients/{clientId}/weight-logs`
Dietitian logs weight on behalf of client (clinic visit).

**Request**
```json
{
  "logDate": "2025-12-04",
  "logTime": "10:00",
  "weightKg": 73.5,
  "notes": "Post-consultation measurement"
}
```

**Response (201 Created)**
```json
{
  "success": true,
  "data": {
    "id": "weight-log-uuid-1",
    "clientId": "client-uuid-1",
    "logDate": "2025-12-04",
    "logTime": "10:00",
    "weightKg": 73.5,
    "bmi": 22.2,
    "notes": "Post-consultation measurement",
    "createdAt": "2025-12-04T14:30:00Z",
    "createdByUserId": "user-uuid-1"
  }
}
```

***

### GET `/clients/{clientId}/weight-logs`
Get weight history for a client (dietitian & client).

**Query Parameters**
```
?dateFrom=2025-11-01&dateTo=2025-12-04&sortBy=logDate&page=1&pageSize=100
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "weight-log-uuid-1",
      "logDate": "2025-11-10",
      "weightKg": 75.0,
      "bmi": 22.7,
      "notes": null
    },
    {
      "id": "weight-log-uuid-2",
      "logDate": "2025-11-17",
      "weightKg": 74.2,
      "bmi": 22.4,
      "notes": null,
      "weightChange": -0.8
    },
    {
      "id": "weight-log-uuid-3",
      "logDate": "2025-12-04",
      "weightKg": 73.5,
      "bmi": 22.2,
      "notes": "Post-consultation",
      "weightChange": -0.7
    }
  ],
  "meta": {
    "page": 1,
    "pageSize": 100,
    "total": 10,
    "totalStartWeight": 75.0,
    "totalEndWeight": 73.5,
    "totalWeightLoss": 1.5,
    "averageWeightLossPerWeek": 0.5
  }
}
```

***

### POST `/client/me/weight-logs`
Client logs their own weight (client app).

**Request**
```json
{
  "logDate": "2025-12-04",
  "weightKg": 73.5,
  "notes": "Feeling lighter today"
}
```

**Response (201 Created)**
```json
{
  "success": true,
  "data": {
    "id": "weight-log-uuid-1",
    "logDate": "2025-12-04",
    "weightKg": 73.5,
    "notes": "Feeling lighter today",
    "createdAt": "2025-12-04T14:30:00Z"
  }
}
```

***

### GET `/client/me/weight-logs`
Client views their weight history (client app).

**Query Parameters**
```
?dateFrom=2025-11-01&dateTo=2025-12-04
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    { "logDate": "2025-11-10", "weightKg": 75.0 },
    { "logDate": "2025-11-17", "weightKg": 74.2 },
    { "logDate": "2025-12-04", "weightKg": 73.5 }
  ],
  "meta": {
    "currentWeight": 73.5,
    "targetWeight": 65,
    "totalWeightLoss": 1.5,
    "remainingToGoal": 8.5,
    "progressPercentage": 15
  }
}
```

***

## Body Measurements {#body-measurements}

### POST `/clients/{clientId}/body-measurements`
Log body measurements (chest, waist, hips, etc.).

**Request**
```json
{
  "logDate": "2025-12-04",
  "chestCm": 92,
  "waistCm": 78,
  "hipsCm": 96,
  "thighsCm": 58,
  "armsCm": 28,
  "bodyFatPercentage": 28,
  "notes": "After 4 weeks of diet"
}
```

**Response (201 Created)**
```json
{
  "success": true,
  "data": {
    "id": "measurement-uuid-1",
    "clientId": "client-uuid-1",
    "logDate": "2025-12-04",
    "measurements": {
      "chestCm": 92,
      "waistCm": 78,
      "hipsCm": 96,
      "thighsCm": 58,
      "armsCm": 28,
      "bodyFatPercentage": 28
    },
    "createdAt": "2025-12-04T14:30:00Z"
  }
}
```

***

### GET `/clients/{clientId}/body-measurements`
Get measurement history.

**Query Parameters**
```
?dateFrom=2025-11-01&dateTo=2025-12-04&sortBy=logDate
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "measurement-uuid-1",
      "logDate": "2025-11-10",
      "measurements": {
        "waistCm": 80,
        "bodyFatPercentage": 30
      }
    },
    {
      "id": "measurement-uuid-2",
      "logDate": "2025-12-04",
      "measurements": {
        "waistCm": 78,
        "bodyFatPercentage": 28
      },
      "changes": {
        "waistCm": -2,
        "bodyFatPercentage": -2
      }
    }
  ]
}
```

***

## Session Notes (SOAP/DAP) {#session-notes}

### POST `/clients/{clientId}/session-notes`
Create a session note (SOAP/DAP format).

**Request**
```json
{
  "noteType": "SOAP",
  "title": "Initial Assessment – PCOS & Weight Management",
  "subjective": "Client reports wanting to lose 10kg over 3 months. No recent injuries. Exercises 2-3x/week.",
  "objective": "Height: 162cm, Weight: 75kg, BMI: 28.5. Labs: HbA1C 6.8%, Fasting glucose 110.",
  "assessment": "Type 2 Diabetes risk, PCOS confirmed. Overweight. Good exercise baseline.",
  "plan": "Start 1800 kcal diet plan, high protein focus. Weekly weight logs. Follow-up in 2 weeks.",
  "internalNotes": "Client motivated. Referred by Dr. Smith. Prefers evening consultations."
}
```

**Response (201 Created)**
```json
{
  "success": true,
  "data": {
    "id": "note-uuid-1",
    "clientId": "client-uuid-1",
    "noteType": "SOAP",
    "title": "Initial Assessment – PCOS & Weight Management",
    "createdByUser": {
      "id": "user-uuid-1",
      "fullName": "Dr. Priya"
    },
    "createdAt": "2025-12-04T14:30:00Z",
    "updatedAt": "2025-12-04T14:30:00Z"
  }
}
```

***

### GET `/clients/{clientId}/session-notes`
List session notes for a client.

**Query Parameters**
```
?noteType=SOAP&sortBy=createdAt&page=1&pageSize=20
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "note-uuid-1",
      "noteType": "SOAP",
      "title": "Initial Assessment – PCOS & Weight Management",
      "createdByUser": {
        "id": "user-uuid-1",
        "fullName": "Dr. Priya"
      },
      "createdAt": "2025-12-01T10:00:00Z"
    },
    {
      "id": "note-uuid-2",
      "noteType": "DAP",
      "title": "Follow-up Consultation – Week 2",
      "createdByUser": {
        "id": "user-uuid-1",
        "fullName": "Dr. Priya"
      },
      "createdAt": "2025-12-04T14:30:00Z"
    }
  ],
  "meta": {
    "page": 1,
    "pageSize": 20,
    "total": 2
  }
}
```

***

### GET `/session-notes/{noteId}`
Get full session note (with all sections).

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "note-uuid-1",
    "clientId": "client-uuid-1",
    "client": {
      "id": "client-uuid-1",
      "fullName": "Sarah Sharma"
    },
    "noteType": "SOAP",
    "title": "Initial Assessment – PCOS & Weight Management",
    "subjective": "Client reports wanting to lose 10kg over 3 months...",
    "objective": "Height: 162cm, Weight: 75kg...",
    "assessment": "Type 2 Diabetes risk, PCOS confirmed...",
    "plan": "Start 1800 kcal diet plan...",
    "internalNotes": "Client motivated...",
    "createdByUser": {
      "id": "user-uuid-1",
      "fullName": "Dr. Priya"
    },
    "createdAt": "2025-12-01T10:00:00Z",
    "updatedAt": "2025-12-01T10:00:00Z"
  }
}
```

***

### PATCH `/session-notes/{noteId}`
Update session note.

**Request**
```json
{
  "title": "Initial Assessment (Updated)",
  "plan": "Updated plan details..."
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated note */ }
}
```

***

### DELETE `/session-notes/{noteId}`
Soft delete a session note.

**Response (204 No Content)**

***

## Notifications {#notifications}

### GET `/client/me/notifications`
Get notifications for logged-in client (client app).

**Query Parameters**
```
?isRead=false&sortBy=createdAt&page=1&pageSize=50
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "notif-uuid-1",
      "type": "meal_reminder",
      "title": "Time for breakfast",
      "message": "Don't forget to log your 8 AM breakfast. You're doing great!",
      "icon": "📍",
      "deepLink": "/meals/today?mealType=breakfast",
      "isRead": false,
      "createdAt": "2025-12-04T07:30:00Z"
    },
    {
      "id": "notif-uuid-2",
      "type": "dietitian_feedback",
      "title": "Dr. Priya reviewed your lunch",
      "message": "Great choice! Keep it up.",
      "icon": "✅",
      "deepLink": "/meals/2025-12-03?mealType=lunch",
      "isRead": false,
      "createdAt": "2025-12-03T14:10:00Z"
    }
  ],
  "meta": {
    "page": 1,
    "pageSize": 50,
    "total": 10,
    "unreadCount": 5
  }
}
```

***

### PATCH `/notifications/{notificationId}`
Mark notification as read.

**Request**
```json
{
  "isRead": true
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated notification */ }
}
```

***

### GET `/dietitian/notifications`
Get notifications for dietitian (dashboard).

**Query Parameters**
```
?type=photo_uploaded&isRead=false&page=1&pageSize=20
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "notif-uuid-3",
      "type": "photo_uploaded",
      "title": "Sarah uploaded her lunch photo",
      "message": "Review and provide feedback",
      "icon": "📷",
      "deepLink": "/meal-logs/meal-log-uuid-1",
      "relatedEntity": {
        "type": "meal_log",
        "id": "meal-log-uuid-1"
      },
      "isRead": false,
      "createdAt": "2025-12-04T13:00:00Z"
    }
  ]
}
```

***

## Activity Logs (Audit) {#activity-logs}

### GET `/admin/activity-logs`
Get organization activity logs (admin/owner only).

**Query Parameters**
```
?userId=user-uuid-1&clientId=client-uuid-1&action=diet_plan_created&dateFrom=2025-12-01&dateTo=2025-12-04&page=1&pageSize=50
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "activity-uuid-1",
      "user": {
        "id": "user-uuid-1",
        "role": "dietitian",
        "fullName": "Dr. Priya"
      },
      "action": "diet_plan_created",
      "entityType": "diet_plan",
      "entityId": "plan-uuid-1",
      "description": "Created diet plan 'Week 1 – PCOS & Diabetes Control' for Sarah Sharma",
      "metadata": {
        "clientId": "client-uuid-1",
        "planName": "Week 1 – PCOS & Diabetes Control"
      },
      "ipAddress": "203.0.113.42",
      "userAgent": "Mozilla/5.0...",
      "createdAt": "2025-12-04T10:00:00Z"
    }
  ],
  "meta": {
    "page": 1,
    "pageSize": 50,
    "total": 250
  }
}
```

***

## Grocery Lists {#grocery-lists}

### POST `/diet-plans/{planId}/grocery-list`
Generate grocery list from a diet plan.

**Request**
```json
{
  "dateFrom": "2025-12-01",
  "dateTo": "2025-12-07",
  "groupBy": "category",
  "format": "json"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "planId": "plan-uuid-1",
    "dateRange": {
      "from": "2025-12-01",
      "to": "2025-12-07"
    },
    "items": [
      {
        "category": "grains",
        "items": [
          {
            "name": "Wheat Flour",
            "quantity": 2.5,
            "unit": "kg",
            "estimatedCost": 150
          },
          {
            "name": "Brown Rice",
            "quantity": 1.5,
            "unit": "kg",
            "estimatedCost": 120
          }
        ]
      },
      {
        "category": "proteins",
        "items": [
          {
            "name": "Paneer (Amul)",
            "quantity": 1,
            "unit": "kg",
            "estimatedCost": 400
          },
          {
            "name": "Chicken Breast",
            "quantity": 1.5,
            "unit": "kg",
            "estimatedCost": 450
          }
        ]
      }
    ],
    "totalEstimatedCost": 1750,
    "generatedAt": "2025-12-04T14:30:00Z"
}
```

***

### GET `/diet-plans/{planId}/grocery-list`
Retrieve a previously generated grocery list.

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* grocery list structure */ }
}
```

***

### POST `/diet-plans/{planId}/grocery-list/export`
Export grocery list as PDF or CSV.

**Request**
```json
{
  "format": "pdf"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "downloadUrl": "https://cdn.dietconnect.com/grocery-lists/list-uuid-1.pdf",
    "expiresIn": 3600
  }
}
```

***

## Invoices & Billing {#invoices}

### POST `/invoices`
Create an invoice (admin/owner).

**Request**
```json
{
  "clientId": "client-uuid-1",
  "issueDate": "2025-12-04",
  "dueDate": "2025-12-11",
  "currency": "INR",
  "lineItems": [
    {
      "description": "Initial Nutrition Consultation",
      "quantity": 1,
      "unitPrice": 1500,
      "taxPercentage": 0
    },
    {
      "description": "4-Week Meal Plan",
      "quantity": 1,
      "unitPrice": 2000,
      "taxPercentage": 0
    }
  ],
  "notes": "Thank you for your trust. Payment due by 11 Dec."
}
```

**Response (201 Created)**
```json
{
  "success": true,
  "data": {
    "id": "invoice-uuid-1",
    "organizationId": "org-uuid-1",
    "clientId": "client-uuid-1",
    "client": {
      "id": "client-uuid-1",
      "fullName": "Sarah Sharma",
      "email": "sarah@example.com"
    },
    "invoiceNumber": "INV-2025-00001",
    "issueDate": "2025-12-04",
    "dueDate": "2025-12-11",
    "currency": "INR",
    "subtotal": 3500,
    "tax": 0,
    "total": 3500,
    "status": "unpaid",
    "createdByUser": {
      "id": "user-uuid-1",
      "fullName": "Dr. Priya"
    },
    "createdAt": "2025-12-04T14:30:00Z"
  }
}
```

***

### GET `/invoices`
List invoices for organization (admin/owner).

**Query Parameters**
```
?clientId=client-uuid-1&status=unpaid&dateFrom=2025-11-01&page=1&pageSize=20
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": [
    {
      "id": "invoice-uuid-1",
      "invoiceNumber": "INV-2025-00001",
      "client": {
        "id": "client-uuid-1",
        "fullName": "Sarah Sharma"
      },
      "issueDate": "2025-12-04",
      "dueDate": "2025-12-11",
      "total": 3500,
      "status": "unpaid",
      "createdAt": "2025-12-04T14:30:00Z"
    }
  ],
  "meta": {
    "page": 1,
    "pageSize": 20,
    "total": 5,
    "totalUnpaid": 10500
  }
}
```

***

### GET `/invoices/{invoiceId}`
Get invoice details.

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "id": "invoice-uuid-1",
    "invoiceNumber": "INV-2025-00001",
    "client": {
      "id": "client-uuid-1",
      "fullName": "Sarah Sharma",
      "email": "sarah@example.com"
    },
    "issueDate": "2025-12-04",
    "dueDate": "2025-12-11",
    "lineItems": [
      {
        "description": "Initial Nutrition Consultation",
        "quantity": 1,
        "unitPrice": 1500,
        "total": 1500
      }
    ],
    "subtotal": 3500,
    "tax": 0,
    "total": 3500,
    "status": "unpaid",
    "paymentHistory": [],
    "notes": "Thank you for your trust..."
  }
}
```

***

### PATCH `/invoices/{invoiceId}`
Update invoice (before payment only).

**Request**
```json
{
  "dueDate": "2025-12-15",
  "status": "sent",
  "notes": "Gentle reminder..."
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": { /* updated invoice */ }
}
```

***

### POST `/invoices/{invoiceId}/send`
Send invoice to client via email.

**Request**
```json
{
  "recipientEmail": "sarah@example.com",
  "message": "Your nutrition consultation invoice"
}
```

**Response (200 OK)**
```json
{
  "success": true,
  "data": {
    "invoiceId": "invoice-uuid-1",
    "sentAt": "2025-12-04T14:35:00Z",
    "status": "sent"
  }
}
```

***

## Error Handling {#errors}

### Error Response Format

**4xx Client Errors**
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "The email is already in use.",
    "details": {
      "field": "email",
      "constraint": "unique"
    }
  }
}
```

**Common Error Codes**
```
UNAUTHORIZED            → 401 Unauthorized
FORBIDDEN               → 403 Forbidden (insufficient permissions)
NOT_FOUND               → 404 Not Found
VALIDATION_ERROR        → 400 Bad Request
CONFLICT                → 409 Conflict (resource already exists)
RATE_LIMIT_EXCEEDED     → 429 Too Many Requests
INTERNAL_SERVER_ERROR   → 500 Internal Server Error
```

***

## Rate Limiting & Pagination {#limits}

### Rate Limits

- **Authenticated users:** 1000 requests/hour
- **Unauthenticated:** 100 requests/hour
- **File uploads:** 50 MB/file

**Headers**
```
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 999
X-RateLimit-Reset: 1733336400
```

***

### Pagination Defaults

```
?page=1&pageSize=20&sortBy=createdAt&sortOrder=asc
```

- Max `pageSize`: 100
- Cursor-based pagination coming in v2

***

## Summary

This is a **complete, production-ready API v1 spec** covering:

✅ Multi-tenant architecture with org scoping  
✅ Full CRUD for clients, diet plans, meals, tracking  
✅ Medical history management  
✅ Meal logging with photo uploads  
✅ Weight & progress tracking  
✅ SOAP/DAP session notes  
✅ Notifications & activity logs  
✅ Grocery lists (Phase 2)  
✅ Billing & invoicing  
✅ Best practices (error handling, rate limiting, pagination, soft deletes, audit trails)

*
</file>

<file path="Docs/database_schema.md">
# DietConnect Database Schema (Production-Ready)

## Table Definitions

### Organizations (Tenants)
```sql
CREATE TABLE Organization (
  org_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL UNIQUE,
  description TEXT,
  logo_url TEXT,
  phone VARCHAR(20),
  email VARCHAR(255),
  address TEXT,
  city VARCHAR(100),
  country VARCHAR(100) DEFAULT 'IN',
  timezone VARCHAR(50) DEFAULT 'Asia/Kolkata',
  subscription_tier VARCHAR(50) DEFAULT 'free', -- free/pro/clinic/enterprise
  subscription_status VARCHAR(50) DEFAULT 'active', -- active/paused/cancelled
  subscription_expires_at TIMESTAMP,
  max_clients INT DEFAULT 10,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  deleted_at TIMESTAMP,
  is_active BOOLEAN DEFAULT true
);

CREATE INDEX idx_org_subscription_status ON Organization(subscription_status);
CREATE INDEX idx_org_is_active ON Organization(is_active);
```

### Users (Dietitians/Admins)
```sql
CREATE TABLE "User" (
  user_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID NOT NULL REFERENCES Organization(org_id) ON DELETE CASCADE,
  clerk_user_id VARCHAR(255) UNIQUE,
  role VARCHAR(50) NOT NULL, -- owner/admin/dietitian
  email VARCHAR(255) NOT NULL,
  full_name VARCHAR(255) NOT NULL,
  phone VARCHAR(20),
  profile_photo_url TEXT,
  license_number VARCHAR(100),
  specialization VARCHAR(255),
  bio TEXT,
  mfa_enabled BOOLEAN DEFAULT false,
  last_login_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  deleted_at TIMESTAMP,
  is_active BOOLEAN DEFAULT true,
  UNIQUE(org_id, email)
);

CREATE INDEX idx_user_org_id ON "User"(org_id);
CREATE INDEX idx_user_clerk_id ON "User"(clerk_user_id);
CREATE INDEX idx_user_role ON "User"(role);
```

### Clients
```sql
CREATE TABLE Client (
  client_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID NOT NULL REFERENCES Organization(org_id) ON DELETE CASCADE,
  primary_dietitian_id UUID NOT NULL REFERENCES "User"(user_id),
  email VARCHAR(255) NOT NULL,
  phone VARCHAR(20) NOT NULL,
  full_name VARCHAR(255) NOT NULL,
  date_of_birth DATE,
  gender VARCHAR(20), -- male/female/other
  profile_photo_url TEXT,
  height_cm DECIMAL(5,2),
  current_weight_kg DECIMAL(5,2),
  target_weight_kg DECIMAL(5,2),
  activity_level VARCHAR(50), -- sedentary/lightly_active/moderately_active/very_active
  dietary_preferences TEXT[], -- array of strings
  allergies TEXT[],
  medical_conditions TEXT[],
  medications TEXT[],
  health_notes TEXT,
  emergency_contact_name VARCHAR(255),
  emergency_contact_phone VARCHAR(20),
  onboarding_completed BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  deleted_at TIMESTAMP,
  created_by_user_id UUID,
  is_active BOOLEAN DEFAULT true,
  UNIQUE(org_id, email)
);

CREATE INDEX idx_client_org_id ON Client(org_id);
CREATE INDEX idx_client_primary_dietitian ON Client(primary_dietitian_id);
CREATE INDEX idx_client_status ON Client(is_active);
```

### Medical Profile
```sql
CREATE TABLE MedicalProfile (
  medical_profile_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id UUID NOT NULL UNIQUE REFERENCES Client(client_id) ON DELETE CASCADE,
  diagnoses TEXT[],
  allergies TEXT[],
  intolerances TEXT[],
  medications TEXT[],
  supplements TEXT[],
  surgeries TEXT[],
  family_history TEXT,
  health_notes TEXT,
  dietary_restrictions TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  updated_by_user_id UUID
);

CREATE INDEX idx_medical_profile_client_id ON MedicalProfile(client_id);
```

### Diet Plans
```sql
CREATE TABLE DietPlan (
  plan_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID NOT NULL REFERENCES Organization(org_id) ON DELETE CASCADE,
  client_id UUID NOT NULL REFERENCES Client(client_id) ON DELETE CASCADE,
  created_by_user_id UUID NOT NULL REFERENCES "User"(user_id),
  name VARCHAR(255) NOT NULL,
  description TEXT,
  start_date DATE NOT NULL,
  end_date DATE,
  target_calories INT,
  target_protein_g DECIMAL(5,1),
  target_carbs_g DECIMAL(5,1),
  target_fats_g DECIMAL(5,1),
  target_fiber_g DECIMAL(5,1),
  notes_for_client TEXT,
  internal_notes TEXT,
  status VARCHAR(50) DEFAULT 'draft', -- draft/active/completed/paused
  is_template BOOLEAN DEFAULT false,
  template_category VARCHAR(100),
  visibility VARCHAR(50) DEFAULT 'private', -- private/org_shared/public
  published_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  deleted_at TIMESTAMP,
  is_active BOOLEAN DEFAULT true
);

CREATE INDEX idx_diet_plan_org_id ON DietPlan(org_id);
CREATE INDEX idx_diet_plan_client_id ON DietPlan(client_id);
CREATE INDEX idx_diet_plan_status ON DietPlan(status);
CREATE INDEX idx_diet_plan_is_template ON DietPlan(is_template);
```

### Meals
```sql
CREATE TABLE Meal (
  meal_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  plan_id UUID NOT NULL REFERENCES DietPlan(plan_id) ON DELETE CASCADE,
  day_of_week INT, -- 1-7 (Monday-Sunday)
  meal_date DATE,
  sequence_number INT,
  meal_type VARCHAR(50) NOT NULL, -- breakfast/lunch/snack/dinner
  time_of_day VARCHAR(10), -- "08:00" format
  name VARCHAR(255) NOT NULL,
  description TEXT,
  instructions TEXT,
  serving_size_notes TEXT,
  total_calories INT,
  total_protein_g DECIMAL(5,1),
  total_carbs_g DECIMAL(5,1),
  total_fats_g DECIMAL(5,1),
  total_fiber_g DECIMAL(5,1),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_meal_plan_id ON Meal(plan_id);
CREATE INDEX idx_meal_date ON Meal(meal_date);
```

### Food Items (Global + Org-Specific)
```sql
CREATE TABLE FoodItem (
  food_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID, -- NULL = global food, else org-specific
  name VARCHAR(255) NOT NULL,
  brand VARCHAR(255),
  category VARCHAR(100) NOT NULL,
  sub_category VARCHAR(100),
  serving_size_g DECIMAL(6,2) DEFAULT 100,
  calories INT NOT NULL,
  protein_g DECIMAL(5,1),
  carbs_g DECIMAL(5,1),
  fats_g DECIMAL(5,1),
  fiber_g DECIMAL(5,1),
  sodium_mg DECIMAL(7,2),
  sugar_g DECIMAL(5,1),
  is_verified BOOLEAN DEFAULT false,
  source VARCHAR(100), -- USDA/user_submitted/industry
  barcode VARCHAR(50),
  allergen_flags TEXT[],
  dietary_tags TEXT[], -- vegan/vegetarian/organic/etc
  created_by_user_id UUID,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_food_org_id ON FoodItem(org_id);
CREATE INDEX idx_food_category ON FoodItem(category);
CREATE INDEX idx_food_name ON FoodItem(name);
```

### Meal Food Items (Junction Table)
```sql
CREATE TABLE MealFoodItem (
  meal_food_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  meal_id UUID NOT NULL REFERENCES Meal(meal_id) ON DELETE CASCADE,
  food_id UUID NOT NULL REFERENCES FoodItem(food_id) ON DELETE CASCADE,
  quantity_g DECIMAL(6,2) NOT NULL,
  calories INT,
  protein_g DECIMAL(5,1),
  carbs_g DECIMAL(5,1),
  fats_g DECIMAL(5,1),
  fiber_g DECIMAL(5,1),
  sort_order INT DEFAULT 0,
  notes TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_meal_food_item_meal_id ON MealFoodItem(meal_id);
CREATE INDEX idx_meal_food_item_food_id ON MealFoodItem(food_id);
```

### Meal Logs (Tracking)
```sql
CREATE TABLE MealLog (
  meal_log_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID NOT NULL REFERENCES Organization(org_id) ON DELETE CASCADE,
  client_id UUID NOT NULL REFERENCES Client(client_id) ON DELETE CASCADE,
  meal_id UUID NOT NULL REFERENCES Meal(meal_id) ON DELETE CASCADE,
  scheduled_date DATE NOT NULL,
  scheduled_time VARCHAR(10), -- "08:00"
  status VARCHAR(50) DEFAULT 'pending', -- pending/eaten/skipped/substituted
  meal_photo_url TEXT,
  meal_photo_small_url TEXT,
  photo_uploaded_at TIMESTAMP,
  ai_food_recognition JSONB, -- AI analysis results
  client_notes TEXT,
  dietitian_feedback TEXT,
  dietitian_feedback_at TIMESTAMP,
  reviewed_by_user_id UUID REFERENCES "User"(user_id),
  substitute_description TEXT,
  substitute_calories_est INT,
  logged_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_meal_log_org_id ON MealLog(org_id);
CREATE INDEX idx_meal_log_client_id ON MealLog(client_id);
CREATE INDEX idx_meal_log_scheduled_date ON MealLog(scheduled_date);
CREATE INDEX idx_meal_log_status ON MealLog(status);
```

### Weight Logs
```sql
CREATE TABLE WeightLog (
  weight_log_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID NOT NULL REFERENCES Organization(org_id) ON DELETE CASCADE,
  client_id UUID NOT NULL REFERENCES Client(client_id) ON DELETE CASCADE,
  weight_kg DECIMAL(5,2) NOT NULL,
  log_date DATE NOT NULL,
  log_time VARCHAR(10), -- "10:00"
  notes TEXT,
  progress_photo_url TEXT,
  bmi DECIMAL(4,2),
  weight_change_from_previous DECIMAL(5,2),
  is_outlier BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(client_id, log_date)
);

CREATE INDEX idx_weight_log_org_id ON WeightLog(org_id);
CREATE INDEX idx_weight_log_client_id ON WeightLog(client_id);
CREATE INDEX idx_weight_log_log_date ON WeightLog(log_date);
```

### Body Measurements
```sql
CREATE TABLE BodyMeasurement (
  measurement_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID NOT NULL REFERENCES Organization(org_id) ON DELETE CASCADE,
  client_id UUID NOT NULL REFERENCES Client(client_id) ON DELETE CASCADE,
  log_date DATE NOT NULL,
  chest_cm DECIMAL(5,2),
  waist_cm DECIMAL(5,2),
  hips_cm DECIMAL(5,2),
  thighs_cm DECIMAL(5,2),
  arms_cm DECIMAL(5,2),
  body_fat_percentage DECIMAL(4,2),
  notes TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_body_measurement_org_id ON BodyMeasurement(org_id);
CREATE INDEX idx_body_measurement_client_id ON BodyMeasurement(client_id);
```

### Session Notes (SOAP/DAP)
```sql
CREATE TABLE SessionNote (
  note_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID NOT NULL REFERENCES Organization(org_id) ON DELETE CASCADE,
  client_id UUID NOT NULL REFERENCES Client(client_id) ON DELETE CASCADE,
  created_by_user_id UUID NOT NULL REFERENCES "User"(user_id),
  note_type VARCHAR(50) NOT NULL, -- SOAP/DAP/other
  title VARCHAR(255) NOT NULL,
  subjective TEXT,
  objective TEXT,
  assessment TEXT,
  plan TEXT,
  internal_notes TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  deleted_at TIMESTAMP
);

CREATE INDEX idx_session_note_org_id ON SessionNote(org_id);
CREATE INDEX idx_session_note_client_id ON SessionNote(client_id);
```

### Notifications
```sql
CREATE TABLE Notification (
  notification_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  recipient_id UUID NOT NULL,
  recipient_type VARCHAR(50) NOT NULL, -- 'user' or 'client'
  org_id UUID NOT NULL REFERENCES Organization(org_id) ON DELETE CASCADE,
  type VARCHAR(100) NOT NULL, -- meal_reminder/photo_uploaded/feedback_received
  category VARCHAR(100),
  title VARCHAR(255) NOT NULL,
  message TEXT NOT NULL,
  icon VARCHAR(100),
  deep_link TEXT,
  related_entity_type VARCHAR(100),
  related_entity_id UUID,
  is_read BOOLEAN DEFAULT false,
  read_at TIMESTAMP,
  sent_via_channels TEXT[] DEFAULT ARRAY['push'], -- push/email/in-app
  delivery_status VARCHAR(50) DEFAULT 'pending', -- pending/delivered/failed
  created_at TIMESTAMP DEFAULT NOW(),
  expires_at TIMESTAMP DEFAULT NOW() + INTERVAL '30 days'
);

CREATE INDEX idx_notification_recipient ON Notification(recipient_id, recipient_type);
CREATE INDEX idx_notification_is_read ON Notification(is_read);
CREATE INDEX idx_notification_org_id ON Notification(org_id);
```

### Activity Logs (Audit Trail)
```sql
CREATE TABLE ActivityLog (
  activity_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID NOT NULL REFERENCES Organization(org_id) ON DELETE CASCADE,
  user_id UUID REFERENCES "User"(user_id),
  user_type VARCHAR(50), -- 'dietitian', 'client', 'admin'
  action VARCHAR(100) NOT NULL,
  entity_type VARCHAR(100),
  entity_id UUID,
  old_values JSONB,
  new_values JSONB,
  change_desc TEXT,
  ip_address VARCHAR(50),
  user_agent TEXT,
  status VARCHAR(50) DEFAULT 'success', -- success/failed/warning
  error_message TEXT,
  metadata JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_activity_log_org_id ON ActivityLog(org_id);
CREATE INDEX idx_activity_log_user_id ON ActivityLog(user_id);
CREATE INDEX idx_activity_log_action ON ActivityLog(action);
```

### Invoices
```sql
CREATE TABLE Invoice (
  invoice_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID NOT NULL REFERENCES Organization(org_id) ON DELETE CASCADE,
  client_id UUID NOT NULL REFERENCES Client(client_id) ON DELETE CASCADE,
  created_by_user_id UUID NOT NULL REFERENCES "User"(user_id),
  invoice_number VARCHAR(50) NOT NULL UNIQUE,
  issue_date DATE NOT NULL,
  due_date DATE NOT NULL,
  currency VARCHAR(10) DEFAULT 'INR',
  subtotal DECIMAL(10,2) NOT NULL,
  tax DECIMAL(10,2) DEFAULT 0,
  total DECIMAL(10,2) NOT NULL,
  status VARCHAR(50) DEFAULT 'unpaid', -- unpaid/sent/paid/cancelled
  notes TEXT,
  sent_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_invoice_org_id ON Invoice(org_id);
CREATE INDEX idx_invoice_client_id ON Invoice(client_id);
CREATE INDEX idx_invoice_status ON Invoice(status);
```

---

## Summary: 15 Tables 

| Table | Purpose | Records (1yr) |
|-------|---------|---------------|
| Organization | Tenants | 1 |
| User | Dietitians/admins | 50 |
| Client | Clients | 500 |
| MedicalProfile | Medical history | 500 |
| DietPlan | Meal plans | 2,000 |
| Meal | Individual meals | 7,000 |
| FoodItem | Global + org foods | 10,000 |
| MealFoodItem | Meal compositions | 28,000 |
| MealLog | Tracked meals | 30,000 |
| WeightLog | Weight entries | 5,000 |
| BodyMeasurement | Measurement history | 2,000 |
| SessionNote | SOAP notes | 5,000 |
| Notification | Push alerts | 50,000 |
| ActivityLog | Audit trail | 100,000 |
| Invoice | Billing | 1,000 |
| **TOTAL** | | **241,050** |

---
</file>

<file path="Docs/dietconnect_prd.md">
# DietConnect PRD (Product Requirements Document)

**Version:** 1.0.0  
**Date:** December 7, 2025  
**Status:** Ready for Development  
**Team:** Poorav (PM/Tech Lead)

---

## Executive Summary

**DietConnect** is a **B2B SaaS platform** connecting dietitians with clients for personalized nutrition management. Dietitians create custom meal plans, clients log meals with photos, and dietitians provide real-time feedback. Built on self-hosted infrastructure for complete data control and cost efficiency.

**Target Users:** Nutrition clinics, private practice dietitians, wellness centers in India

**Launch Timeline:** 3-4 weeks (MVP)

---

## 1. Vision & Goals

### Product Vision
Enable dietitians to scale their practice by providing a digital platform for meal planning, client tracking, and real-time nutrition feedback.

### Success Metrics (Month 1-6)
- 50+ registered dietitians
- 500+ active clients
- 10,000+ meal logs per month
- 90%+ client retention (1-month)
- < 2 second API response time
- 99.5% uptime

---

## 2. Market & User Analysis

### Primary Users

#### **User Persona 1: Dietitian (Dashboard)**
- **Name:** Dr. Priya Sharma
- **Age:** 32
- **Experience:** 8+ years in nutrition
- **Pain Points:** 
  - Manual meal plan creation takes 2-3 hours per client
  - Can't track client adherence in real-time
  - Limited to email follow-ups
  - Managing 30+ clients manually is chaotic
- **Goals:**
  - Reduce plan creation time to 30 minutes
  - See client progress instantly
  - Send automated reminders
  - Scale to 100+ clients

#### **User Persona 2: Client (Mobile App)**
- **Name:** Sarah Sharma
- **Age:** 28
- **Goals:** Lose 10kg in 3 months
- **Pain Points:**
  - Forgets when to eat meals
  - Doesn't know if portions are correct
  - No feedback from dietitian
  - Gets demotivated easily
- **Goals:**
  - Easy meal logging (just take a photo)
  - Quick dietitian feedback
  - Track weight progress
  - Stay motivated with reminders

### Target Market Size
- **India:** ~50,000 professional dietitians
- **Addressable:** ~5,000 practicing dietitians with digital practice
- **Year 1 Goal:** 100-200 dietitians

---

## 3. Core Features (MVP)

### **Phase 1: MVP (Weeks 1-3)**

#### 3.1 Authentication & Onboarding

**Dietitian Registration**
- Email/password signup
- License number verification (optional for MVP)
- Organization setup
- Clinic profile creation

**Client Onboarding**
- OTP-based mobile login
- Medical history questionnaire (5-10 questions)
- Health goals setup
- Dietary preferences & allergies

---

#### 3.2 Dietitian Dashboard

##### A. Client Management
- **Client List View**
  - Name, age, goal, primary dietitian
  - Current weight vs target
  - Last interaction date
  - Status (active/paused/completed)
  - Search & filter by status, dietitian
  - Bulk actions (export, message)

- **Client Profile**
  - Demographics (DOB, height, weight, activity level)
  - Medical history (diagnoses, medications, allergies)
  - Emergency contact
  - Session notes history
  - Weight tracking graph
  - Body measurement history

- **Add Client**
  - Form: name, email, phone, DOB, height, weight, goal
  - Medical profile: conditions, medications, allergies
  - Primary dietitian assignment

##### B. Diet Plan Builder (Core Feature)
- **Three-column layout:**
  1. Left: Client info + medical history sidebar
  2. Center: Weekly meal grid (7 days × 4 meals)
  3. Right: Daily macro targets & current totals

- **Meal Creation**
  - Click any day/meal type to add meal
  - Type meal name (e.g., "Paneer Tikka + Rice")
  - Search & add food items from database
  - Adjust quantities via drag-handle
  - Auto-calculate nutrition
  - Add cooking instructions
  - Save as template option

- **Food Database Search**
  - Search by name, category, brand
  - Filter: vegetarian, vegan, high-protein, low-carb
  - Show nutrition per 100g
  - Option to create custom food items

- **Meal Plan Management**
  - Save as draft
  - Preview as client sees it
  - Publish (auto-generates meal logs for client)
  - Edit existing plans
  - Clone & modify previous plans
  - Save as template for reuse

- **Macro Targets**
  - Set daily targets: Calories, Protein, Carbs, Fats, Fiber
  - See current totals vs targets
  - Green (on target), Yellow (5-10% off), Red (>10% off)
  - Adjust meals to hit targets

##### C. Meal Log Review
- **Pending Photos**
  - List of photos awaiting review
  - Sorted by date (newest first)
  - Status: Pending → Reviewed
  
- **Review Interface**
  - Large photo display
  - Original meal details (name, planned nutrition)
  - Client's notes ("Used less oil today")
  - Quick feedback buttons:
    - ✅ Great job! (with optional custom message)
    - ⚠️ Good, but... (with custom feedback)
    - ❌ Off plan (with suggestion)
  - Save feedback → Notification sent to client

##### D. Client Progress
- **Weight Tracking**
  - Line graph: weight over time
  - Statistics: total loss, weekly average, trend
  - Comparison to target
  
- **Adherence Analytics**
  - % meals logged this week
  - % meals on-plan (eaten vs skipped)
  - Most logged meals (hit/miss)
  - Compliance score (0-100)

- **Session Notes**
  - Create SOAP notes (Subjective/Objective/Assessment/Plan)
  - Store notes linked to date
  - View history of all notes

##### E. Billing & Invoicing
- **Invoice Creation**
  - Manual invoice generation
  - Line items: consultation, meal plan, follow-up
  - Save as draft or send immediately
  - Email invoice to client
  - Track paid/unpaid status

---

#### 3.3 Client Mobile App (React Native)

##### A. Authentication
- **OTP Login**
  - Enter phone → Receive OTP → Verify → Logged in
  - Token stored securely (secure storage)
  - Auto-logout after 30 days inactivity

##### B. Today's Plan View
- **Home Screen**
  - Date header
  - Current meal streak counter
  - 4 meal cards:
    - Breakfast (8 AM)
    - Lunch (1 PM)
    - Snack (4 PM)
    - Dinner (8 PM)
  
  - Each card shows:
    - Meal name ("Besan Chilla + Curd")
    - Meal photo
    - Planned nutrition (calories, macros)
    - Instruction icon (collapsible)
    - Status: Pending → Logged → Reviewed
    - Dietitian feedback (if any)

##### C. Meal Logging
- **Log Meal Flow**
  1. Tap meal card
  2. Choose: Camera → Photo, Gallery → Photo, Or "Skipped" / "Substitute"
  3. If photo: Display photo, allow edit/crop
  4. Optional notes ("Used less oil", "Added extra salad")
  5. Tap "Log Meal" → Uploaded to server
  6. Show success → Return to home

- **Photo Upload**
  - Camera capture
  - Gallery pick
  - Compress to <2MB
  - Upload with progress indicator
  - Display thumbnail once uploaded

##### D. Weight Tracking
- **Weight Screen**
  - Weekly line graph (auto-scales)
  - Current weight vs target
  - Progress card: "3kg down, 7kg to go"
  - Quick log button
  - View full history

- **Log Weight**
  - Date picker
  - Weight input field
  - Optional notes
  - Show weight change from previous entry

##### E. Progress & Insights
- **Dashboard Tab**
  - Weekly adherence %
  - Weight trend (arrow: ↓ Good, ↑ Concerning)
  - Meal completion %
  - Calories burned vs consumed (if tracked)
  - Dietitian's message (latest feedback)

##### F. Notifications
- **Push Notifications**
  - Meal reminders (8 AM, 1 PM, 4 PM, 8 PM)
  - "Breakfast time! Log your meal"
  - Dietitian feedback ("Dr. Priya reviewed your lunch")
  - Weight check-in reminder (weekly)
  - Personalized motivation messages

---

### **Phase 2: Post-MVP (Week 4+) - NOT in MVP**

These are explicitly **excluded** from MVP to keep scope tight:

- ❌ AI food recognition
- ❌ Grocery list generation
- ❌ Prescription meal plans
- ❌ Video consultations
- ❌ Community features
- ❌ Advanced reporting
- ❌ Integration with wearables
- ❌ Multi-language support

---

## 4. Technical Architecture

### 4.1 Tech Stack

| Layer | Technology | Reason |
|-------|-----------|--------|
| **Backend** | Node.js 18 + Express + TypeScript | Fast, scalable, type-safe |
| **Database** | PostgreSQL 14 (self-hosted) | ACID, RLS for multi-tenant |
| **ORM** | Prisma | Type-safe, migrations |
| **File Storage** | Disk storage (/var/uploads) | Self-hosted, simple |
| **Web Server** | Nginx (reverse proxy) | Load balancing, SSL |
| **Frontend** | Next.js 14 + Tailwind CSS | SSR, fast builds |
| **Mobile** | React Native (Expo) | Cross-platform MVP |
| **Notifications** | Postfix SMTP + Push (FCM) | Email & mobile alerts |
| **Monitoring** | Prometheus + Grafana | Server metrics |
| **Containerization** | Docker + Docker Compose | Local and server deployment |

### 4.2 Architecture Diagram

```
┌──────────────────────────────────────────┐
│        Client Machines                   │
├──────────────┬──────────────┬────────────┤
│  Web Browser │ Mobile App   │ Postman    │
│  (Dashboard) │ (React NA)   │ (Testing)  │
└──────────┬───┴──────────┬───┴────────────┘
           │              │
           └──────┬───────┘
                  │ HTTPS
        ┌─────────▼────────────┐
        │  Nginx (Port 443)    │
        │  Reverse Proxy       │
        └─────────┬────────────┘
                  │
      ┌───────────┼───────────┐
      │           │           │
      ▼           ▼           ▼
┌─────────┐  ┌─────────┐  ┌─────────┐
│ Backend │  │Frontend │  │ (Files) │
│ :3000   │  │ :3001   │  │Upload   │
└────┬────┘  └─────────┘  │/uploads │
     │                    └─────────┘
     │ TCP
     ▼
┌──────────────────┐
│  PostgreSQL      │
│  Database        │
│  Port 5432       │
└──────────────────┘
```

### 4.3 Database Schema (18 Tables)
- Organizations
- Users (Dietitians/Admins)
- Clients
- DietPlans
- Meals
- MealFoodItems
- FoodItems
- MealLogs
- WeightLogs
- BodyMeasurements
- SessionNotes
- Notifications
- ActivityLogs
- Invoices
- MedicalProfiles
- (+ 2-3 junction/utility tables)

**All with:**
- UUID primary keys
- Soft deletes (deletedAt field)
- Timestamps (createdAt, updatedAt)
- Row-level security (multi-tenant isolation)

---

## 5. User Flows

### 5.1 Dietitian User Flow

```
1. SIGNUP
   Email → Verify → Organization setup → Profile → Dashboard

2. CREATE CLIENT
   Add client form → Medical history → Assign to self → Client invite link

3. CREATE DIET PLAN
   Select client → Set macros → Add meals → Search foods → 
   Adjust portions → Preview → Publish → Auto-generate meal logs

4. REVIEW MEAL LOGS
   See pending photos → View photo + client notes → 
   Give feedback → Notification sent to client

5. TRACK PROGRESS
   View client weight graph → View adherence % → 
   Session notes → Identify patterns
```

### 5.2 Client User Flow

```
1. SIGNUP
   OTP login → Medical history → Goals → Dietary prefs → Home

2. VIEW PLAN
   Open app → See today's meals → View meal details →
   See instructions → View dietitian's notes

3. LOG MEAL
   Tap meal → Take photo → Add notes → "Log meal" → 
   Upload → Wait for feedback

4. TRACK WEIGHT
   Progress tab → Log weight → See graph → Check trend

5. GET FEEDBACK
   Notification: "Dietitian reviewed your lunch" → 
   Tap → See feedback → Encouragement/adjustment
```

---

## 6. API Endpoints (V1)

### Summary: 45+ endpoints across 10 domains

| Domain | Endpoints | Priority |
|--------|-----------|----------|
| Auth | 4 | P0 |
| Organization | 2 | P0 |
| Users | 5 | P0 |
| Clients | 6 | P0 |
| Medical Profiles | 2 | P0 |
| Diet Plans | 8 | P0 |
| Meals | 6 | P0 |
| Food Items | 5 | P0 |
| Meal Logs | 6 | P0 |
| Weight Logs | 4 | P0 |
| Session Notes | 5 | P1 |
| Notifications | 3 | P1 |
| Activity Logs | 1 | P2 |
| Invoices | 5 | P2 |
| Body Measurements | 2 | P2 |

**Full API doc:** See attached `api-v1.md` (comprehensive)

---

## 7. Non-Functional Requirements

### 7.1 Performance
- API response time: < 2 seconds (p95)
- File upload: < 5 seconds (for 2MB photo)
- Database query: < 500ms
- Frontend load: < 3 seconds (First Contentful Paint)
- Mobile app load: < 2 seconds per screen

### 7.2 Scalability
- Support 10,000 concurrent users (Phase 2)
- 100,000 meal logs/month
- Store 50GB+ photos over 1 year
- Database: Can scale to 1M records per table

### 7.3 Security
- HTTPS/TLS for all traffic
- JWT tokens (1-hour expiry)
- Row-level security (tenant isolation)
- Password hashing (bcrypt)
- Rate limiting: 1000 req/hour per user
- Input validation on all endpoints
- CSRF protection
- SQL injection protection (Prisma parameterized queries)

### 7.4 Reliability
- 99.5% uptime target
- Database backups: Daily (7-day retention)
- Photo backups: Daily to external drive
- Error tracking: Sentry integration
- Health checks: Every 5 minutes
- Graceful error messages (no 500 errors)

### 7.5 Compliance
- GDPR-ready (data export/deletion)
- Data residency: India (self-hosted)
- Privacy policy: Clear consent for photo storage
- Medical data: Encrypted in transit & at rest

---

## 8. Success Criteria (MVP)

### Functional Success
- [ ] All 20 priority API endpoints working
- [ ] Dietitian can create full diet plan in < 5 minutes
- [ ] Client can log meal with photo in < 1 minute
- [ ] Photos upload & display correctly
- [ ] Weight tracking graph works smoothly
- [ ] Notifications send and display correctly
- [ ] No data loss on server restart

### Non-Functional Success
- [ ] API response time: < 2 sec average
- [ ] Mobile app: < 3 seconds cold start
- [ ] Dashboard: < 2 seconds page load
- [ ] Server uptime: 99%+ in week 1
- [ ] No security vulnerabilities (OWASP Top 10)

### User Success
- [ ] Dietitian can invite client (email works)
- [ ] Client receives invite and signs up via OTP
- [ ] Dietitian receives meal log photo
- [ ] Client receives dietitian feedback notification
- [ ] 10 internal testers can use app without bugs

---

## 9. Development Roadmap

### Week 1: Backend Foundation
- [ ] Prisma schema + migrations
- [ ] PostgreSQL setup
- [ ] Express server + middleware
- [ ] Auth endpoints (login, refresh)
- [ ] Organization endpoints
- [ ] User CRUD endpoints
- [ ] Client CRUD endpoints

**Deliverable:** 10 working API endpoints, testable in Postman

### Week 2: Core Features
- [ ] Diet plan CRUD endpoints
- [ ] Meal endpoints
- [ ] Food database endpoints
- [ ] Meal log endpoints
- [ ] Weight log endpoints
- [ ] File upload (disk storage)
- [ ] Notification system

**Deliverable:** 30+ working API endpoints

### Week 2-3: Frontend (Dashboard)
- [ ] Next.js project setup
- [ ] Login page
- [ ] Client list page
- [ ] Client detail page
- [ ] Diet plan builder (3-column layout)
- [ ] Meal log review page
- [ ] Weight tracking page

**Deliverable:** Fully functional dietitian dashboard

### Week 3-4: Mobile App
- [ ] React Native project setup
- [ ] OTP login
- [ ] Home/today's plan screen
- [ ] Meal logging (photo upload)
- [ ] Weight tracking
- [ ] Progress dashboard
- [ ] Notifications

**Deliverable:** Fully functional mobile app

### Week 4: Testing & Deployment
- [ ] API testing (Postman collection)
- [ ] Frontend testing (Cypress E2E)
- [ ] Mobile testing (iOS/Android)
- [ ] Security audit
- [ ] Deploy to self-hosted servers
- [ ] Docker setup
- [ ] Nginx SSL configuration

**Deliverable:** Live MVP at dietconnect.yourcompany.com

---

## 10. Deployment & Infrastructure

### 10.1 Self-Hosted Stack

```
Hardware: Your local servers
OS: Ubuntu 20.04 LTS
Docker: Version 24+
Disk: /var/uploads (for photos)
Database: PostgreSQL 14 (self-managed)
Backup: Daily (external drive)
```

### 10.2 Services

```
PostgreSQL     → Port 5432 (internal only)
Backend API    → Port 3000 (via Nginx)
Frontend       → Port 3001 (via Nginx)
Nginx          → Port 80, 443 (HTTPS)
Prometheus     → Port 9090 (internal)
Grafana        → Port 3100 (internal)
```

### 10.3 Docker Compose
Single file deploys everything:
```bash
docker-compose up -d
# Waits for all services
# Auto-migrations run
# All health checks pass
```

### 10.4 Backup Strategy
- **Database:** PostgreSQL dump daily → /backups/
- **Photos:** rsync to external NAS daily
- **Retention:** 30-day rotating backup
- **Recovery:** < 1 hour

---

## 11. Launch Plan

### Week 1-3: Internal Development
- Build MVP with your team
- Test with internal users (yourself + 2-3 testers)
- Fix critical bugs

### Week 4: Soft Launch
- 10-20 beta users (select dietitians)
- Gather feedback
- Fix issues

### Week 5: Official Launch
- Public website launch
- Marketing/outreach begins
- Support team ready

### Month 2-3: Growth
- Onboard 50+ dietitians
- Scale infrastructure if needed
- Plan Phase 2 features

---

## 12. Risks & Mitigation

| Risk | Impact | Mitigation |
|------|--------|-----------|
| **Data loss** | Critical | Daily backups, 30-day retention |
| **Security breach** | Critical | HTTPS, RLS, rate limiting, audit logs |
| **Server downtime** | High | Health checks, restart on crash, monitoring |
| **Photo upload fails** | Medium | Retry logic, queue system |
| **Client churn** | High | Great UX, quick feedback loops |
| **Compliance issues** | High | Privacy policy, data residency |
| **Scaling problems** | Medium | Load testing, optimize queries |

---

## 13. Success Metrics & KPIs

### Month 1-2
- 50+ registered dietitians
- 10+ meal plans created
- 0 critical bugs

### Month 3
- 100+ dietitians
- 1000+ clients onboarded
- 10,000+ meal logs
- < 0.1% error rate

### Month 6
- 200+ dietitians
- 2000+ active clients
- 30,000+ meal logs/month
- 90%+ client retention
- NPS > 50

---

## 14. Out of Scope (MVP)

**Explicitly NOT included:**

- ❌ Video consultations
- ❌ AI food recognition
- ❌ Grocery list generation
- ❌ Wearable integration (Fitbit, Apple Watch)
- ❌ Advanced reporting/analytics
- ❌ Multi-language support
- ❌ Payment processing (invoices manual)
- ❌ Third-party integrations
- ❌ Mobile app admin panel
- ❌ Advanced scheduling

**These are Phase 2+ features.**

---

## 15. Glossary & Definitions

| Term | Definition |
|------|-----------|
| **Dietitian** | Nutrition professional creating plans & reviewing logs |
| **Client** | End-user logging meals & tracking progress |
| **Meal Plan** | Weekly meal schedule with nutrition targets |
| **Meal Log** | Client's photo/record of eating a meal |
| **Session Note** | SOAP note documenting consultation |
| **Macro** | Macronutrient (protein, carbs, fats) |
| **Adherence** | % of planned meals client actually logged/ate |
| **MVP** | Minimum Viable Product (core features only) |

---

## 16. Approval & Sign-Off

| Role | Name | Date | Signature |
|------|------|------|-----------|
| Product Manager | Poorav | Dec 7, 2025 | ✓ |
| Tech Lead | Poorav | Dec 7, 2025 | ✓ |
| Stakeholder | You | — | — |

---

## Appendix A: File Structure

```
DietConnect/
├── backend/
│   ├── src/
│   │   ├── index.ts (entry point)
│   │   ├── middleware/
│   │   ├── routes/
│   │   ├── services/
│   │   ├── types/
│   │   └── utils/
│   ├── prisma/
│   │   ├── schema.prisma
│   │   └── migrations/
│   ├── .env
│   ├── Dockerfile
│   └── package.json
├── dashboard/
│   ├── app/
│   │   ├── page.tsx
│   │   ├── layout.tsx
│   │   └── (routes)/
│   ├── components/
│   ├── lib/
│   ├── .env.local
│   ├── Dockerfile
│   └── package.json
├── client-app/
│   ├── app/
│   ├── components/
│   ├── services/
│   ├── .env
│   ├── app.json
│   └── package.json
├── docker-compose.yml
├── nginx.conf
└── docs/
    ├── api-v1.md
    ├── deployment.md
    └── database-schema.md
```

---

## Appendix B: API Response Examples

### Successful Response
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "name": "Sarah Sharma",
    "email": "sarah@example.com"
  },
  "meta": {
    "page": 1,
    "pageSize": 20,
    "total": 100
  }
}
```

### Error Response
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Email is already in use",
    "details": {
      "field": "email"
    }
  }
}
```

---

## Appendix C: Database Statistics (MVP)

| Table | Estimated Records | Storage (1 year) |
|-------|------------------|-----------------|
| Clients | 500 | 50 MB |
| Diet Plans | 2,000 | 100 MB |
| Meal Logs | 30,000 | 200 MB + 50GB photos |
| Weight Logs | 5,000 | 50 MB |
| Food Items | 10,000 | 50 MB |
| Session Notes | 5,000 | 100 MB |
| **TOTAL** | **~50,000** | **~50.5 GB** |

**Photos:** ~1.5 MB average × 30,000 = 45GB

---

## Appendix D: Environment Variables (All Services)

```bash
# PostgreSQL
DATABASE_URL="postgresql://user:pass@localhost:5432/dietconnect"

# Server
PORT=3000
NODE_ENV=production
JWT_SECRET="your-super-secret-key-min-32-chars"

# File Storage (local disk)
UPLOAD_DIR="/var/uploads/meal-logs"
UPLOAD_MAX_SIZE_MB=5

# Email (Postfix)
SMTP_HOST="localhost"
SMTP_PORT=25
SMTP_FROM="noreply@dietconnect.yourcompany.com"

# Frontend
NEXT_PUBLIC_API_URL="https://api.dietconnect.yourcompany.com/v1"
NEXT_PUBLIC_APP_URL="https://dietconnect.yourcompany.com"

# Mobile App
REACT_APP_API_URL="https://api.dietconnect.yourcompany.com/v1"
REACT_APP_APP_VERSION="1.0.0"

# Monitoring
PROMETHEUS_ENABLED=true
SENTRY_ENABLED=false  # Enable after MVP

# Backup
BACKUP_ENABLED=true
BACKUP_PATH="/backups"
BACKUP_RETENTION_DAYS=30
```

---

**END OF PRD**

This PRD is a **north star** for the next 3-4 weeks of development. Any questions or changes should be documented and versioned.

**Next Action:** Start Week 1 development with backend foundation setup.
</file>

<file path="frontend/src/app/dashboard/analytics/page.tsx">
'use client';

import {
    TrendingUp,
    TrendingDown,
    Users,
    UtensilsCrossed,
    Target,
    Calendar,
    Loader2,
} from 'lucide-react';
import { useDashboardStats } from '@/lib/hooks/use-dashboard';
import { useClients } from '@/lib/hooks/use-clients';

export default function AnalyticsPage() {
    const { data: dashboardData, isLoading: dashboardLoading } = useDashboardStats();
    const { data: clientsData, isLoading: clientsLoading } = useClients({ pageSize: 100 });

    const isLoading = dashboardLoading || clientsLoading;

    const clients = clientsData?.data || [];
    const totalClients = clientsData?.meta?.total || 0;

    // Calculate top performers from client data
    // For now, just show the first 5 clients sorted by name alphabetically
    const topClients = clients.slice(0, 5).map((c, i) => ({
        name: c.fullName,
        adherence: 80 + Math.floor(Math.random() * 15), // Simulated - would need real progress data
        weightLoss: c.targetWeightKg && c.currentWeightKg
            ? Math.max(0, Number(c.currentWeightKg) - Number(c.targetWeightKg)).toFixed(1)
            : '0'
    }));

    const stats = [
        {
            label: 'Total Clients',
            value: totalClients.toString(),
            change: '+0%',
            trend: 'up' as const,
            icon: Users
        },
        {
            label: 'Active Diet Plans',
            value: (dashboardData?.stats.activeDietPlans || 0).toString(),
            change: '+0%',
            trend: 'up' as const,
            icon: UtensilsCrossed
        },
        {
            label: 'Avg. Adherence Rate',
            value: `${dashboardData?.stats.adherencePercent || 0}%`,
            change: '+0%',
            trend: 'up' as const,
            icon: Target
        },
        {
            label: 'Pending Reviews',
            value: (dashboardData?.stats.pendingReviews || 0).toString(),
            change: '+0%',
            trend: 'down' as const,
            icon: Calendar
        },
    ];

    const weeklyData = dashboardData?.weeklyAdherence || [
        { day: 'Mon', value: 0 },
        { day: 'Tue', value: 0 },
        { day: 'Wed', value: 0 },
        { day: 'Thu', value: 0 },
        { day: 'Fri', value: 0 },
        { day: 'Sat', value: 0 },
        { day: 'Sun', value: 0 },
    ];

    if (isLoading) {
        return (
            <div className="flex items-center justify-center h-64">
                <Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" />
            </div>
        );
    }

    return (
        <div className="space-y-6">
            {/* Header */}
            <div>
                <h1 className="text-3xl font-bold tracking-tight text-gray-900">Progress & Analytics</h1>
                <p className="text-[#4e9767] mt-1">Track your practice performance and client outcomes.</p>
            </div>

            {/* Stats Grid */}
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                {stats.map((stat, i) => (
                    <div
                        key={i}
                        className="flex flex-col gap-2 rounded-xl border border-gray-200 bg-white p-6"
                    >
                        <div className="flex items-center justify-between">
                            <div className="p-2 rounded-lg bg-[#17cf54]/10">
                                <stat.icon className="w-5 h-5 text-[#17cf54]" />
                            </div>
                            <span
                                className={`text-sm font-medium flex items-center gap-1 ${stat.trend === 'up' ? 'text-green-600' : 'text-red-500'
                                    }`}
                            >
                                {stat.change}
                                {stat.trend === 'up' ? (
                                    <TrendingUp className="w-4 h-4" />
                                ) : (
                                    <TrendingDown className="w-4 h-4" />
                                )}
                            </span>
                        </div>
                        <p className="text-3xl font-bold text-gray-900">{stat.value}</p>
                        <p className="text-sm text-gray-600">{stat.label}</p>
                    </div>
                ))}
            </div>

            {/* Charts Row */}
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                {/* Weekly Adherence Chart */}
                <div className="rounded-xl border border-gray-200 bg-white p-6">
                    <h3 className="mb-6 text-lg font-semibold text-gray-900">Weekly Adherence Trend</h3>
                    <div className="flex h-48 items-end justify-between gap-4">
                        {weeklyData.map((day, i) => (
                            <div key={i} className="flex-1 flex flex-col items-center gap-2">
                                <div
                                    className="w-full bg-[#17cf54] rounded-t transition-all hover:bg-[#17cf54]/80"
                                    style={{ height: `${Math.max(day.value, 5)}%` }}
                                />
                                <div className="text-center">
                                    <p className="text-sm font-bold text-gray-900">{day.value}%</p>
                                    <p className="text-xs text-gray-500">{day.day}</p>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>

                {/* Meal Reviews Summary */}
                <div className="rounded-xl border border-gray-200 bg-white p-6">
                    <h3 className="mb-6 text-lg font-semibold text-gray-900">Review Summary</h3>
                    <div className="grid grid-cols-2 gap-4">
                        <div className="bg-green-50 rounded-lg p-4 text-center">
                            <p className="text-3xl font-bold text-green-600">
                                {dashboardData?.stats.adherencePercent || 0}%
                            </p>
                            <p className="text-sm text-green-700 mt-1">Overall Adherence</p>
                        </div>
                        <div className="bg-orange-50 rounded-lg p-4 text-center">
                            <p className="text-3xl font-bold text-orange-600">
                                {dashboardData?.stats.pendingReviews || 0}
                            </p>
                            <p className="text-sm text-orange-700 mt-1">Pending Reviews</p>
                        </div>
                        <div className="bg-blue-50 rounded-lg p-4 text-center">
                            <p className="text-3xl font-bold text-blue-600">
                                {totalClients}
                            </p>
                            <p className="text-sm text-blue-700 mt-1">Total Clients</p>
                        </div>
                        <div className="bg-purple-50 rounded-lg p-4 text-center">
                            <p className="text-3xl font-bold text-purple-600">
                                {dashboardData?.stats.activeDietPlans || 0}
                            </p>
                            <p className="text-sm text-purple-700 mt-1">Active Plans</p>
                        </div>
                    </div>
                </div>
            </div>

            {/* Top Performers Table */}
            <div className="rounded-xl border border-gray-200 bg-white">
                <div className="p-6 border-b border-gray-100">
                    <h3 className="text-lg font-semibold text-gray-900">Recent Clients</h3>
                </div>
                <div className="overflow-x-auto">
                    {topClients.length === 0 ? (
                        <div className="p-6 text-center text-gray-500">
                            No clients yet. Add your first client!
                        </div>
                    ) : (
                        <table className="w-full">
                            <thead>
                                <tr className="bg-gray-50">
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        #
                                    </th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Client
                                    </th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Adherence
                                    </th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Weight to Goal
                                    </th>
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-gray-200">
                                {topClients.map((client, i) => (
                                    <tr key={i} className="hover:bg-gray-50">
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <span className={`inline-flex items-center justify-center w-8 h-8 rounded-full text-sm font-bold ${i === 0 ? 'bg-yellow-100 text-yellow-800' :
                                                i === 1 ? 'bg-gray-100 text-gray-800' :
                                                    i === 2 ? 'bg-orange-100 text-orange-800' :
                                                        'bg-gray-50 text-gray-600'
                                                }`}>
                                                {i + 1}
                                            </span>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <span className="font-medium text-gray-900">{client.name}</span>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="flex items-center gap-2">
                                                <div className="w-24 h-2 bg-gray-200 rounded-full overflow-hidden">
                                                    <div
                                                        className="h-full bg-[#17cf54] rounded-full"
                                                        style={{ width: `${client.adherence}%` }}
                                                    />
                                                </div>
                                                <span className="text-sm font-medium text-gray-900">{client.adherence}%</span>
                                            </div>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <span className="text-[#17cf54] font-medium">{client.weightLoss} kg</span>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    )}
                </div>
            </div>
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/clients/[id]/page.tsx">
'use client';

import Link from 'next/link';
import { useParams } from 'next/navigation';
import {
    ArrowLeft,
    Send,
    Utensils,
    Flag,
    MessageSquare,
    TrendingDown,
    TrendingUp,
    Loader2,
} from 'lucide-react';
import { useClient, useClientProgress } from '@/lib/hooks/use-clients';
import { useDietPlans } from '@/lib/hooks/use-diet-plans';

export default function ClientProfilePage() {
    const params = useParams();
    const clientId = params.id as string;

    // API hooks
    const { data: client, isLoading: clientLoading, error: clientError } = useClient(clientId);
    const { data: progress, isLoading: progressLoading } = useClientProgress(clientId);
    const { data: plansData } = useDietPlans({ clientId, isPublished: true });

    const activePlan = plansData?.data?.[0];

    const getInitials = (name?: string) => {
        if (!name) return '??';
        return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
    };

    const calculateAge = (dob?: string) => {
        if (!dob) return null;
        const birthDate = new Date(dob);
        const today = new Date();
        let age = today.getFullYear() - birthDate.getFullYear();
        const m = today.getMonth() - birthDate.getMonth();
        if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) age--;
        return age;
    };

    if (clientLoading) {
        return (
            <div className="flex items-center justify-center h-64">
                <Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" />
            </div>
        );
    }

    if (clientError || !client) {
        return (
            <div className="text-center py-12">
                <p className="text-red-600">Failed to load client.</p>
                <Link href="/dashboard/clients" className="text-[#17cf54] hover:underline mt-2 inline-block">
                    Back to Clients
                </Link>
            </div>
        );
    }

    const age = calculateAge(client.dateOfBirth);
    const adherencePercent = progress?.meals?.adherencePercentage || 0;
    const weightChange = progress?.weight?.totalChange;

    return (
        <div className="space-y-6">
            {/* Header */}
            <header className="flex flex-col gap-6">
                <div className="flex flex-wrap items-center justify-between gap-4">
                    <Link
                        href="/dashboard/clients"
                        className="flex items-center gap-2 text-[#4e9767] hover:text-[#0e1b12] transition-colors"
                    >
                        <ArrowLeft className="w-5 h-5" />
                        <span className="text-sm font-medium">Back to Clients</span>
                    </Link>
                    <div className="flex gap-2">
                        <Link
                            href={`/dashboard/diet-plans/new?clientId=${clientId}`}
                            className="flex items-center gap-2 h-10 px-4 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-bold transition-colors"
                        >
                            <Flag className="w-4 h-4" />
                            Create Diet Plan
                        </Link>
                        <button className="flex items-center gap-2 h-10 px-4 bg-[#17cf54] hover:bg-[#17cf54]/90 text-white rounded-lg text-sm font-bold transition-colors">
                            <Send className="w-4 h-4" />
                            Send Message
                        </button>
                    </div>
                </div>

                {/* Profile Header */}
                <div className="flex flex-col md:flex-row md:items-center gap-4">
                    <div className="w-24 h-24 md:w-32 md:h-32 rounded-full bg-[#17cf54]/20 flex items-center justify-center text-[#17cf54] text-3xl md:text-4xl font-bold">
                        {getInitials(client.fullName)}
                    </div>
                    <div className="flex flex-col justify-center">
                        <h1 className="text-2xl md:text-3xl font-bold text-gray-900 tracking-tight">
                            {client.fullName}
                        </h1>
                        <p className="text-[#4e9767]">
                            {age && `Age: ${age}, `}
                            {client.gender && `Gender: ${client.gender.charAt(0).toUpperCase() + client.gender.slice(1)}`}
                        </p>
                        <p className="text-[#4e9767]">
                            {client.email} • {client.phone || 'No phone'}
                        </p>
                    </div>
                </div>
            </header>

            {/* Key Metrics */}
            <section className="grid grid-cols-1 md:grid-cols-2 gap-6">
                {/* Weight Trend */}
                <div className="flex flex-col gap-2 rounded-xl bg-white p-6 shadow-sm border border-gray-100">
                    <p className="text-gray-900 font-medium">Weight Trend</p>
                    <div className="flex items-baseline gap-2">
                        <p className="text-3xl font-bold text-gray-900">
                            {progress?.weight?.currentWeight || client.currentWeightKg || '-'} kg
                        </p>
                        <span className="text-gray-400 text-lg">/ {client.targetWeightKg || '-'} kg goal</span>
                    </div>
                    {weightChange !== null && weightChange !== undefined && (
                        <div className="flex gap-1 items-center">
                            <span className="text-sm text-[#4e9767]">Last 30 Days</span>
                            <span className={`text-sm font-medium flex items-center gap-1 ${weightChange < 0 ? 'text-[#17cf54]' : 'text-orange-500'}`}>
                                {weightChange < 0 ? <TrendingDown className="w-4 h-4" /> : <TrendingUp className="w-4 h-4" />}
                                {weightChange > 0 ? '+' : ''}{weightChange} kg
                            </span>
                        </div>
                    )}
                    {/* Simple chart placeholder */}
                    <div className="h-32 mt-4 flex items-end gap-1">
                        {[70, 85, 60, 95, 75, 80, 55].map((h, i) => (
                            <div
                                key={i}
                                className="flex-1 bg-[#17cf54] rounded-t"
                                style={{ height: `${h}%` }}
                            />
                        ))}
                    </div>
                </div>

                {/* Adherence Score */}
                <div className="flex flex-col gap-3 rounded-xl bg-white p-6 shadow-sm border border-gray-100">
                    <div className="flex items-center justify-between">
                        <p className="text-gray-900 font-medium">Adherence Score</p>
                        <p className="text-2xl font-bold text-[#17cf54]">
                            {progressLoading ? '...' : `${adherencePercent}%`}
                        </p>
                    </div>
                    <div className="h-2 rounded-full bg-[#17cf54]/20">
                        <div
                            className="h-2 rounded-full bg-[#17cf54] transition-all"
                            style={{ width: `${adherencePercent}%` }}
                        />
                    </div>
                    <p className="text-sm text-[#4e9767]">
                        {client.fullName.split(' ')[0]} has logged {progress?.meals?.eaten || 0} of {progress?.meals?.total || 0} meals.
                    </p>
                    <div className="mt-auto pt-4 border-t border-gray-100 grid grid-cols-3 gap-2 text-center text-sm">
                        <div>
                            <p className="font-bold text-gray-900">{progress?.meals?.eaten || 0}</p>
                            <p className="text-gray-500">Eaten</p>
                        </div>
                        <div>
                            <p className="font-bold text-gray-900">{progress?.meals?.skipped || 0}</p>
                            <p className="text-gray-500">Skipped</p>
                        </div>
                        <div>
                            <p className="font-bold text-gray-900">{progress?.meals?.pending || 0}</p>
                            <p className="text-gray-500">Pending</p>
                        </div>
                    </div>
                </div>
            </section>

            {/* Tab Navigation */}
            <section>
                <div className="border-b border-gray-200">
                    <nav className="-mb-px flex space-x-6">
                        <button className="whitespace-nowrap border-b-2 border-[#17cf54] px-1 pb-3 text-sm font-semibold text-[#17cf54]">
                            Overview
                        </button>
                        <button className="whitespace-nowrap border-b-2 border-transparent px-1 pb-3 text-sm font-medium text-[#4e9767] hover:border-gray-300 hover:text-gray-900">
                            Diet Plan
                        </button>
                        <button className="whitespace-nowrap border-b-2 border-transparent px-1 pb-3 text-sm font-medium text-[#4e9767] hover:border-gray-300 hover:text-gray-900">
                            Meal Logs
                        </button>
                        <button className="whitespace-nowrap border-b-2 border-transparent px-1 pb-3 text-sm font-medium text-[#4e9767] hover:border-gray-300 hover:text-gray-900">
                            Progress
                        </button>
                    </nav>
                </div>

                {/* Tab Content */}
                <div className="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
                    {/* Current Diet Plan */}
                    <div className="flex flex-col gap-4 rounded-xl bg-white p-6 shadow-sm border border-gray-100">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 rounded-full bg-[#17cf54]/10 flex items-center justify-center text-[#17cf54]">
                                <Flag className="w-5 h-5" />
                            </div>
                            <h3 className="font-semibold text-gray-900">Current Diet Plan</h3>
                        </div>
                        {activePlan ? (
                            <>
                                <p className="text-[#4e9767]">Active since {new Date(activePlan.startDate).toLocaleDateString()}</p>
                                <p className="text-lg font-medium text-gray-900">{activePlan.title}</p>
                                <p className="text-sm text-[#4e9767]">{activePlan.description || 'No description'}</p>
                            </>
                        ) : (
                            <p className="text-gray-500 text-sm">No active diet plan</p>
                        )}
                    </div>

                    {/* Nutrition Targets */}
                    <div className="flex flex-col gap-4 rounded-xl bg-white p-6 shadow-sm border border-gray-100">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 rounded-full bg-[#17cf54]/10 flex items-center justify-center text-[#17cf54]">
                                <Utensils className="w-5 h-5" />
                            </div>
                            <h3 className="font-semibold text-gray-900">Nutrition Targets</h3>
                        </div>
                        {activePlan ? (
                            <div className="grid grid-cols-2 gap-3 text-sm">
                                <div className="bg-gray-50 p-3 rounded">
                                    <p className="font-bold text-gray-900">{activePlan.targetCalories || '-'}</p>
                                    <p className="text-gray-500">Calories</p>
                                </div>
                                <div className="bg-gray-50 p-3 rounded">
                                    <p className="font-bold text-gray-900">{activePlan.targetProteinG || '-'}g</p>
                                    <p className="text-gray-500">Protein</p>
                                </div>
                                <div className="bg-gray-50 p-3 rounded">
                                    <p className="font-bold text-gray-900">{activePlan.targetCarbsG || '-'}g</p>
                                    <p className="text-gray-500">Carbs</p>
                                </div>
                                <div className="bg-gray-50 p-3 rounded">
                                    <p className="font-bold text-gray-900">{activePlan.targetFatsG || '-'}g</p>
                                    <p className="text-gray-500">Fat</p>
                                </div>
                            </div>
                        ) : (
                            <p className="text-gray-500 text-sm">No diet plan set</p>
                        )}
                    </div>

                    {/* Medical Info */}
                    <div className="flex flex-col gap-4 rounded-xl bg-white p-6 shadow-sm border border-gray-100">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 rounded-full bg-[#17cf54]/10 flex items-center justify-center text-[#17cf54]">
                                <MessageSquare className="w-5 h-5" />
                            </div>
                            <h3 className="font-semibold text-gray-900">Medical Profile</h3>
                        </div>
                        <div className="space-y-2 text-sm">
                            <div>
                                <p className="font-medium text-gray-700">Allergies</p>
                                <p className="text-gray-500">
                                    {client.medicalProfile?.allergies?.join(', ') || 'None recorded'}
                                </p>
                            </div>
                            <div>
                                <p className="font-medium text-gray-700">Conditions</p>
                                <p className="text-gray-500">
                                    {client.medicalProfile?.conditions?.join(', ') || 'None recorded'}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/clients/new/page.tsx">
'use client';

import { useRouter } from 'next/navigation';
import { useEffect } from 'react';

// Redirect to clients page - new client is handled via modal
export default function NewClientPage() {
    const router = useRouter();

    useEffect(() => {
        router.replace('/dashboard/clients');
    }, [router]);

    return (
        <div className="flex items-center justify-center h-64">
            <p className="text-gray-500">Redirecting...</p>
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/clients/page.tsx">
'use client';

import { useState } from 'react';
import Link from 'next/link';
import {
    Search,
    Plus,
    ChevronLeft,
    ChevronRight,
    MoreVertical,
    MessageSquare,
    Eye,
    Loader2,
} from 'lucide-react';
import { AddClientModal } from '@/components/modals/add-client-modal';
import { useClients, useCreateClient, Client } from '@/lib/hooks/use-clients';

type FilterType = 'all' | 'active' | 'at-risk' | 'completed';

export default function ClientsPage() {
    const [filter, setFilter] = useState<FilterType>('all');
    const [search, setSearch] = useState('');
    const [page, setPage] = useState(1);
    const [showAddClientModal, setShowAddClientModal] = useState(false);

    // API hook
    const { data, isLoading, error } = useClients({
        page,
        pageSize: 20,
        search: search || undefined,
        status: filter !== 'all' ? filter : undefined,
    });
    const createClient = useCreateClient();

    const clients = data?.data || [];
    const meta = data?.meta;

    const handleAddClient = async (clientData: any) => {
        try {
            await createClient.mutateAsync({
                fullName: clientData.name,
                email: clientData.email,
                phone: clientData.phone,
                dateOfBirth: clientData.dateOfBirth,
                gender: clientData.gender,
                heightCm: clientData.height ? Number(clientData.height) : undefined,
                currentWeightKg: clientData.weight ? Number(clientData.weight) : undefined,
                targetWeightKg: clientData.targetWeight ? Number(clientData.targetWeight) : undefined,
            });
            setShowAddClientModal(false);
        } catch (err) {
            console.error('Failed to create client:', err);
        }
    };

    const getInitials = (name: string) => {
        return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
    };

    const formatLastActivity = (date?: string) => {
        if (!date) return 'Never';
        const d = new Date(date);
        const now = new Date();
        const diff = now.getTime() - d.getTime();
        const hours = Math.floor(diff / (1000 * 60 * 60));
        if (hours < 24) return `${hours} hours ago`;
        const days = Math.floor(hours / 24);
        if (days < 7) return `${days} days ago`;
        return `${Math.floor(days / 7)} weeks ago`;
    };

    return (
        <div className="space-y-6">
            {/* Header */}
            <div className="flex flex-wrap items-center justify-between gap-4">
                <h1 className="text-3xl font-bold tracking-tight text-gray-900">Clients</h1>
                <button
                    onClick={() => setShowAddClientModal(true)}
                    className="flex items-center gap-2 h-10 px-4 bg-[#17cf54] hover:bg-[#17cf54]/90 text-white rounded-lg text-sm font-bold transition-colors shadow-sm"
                >
                    <Plus className="w-4 h-4" />
                    Add New Client
                </button>
            </div>

            {/* Search and Filters */}
            <div className="flex flex-col md:flex-row gap-4">
                {/* Search Bar */}
                <div className="flex-grow">
                    <label className="flex h-12 w-full">
                        <div className="flex w-full flex-1 items-stretch rounded-lg h-full bg-gray-100">
                            <div className="flex items-center justify-center pl-4 text-[#17cf54]">
                                <Search className="w-5 h-5" />
                            </div>
                            <input
                                className="flex w-full min-w-0 flex-1 bg-transparent h-full placeholder:text-gray-500 pl-3 pr-4 text-base outline-none text-gray-900"
                                placeholder="Search by name, phone, or email..."
                                value={search}
                                onChange={(e) => {
                                    setSearch(e.target.value);
                                    setPage(1);
                                }}
                            />
                        </div>
                    </label>
                </div>

                {/* Filter Chips */}
                <div className="flex gap-2 items-center flex-wrap">
                    {(['all', 'active', 'at-risk', 'completed'] as FilterType[]).map((f) => (
                        <button
                            key={f}
                            onClick={() => {
                                setFilter(f);
                                setPage(1);
                            }}
                            className={`flex h-8 shrink-0 items-center justify-center px-4 rounded-lg text-sm font-medium capitalize transition-colors ${filter === f
                                ? 'bg-[#17cf54] text-white'
                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                }`}
                        >
                            {f === 'at-risk' ? 'At Risk' : f}
                        </button>
                    ))}
                </div>
            </div>

            {/* Loading State */}
            {isLoading && (
                <div className="flex items-center justify-center py-12">
                    <Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" />
                </div>
            )}

            {/* Error State */}
            {error && (
                <div className="bg-red-50 border border-red-200 rounded-lg p-4 text-red-700">
                    Failed to load clients. Please try again.
                </div>
            )}

            {/* Empty State */}
            {!isLoading && !error && clients.length === 0 && (
                <div className="text-center py-12 bg-white rounded-lg border border-gray-200">
                    <p className="text-gray-500">No clients found.</p>
                    <button
                        onClick={() => setShowAddClientModal(true)}
                        className="mt-4 text-[#17cf54] font-medium hover:underline"
                    >
                        Add your first client
                    </button>
                </div>
            )}

            {/* Table */}
            {!isLoading && clients.length > 0 && (
                <div className="overflow-hidden rounded-lg border border-gray-200 bg-white">
                    <div className="overflow-x-auto">
                        <table className="w-full">
                            <thead>
                                <tr className="bg-gray-50">
                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Client
                                    </th>
                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Phone
                                    </th>
                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Weight (current/goal)
                                    </th>
                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Dietitian
                                    </th>
                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Last Activity
                                    </th>
                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Actions
                                    </th>
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-gray-200">
                                {clients.map((client: Client) => (
                                    <tr key={client.id} className="hover:bg-gray-50">
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="flex items-center gap-3">
                                                <div className="w-10 h-10 rounded-full bg-[#17cf54]/20 flex items-center justify-center text-[#17cf54] font-bold">
                                                    {getInitials(client.fullName)}
                                                </div>
                                                <div className="flex items-center gap-2">
                                                    <span className="font-medium text-gray-900">{client.fullName}</span>
                                                    {client.status === 'at-risk' && (
                                                        <span className="w-2.5 h-2.5 rounded-full bg-orange-400" title="At risk" />
                                                    )}
                                                </div>
                                            </div>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-gray-600">
                                            {client.phone || '-'}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-gray-600">
                                            {client.currentWeightKg || '-'} kg / {client.targetWeightKg || '-'} kg
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-gray-600">
                                            {client.primaryDietitian?.fullName || '-'}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-gray-600">
                                            {formatLastActivity(client.lastActivityAt)}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="flex items-center gap-2">
                                                <Link
                                                    href={`/dashboard/clients/${client.id}`}
                                                    className="text-[#17cf54] hover:underline text-sm font-medium flex items-center gap-1"
                                                >
                                                    <Eye className="w-4 h-4" />
                                                    View
                                                </Link>
                                                <button className="text-[#17cf54] hover:underline text-sm font-medium flex items-center gap-1">
                                                    <MessageSquare className="w-4 h-4" />
                                                    Message
                                                </button>
                                                <button className="text-gray-500 hover:text-gray-700 p-1">
                                                    <MoreVertical className="w-4 h-4" />
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            )}

            {/* Pagination */}
            {meta && (
                <div className="flex items-center justify-between px-1">
                    <p className="text-sm text-gray-600">
                        Showing <span className="font-medium">{(page - 1) * (meta.pageSize || 20) + 1}</span>-
                        <span className="font-medium">{Math.min(page * (meta.pageSize || 20), meta.total)}</span> of{' '}
                        <span className="font-medium">{meta.total}</span> clients
                    </p>
                    <div className="flex items-center gap-2">
                        <button
                            onClick={() => setPage(p => Math.max(1, p - 1))}
                            disabled={page === 1}
                            className="flex items-center justify-center w-9 h-9 rounded-lg border border-gray-300 bg-white hover:bg-gray-100 disabled:opacity-50"
                        >
                            <ChevronLeft className="w-4 h-4" />
                        </button>
                        <button
                            onClick={() => setPage(p => p + 1)}
                            disabled={!meta.hasNextPage && page >= meta.totalPages}
                            className="flex items-center justify-center w-9 h-9 rounded-lg border border-gray-300 bg-white hover:bg-gray-100 disabled:opacity-50"
                        >
                            <ChevronRight className="w-4 h-4" />
                        </button>
                    </div>
                </div>
            )}

            {/* Add Client Modal */}
            <AddClientModal
                isOpen={showAddClientModal}
                onClose={() => setShowAddClientModal(false)}
                onSubmit={handleAddClient}
            />
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/diet-plans/[id]/page.tsx">
'use client';

import { useParams, useRouter } from 'next/navigation';
import { useDietPlan, usePublishDietPlan, useUpdateDietPlan } from '@/lib/hooks/use-diet-plans';
import { ArrowLeft, Calendar, User, FileText, Utensils, Loader2, CheckCircle, Clock, AlertCircle, Pencil } from 'lucide-react';
import Link from 'next/link';
import { useState } from 'react';

export default function DietPlanDetailPage() {
    const params = useParams();
    const router = useRouter();
    const planId = params.id as string;

    const { data: plan, isLoading, error, refetch } = useDietPlan(planId);
    const publishMutation = usePublishDietPlan();
    const updateMutation = useUpdateDietPlan();

    const [isEditingName, setIsEditingName] = useState(false);
    const [editedName, setEditedName] = useState('');

    const handlePublish = async () => {
        if (!plan) return;
        try {
            await publishMutation.mutateAsync(planId);
            await refetch(); // Refetch to update UI immediately
        } catch (err) {
            console.error('Failed to publish plan:', err);
        }
    };

    const handleSaveName = async () => {
        if (!editedName.trim() || !plan) return;
        try {
            await updateMutation.mutateAsync({ id: planId, name: editedName });
            setIsEditingName(false);
            await refetch();
        } catch (err) {
            console.error('Failed to update name:', err);
        }
    };

    if (isLoading) {
        return (
            <div className="flex justify-center items-center py-20">
                <Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" />
            </div>
        );
    }

    if (error || !plan) {
        return (
            <div className="text-center py-20">
                <AlertCircle className="w-12 h-12 text-red-500 mx-auto mb-4" />
                <h2 className="text-xl font-semibold text-gray-900 mb-2">Plan not found</h2>
                <p className="text-gray-500 mb-4">The diet plan you're looking for doesn't exist.</p>
                <Link href="/dashboard/diet-plans" className="text-[#17cf54] hover:underline">
                    ← Back to Diet Plans
                </Link>
            </div>
        );
    }

    const statusColor = plan.status === 'active' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700';

    return (
        <div className="space-y-6">
            {/* Header */}
            <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                    <button
                        onClick={() => router.back()}
                        className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                    >
                        <ArrowLeft className="w-5 h-5 text-gray-600" />
                    </button>
                    <div>
                        {isEditingName ? (
                            <div className="flex items-center gap-2">
                                <input
                                    type="text"
                                    value={editedName}
                                    onChange={(e) => setEditedName(e.target.value)}
                                    className="text-2xl font-bold text-gray-900 border border-gray-300 rounded-lg px-2 py-1 focus:ring-2 focus:ring-[#17cf54] focus:border-transparent outline-none"
                                    autoFocus
                                    onKeyDown={(e) => {
                                        if (e.key === 'Enter') handleSaveName();
                                        if (e.key === 'Escape') setIsEditingName(false);
                                    }}
                                />
                                <button
                                    onClick={handleSaveName}
                                    disabled={updateMutation.isPending}
                                    className="px-3 py-1 bg-[#17cf54] text-white text-sm font-medium rounded-lg hover:bg-[#17cf54]/90 disabled:opacity-50"
                                >
                                    {updateMutation.isPending ? 'Saving...' : 'Save'}
                                </button>
                                <button
                                    onClick={() => setIsEditingName(false)}
                                    className="px-3 py-1 bg-gray-200 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-300"
                                >
                                    Cancel
                                </button>
                            </div>
                        ) : (
                            <div className="flex items-center gap-2">
                                <h1 className="text-2xl font-bold text-gray-900">
                                    {plan.name || 'Diet Plan'}
                                </h1>
                                <button
                                    onClick={() => {
                                        setEditedName(plan.name || '');
                                        setIsEditingName(true);
                                    }}
                                    className="p-1 hover:bg-gray-100 rounded-lg transition-colors"
                                    title="Edit name"
                                >
                                    <Pencil className="w-4 h-4 text-gray-400 hover:text-gray-600" />
                                </button>
                            </div>
                        )}
                        <p className="text-gray-500">
                            For {plan.client?.fullName || 'Unknown Client'}
                        </p>
                    </div>
                </div>
                <div className="flex items-center gap-3">
                    <span className={`px-3 py-1 rounded-full text-sm font-medium ${statusColor}`}>
                        {plan.status === 'active' ? 'Active' : 'Draft'}
                    </span>
                    {plan.status !== 'active' && (
                        <button
                            onClick={handlePublish}
                            disabled={publishMutation.isPending}
                            className="px-4 py-2 bg-[#17cf54] text-white font-medium rounded-lg hover:bg-[#17cf54]/90 transition-colors disabled:opacity-50"
                        >
                            {publishMutation.isPending ? 'Publishing...' : 'Publish Plan'}
                        </button>
                    )}
                </div>
            </div>

            {/* Plan Details Card */}
            <div className="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Plan Details</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center">
                            <Calendar className="w-5 h-5 text-blue-600" />
                        </div>
                        <div>
                            <p className="text-sm text-gray-500">Start Date</p>
                            <p className="font-medium text-gray-900">
                                {new Date(plan.startDate).toLocaleDateString()}
                            </p>
                        </div>
                    </div>
                    <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-purple-50 rounded-lg flex items-center justify-center">
                            <User className="w-5 h-5 text-purple-600" />
                        </div>
                        <div>
                            <p className="text-sm text-gray-500">Client</p>
                            <p className="font-medium text-gray-900">{plan.client?.fullName || 'N/A'}</p>
                        </div>
                    </div>
                    <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-orange-50 rounded-lg flex items-center justify-center">
                            <Utensils className="w-5 h-5 text-orange-600" />
                        </div>
                        <div>
                            <p className="text-sm text-gray-500">Target Calories</p>
                            <p className="font-medium text-gray-900">
                                {plan.targetCalories || 'Not set'} {plan.targetCalories && 'kcal'}
                            </p>
                        </div>
                    </div>
                    <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-green-50 rounded-lg flex items-center justify-center">
                            <FileText className="w-5 h-5 text-green-600" />
                        </div>
                        <div>
                            <p className="text-sm text-gray-500">Meals</p>
                            <p className="font-medium text-gray-900">{plan.meals?.length || 0} meals</p>
                        </div>
                    </div>
                </div>

                {plan.description && (
                    <div className="mt-6 pt-6 border-t border-gray-100">
                        <p className="text-sm text-gray-500 mb-2">Description</p>
                        <p className="text-gray-700">{plan.description}</p>
                    </div>
                )}
            </div>

            {/* Meals Section */}
            <div className="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Meals</h2>
                {plan.meals && plan.meals.length > 0 ? (
                    <div className="space-y-4">
                        {plan.meals.map((meal, index) => (
                            <div key={meal.id || index} className="p-4 bg-gray-50 rounded-lg">
                                <div className="flex items-center justify-between mb-2">
                                    <h3 className="font-medium text-gray-900">{meal.name}</h3>
                                    <span className="text-sm text-gray-500 capitalize">{meal.mealType}</span>
                                </div>
                                {meal.scheduledTime && (
                                    <p className="text-sm text-gray-500 flex items-center gap-1">
                                        <Clock className="w-4 h-4" />
                                        {meal.scheduledTime}
                                    </p>
                                )}
                                {meal.foods && meal.foods.length > 0 && (
                                    <div className="mt-3 space-y-1">
                                        {meal.foods.map((food, fi) => (
                                            <div key={fi} className="text-sm text-gray-600 flex justify-between">
                                                <span>{food.foodItem?.name || 'Unknown'}</span>
                                                <span>{food.quantityG}g</span>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>
                ) : (
                    <div className="text-center py-8 text-gray-500">
                        <Utensils className="w-8 h-8 mx-auto mb-2 text-gray-400" />
                        <p>No meals added yet</p>
                    </div>
                )}
            </div>
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/diet-plans/new/page.tsx">
'use client';

import { useState, Suspense } from 'react';
import Link from 'next/link';
import { useSearchParams, useRouter } from 'next/navigation';
import {
    ArrowLeft,
    Eye,
    Download,
    Save,
    Send,
    ChevronLeft,
    ChevronRight,
    Search,
    BookOpen,
    Trash2,
    Plus,
    AlertTriangle,
    Loader2,
    Users,
} from 'lucide-react';
import { AddFoodModal } from '@/components/modals/add-food-modal';
import { useClient, useClients } from '@/lib/hooks/use-clients';
import { useCreateDietPlan, usePublishDietPlan, useDietPlans, CreateDietPlanInput } from '@/lib/hooks/use-diet-plans';
import { toast } from 'sonner';
import { useQueryClient } from '@tanstack/react-query';
import { useApiClient } from '@/lib/api/use-api-client';

// Helper to generate dates for keys
const getDates = (startDate: Date, days: number) => {
    return Array.from({ length: days }, (_, i) => {
        const d = new Date(startDate);
        d.setDate(d.getDate() + i);
        return {
            date: d,
            label: d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
            day: d.toLocaleDateString('en-US', { weekday: 'short' })
        };
    });
};

interface LocalMeal {
    id: string; // temp id
    name: string;
    type: 'breakfast' | 'lunch' | 'dinner' | 'snack';
    time: string;
    foods: LocalFoodItem[];
}

interface LocalFoodItem {
    id: string; // db food id
    tempId: string; // unique local id
    name: string;
    quantity: string;
    quantityValue: number; // in grams/units approx
    calories: number;
    protein: number;
    carbs: number;
    fat: number;
    hasWarning: boolean;
}

function BuilderContent() {
    const searchParams = useSearchParams();
    const router = useRouter();
    const clientId = searchParams.get('clientId');
    const isTemplateMode = searchParams.get('template') === 'true';

    // Hooks - only fetch client if not in template mode and clientId provided
    const { data: client, isLoading: clientLoading } = useClient(
        !isTemplateMode && clientId ? clientId : ''
    );
    const createMutation = useCreateDietPlan();
    const publishMutation = usePublishDietPlan();

    // State for client selection if not provided in URL (and not in template mode)
    const [searchTerm, setSearchTerm] = useState('');
    const { data: clientsData } = useClients(
        !isTemplateMode && !clientId ? { search: searchTerm, pageSize: 10 } : {}
    );

    // Local State
    const [startDate, setStartDate] = useState(new Date());
    const [selectedDayIndex, setSelectedDayIndex] = useState(0);
    const [planName, setPlanName] = useState(isTemplateMode ? 'New Template' : 'New Diet Plan');
    const [planDescription, setPlanDescription] = useState('');

    // Store meals by day index (0-6 typically for a week)
    const [weeklyMeals, setWeeklyMeals] = useState<Record<number, LocalMeal[]>>({
        0: [
            { id: '1', name: 'Breakfast', type: 'breakfast', time: '08:00', foods: [] },
            { id: '2', name: 'Lunch', type: 'lunch', time: '13:00', foods: [] },
            { id: '3', name: 'Dinner', type: 'dinner', time: '19:30', foods: [] },
        ]
    });

    const [showAddFoodModal, setShowAddFoodModal] = useState(false);
    const [activeMealId, setActiveMealId] = useState<string | null>(null);

    const queryClient = useQueryClient();
    const api = useApiClient();

    // Fetch templates for sidebar
    const { data: templatesData } = useDietPlans({
        isTemplate: true,
        pageSize: 50
    });
    const templates = templatesData?.data || [];
    const [applyingTemplateId, setApplyingTemplateId] = useState<string | null>(null);


    // For templates, skip client selection entirely
    if (!isTemplateMode && !clientId) {
        return (
            <div className="flex flex-col items-center justify-center min-h-[60vh] p-8">
                <div className="w-full max-w-md space-y-6 text-center">
                    <div className="w-16 h-16 bg-[#17cf54]/10 rounded-full flex items-center justify-center mx-auto mb-4">
                        <Users className="w-8 h-8 text-[#17cf54]" />
                    </div>
                    <div>
                        <h2 className="text-2xl font-bold text-gray-900">Select a Client</h2>
                        <p className="text-gray-500 mt-2">Choose a client to start building their diet plan.</p>
                    </div>

                    <div className="relative">
                        <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                        <input
                            type="text"
                            placeholder="Search clients by name..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                            className="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#17cf54]/20 focus:border-[#17cf54] outline-none transition-all"
                            autoFocus
                        />
                    </div>

                    <div className="bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm text-left max-h-[300px] overflow-y-auto">
                        {!clientsData?.data?.length ? (
                            <div className="p-4 text-center text-gray-500 text-sm">
                                {searchTerm ? 'No clients found matching your search.' : 'Start typing to search...'}
                            </div>
                        ) : (
                            <div className="divide-y divide-gray-100">
                                {clientsData.data.map((c: any) => (
                                    <button
                                        key={c.id}
                                        onClick={() => router.push(`/dashboard/diet-plans/new?clientId=${c.id}`)}
                                        className="w-full px-4 py-3 flex items-center gap-3 hover:bg-gray-50 transition-colors group"
                                    >
                                        <div className="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 font-medium group-hover:bg-[#17cf54]/10 group-hover:text-[#17cf54]">
                                            {c.fullName.charAt(0)}
                                        </div>
                                        <div>
                                            <p className="font-semibold text-gray-900">{c.fullName}</p>
                                            <p className="text-xs text-gray-500">{c.email}</p>
                                        </div>
                                        <ChevronRight className="w-4 h-4 text-gray-400 ml-auto group-hover:text-[#17cf54]" />
                                    </button>
                                ))}
                            </div>
                        )}
                    </div>

                    <div className="text-sm">
                        <span className="text-gray-500">Don&apos;t see the client? </span>
                        <Link href="/dashboard/clients" className="text-[#17cf54] font-medium hover:underline">
                            Add new client
                        </Link>
                    </div>
                </div>
            </div>
        );
    }

    // For regular plans, show loading if client is loading
    if (!isTemplateMode && clientLoading) {
        return <div className="flex justify-center p-12"><Loader2 className="animate-spin" /></div>;
    }

    // For regular plans, show error if client not found
    if (!isTemplateMode && !client) {
        return <div className="p-8 text-center text-red-500">Client not found.</div>;
    }

    const planDates = getDates(startDate, 7); // Default 1 week view
    const currentMeals = weeklyMeals[selectedDayIndex] || [];

    const handleAddMeal = () => {
        const newMeal: LocalMeal = {
            id: Math.random().toString(36).substr(2, 9),
            name: 'Snack',
            type: 'snack',
            time: '16:00',
            foods: []
        };
        setWeeklyMeals(prev => ({
            ...prev,
            [selectedDayIndex]: [...(prev[selectedDayIndex] || []), newMeal]
        }));
    };

    const removeMeal = (id: string) => {
        setWeeklyMeals(prev => ({
            ...prev,
            [selectedDayIndex]: (prev[selectedDayIndex] || []).filter(m => m.id !== id)
        }));
    };

    const openAddFood = (mealId: string) => {
        setActiveMealId(mealId);
        setShowAddFoodModal(true);
    };

    const handleFoodAdded = (food: any) => {
        if (!activeMealId) return;

        const newFood: LocalFoodItem = {
            id: food.id,
            tempId: Math.random().toString(36).substr(2, 9),
            name: food.name,
            quantity: '1 serving',
            quantityValue: 100, // default
            calories: food.calories,
            protein: food.protein,
            carbs: food.carbs,
            fat: food.fat,
            hasWarning: client?.medicalProfile?.allergies?.some(a => food.name.toLowerCase().includes(a.toLowerCase())) || false
        };

        setWeeklyMeals(prev => ({
            ...prev,
            [selectedDayIndex]: (prev[selectedDayIndex] || []).map(m => {
                if (m.id === activeMealId) {
                    return { ...m, foods: [...m.foods, newFood] };
                }
                return m;
            })
        }));
        setShowAddFoodModal(false);
    };

    const removeFood = (mealId: string, tempId: string) => {
        setWeeklyMeals(prev => ({
            ...prev,
            [selectedDayIndex]: (prev[selectedDayIndex] || []).map(m => {
                if (m.id === mealId) {
                    return { ...m, foods: m.foods.filter(f => f.tempId !== tempId) };
                }
                return m;
            })
        }));
    };

    const updateFoodQuantity = (mealId: string, tempId: string, val: string) => {
        setWeeklyMeals(prev => ({
            ...prev,
            [selectedDayIndex]: (prev[selectedDayIndex] || []).map(m => {
                if (m.id === mealId) {
                    return { ...m, foods: m.foods.map(f => f.tempId === tempId ? { ...f, quantity: val } : f) };
                }
                return m;
            })
        }));
    };

    const calculateDayNutrition = () => {
        let calories = 0, protein = 0, carbs = 0, fat = 0;
        currentMeals.forEach(m => {
            m.foods.forEach(f => {
                calories += f.calories;
                protein += f.protein;
                carbs += f.carbs;
                fat += f.fat;
            });
        });
        return { calories, protein, carbs, fat };
    };

    const dayNutrition = calculateDayNutrition();
    // Default targets logic - use client data if available, otherwise defaults
    const targets = {
        calories: client?.targetWeightKg ? client.targetWeightKg * 30 : 2000,
        protein: 150,
        carbs: 200,
        fat: 70
    };


    const handleApplyTemplate = async (templateId: string) => {
        if (!confirm('This will replace all current meal entries with the selected template. Continue?')) return;

        setApplyingTemplateId(templateId);
        try {
            const { data } = await api.get(`/diet-plans/${templateId}`);
            const template = data.data;

            if (!template.meals || template.meals.length === 0) {
                toast.error('Template has no meals');
                return;
            }

            // Group by day and find min day to normalize
            const mealsByDay: Record<number, any[]> = {};
            let minDay = Infinity;

            template.meals.forEach((tm: any) => {
                // Ensure dayOfWeek is treated as number
                const d = typeof tm.dayOfWeek === 'string' ? parseInt(tm.dayOfWeek) : tm.dayOfWeek;
                if (!isNaN(d)) {
                    if (d < minDay) minDay = d;
                    if (!mealsByDay[d]) mealsByDay[d] = [];
                    mealsByDay[d].push(tm);
                }
            });

            if (minDay === Infinity) minDay = 0;

            const newWeeklyMeals: Record<number, LocalMeal[]> = {};

            Object.entries(mealsByDay).forEach(([dayStr, dayMeals]) => {
                const originalDay = parseInt(dayStr);
                const normalizedDay = originalDay - minDay;

                newWeeklyMeals[normalizedDay] = dayMeals.map((tm: any) => {
                    const localFoods: LocalFoodItem[] = tm.foodItems?.map((f: any) => {
                        const ratio = (f.quantityG || 100) / 100;
                        return {
                            id: f.foodItem.id,
                            tempId: Math.random().toString(36).substr(2, 9),
                            name: f.foodItem.name,
                            quantity: f.notes || `${f.quantityG}g`,
                            quantityValue: f.quantityG || 100,
                            calories: f.foodItem.calories * ratio,
                            protein: f.foodItem.protein * ratio,
                            carbs: f.foodItem.carbs * ratio,
                            fat: f.foodItem.fat * ratio,
                            hasWarning: client?.medicalProfile?.allergies?.some((a: string) => f.foodItem.name.toLowerCase().includes(a.toLowerCase())) || false
                        };
                    }) || [];

                    return {
                        id: Math.random().toString(36).substr(2, 9),
                        name: tm.name || tm.mealType,
                        type: tm.mealType, // Assuming type matches valid types
                        time: tm.timeOfDay,
                        foods: localFoods
                    };
                });
            });

            console.log('Normalized Weekly Meals:', newWeeklyMeals);
            setWeeklyMeals(newWeeklyMeals);

            // If the current viewed day is empty after update, switch to the first populated day?
            // Actually, day 0 (normalized) should be populated if template wasn't empty.
            if (!newWeeklyMeals[selectedDayIndex]) {
                // Try to find first day with meals
                const firstDay = Object.keys(newWeeklyMeals).map(Number).sort((a, b) => a - b)[0];
                if (firstDay !== undefined && firstDay !== selectedDayIndex) {
                    setSelectedDayIndex(firstDay);
                }
            }

            toast.success('Template applied successfully');
        } catch (error) {
            console.error(error);
            toast.error('Failed to apply template');
        } finally {
            setApplyingTemplateId(null);
        }
    };


    const handleSave = async (publish: boolean) => {
        // Flatten weekly meals into API format
        const apiMeals: CreateDietPlanInput['meals'] = [];

        Object.entries(weeklyMeals).forEach(([dayIdx, dayMeals]) => {
            dayMeals.forEach(m => {
                apiMeals.push({
                    dayIndex: parseInt(dayIdx),
                    mealType: m.type,
                    timeOfDay: m.time,
                    title: m.name,
                    foodItems: m.foods.map(f => ({
                        foodId: f.id,
                        quantity: f.quantityValue, // Needs better quantity handling
                        notes: f.quantity
                    }))
                });
            });
        });

        if (apiMeals.length === 0) {
            toast.error('Add at least one meal to the plan');
            return;
        }

        try {
            // First create the plan (always as draft)
            const createdPlan = await createMutation.mutateAsync({
                clientId: clientId || undefined, // undefined for templates
                title: planName,
                description: planDescription,
                startDate: startDate.toISOString(),
                meals: apiMeals,
                options: isTemplateMode ? { saveAsTemplate: true } : undefined,
            });

            // If publish is requested, use the publish mutation
            if (publish && createdPlan?.id) {
                await publishMutation.mutateAsync(createdPlan.id);
            }

            toast.success(
                isTemplateMode
                    ? (publish ? 'Template Published!' : 'Template Saved!')
                    : (publish ? 'Diet Plan Published!' : 'Draft Saved!')
            );

            // Navigate based on mode
            if (isTemplateMode) {
                router.push('/dashboard/diet-plans?tab=templates');
            } else if (clientId) {
                router.push(`/dashboard/clients/${clientId}`);
            } else {
                router.push('/dashboard/diet-plans');
            }
        } catch (error) {
            toast.error('Failed to save plan');
            console.error(error);
        }
    };

    const hasAllergyWarning = currentMeals.some(m => m.foods.some(f => f.hasWarning));

    // Get client initials (or T for template)
    const initials = isTemplateMode
        ? 'T'
        : (client?.fullName?.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2) || '?');

    return (
        <div className="flex flex-col h-[calc(100vh-5rem)] -m-6">
            {/* Top Header */}
            <header className="flex items-center justify-between border-b border-gray-200 px-6 py-3 bg-white flex-shrink-0">
                <div className="flex items-center gap-6">
                    <Link
                        href={isTemplateMode ? '/dashboard/diet-plans' : `/dashboard/clients/${clientId}`}
                        className="flex items-center gap-2 text-gray-600 hover:text-gray-900 text-sm font-medium"
                    >
                        <ArrowLeft className="w-4 h-4" />
                        {isTemplateMode ? 'Back to Templates' : 'Back to Client'}
                    </Link>
                    <div className="flex items-center gap-2">
                        <input
                            value={planName}
                            onChange={e => setPlanName(e.target.value)}
                            className="text-gray-900 text-sm font-medium border-none focus:ring-0"
                        />
                        {!isTemplateMode && client && (
                            <>
                                <span className="text-gray-400">|</span>
                                <span className="text-gray-600 text-sm">
                                    {client.fullName} ({client.dateOfBirth ?
                                        Math.floor((new Date().getTime() - new Date(client.dateOfBirth).getTime()) / 3.15576e10) :
                                        '?'
                                    } yrs)
                                </span>
                            </>
                        )}
                        {isTemplateMode && (
                            <>
                                <span className="text-gray-400">|</span>
                                <span className="text-purple-600 text-sm font-medium">Template</span>
                            </>
                        )}
                    </div>
                </div>
                <div className="flex gap-2">
                    {isTemplateMode ? (
                        // Template mode - just one Save Template button
                        <button
                            onClick={() => handleSave(false)}
                            disabled={createMutation.isPending}
                            className="flex items-center gap-2 h-10 px-4 bg-[#17cf54] hover:bg-[#17cf54]/90 text-white rounded-lg text-sm font-bold transition-colors disabled:opacity-50"
                        >
                            <Save className="w-4 h-4" />
                            {createMutation.isPending ? 'Saving...' : 'Save Template'}
                        </button>
                    ) : (
                        // Client mode - Save Draft and Publish buttons
                        <>
                            <button
                                onClick={() => handleSave(false)}
                                disabled={createMutation.isPending}
                                className="flex items-center gap-2 h-10 px-4 bg-gray-200 hover:bg-gray-300 text-gray-900 rounded-lg text-sm font-bold transition-colors disabled:opacity-50"
                            >
                                <Save className="w-4 h-4" />
                                Save Draft
                            </button>
                            <button
                                onClick={() => handleSave(true)}
                                disabled={createMutation.isPending}
                                className="flex items-center gap-2 h-10 px-4 bg-[#17cf54] hover:bg-[#17cf54]/90 text-white rounded-lg text-sm font-bold transition-colors disabled:opacity-50"
                            >
                                <Send className="w-4 h-4" />
                                Publish
                            </button>
                        </>
                    )}
                </div>
            </header>

            {/* Main Content */}
            <main className="flex-grow grid grid-cols-12 gap-4 p-4 overflow-hidden bg-gray-50">
                {/* Left Sidebar - Client Info (only for non-template mode) */}
                <aside className="col-span-3 flex flex-col gap-4 overflow-y-auto pr-2">
                    {isTemplateMode ? (
                        // Template mode sidebar
                        <>
                            <div className="bg-purple-50 p-4 rounded-lg border border-purple-200">
                                <div className="flex items-center gap-3">
                                    <div className="w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 font-bold">
                                        T
                                    </div>
                                    <div>
                                        <h1 className="text-gray-900 font-medium">Template</h1>
                                        <p className="text-gray-500 text-sm">
                                            Create reusable diet plan
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div className="bg-white p-4 rounded-lg border border-gray-200">
                                <h3 className="text-gray-900 font-medium mb-3">Template Tips</h3>
                                <ul className="text-sm text-gray-600 space-y-2">
                                    <li>• Templates can be assigned to any client</li>
                                    <li>• Meals will be copied when assigned</li>
                                    <li>• Client-specific targets will be applied later</li>
                                </ul>
                            </div>
                        </>
                    ) : client ? (
                        // Client mode sidebar
                        <>
                            {/* Client Card */}
                            <div className="bg-white p-4 rounded-lg border border-gray-200">
                                <div className="flex items-center gap-3">
                                    <div className="w-12 h-12 rounded-full bg-[#17cf54]/20 flex items-center justify-center text-[#17cf54] font-bold">
                                        {initials}
                                    </div>
                                    <div>
                                        <h1 className="text-gray-900 font-medium">{client.fullName}</h1>
                                        <p className="text-gray-500 text-sm">
                                            {client.heightCm}cm, {client.currentWeightKg}kg <br />
                                            Goal: {client.targetWeightKg}kg
                                        </p>
                                    </div>
                                </div>
                            </div>

                            {/* Medical Summary */}
                            <div className="bg-white p-4 rounded-lg border border-gray-200">
                                <h3 className="text-gray-900 font-medium mb-3">Medical Summary</h3>
                                {client.medicalProfile?.allergies?.length ? (
                                    <details className="bg-gray-50 rounded-lg px-4 py-1 group mb-2" open>
                                        <summary className="flex cursor-pointer items-center justify-between py-2 text-sm font-medium text-gray-800">
                                            Allergies
                                            <ChevronRight className="w-4 h-4 text-gray-400 group-open:rotate-90 transition-transform" />
                                        </summary>
                                        <p className="text-gray-600 text-sm pb-2">{client.medicalProfile.allergies.join(', ')}</p>
                                    </details>
                                ) : <p className="text-sm text-gray-500 italic">No allergies recorded.</p>}

                                {client.medicalProfile?.conditions?.length ? (
                                    <details className="bg-gray-50 rounded-lg px-4 py-1 group">
                                        <summary className="flex cursor-pointer items-center justify-between py-2 text-sm font-medium text-gray-800">
                                            Conditions
                                            <ChevronRight className="w-4 h-4 text-gray-400 group-open:rotate-90 transition-transform" />
                                        </summary>
                                        <p className="text-gray-600 text-sm pb-2">{client.medicalProfile.conditions.join(', ')}</p>
                                    </details>
                                ) : null}
                            </div>
                        </>
                    ) : null}

                    {/* Templates Sidebar Scroller */}
                    <div className="bg-white p-4 rounded-lg border border-gray-200 shadow-sm mt-4 flex flex-col gap-3 max-h-[400px]">
                        <h3 className="text-gray-900 font-medium flex items-center gap-2">
                            <BookOpen className="w-4 h-4 text-[#17cf54]" />
                            Saved Templates
                        </h3>
                        <div className="overflow-y-auto pr-1 space-y-2 flex-grow">
                            {templates.length === 0 ? (
                                <p className="text-sm text-gray-500 italic text-center py-4">No templates found</p>
                            ) : (
                                templates.map((t: any) => (
                                    <button
                                        key={t.id}
                                        onClick={() => handleApplyTemplate(t.id)}
                                        disabled={applyingTemplateId === t.id}
                                        className="w-full text-left p-3 rounded-lg border border-gray-100 hover:border-[#17cf54] hover:bg-[#17cf54]/5 transition-all group"
                                    >
                                        <div className="flex justify-between items-start">
                                            <span className="font-medium text-gray-800 text-sm group-hover:text-[#17cf54] line-clamp-1">
                                                {t.name}
                                            </span>
                                            {applyingTemplateId === t.id && (
                                                <Loader2 className="w-3 h-3 animate-spin text-[#17cf54]" />
                                            )}
                                        </div>
                                        <div className="flex items-center gap-2 mt-1 text-xs text-gray-500">
                                            <span>{t.checkInFrequency || 'Flexible'}</span>
                                        </div>
                                    </button>
                                ))
                            )}
                        </div>
                    </div>
                </aside>

                {/* Center - Meal Editor */}
                <section className="col-span-6 flex flex-col gap-4 overflow-y-auto">
                    {/* Day Selector */}
                    <div className="bg-white p-2 rounded-lg border border-gray-200 flex-shrink-0 sticky top-0 z-10">
                        <div className="flex justify-between items-center">
                            <button
                                onClick={() => setSelectedDayIndex(Math.max(0, selectedDayIndex - 1))}
                                className="p-2 rounded-full hover:bg-gray-100 disabled:opacity-30"
                                disabled={selectedDayIndex === 0}
                            >
                                <ChevronLeft className="w-5 h-5 text-gray-600" />
                            </button>
                            <div className="flex gap-1 overflow-x-auto no-scrollbar">
                                {planDates.map((d, i) => (
                                    <button
                                        key={i}
                                        onClick={() => setSelectedDayIndex(i)}
                                        className={`px-3 py-2 text-sm font-medium rounded-md transition-colors min-w-[80px] ${selectedDayIndex === i
                                            ? 'bg-[#17cf54] text-white'
                                            : 'text-gray-500 hover:bg-gray-100'
                                            }`}
                                    >
                                        {isTemplateMode ? (
                                            <>
                                                <div className="text-xs opacity-80">Day</div>
                                                <div className="font-bold">{i + 1}</div>
                                            </>
                                        ) : (
                                            <>
                                                <div className="text-xs opacity-80">{d.label}</div>
                                                <div className="font-bold">{d.day}</div>
                                            </>
                                        )}
                                    </button>
                                ))}
                            </div>
                            <button
                                onClick={() => setSelectedDayIndex(Math.min(6, selectedDayIndex + 1))}
                                className="p-2 rounded-full hover:bg-gray-100 disabled:opacity-30"
                                disabled={selectedDayIndex === 6}
                            >
                                <ChevronRight className="w-5 h-5 text-gray-600" />
                            </button>
                        </div>
                    </div>

                    {/* Meals */}
                    <div className="space-y-4">
                        {currentMeals.length === 0 && (
                            <div className="text-center py-8 bg-white rounded-lg border border-gray-200 border-dashed">
                                <p className="text-gray-400 mb-2">No meals for this day</p>
                                <button onClick={handleAddMeal} className="text-[#17cf54] font-medium hover:underline">Start adding meals</button>
                            </div>
                        )}

                        {currentMeals.map((meal) => (
                            <div key={meal.id} className="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                                <div className="flex justify-between items-center mb-3">
                                    <div className="flex items-center gap-2">
                                        <input
                                            value={meal.name}
                                            onChange={(e) => {
                                                setWeeklyMeals(prev => ({
                                                    ...prev,
                                                    [selectedDayIndex]: prev[selectedDayIndex].map(m => m.id === meal.id ? { ...m, name: e.target.value } : m)
                                                }));
                                            }}
                                            className="font-semibold text-gray-900 border-none p-0 focus:ring-0 w-32"
                                        />
                                        <input
                                            type="time"
                                            value={meal.time}
                                            onChange={(e) => {
                                                setWeeklyMeals(prev => ({
                                                    ...prev,
                                                    [selectedDayIndex]: prev[selectedDayIndex].map(m => m.id === meal.id ? { ...m, time: e.target.value } : m)
                                                }));
                                            }}
                                            className="text-sm p-1 border border-gray-200 rounded-md text-gray-700 w-24"
                                        />
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <p className="text-xs font-medium text-gray-500">
                                            {meal.foods.reduce((acc, f) => acc + f.calories, 0)} Kcal
                                        </p>
                                        <button onClick={() => removeMeal(meal.id)} className="text-gray-400 hover:text-red-500">
                                            <Trash2 className="w-4 h-4" />
                                        </button>
                                    </div>
                                </div>

                                {/* Food Items */}
                                <div className="space-y-2 mb-3">
                                    {meal.foods.map((food) => (
                                        <div
                                            key={food.tempId}
                                            className={`flex items-center gap-2 p-2 rounded-md ${food.hasWarning
                                                ? 'bg-red-50 border border-red-300'
                                                : 'bg-gray-50'
                                                }`}
                                        >
                                            {food.hasWarning && (
                                                <AlertTriangle className="w-4 h-4 text-red-500 mr-1" />
                                            )}
                                            <span className="text-gray-800 text-sm font-medium flex-grow truncate">{food.name}</span>
                                            <input
                                                type="text"
                                                value={food.quantity}
                                                onChange={(e) => updateFoodQuantity(meal.id, food.tempId, e.target.value)}
                                                className="w-24 text-sm text-right p-1 border border-gray-200 rounded-md text-gray-700 bg-white"
                                            />
                                            <button
                                                onClick={() => removeFood(meal.id, food.tempId)}
                                                className="p-1 text-gray-400 hover:text-red-500 transition-colors"
                                            >
                                                <Trash2 className="w-4 h-4" />
                                            </button>
                                        </div>
                                    ))}
                                </div>

                                {/* Add Food */}
                                <div className="flex gap-2">
                                    <button
                                        onClick={() => openAddFood(meal.id)}
                                        className="flex-grow flex items-center justify-center gap-2 px-3 py-2 text-sm font-medium text-gray-600 bg-gray-50 border border-gray-200 rounded-md hover:bg-gray-100 hover:border-gray-300 transition-colors"
                                    >
                                        <Plus className="w-4 h-4" />
                                        Add Food Item
                                    </button>
                                </div>
                            </div>
                        ))}

                        {/* Add Meal Button */}
                        <button
                            onClick={handleAddMeal}
                            className="w-full flex items-center justify-center gap-2 py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:bg-gray-50 hover:border-[#17cf54] hover:text-[#17cf54] transition-colors"
                        >
                            <Plus className="w-5 h-5" />
                            <span className="text-sm font-medium">Add another meal</span>
                        </button>
                    </div>
                </section>

                {/* Right Sidebar - Nutrition Summary */}
                <aside className="col-span-3 flex flex-col gap-4 overflow-y-auto pl-2">
                    {/* Allergy Warning */}
                    {hasAllergyWarning && (
                        <div className="bg-red-50 border border-red-300 p-4 rounded-lg">
                            <div className="flex items-start gap-3">
                                <AlertTriangle className="w-5 h-5 text-red-500 mt-0.5" />
                                <div>
                                    <h4 className="font-bold text-red-700">Allergy Warning</h4>
                                    <p className="text-sm text-red-600">
                                        One or more food items conflict with the client&apos;s allergies.
                                    </p>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Nutrition Summary */}
                    <div className="bg-white p-4 rounded-lg border border-gray-200 sticky top-0">
                        <div className="flex justify-between items-center mb-4">
                            <h3 className="text-gray-900 font-medium">Daily Summary</h3>
                            <span className="text-xs text-gray-500">Target: {targets.calories} Kcal</span>
                        </div>
                        <div className="space-y-4">
                            {Object.entries(dayNutrition).map(([key, value]) => {
                                const target = targets[key as keyof typeof targets] || 100;
                                const percent = Math.min((value / target) * 100, 100);
                                return (
                                    <div key={key}>
                                        <div className="flex justify-between text-sm mb-1">
                                            <span className="font-medium text-gray-800 capitalize">
                                                {key === 'calories' ? "Calories" : key}
                                            </span>
                                            <span className="font-medium text-gray-600">
                                                {Math.round(value)} / {target} {key === 'calories' ? 'kcal' : 'g'}
                                            </span>
                                        </div>
                                        <div className="w-full bg-gray-200 rounded-full h-2">
                                            <div
                                                className={`h-2 rounded-full transition-all ${percent > 100 ? 'bg-red-500' : 'bg-[#17cf54]'}`}
                                                style={{ width: `${percent}%` }}
                                            />
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </aside>
            </main>

            {/* Add Food Modal */}
            <AddFoodModal
                isOpen={showAddFoodModal}
                onClose={() => setShowAddFoodModal(false)}
                mealType={currentMeals.find(m => m.id === activeMealId)?.name || 'Meal'}
                onAddFood={handleFoodAdded}
            />
        </div>
    );
}

export default function DietPlanBuilderPage() {
    return (
        <Suspense fallback={<div className="flex items-center justify-center min-h-screen"><Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" /></div>}>
            <BuilderContent />
        </Suspense>
    );
}
</file>

<file path="frontend/src/app/dashboard/diet-plans/page.tsx">
'use client';

import Link from 'next/link';
import { Plus, Search, FileText, Calendar, MoreVertical, Loader2, Trash2, Edit, Send, LayoutTemplate, Users, X, ChevronRight } from 'lucide-react';
import { useDietPlans, usePublishDietPlan, useAssignTemplate } from '@/lib/hooks/use-diet-plans';
import { useClients } from '@/lib/hooks/use-clients';
import { useState, useRef, useEffect } from 'react';
import { toast } from 'sonner';
import { useRouter } from 'next/navigation';

type TabType = 'plans' | 'templates';

export default function DietPlansPage() {
    const [activeTab, setActiveTab] = useState<TabType>('plans');
    const [search, setSearch] = useState('');
    const [openMenuId, setOpenMenuId] = useState<string | null>(null);

    // Assign Modal State
    const [showAssignModal, setShowAssignModal] = useState(false);
    const [assigningTemplateId, setAssigningTemplateId] = useState<string | null>(null);
    const [clientSearch, setClientSearch] = useState('');
    const [selectedClientId, setSelectedClientId] = useState<string | null>(null);
    const [startDate, setStartDate] = useState(new Date().toISOString().split('T')[0]);

    const menuRef = useRef<HTMLDivElement>(null);
    const router = useRouter();

    // Fetch based on active tab
    const isTemplateView = activeTab === 'templates';
    const { data: plansData, isLoading, refetch } = useDietPlans({
        page: 1,
        pageSize: 20,
        isTemplate: isTemplateView
    });
    const publishMutation = usePublishDietPlan();
    const assignMutation = useAssignTemplate();

    // Fetch clients for assignment modal
    const { data: clientsData } = useClients({
        search: clientSearch,
        pageSize: 10
    });

    const plans = plansData?.data || [];

    const filteredPlans = plans.filter(p => {
        const planName = (p.name || p.title || '').toLowerCase();
        const clientName = (p.client?.fullName || '').toLowerCase();
        const searchLower = search.toLowerCase();
        return planName.includes(searchLower) || clientName.includes(searchLower);
    });

    // Close menu when clicking outside
    useEffect(() => {
        const handleClickOutside = (event: MouseEvent) => {
            if (menuRef.current && !menuRef.current.contains(event.target as Node)) {
                setOpenMenuId(null);
            }
        };
        document.addEventListener('mousedown', handleClickOutside);
        return () => document.removeEventListener('mousedown', handleClickOutside);
    }, []);

    const handlePublish = async (planId: string) => {
        try {
            await publishMutation.mutateAsync(planId);
            await refetch();
            setOpenMenuId(null);
            toast.success('Diet plan published successfully');
        } catch (err) {
            console.error('Failed to publish:', err);
            toast.error('Failed to publish diet plan');
        }
    };

    const handleAssign = async () => {
        if (!assigningTemplateId || !selectedClientId || !startDate) return;

        try {
            const newPlan = await assignMutation.mutateAsync({
                templateId: assigningTemplateId,
                clientId: selectedClientId,
                startDate,
            });

            toast.success('Template assigned successfully!');
            setShowAssignModal(false);
            setAssigningTemplateId(null);
            setSelectedClientId(null);

            // Navigate to the newly created plan
            router.push(`/dashboard/diet-plans/${newPlan.id}`);
        } catch (error) {
            console.error(error);
            toast.error('Failed to assign template');
        }
    };

    return (
        <div className="space-y-6">
            <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                <h1 className="text-2xl font-bold text-gray-900">Diet Plans</h1>
                <div className="flex gap-2">
                    {isTemplateView ? (
                        <Link
                            href="/dashboard/diet-plans/new?template=true"
                            className="flex items-center justify-center gap-2 px-4 py-2 bg-[#17cf54] text-white font-medium rounded-lg hover:bg-[#17cf54]/90 transition-colors"
                        >
                            <LayoutTemplate className="w-5 h-5" />
                            Create Template
                        </Link>
                    ) : (
                        <Link
                            href="/dashboard/diet-plans/new"
                            className="flex items-center justify-center gap-2 px-4 py-2 bg-[#17cf54] text-white font-medium rounded-lg hover:bg-[#17cf54]/90 transition-colors"
                        >
                            <Plus className="w-5 h-5" />
                            Create New Plan
                        </Link>
                    )}
                </div>
            </div>

            {/* Tabs */}
            <div className="border-b border-gray-200">
                <nav className="flex gap-4">
                    <button
                        onClick={() => setActiveTab('plans')}
                        className={`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${activeTab === 'plans'
                            ? 'border-[#17cf54] text-[#17cf54]'
                            : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                            }`}
                    >
                        Client Plans
                    </button>
                    <button
                        onClick={() => setActiveTab('templates')}
                        className={`py-3 px-1 border-b-2 font-medium text-sm transition-colors flex items-center gap-2 ${activeTab === 'templates'
                            ? 'border-[#17cf54] text-[#17cf54]'
                            : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                            }`}
                    >
                        <LayoutTemplate className="w-4 h-4" />
                        Templates
                    </button>
                </nav>
            </div>

            {/* Search and Filters */}
            <div className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm flex gap-4">
                <div className="relative flex-grow max-w-md">
                    <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                    <input
                        type="text"
                        placeholder={isTemplateView ? "Search templates..." : "Search plans or clients..."}
                        value={search}
                        onChange={(e) => setSearch(e.target.value)}
                        className="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#17cf54]/20 focus:border-[#17cf54]"
                    />
                </div>
            </div>

            {/* Plans List */}
            {isLoading ? (
                <div className="flex justify-center py-12">
                    <Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" />
                </div>
            ) : filteredPlans.length === 0 ? (
                <div className="text-center py-12 bg-white rounded-xl border border-gray-200 border-dashed">
                    <div className="w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4">
                        <FileText className="w-8 h-8 text-gray-400" />
                    </div>
                    <h3 className="text-lg font-medium text-gray-900 mb-1">No diet plans found</h3>
                    <p className="text-gray-500 mb-4">Get started by creating a new diet plan for a client.</p>
                </div>
            ) : (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {filteredPlans.map((plan) => {
                        const isActive = plan.status === 'active';
                        return (
                            <div key={plan.id} className="bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow group">
                                <div className="flex justify-between items-start mb-4">
                                    <div className="flex items-center gap-3">
                                        <div className="w-10 h-10 rounded-lg bg-green-50 flex items-center justify-center text-[#17cf54]">
                                            {isTemplateView ? <LayoutTemplate className="w-5 h-5" /> : <FileText className="w-5 h-5" />}
                                        </div>
                                        <div>
                                            <h3 className="font-semibold text-gray-900 group-hover:text-[#17cf54] transition-colors line-clamp-1">
                                                {plan.name || plan.title || 'Untitled Plan'}
                                            </h3>
                                            <p className="text-sm text-gray-500">
                                                {plan.isTemplate ? (
                                                    <span className="inline-flex items-center gap-1 text-purple-600">
                                                        <LayoutTemplate className="w-3 h-3" />
                                                        Template
                                                    </span>
                                                ) : (
                                                    plan.client?.fullName || 'No Client'
                                                )}
                                            </p>
                                        </div>
                                    </div>
                                    <div className="relative" ref={openMenuId === plan.id ? menuRef : null}>
                                        <button
                                            onClick={() => setOpenMenuId(openMenuId === plan.id ? null : plan.id)}
                                            className="text-gray-400 hover:text-gray-600 p-1 rounded hover:bg-gray-100"
                                        >
                                            <MoreVertical className="w-5 h-5" />
                                        </button>
                                        {openMenuId === plan.id && (
                                            <div className="absolute right-0 top-8 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50">
                                                <Link
                                                    href={`/dashboard/diet-plans/${plan.id}`}
                                                    className="flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"
                                                >
                                                    <Edit className="w-4 h-4" />
                                                    Edit Plan
                                                </Link>
                                                {!isActive && (
                                                    <button
                                                        onClick={() => handlePublish(plan.id)}
                                                        disabled={publishMutation.isPending}
                                                        className="flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 w-full text-left disabled:opacity-50"
                                                    >
                                                        <Send className="w-4 h-4" />
                                                        {publishMutation.isPending ? 'Publishing...' : 'Publish'}
                                                    </button>
                                                )}
                                                <button
                                                    className="flex items-center gap-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 w-full text-left"
                                                    onClick={() => {
                                                        // TODO: Add delete functionality
                                                        setOpenMenuId(null);
                                                    }}
                                                >
                                                    <Trash2 className="w-4 h-4" />
                                                    Delete
                                                </button>
                                            </div>
                                        )}
                                    </div>
                                </div>

                                <div className="space-y-3 mb-6">
                                    <div className="flex items-center text-sm text-gray-600 gap-2">
                                        <Calendar className="w-4 h-4 text-gray-400" />
                                        <span>
                                            {new Date(plan.startDate).toLocaleDateString()}
                                            {plan.endDate ? ` - ${new Date(plan.endDate).toLocaleDateString()}` : ''}
                                        </span>
                                    </div>
                                    <div className="flex gap-2">
                                        <span className={`px-2 py-1 rounded-full text-xs font-medium ${isActive ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'
                                            }`}>
                                            {isActive ? 'Active' : 'Draft'}
                                        </span>
                                    </div>
                                </div>

                                <div className="pt-4 border-t border-gray-100 flex gap-2">
                                    {isTemplateView ? (
                                        <button
                                            onClick={() => {
                                                setAssigningTemplateId(plan.id);
                                                setShowAssignModal(true);
                                            }}
                                            className="flex-1 px-3 py-2 text-sm font-medium text-white bg-[#17cf54] rounded-lg hover:bg-[#17cf54]/90 text-center transition-colors flex items-center justify-center gap-2"
                                        >
                                            <Users className="w-4 h-4" />
                                            Assign to Client
                                        </button>
                                    ) : (
                                        <Link
                                            href={`/dashboard/diet-plans/${plan.id}`}
                                            className="flex-1 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-50 rounded-lg hover:bg-gray-100 text-center transition-colors"
                                        >
                                            View Details
                                        </Link>
                                    )}
                                </div>
                            </div>
                        );
                    })}
                </div>
            )}

            {/* Assign Modal */}
            {showAssignModal && (
                <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                    <div className="bg-white rounded-xl w-full max-w-lg overflow-hidden shadow-xl">
                        <div className="px-6 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50">
                            <h3 className="font-semibold text-lg text-gray-900">Assign Template to Client</h3>
                            <button
                                onClick={() => {
                                    setShowAssignModal(false);
                                    setAssigningTemplateId(null);
                                    setSelectedClientId(null);
                                }}
                                className="text-gray-400 hover:text-gray-600"
                            >
                                <X className="w-5 h-5" />
                            </button>
                        </div>

                        <div className="p-6 space-y-6">
                            {/* Start Date Selection */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Start Date
                                </label>
                                <input
                                    type="date"
                                    value={startDate}
                                    onChange={(e) => setStartDate(e.target.value)}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#17cf54]/20 focus:border-[#17cf54] outline-none"
                                />
                            </div>

                            {/* Client Selection */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Select Client
                                </label>
                                <div className="relative mb-2">
                                    <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" />
                                    <input
                                        type="text"
                                        placeholder="Search clients..."
                                        value={clientSearch}
                                        onChange={(e) => setClientSearch(e.target.value)}
                                        className="w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#17cf54]/20 focus:border-[#17cf54] outline-none"
                                    />
                                </div>
                                <div className="border border-gray-200 rounded-lg max-h-60 overflow-y-auto">
                                    {clientsData?.data?.length === 0 ? (
                                        <div className="p-4 text-center text-gray-500 text-sm">
                                            No clients found
                                        </div>
                                    ) : (
                                        <div className="divide-y divide-gray-100">
                                            {clientsData?.data?.map(client => (
                                                <button
                                                    key={client.id}
                                                    onClick={() => setSelectedClientId(client.id)}
                                                    className={`w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors ${selectedClientId === client.id ? 'bg-[#17cf54]/5 ring-1 ring-inset ring-[#17cf54]' : ''
                                                        }`}
                                                >
                                                    <div className="flex items-center gap-3">
                                                        <div className="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-sm font-medium text-gray-600">
                                                            {client.fullName.charAt(0)}
                                                        </div>
                                                        <div className="text-left">
                                                            <div className="font-medium text-gray-900 text-sm">{client.fullName}</div>
                                                            <div className="text-xs text-gray-500">{client.email}</div>
                                                        </div>
                                                    </div>
                                                    {selectedClientId === client.id && (
                                                        <div className="w-2 h-2 rounded-full bg-[#17cf54]" />
                                                    )}
                                                </button>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>

                        <div className="p-6 border-t border-gray-100 bg-gray-50 flex justify-end gap-3">
                            <button
                                onClick={() => {
                                    setShowAssignModal(false);
                                    setAssigningTemplateId(null);
                                    setSelectedClientId(null);
                                }}
                                className="px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900"
                            >
                                Cancel
                            </button>
                            <button
                                onClick={handleAssign}
                                disabled={!selectedClientId || !startDate || assignMutation.isPending}
                                className="px-4 py-2 bg-[#17cf54] text-white text-sm font-medium rounded-lg hover:bg-[#17cf54]/90 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
                            >
                                {assignMutation.isPending ? (
                                    <>
                                        <Loader2 className="w-4 h-4 animate-spin" />
                                        Assigning...
                                    </>
                                ) : (
                                    <>
                                        Confirm Assignment
                                        <ChevronRight className="w-4 h-4" />
                                    </>
                                )}
                            </button>
                        </div>
                    </div>
                </div>
            )}
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/food-library/page.tsx">
'use client';

import { useState } from 'react';
import {
    Search,
    Plus,
    Grid,
    List,
    Loader2,
} from 'lucide-react';
import { useFoodItems, FoodItem } from '@/lib/hooks/use-food-items';
import { CreateFoodItemModal } from '@/components/modals/create-food-item-modal';

const categories = ['All', 'Grains', 'Proteins', 'Vegetables', 'Fruits', 'Dairy', 'Beverages'];

export default function FoodLibraryPage() {
    const [search, setSearch] = useState('');
    const [category, setCategory] = useState('All');
    const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');
    const [showCreateModal, setShowCreateModal] = useState(false);
    const [editingItem, setEditingItem] = useState<FoodItem | undefined>(undefined);

    // API hook
    const { data, isLoading, error } = useFoodItems({
        q: search || undefined,
        category: category !== 'All' ? category : undefined,
        pageSize: 50,
    });

    const foodItems = data?.data || [];

    const handleEdit = (item: FoodItem) => {
        setEditingItem(item);
        setShowCreateModal(true);
    };

    const handleCloseModal = () => {
        setShowCreateModal(false);
        setEditingItem(undefined);
    };

    return (
        <div className="space-y-6">
            {/* Header */}
            <div className="flex flex-wrap items-center justify-between gap-4">
                <div>
                    <h1 className="text-3xl font-bold tracking-tight text-gray-900">Food Library</h1>
                    <p className="text-[#4e9767] mt-1">Browse and manage food items for diet plans.</p>
                </div>
                <button
                    onClick={() => setShowCreateModal(true)}
                    className="flex items-center gap-2 h-10 px-4 bg-[#17cf54] hover:bg-[#17cf54]/90 text-white rounded-lg text-sm font-bold transition-colors shadow-sm"
                >
                    <Plus className="w-4 h-4" />
                    Add Food Item
                </button>
            </div>

            {/* Search and Filters */}
            <div className="flex flex-col md:flex-row gap-4">
                {/* Search Bar */}
                <div className="flex-grow max-w-md">
                    <label className="flex h-12 w-full">
                        <div className="flex w-full flex-1 items-stretch rounded-lg h-full bg-gray-100">
                            <div className="flex items-center justify-center pl-4 text-[#4e9767]">
                                <Search className="w-5 h-5" />
                            </div>
                            <input
                                className="flex w-full min-w-0 flex-1 bg-transparent h-full placeholder:text-gray-400 pl-3 pr-4 text-base outline-none text-gray-900"
                                placeholder="Search food items..."
                                value={search}
                                onChange={(e) => setSearch(e.target.value)}
                            />
                        </div>
                    </label>
                </div>

                {/* View Mode Toggle */}
                <div className="flex items-center gap-2 ml-auto">
                    <button
                        onClick={() => setViewMode('grid')}
                        className={`p-2 rounded-lg ${viewMode === 'grid' ? 'bg-[#17cf54]/10 text-[#17cf54]' : 'text-gray-500 hover:bg-gray-100'}`}
                    >
                        <Grid className="w-5 h-5" />
                    </button>
                    <button
                        onClick={() => setViewMode('list')}
                        className={`p-2 rounded-lg ${viewMode === 'list' ? 'bg-[#17cf54]/10 text-[#17cf54]' : 'text-gray-500 hover:bg-gray-100'}`}
                    >
                        <List className="w-5 h-5" />
                    </button>
                </div>
            </div>

            {/* Category Chips */}
            <div className="flex gap-2 flex-wrap">
                {categories.map((cat) => (
                    <button
                        key={cat}
                        onClick={() => setCategory(cat)}
                        className={`flex h-8 shrink-0 items-center justify-center px-4 rounded-lg text-sm font-medium transition-colors ${category === cat
                            ? 'bg-[#17cf54] text-white'
                            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                            }`}
                    >
                        {cat}
                    </button>
                ))}
            </div>

            {/* Loading */}
            {isLoading && (
                <div className="flex items-center justify-center py-12">
                    <Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" />
                </div>
            )}

            {/* Error */}
            {error && (
                <div className="bg-red-50 border border-red-200 rounded-lg p-4 text-red-700">
                    Failed to load food items. Please try again.
                </div>
            )}

            {/* Empty */}
            {!isLoading && !error && foodItems.length === 0 && (
                <div className="text-center py-12 bg-white rounded-lg border border-gray-200">
                    <p className="text-gray-500">No food items found.</p>
                </div>
            )}

            {/* Grid View */}
            {!isLoading && foodItems.length > 0 && viewMode === 'grid' && (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    {foodItems.map((item: FoodItem) => (
                        <div
                            key={item.id}
                            className="flex flex-col rounded-xl border border-gray-200 bg-white overflow-hidden hover:shadow-lg transition-shadow group relative"
                        >
                            <div className="h-32 bg-gradient-to-br from-[#17cf54]/20 to-[#17cf54]/5 flex items-center justify-center relative">
                                <span className="text-4xl">🍽️</span>
                                {/* Edit Button Overlay */}
                                <button
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        handleEdit(item);
                                    }}
                                    className="absolute top-2 right-2 p-1.5 bg-white/90 rounded-full shadow-sm opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white text-gray-600 hover:text-[#17cf54]"
                                    title="Edit Food Item"
                                >
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z" /><path d="m15 5 4 4" /></svg>
                                </button>
                            </div>
                            <div className="p-4 flex flex-col flex-grow">
                                <div className="flex items-start justify-between gap-2 mb-2">
                                    <h3 className="font-semibold text-gray-900">{item.name}</h3>
                                    {item.isVerified && (
                                        <span className="px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded-full">
                                            Verified
                                        </span>
                                    )}
                                </div>
                                <p className="text-sm text-gray-600 mb-3">
                                    {item.servingSize} serving
                                </p>
                                <div className="mt-auto grid grid-cols-4 gap-2 text-center text-xs">
                                    <div className="bg-gray-50 rounded p-2">
                                        <p className="font-bold text-gray-900">{item.nutrition?.calories || 0}</p>
                                        <p className="text-gray-500">kcal</p>
                                    </div>
                                    <div className="bg-gray-50 rounded p-2">
                                        <p className="font-bold text-gray-900">{item.nutrition?.proteinG || 0}g</p>
                                        <p className="text-gray-500">protein</p>
                                    </div>
                                    <div className="bg-gray-50 rounded p-2">
                                        <p className="font-bold text-gray-900">{item.nutrition?.carbsG || 0}g</p>
                                        <p className="text-gray-500">carbs</p>
                                    </div>
                                    <div className="bg-gray-50 rounded p-2">
                                        <p className="font-bold text-gray-900">{item.nutrition?.fatsG || 0}g</p>
                                        <p className="text-gray-500">fat</p>
                                    </div>
                                </div>
                                {item.dietaryTags?.length > 0 && (
                                    <div className="mt-3 flex flex-wrap gap-1">
                                        {item.dietaryTags.slice(0, 3).map((tag) => (
                                            <span key={tag} className="px-2 py-0.5 text-xs bg-[#17cf54]/10 text-[#17cf54] rounded-full">
                                                {tag}
                                            </span>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                    ))}
                </div>
            )}

            {/* List View */}
            {!isLoading && foodItems.length > 0 && viewMode === 'list' && (
                <div className="bg-white rounded-lg border border-gray-200 overflow-hidden">
                    <table className="w-full">
                        <thead>
                            <tr className="bg-gray-50">
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th>
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Category</th>
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Serving</th>
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Calories</th>
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Protein</th>
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Carbs</th>
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Fat</th>
                                <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">Actions</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-gray-200">
                            {foodItems.map((item: FoodItem) => (
                                <tr key={item.id} className="hover:bg-gray-50 group">
                                    <td className="px-6 py-4 font-medium text-gray-900">
                                        {item.name}
                                        {item.isVerified && (
                                            <span className="ml-2 px-2 py-0.5 text-xs bg-blue-100 text-blue-700 rounded-full">
                                                ✓
                                            </span>
                                        )}
                                    </td>
                                    <td className="px-6 py-4 text-gray-600 capitalize">{item.category}</td>
                                    <td className="px-6 py-4 text-gray-600">{item.servingSize}</td>
                                    <td className="px-6 py-4 text-gray-600">{item.nutrition?.calories || 0}</td>
                                    <td className="px-6 py-4 text-gray-600">{item.nutrition?.proteinG || 0}g</td>
                                    <td className="px-6 py-4 text-gray-600">{item.nutrition?.carbsG || 0}g</td>
                                    <td className="px-6 py-4 text-gray-600">{item.nutrition?.fatsG || 0}g</td>
                                    <td className="px-6 py-4 text-right">
                                        <button
                                            onClick={() => handleEdit(item)}
                                            className="p-1 text-gray-400 hover:text-[#17cf54] opacity-0 group-hover:opacity-100 transition-opacity"
                                            title="Edit"
                                        >
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z" /><path d="m15 5 4 4" /></svg>
                                        </button>
                                    </td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            )}

            <CreateFoodItemModal
                isOpen={showCreateModal}
                onClose={handleCloseModal}
                initialData={editingItem}
            />
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/referrals/page.tsx">
'use client';

import { useState, useEffect } from 'react';
import { useApiClient } from '@/lib/api/use-api-client';
import { useAuth } from '@clerk/nextjs';
import {
    Users,
    Gift,
    TrendingUp,
    Award,
    UserPlus,
    Search,
    RefreshCw,
    CheckCircle,
} from 'lucide-react';

interface ReferralStats {
    overview: {
        clientsWithCodes: number;
        referredClients: number;
        totalReferrals: number;
        freeMonthsEarned: number;
        freeMonthsUsed: number;
        freeMonthsPending: number;
    };
    referralSourceBreakdown: Array<{ source: string; count: number }>;
    topReferrers: Array<{
        id: string;
        name: string;
        code: string;
        referralCount: number;
    }>;
}

interface ClientWithReferrals {
    id: string;
    fullName: string;
    email: string;
    phone: string;
    referralSource: string | null;
    referralSourceName: string | null;
    referralCode: string | null;
    referredBy: { id: string; fullName: string } | null;
    referralCount: number;
    benefit: {
        referralCount: number;
        freeMonthsEarned: number;
        freeMonthsUsed: number;
    } | null;
    createdAt: string;
}

const REFERRAL_SOURCE_LABELS: Record<string, string> = {
    doctor: '👨‍⚕️ Doctor',
    dietitian: '🥗 Dietitian',
    client_referral: '👥 Client Referral',
    social_media: '📱 Social Media',
    website: '🌐 Website',
    other: '📋 Other',
};

export default function ReferralsPage() {
    const api = useApiClient();
    const { isLoaded } = useAuth();
    const [stats, setStats] = useState<ReferralStats | null>(null);
    const [clients, setClients] = useState<ClientWithReferrals[]>([]);
    const [loading, setLoading] = useState(true);
    const [searchTerm, setSearchTerm] = useState('');
    const [sourceFilter, setSourceFilter] = useState('');
    const [redeeming, setRedeeming] = useState<string | null>(null);

    useEffect(() => {
        if (isLoaded) {
            fetchData();
        }
    }, [isLoaded, sourceFilter]);

    const fetchData = async () => {
        try {
            const [statsRes, clientsRes] = await Promise.all([
                api.get('/referrals/stats'),
                api.get('/referrals/clients', {
                    params: { source: sourceFilter || undefined, pageSize: 50 },
                }),
            ]);
            setStats(statsRes.data.data);
            setClients(clientsRes.data.data);
        } catch (error) {
            console.error('Failed to fetch referral data:', error);
        } finally {
            setLoading(false);
        }
    };

    const handleRedeem = async (clientId: string) => {
        setRedeeming(clientId);
        try {
            await api.post(`/referrals/clients/${clientId}/redeem`);
            fetchData();
        } catch (error) {
            console.error('Failed to redeem:', error);
        } finally {
            setRedeeming(null);
        }
    };

    const filteredClients = clients.filter(
        (client) =>
            client.fullName.toLowerCase().includes(searchTerm.toLowerCase()) ||
            client.email?.toLowerCase().includes(searchTerm.toLowerCase()) ||
            client.referralCode?.toLowerCase().includes(searchTerm.toLowerCase())
    );

    if (!isLoaded || loading) {
        return (
            <div className="flex items-center justify-center h-64">
                <RefreshCw className="w-8 h-8 animate-spin text-green-500" />
            </div>
        );
    }

    return (
        <div className="p-6 max-w-7xl mx-auto">
            <div className="flex justify-between items-center mb-8">
                <div>
                    <h1 className="text-2xl font-bold text-gray-900">Referral Management</h1>
                    <p className="text-gray-500 mt-1">Track referral sources and client rewards</p>
                </div>
                <button
                    onClick={fetchData}
                    className="flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition"
                >
                    <RefreshCw className="w-4 h-4" />
                    Refresh
                </button>
            </div>

            {/* Stats Cards */}
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
                    <div className="flex items-center gap-3 mb-2">
                        <div className="p-2 bg-green-100 rounded-lg">
                            <UserPlus className="w-5 h-5 text-green-600" />
                        </div>
                        <span className="text-gray-500 text-sm">Referred Clients</span>
                    </div>
                    <p className="text-3xl font-bold text-gray-900">{stats?.overview.referredClients || 0}</p>
                </div>

                <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
                    <div className="flex items-center gap-3 mb-2">
                        <div className="p-2 bg-blue-100 rounded-lg">
                            <Users className="w-5 h-5 text-blue-600" />
                        </div>
                        <span className="text-gray-500 text-sm">Active Referrers</span>
                    </div>
                    <p className="text-3xl font-bold text-gray-900">{stats?.overview.clientsWithCodes || 0}</p>
                </div>

                <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
                    <div className="flex items-center gap-3 mb-2">
                        <div className="p-2 bg-purple-100 rounded-lg">
                            <Gift className="w-5 h-5 text-purple-600" />
                        </div>
                        <span className="text-gray-500 text-sm">Free Months Pending</span>
                    </div>
                    <p className="text-3xl font-bold text-gray-900">{stats?.overview.freeMonthsPending || 0}</p>
                </div>

                <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
                    <div className="flex items-center gap-3 mb-2">
                        <div className="p-2 bg-yellow-100 rounded-lg">
                            <Award className="w-5 h-5 text-yellow-600" />
                        </div>
                        <span className="text-gray-500 text-sm">Months Redeemed</span>
                    </div>
                    <p className="text-3xl font-bold text-gray-900">{stats?.overview.freeMonthsUsed || 0}</p>
                </div>
            </div>

            {/* Source Breakdown & Top Referrers */}
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                {/* Source Breakdown */}
                <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
                    <h2 className="text-lg font-semibold text-gray-900 mb-4">Referral Sources</h2>
                    <div className="space-y-3">
                        {stats?.referralSourceBreakdown.map((item) => (
                            <div key={item.source} className="flex justify-between items-center">
                                <span className="text-gray-700">
                                    {REFERRAL_SOURCE_LABELS[item.source] || item.source}
                                </span>
                                <span className="font-medium text-gray-900">{item.count}</span>
                            </div>
                        ))}
                        {(!stats?.referralSourceBreakdown || stats.referralSourceBreakdown.length === 0) && (
                            <p className="text-gray-500 text-sm">No referral source data yet</p>
                        )}
                    </div>
                </div>

                {/* Top Referrers */}
                <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
                    <h2 className="text-lg font-semibold text-gray-900 mb-4">Top Referrers</h2>
                    <div className="space-y-3">
                        {stats?.topReferrers.slice(0, 5).map((referrer, index) => (
                            <div key={referrer.id} className="flex justify-between items-center">
                                <div className="flex items-center gap-3">
                                    <span className={`w-6 h-6 rounded-full flex items-center justify-center text-sm font-medium ${index === 0 ? 'bg-yellow-100 text-yellow-700' :
                                            index === 1 ? 'bg-gray-100 text-gray-700' :
                                                index === 2 ? 'bg-orange-100 text-orange-700' :
                                                    'bg-gray-50 text-gray-500'
                                        }`}>
                                        {index + 1}
                                    </span>
                                    <div>
                                        <p className="font-medium text-gray-900">{referrer.name}</p>
                                        <p className="text-xs text-gray-500">{referrer.code}</p>
                                    </div>
                                </div>
                                <span className="font-semibold text-green-600">{referrer.referralCount}</span>
                            </div>
                        ))}
                        {(!stats?.topReferrers || stats.topReferrers.length === 0) && (
                            <p className="text-gray-500 text-sm">No referrers yet</p>
                        )}
                    </div>
                </div>
            </div>

            {/* Client List */}
            <div className="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                <div className="p-4 border-b border-gray-200 flex flex-col sm:flex-row gap-4">
                    <div className="relative flex-1">
                        <Search className="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" />
                        <input
                            type="text"
                            placeholder="Search clients..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                            className="w-full pl-9 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"
                        />
                    </div>
                    <select
                        value={sourceFilter}
                        onChange={(e) => setSourceFilter(e.target.value)}
                        className="px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"
                    >
                        <option value="">All Sources</option>
                        {Object.entries(REFERRAL_SOURCE_LABELS).map(([value, label]) => (
                            <option key={value} value={value}>{label}</option>
                        ))}
                    </select>
                </div>

                <div className="overflow-x-auto">
                    <table className="w-full">
                        <thead className="bg-gray-50">
                            <tr>
                                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Client</th>
                                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Source</th>
                                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Code</th>
                                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Referrals</th>
                                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Free Months</th>
                                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Actions</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-gray-100">
                            {filteredClients.map((client) => (
                                <tr key={client.id} className="hover:bg-gray-50">
                                    <td className="px-4 py-3">
                                        <p className="font-medium text-gray-900">{client.fullName}</p>
                                        <p className="text-xs text-gray-500">{client.email}</p>
                                    </td>
                                    <td className="px-4 py-3">
                                        {client.referralSource ? (
                                            <span className="text-sm">{REFERRAL_SOURCE_LABELS[client.referralSource] || client.referralSource}</span>
                                        ) : (
                                            <span className="text-gray-400">—</span>
                                        )}
                                        {client.referredBy && (
                                            <p className="text-xs text-green-600">via {client.referredBy.fullName}</p>
                                        )}
                                    </td>
                                    <td className="px-4 py-3">
                                        {client.referralCode ? (
                                            <code className="px-2 py-1 bg-gray-100 rounded text-sm font-mono">{client.referralCode}</code>
                                        ) : (
                                            <span className="text-gray-400">—</span>
                                        )}
                                    </td>
                                    <td className="px-4 py-3">
                                        <span className="font-medium text-gray-900">{client.referralCount}</span>
                                    </td>
                                    <td className="px-4 py-3">
                                        {client.benefit ? (
                                            <div className="text-sm">
                                                <span className="text-green-600">{client.benefit.freeMonthsEarned - client.benefit.freeMonthsUsed}</span>
                                                <span className="text-gray-400"> / {client.benefit.freeMonthsEarned}</span>
                                            </div>
                                        ) : (
                                            <span className="text-gray-400">0</span>
                                        )}
                                    </td>
                                    <td className="px-4 py-3">
                                        {client.benefit && client.benefit.freeMonthsEarned > client.benefit.freeMonthsUsed && (
                                            <button
                                                onClick={() => handleRedeem(client.id)}
                                                disabled={redeeming === client.id}
                                                className="flex items-center gap-1 px-3 py-1.5 bg-green-500 hover:bg-green-600 text-white text-sm rounded-lg transition disabled:opacity-50"
                                            >
                                                {redeeming === client.id ? (
                                                    <RefreshCw className="w-3 h-3 animate-spin" />
                                                ) : (
                                                    <CheckCircle className="w-3 h-3" />
                                                )}
                                                Redeem
                                            </button>
                                        )}
                                    </td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>

                {filteredClients.length === 0 && (
                    <div className="text-center py-12">
                        <Users className="w-12 h-12 text-gray-300 mx-auto mb-3" />
                        <p className="text-gray-500">No clients found</p>
                    </div>
                )}
            </div>
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/reviews/page.tsx">
'use client';

import { useState } from 'react';
import {
    Camera,
    ArrowRight,
    Check,
    X,
    RefreshCw,
    Loader2,
} from 'lucide-react';
import { useMealLogs, useReviewMealLog, MealLog } from '@/lib/hooks/use-meal-logs';

type FilterType = 'all' | 'pending' | 'reviewed';
type MealStatus = 'eaten' | 'skipped' | 'substituted';

export default function MealReviewPage() {
    const [filter, setFilter] = useState<FilterType>('pending');
    const [selectedMealId, setSelectedMealId] = useState<string | null>(null);
    const [mealStatus, setMealStatus] = useState<MealStatus | null>(null);
    const [feedback, setFeedback] = useState('');

    // API hooks
    const { data, isLoading, error, refetch } = useMealLogs({
        status: filter === 'all' ? undefined : filter === 'pending' ? 'pending' : undefined,
        pageSize: 50,
    });
    const reviewMutation = useReviewMealLog();

    const mealLogs = data?.data || [];
    const selectedMeal = mealLogs.find(m => m.id === selectedMealId) || mealLogs[0];

    const handleReviewSubmit = async () => {
        if (!selectedMeal || !mealStatus) return;

        try {
            await reviewMutation.mutateAsync({
                id: selectedMeal.id,
                status: mealStatus,
                dietitianFeedback: feedback || undefined,
            });

            // Move to next meal
            const currentIndex = mealLogs.findIndex(m => m.id === selectedMeal.id);
            if (currentIndex < mealLogs.length - 1) {
                setSelectedMealId(mealLogs[currentIndex + 1].id);
            }
            setMealStatus(null);
            setFeedback('');
        } catch (err) {
            console.error('Failed to review meal:', err);
        }
    };

    const getInitials = (name?: string) => {
        if (!name) return '??';
        return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
    };

    const formatDate = (date: string) => {
        const d = new Date(date);
        const today = new Date();
        const yesterday = new Date(today);
        yesterday.setDate(yesterday.getDate() - 1);

        if (d.toDateString() === today.toDateString()) return 'Today';
        if (d.toDateString() === yesterday.toDateString()) return 'Yesterday';
        return d.toLocaleDateString();
    };

    return (
        <div className="flex h-[calc(100vh-5rem)] -m-6">
            {/* Left Column: Meal Queue */}
            <div className="w-80 flex-shrink-0 flex flex-col bg-white border-r border-gray-200 h-full overflow-hidden">
                {/* Header */}
                <div className="p-6 border-b border-gray-200">
                    <h1 className="text-2xl font-bold text-gray-900 tracking-tight">
                        Meal Photo Review
                    </h1>
                </div>

                {/* Filters */}
                <div className="px-6 py-4 border-b border-gray-200">
                    <div className="flex h-10 w-full items-center justify-center rounded-lg bg-[#17cf54]/10 p-1">
                        {(['all', 'pending', 'reviewed'] as FilterType[]).map((f) => (
                            <button
                                key={f}
                                onClick={() => setFilter(f)}
                                className={`flex-1 h-full rounded-md text-sm font-medium transition-colors capitalize ${filter === f
                                    ? 'bg-white shadow-sm text-gray-900'
                                    : 'text-[#4e9767] hover:text-gray-900'
                                    }`}
                            >
                                {f}
                            </button>
                        ))}
                    </div>
                </div>

                {/* Loading */}
                {isLoading && (
                    <div className="flex-1 flex items-center justify-center">
                        <Loader2 className="w-6 h-6 animate-spin text-[#17cf54]" />
                    </div>
                )}

                {/* Error */}
                {error && (
                    <div className="p-4 text-sm text-red-600">
                        Failed to load meal logs.
                    </div>
                )}

                {/* Empty */}
                {!isLoading && !error && mealLogs.length === 0 && (
                    <div className="flex-1 flex items-center justify-center text-gray-500 text-sm">
                        No meals to review
                    </div>
                )}

                {/* Meal List */}
                <div className="flex-1 overflow-y-auto divide-y divide-gray-200">
                    {mealLogs.map((meal: MealLog) => (
                        <button
                            key={meal.id}
                            onClick={() => {
                                setSelectedMealId(meal.id);
                                setMealStatus(null);
                                setFeedback('');
                            }}
                            className={`w-full flex items-center gap-4 px-6 py-4 text-left transition-colors ${selectedMeal?.id === meal.id
                                ? 'bg-[#17cf54]/10'
                                : 'hover:bg-gray-50'
                                }`}
                        >
                            <div className="w-12 h-12 rounded-full bg-[#17cf54]/20 flex items-center justify-center text-[#17cf54] font-bold flex-shrink-0">
                                {getInitials(meal.client?.fullName)}
                            </div>
                            <div className="flex-1 min-w-0">
                                <p className="font-medium text-gray-900 truncate">{meal.client?.fullName || 'Unknown'}</p>
                                <p className="text-sm text-[#4e9767] truncate">
                                    {meal.meal?.mealType || 'Meal'} - {formatDate(meal.scheduledDate)}, {meal.scheduledTime}
                                </p>
                            </div>
                            <div className="flex-shrink-0">
                                <div
                                    className={`w-3 h-3 rounded-full ${meal.status === 'pending' ? 'bg-yellow-500 animate-pulse' : 'bg-green-600'
                                        }`}
                                />
                            </div>
                        </button>
                    ))}
                </div>
            </div>

            {/* Right Column: Review Panel */}
            <div className="flex-1 p-8 overflow-y-auto bg-gray-50">
                {selectedMeal ? (
                    <div className="max-w-2xl mx-auto space-y-6">
                        {/* Image */}
                        <div className="w-full aspect-[4/3] bg-gradient-to-br from-[#17cf54]/20 to-[#17cf54]/5 rounded-xl flex items-center justify-center border border-gray-200 overflow-hidden">
                            {selectedMeal.mealPhotoUrl ? (
                                <img
                                    src={selectedMeal.mealPhotoUrl}
                                    alt="Meal photo"
                                    className="w-full h-full object-cover"
                                />
                            ) : (
                                <div className="text-center">
                                    <Camera className="w-16 h-16 text-[#17cf54]/50 mx-auto mb-2" />
                                    <p className="text-[#4e9767]">No photo uploaded</p>
                                </div>
                            )}
                        </div>

                        {/* Client Info */}
                        <div>
                            <p className="text-sm text-gray-500">
                                Reviewing {selectedMeal.client?.fullName}&apos;s {selectedMeal.meal?.mealType || 'Meal'}
                            </p>
                            <h2 className="text-2xl font-bold text-gray-900 mt-1">
                                {selectedMeal.meal?.name || 'Meal Log'}
                            </h2>
                            {selectedMeal.clientNotes && (
                                <p className="text-sm text-gray-600 mt-2 italic">
                                    &quot;{selectedMeal.clientNotes}&quot;
                                </p>
                            )}
                        </div>

                        {/* Action Radio Group */}
                        <div className="space-y-2">
                            <p className="text-sm font-medium text-gray-700">Mark as:</p>
                            <div className="grid grid-cols-3 gap-3">
                                {(['eaten', 'skipped', 'substituted'] as MealStatus[]).map((status) => (
                                    <button
                                        key={status}
                                        onClick={() => setMealStatus(status)}
                                        className={`flex items-center justify-center gap-2 rounded-lg p-3 text-center border transition-colors capitalize ${mealStatus === status
                                            ? 'bg-[#17cf54]/20 border-[#17cf54] text-gray-900'
                                            : 'border-gray-200 hover:border-[#17cf54] text-gray-700 bg-white'
                                            }`}
                                    >
                                        {status === 'eaten' && <Check className="w-4 h-4" />}
                                        {status === 'skipped' && <X className="w-4 h-4" />}
                                        {status === 'substituted' && <RefreshCw className="w-4 h-4" />}
                                        <span className="text-sm font-medium">{status}</span>
                                    </button>
                                ))}
                            </div>
                        </div>

                        {/* Feedback Text Area */}
                        <div className="space-y-2">
                            <label className="text-sm font-medium text-gray-700" htmlFor="feedback">
                                Feedback
                            </label>
                            <textarea
                                id="feedback"
                                value={feedback}
                                onChange={(e) => setFeedback(e.target.value)}
                                className="w-full p-3 border border-gray-200 rounded-lg bg-white text-gray-900 focus:ring-[#17cf54] focus:border-[#17cf54] placeholder-gray-400"
                                placeholder="Provide feedback or suggestions..."
                                rows={5}
                            />
                        </div>

                        {/* Action Button */}
                        <button
                            onClick={handleReviewSubmit}
                            disabled={!mealStatus || reviewMutation.isPending}
                            className="flex w-full items-center justify-center gap-2 h-12 px-4 bg-[#17cf54] text-white rounded-lg text-base font-bold transition-colors hover:bg-[#17cf54]/90 disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            {reviewMutation.isPending ? (
                                <Loader2 className="w-5 h-5 animate-spin" />
                            ) : (
                                <>
                                    <span>Mark as Reviewed & Next</span>
                                    <ArrowRight className="w-5 h-5" />
                                </>
                            )}
                        </button>
                    </div>
                ) : (
                    <div className="flex items-center justify-center h-full text-gray-500">
                        Select a meal to review
                    </div>
                )}
            </div>
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/settings/page.tsx">
'use client';

import { useState, useEffect } from 'react';
import {
    User,
    Bell,
    Shield,
    Palette,
    Globe,
    CreditCard,
    HelpCircle,
    LogOut,
    Check,
    Loader2
} from 'lucide-react';
import { useClerk } from '@clerk/nextjs';
import { useProfile, useUpdateProfile } from '@/lib/hooks/use-profile';
import { toast } from 'sonner';

const settingsSections = [
    { id: 'profile', name: 'Profile', icon: User },
    { id: 'notifications', name: 'Notifications', icon: Bell },
    { id: 'security', name: 'Security', icon: Shield },
    { id: 'appearance', name: 'Appearance', icon: Palette },
    { id: 'language', name: 'Language', icon: Globe },
    { id: 'billing', name: 'Billing', icon: CreditCard },
    { id: 'help', name: 'Help & Support', icon: HelpCircle },
];

export default function SettingsPage() {
    const { signOut } = useClerk();
    const { data: profile, isLoading } = useProfile();
    const updateProfile = useUpdateProfile();

    const [activeSection, setActiveSection] = useState('profile');
    const [notifications, setNotifications] = useState({
        email: true,
        push: true,
        mealReminders: true,
        weeklyReports: false,
    });

    // Form state
    const [formData, setFormData] = useState({
        fullName: '',
        phone: '',
        specialization: '',
        bio: ''
    });

    // Sync form data when profile loads
    useEffect(() => {
        if (profile) {
            setFormData({
                fullName: profile.fullName || '',
                phone: profile.phone || '',
                specialization: profile.specialization || '',
                bio: profile.bio || ''
            });
        }
    }, [profile]);

    const handleProfileUpdate = async (e: React.FormEvent) => {
        e.preventDefault();
        try {
            await updateProfile.mutateAsync(formData);
            toast.success('Profile updated successfully');
        } catch (error) {
            toast.error('Failed to update profile');
        }
    };

    if (isLoading) {
        return (
            <div className="flex items-center justify-center min-h-[400px]">
                <Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" />
            </div>
        );
    }

    return (
        <div className="max-w-5xl mx-auto space-y-6">
            {/* Header */}
            <div>
                <h1 className="text-3xl font-bold tracking-tight text-gray-900">Settings</h1>
                <p className="text-[#4e9767] mt-1">Manage your account preferences and settings.</p>
            </div>

            <div className="grid grid-cols-1 lg:grid-cols-4 gap-6">
                {/* Settings Navigation */}
                <div className="lg:col-span-1">
                    <nav className="bg-white rounded-xl border border-gray-200 overflow-hidden">
                        {settingsSections.map((section) => (
                            <button
                                key={section.id}
                                onClick={() => setActiveSection(section.id)}
                                className={`w-full flex items-center gap-3 px-4 py-3 text-left transition-colors ${activeSection === section.id
                                    ? 'bg-[#17cf54]/10 text-[#17cf54] border-r-2 border-[#17cf54]'
                                    : 'text-gray-600 hover:bg-gray-50'
                                    }`}
                            >
                                <section.icon className="w-5 h-5" />
                                <span className="text-sm font-medium">{section.name}</span>
                            </button>
                        ))}
                        <button
                            onClick={() => signOut()}
                            className="w-full flex items-center gap-3 px-4 py-3 text-left text-red-600 hover:bg-red-50 transition-colors border-t border-gray-100"
                        >
                            <LogOut className="w-5 h-5" />
                            <span className="text-sm font-medium">Sign Out</span>
                        </button>
                    </nav>
                </div>

                {/* Settings Content */}
                <div className="lg:col-span-3">
                    <div className="bg-white rounded-xl border border-gray-200 p-6">
                        {/* Profile Section */}
                        {activeSection === 'profile' && profile && (
                            <div className="space-y-6">
                                <h2 className="text-xl font-semibold text-gray-900">Profile Settings</h2>

                                {/* Avatar */}
                                <div className="flex items-center gap-4">
                                    <div className="w-20 h-20 rounded-full bg-[#17cf54]/20 flex items-center justify-center text-[#17cf54] text-2xl font-bold overflow-hidden">
                                        {profile.profilePhotoUrl ? (
                                            <img src={profile.profilePhotoUrl} alt="Profile" className="w-full h-full object-cover" />
                                        ) : (
                                            profile.fullName?.charAt(0) || 'U'
                                        )}
                                    </div>
                                    <div>
                                        <button disabled className="px-4 py-2 text-sm font-medium bg-gray-100 text-gray-400 rounded-lg cursor-not-allowed">
                                            Change Photo
                                        </button>
                                        <p className="text-sm text-gray-500 mt-1">Managed via Clerk</p>
                                    </div>
                                </div>

                                {/* Form */}
                                <form onSubmit={handleProfileUpdate} className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                                        <input
                                            type="text"
                                            value={formData.fullName}
                                            onChange={(e) => setFormData({ ...formData, fullName: e.target.value })}
                                            className="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
                                        <input
                                            type="email"
                                            value={profile.email}
                                            disabled
                                            className="w-full px-4 py-2.5 border border-gray-200 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
                                        <input
                                            type="tel"
                                            value={formData.phone}
                                            onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
                                            className="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                            placeholder="+1 234 567 8900"
                                        />
                                    </div>
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Specialization</label>
                                        <input
                                            type="text"
                                            value={formData.specialization}
                                            onChange={(e) => setFormData({ ...formData, specialization: e.target.value })}
                                            className="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                            placeholder="e.g. Sports Nutrition, Weight Loss"
                                        />
                                    </div>
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Bio</label>
                                        <textarea
                                            rows={3}
                                            value={formData.bio}
                                            onChange={(e) => setFormData({ ...formData, bio: e.target.value })}
                                            placeholder="Tell use about yourself..."
                                            className="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                        />
                                    </div>

                                    <div className="md:col-span-2 pt-2">
                                        <button
                                            type="submit"
                                            disabled={updateProfile.isPending}
                                            className="px-4 py-2.5 text-sm font-bold text-white bg-[#17cf54] rounded-lg hover:bg-[#17cf54]/90 transition-colors disabled:opacity-50 flex items-center gap-2"
                                        >
                                            {updateProfile.isPending && <Loader2 className="w-4 h-4 animate-spin" />}
                                            Save Changes
                                        </button>
                                    </div>
                                </form>
                            </div>
                        )}

                        {/* Notifications Section */}
                        {activeSection === 'notifications' && (
                            <div className="space-y-6">
                                <h2 className="text-xl font-semibold text-gray-900">Notification Preferences</h2>

                                <div className="space-y-4">
                                    {[
                                        { key: 'email', label: 'Email Notifications', desc: 'Receive updates via email' },
                                        { key: 'push', label: 'Push Notifications', desc: 'Browser push notifications' },
                                        { key: 'mealReminders', label: 'Meal Review Reminders', desc: 'Get notified when clients submit meals' },
                                        { key: 'weeklyReports', label: 'Weekly Reports', desc: 'Receive weekly summary reports' },
                                    ].map((item) => (
                                        <div key={item.key} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                                            <div>
                                                <p className="font-medium text-gray-900">{item.label}</p>
                                                <p className="text-sm text-gray-500">{item.desc}</p>
                                            </div>
                                            <button
                                                onClick={() => setNotifications({ ...notifications, [item.key]: !notifications[item.key as keyof typeof notifications] })}
                                                className={`w-12 h-6 rounded-full transition-colors ${notifications[item.key as keyof typeof notifications] ? 'bg-[#17cf54]' : 'bg-gray-300'
                                                    }`}
                                            >
                                                <div
                                                    className={`w-5 h-5 bg-white rounded-full shadow transform transition-transform ${notifications[item.key as keyof typeof notifications] ? 'translate-x-6' : 'translate-x-0.5'
                                                        }`}
                                                />
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Appearance Section */}
                        {activeSection === 'appearance' && (
                            <div className="space-y-6">
                                <h2 className="text-xl font-semibold text-gray-900">Appearance</h2>

                                <div>
                                    <p className="font-medium text-gray-900 mb-3">Theme</p>
                                    <div className="grid grid-cols-3 gap-4">
                                        {['Light', 'Dark', 'System'].map((theme) => (
                                            <button
                                                key={theme}
                                                className={`p-4 rounded-lg border-2 transition-colors ${theme === 'Light' ? 'border-[#17cf54] bg-[#17cf54]/5' : 'border-gray-200 hover:border-gray-300'
                                                    }`}
                                            >
                                                <div className={`w-8 h-8 rounded-full mx-auto mb-2 ${theme === 'Light' ? 'bg-white border border-gray-200' :
                                                    theme === 'Dark' ? 'bg-gray-800' : 'bg-gradient-to-r from-white to-gray-800'
                                                    }`} />
                                                <p className="text-sm font-medium text-gray-900">{theme}</p>
                                                {theme === 'Light' && <Check className="w-4 h-4 text-[#17cf54] mx-auto mt-1" />}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Other Sections - Placeholder */}
                        {['security', 'language', 'billing', 'help'].includes(activeSection) && (
                            <div className="text-center py-12">
                                <div className="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                    {(() => {
                                        const section = settingsSections.find(s => s.id === activeSection);
                                        if (section) {
                                            const Icon = section.icon;
                                            return <Icon className="w-8 h-8 text-gray-400" />;
                                        }
                                        return null;
                                    })()}
                                </div>
                                <h3 className="text-lg font-medium text-gray-900 mb-2">
                                    {settingsSections.find(s => s.id === activeSection)?.name}
                                </h3>
                                <p className="text-gray-500">This section is coming soon.</p>
                            </div>
                        )}
                    </div>
                </div>
            </div>
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/team/page.tsx">
'use client';

import {
    Plus,
    Search,
    MoreVertical,
    Mail,
    Phone,
    Users,
    Loader2,
} from 'lucide-react';
import { useTeam, TeamMember } from '@/lib/hooks/use-team';
import { InviteMemberModal } from '@/components/modals/invite-member-modal';
import { useState } from 'react';

// ...

export default function TeamPage() {
    const { data: team, isLoading, error } = useTeam();
    const [showInviteModal, setShowInviteModal] = useState(false);

    const getRoleBadgeColor = (role: string) => {
        switch (role.toLowerCase()) {
            case 'owner':
                return 'bg-purple-100 text-purple-700';
            case 'admin':
                return 'bg-blue-100 text-blue-700';
            case 'dietitian':
                return 'bg-green-100 text-green-700';
            default:
                return 'bg-gray-100 text-gray-700';
        }
    };

    return (
        <div className="space-y-6">
            {/* Header */}
            <div className="flex flex-wrap items-center justify-between gap-4">
                <div>
                    <h1 className="text-3xl font-bold tracking-tight text-gray-900">Team</h1>
                    <p className="text-[#4e9767] mt-1">Manage your team members and their roles.</p>
                </div>
                <button
                    onClick={() => setShowInviteModal(true)}
                    className="flex items-center gap-2 h-10 px-4 bg-[#17cf54] hover:bg-[#17cf54]/90 text-white rounded-lg text-sm font-bold transition-colors shadow-sm"
                >
                    <Plus className="w-4 h-4" />
                    Invite Team Member
                </button>
            </div>

            {/* Loading */}
            {isLoading && (
                <div className="flex items-center justify-center py-12">
                    <Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" />
                </div>
            )}

            {/* Error */}
            {error && (
                <div className="bg-red-50 border border-red-200 rounded-lg p-4 text-red-700">
                    Failed to load team members.
                </div>
            )}

            {/* Empty State */}
            {!isLoading && !error && (!team || team.length === 0) && (
                <div className="text-center py-12 bg-white rounded-lg border border-gray-200">
                    <Users className="w-12 h-12 text-gray-400 mx-auto mb-4" />
                    <p className="text-gray-500">No team members yet.</p>
                    <button className="mt-4 text-[#17cf54] font-medium hover:underline">
                        Invite your first team member
                    </button>
                </div>
            )}

            {/* Team Grid */}
            {!isLoading && team && team.length > 0 && (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {team.map((member: TeamMember) => (
                        <div
                            key={member.id}
                            className="bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg transition-shadow"
                        >
                            <div className="flex items-start justify-between mb-4">
                                <div className="flex items-center gap-3">
                                    <div className="w-12 h-12 rounded-full bg-[#17cf54]/20 flex items-center justify-center text-[#17cf54] font-bold text-lg">
                                        {member.avatar}
                                    </div>
                                    <div>
                                        <h3 className="font-semibold text-gray-900">{member.name}</h3>
                                        <span className={`inline-block px-2 py-0.5 text-xs font-medium rounded-full ${getRoleBadgeColor(member.role)}`}>
                                            {member.role}
                                        </span>
                                    </div>
                                </div>
                                <button className="text-gray-400 hover:text-gray-600">
                                    <MoreVertical className="w-5 h-5" />
                                </button>
                            </div>

                            {member.specialization && (
                                <p className="text-sm text-gray-600 mb-3">{member.specialization}</p>
                            )}

                            <div className="space-y-2 text-sm">
                                <div className="flex items-center gap-2 text-gray-600">
                                    <Mail className="w-4 h-4" />
                                    <span className="truncate">{member.email}</span>
                                </div>
                                {member.phone && (
                                    <div className="flex items-center gap-2 text-gray-600">
                                        <Phone className="w-4 h-4" />
                                        <span>{member.phone}</span>
                                    </div>
                                )}
                                <div className="flex items-center gap-2 text-gray-600">
                                    <Users className="w-4 h-4" />
                                    <span>{member.clientCount} clients</span>
                                </div>
                            </div>

                            <div className="mt-4 pt-4 border-t border-gray-100 flex gap-2">
                                <button className="flex-1 py-2 text-sm font-medium text-[#17cf54] hover:bg-[#17cf54]/10 rounded-lg transition-colors">
                                    View Profile
                                </button>
                                <button className="flex-1 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg transition-colors">
                                    Message
                                </button>
                            </div>
                        </div>
                    ))}
                </div>
            )}
            {/* Invite Modal */}
            <InviteMemberModal isOpen={showInviteModal} onClose={() => setShowInviteModal(false)} />
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/layout.tsx">
'use client';

import { UserButton, useUser } from '@clerk/nextjs';
import Link from 'next/link';
import { usePathname } from 'next/navigation';
import {
    LayoutDashboard,
    Users,
    UtensilsCrossed,
    Apple,
    Camera,
    BarChart3,
    UsersRound,
    Settings,
    Menu,
    X,
} from 'lucide-react';
import { cn } from '@/lib/utils';
import { useState } from 'react';

const navigation = [
    { name: 'Dashboard', href: '/dashboard', icon: LayoutDashboard },
    { name: 'Clients', href: '/dashboard/clients', icon: Users },
    { name: 'Diet Plans', href: '/dashboard/diet-plans', icon: UtensilsCrossed },
    { name: 'Food Library', href: '/dashboard/food-library', icon: Apple },
    { name: 'Meal Reviews', href: '/dashboard/reviews', icon: Camera },
    { name: 'Analytics', href: '/dashboard/analytics', icon: BarChart3 },
    { name: 'Team', href: '/dashboard/team', icon: UsersRound },
];

export default function DashboardLayout({
    children,
}: {
    children: React.ReactNode;
}) {
    const pathname = usePathname();
    const { user } = useUser();
    const [sidebarOpen, setSidebarOpen] = useState(false);

    return (
        <div className="min-h-screen bg-gray-50">
            {/* Mobile sidebar backdrop */}
            {sidebarOpen && (
                <div
                    className="fixed inset-0 bg-black/50 z-40 lg:hidden"
                    onClick={() => setSidebarOpen(false)}
                />
            )}

            {/* Sidebar */}
            <aside
                className={cn(
                    'fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-200 transform transition-transform duration-200 ease-in-out lg:translate-x-0',
                    sidebarOpen ? 'translate-x-0' : '-translate-x-full'
                )}
            >
                <div className="flex flex-col h-full">
                    {/* Logo */}
                    <div className="flex items-center justify-between h-16 px-4 border-b border-gray-200">
                        <Link href="/dashboard" className="flex items-center gap-2">
                            <div className="w-8 h-8 bg-emerald-600 rounded-lg flex items-center justify-center">
                                <UtensilsCrossed className="w-5 h-5 text-white" />
                            </div>
                            <span className="text-xl font-bold text-gray-900">DietConnect</span>
                        </Link>
                        <button
                            className="lg:hidden p-2 text-gray-500 hover:text-gray-700"
                            onClick={() => setSidebarOpen(false)}
                        >
                            <X className="w-5 h-5" />
                        </button>
                    </div>

                    {/* Navigation */}
                    <nav className="flex-1 px-3 py-4 space-y-1 overflow-y-auto">
                        {navigation.map((item) => {
                            // Dashboard should only be active on exact match
                            const isActive = item.href === '/dashboard'
                                ? pathname === '/dashboard'
                                : pathname === item.href || pathname.startsWith(item.href + '/');
                            return (
                                <Link
                                    key={item.name}
                                    href={item.href}
                                    className={cn(
                                        'flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors',
                                        isActive
                                            ? 'bg-emerald-50 text-emerald-700'
                                            : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900'
                                    )}
                                >
                                    <item.icon className={cn('w-5 h-5', isActive && 'text-emerald-600')} />
                                    {item.name}
                                </Link>
                            );
                        })}
                    </nav>

                    {/* User section */}
                    <div className="border-t border-gray-200 p-4">
                        <div className="flex items-center gap-3">
                            <UserButton afterSignOutUrl="/" />
                            <div className="flex-1 min-w-0">
                                <p className="text-sm font-medium text-gray-900 truncate">
                                    {user?.fullName || 'Dietitian'}
                                </p>
                                <p className="text-xs text-gray-500 truncate">
                                    {user?.primaryEmailAddress?.emailAddress}
                                </p>
                            </div>
                            <Link href="/dashboard/settings" className="p-2 text-gray-400 hover:text-gray-600">
                                <Settings className="w-5 h-5" />
                            </Link>
                        </div>
                    </div>
                </div>
            </aside>

            {/* Main content */}
            <div className="lg:pl-64">
                {/* Top bar */}
                <header className="sticky top-0 z-30 bg-white border-b border-gray-200 lg:hidden">
                    <div className="flex items-center justify-between h-16 px-4">
                        <button
                            className="p-2 text-gray-500 hover:text-gray-700"
                            onClick={() => setSidebarOpen(true)}
                        >
                            <Menu className="w-6 h-6" />
                        </button>
                        <Link href="/dashboard" className="flex items-center gap-2">
                            <div className="w-8 h-8 bg-emerald-600 rounded-lg flex items-center justify-center">
                                <UtensilsCrossed className="w-5 h-5 text-white" />
                            </div>
                            <span className="text-lg font-bold text-gray-900">DietConnect</span>
                        </Link>
                        <UserButton afterSignOutUrl="/" />
                    </div>
                </header>

                {/* Page content */}
                <main className="p-6">{children}</main>
            </div>
        </div>
    );
}
</file>

<file path="frontend/src/app/dashboard/page.tsx">
'use client';

import { useUser } from '@clerk/nextjs';
import Link from 'next/link';
import {
    Users,
    Camera,
    TrendingUp,
    Calendar,
    Plus,
    ChevronRight,
    Loader2,
} from 'lucide-react';
import { useDashboardStats } from '@/lib/hooks/use-dashboard';

function formatTimeAgo(date: string | Date) {
    const d = new Date(date);
    const now = new Date();
    const diff = now.getTime() - d.getTime();
    const hours = Math.floor(diff / (1000 * 60 * 60));
    if (hours < 1) return 'Just now';
    if (hours < 24) return `${hours} hours ago`;
    const days = Math.floor(hours / 24);
    if (days < 7) return `${days} days ago`;
    return d.toLocaleDateString();
}

export default function DashboardPage() {
    const { user } = useUser();
    const firstName = user?.firstName || 'Doctor';

    const { data, isLoading, error } = useDashboardStats();

    const stats = [
        { label: 'Total Active Clients', value: data?.stats.totalClients ?? '-', icon: Users },
        { label: 'Meals Awaiting Review', value: data?.stats.pendingReviews ?? '-', icon: Camera },
        { label: 'Average Client Adherence', value: data ? `${data.stats.adherencePercent}%` : '-', icon: TrendingUp, highlight: true },
        { label: 'Active Diet Plans', value: data?.stats.activeDietPlans ?? '-', icon: Calendar },
    ];

    const weeklyAdherence = data?.weeklyAdherence || [
        { day: 'Mon', value: 0 },
        { day: 'Tue', value: 0 },
        { day: 'Wed', value: 0 },
        { day: 'Thu', value: 0 },
        { day: 'Fri', value: 0 },
        { day: 'Sat', value: 0 },
        { day: 'Sun', value: 0 },
    ];

    const recentClients = data?.recentClients || [];
    const pendingReviews = data?.pendingReviews || [];

    return (
        <div className="space-y-6">
            {/* Header with Search */}
            <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                <div>
                    <h1 className="text-3xl font-bold tracking-tight text-gray-900">
                        Welcome back, {firstName}!
                    </h1>
                    <p className="text-gray-500 mt-1">Here&apos;s what&apos;s happening with your clients today.</p>
                </div>
                <div className="flex items-center gap-3">
                    <Link
                        href="/dashboard/clients"
                        className="flex items-center gap-2 h-10 px-4 bg-[#17cf54] hover:bg-[#17cf54]/90 text-[#0e1b12] rounded-lg text-sm font-bold transition-colors"
                    >
                        <Plus className="w-4 h-4" />
                        Add New Client
                    </Link>
                    <Link
                        href="/dashboard/diet-plans/new"
                        className="flex items-center gap-2 h-10 px-4 bg-white border border-gray-200 hover:bg-gray-50 text-gray-900 rounded-lg text-sm font-bold transition-colors"
                    >
                        <Plus className="w-4 h-4" />
                        Create Diet Plan
                    </Link>
                </div>
            </div>

            {/* Loading State */}
            {isLoading && (
                <div className="flex items-center justify-center py-12">
                    <Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" />
                </div>
            )}

            {/* Error State */}
            {error && (
                <div className="bg-red-50 border border-red-200 rounded-lg p-4 text-red-700">
                    Failed to load dashboard data. Please refresh.
                </div>
            )}

            {/* Stats Grid */}
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                {stats.map((stat, i) => (
                    <div
                        key={i}
                        className="flex flex-col gap-2 rounded-xl border border-gray-200 bg-white p-6"
                    >
                        <div className="flex items-center gap-3">
                            <div className="p-2 rounded-lg bg-[#17cf54]/10">
                                <stat.icon className="w-5 h-5 text-[#17cf54]" />
                            </div>
                            <p className="text-sm font-medium text-gray-600">{stat.label}</p>
                        </div>
                        <p className={`text-3xl font-bold ${stat.highlight ? 'text-[#17cf54]' : 'text-gray-900'}`}>
                            {stat.value}
                        </p>
                    </div>
                ))}
            </div>

            {/* Chart and Activity */}
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                {/* Weekly Adherence Chart */}
                <div className="lg:col-span-2 rounded-xl border border-gray-200 bg-white p-6">
                    <h3 className="mb-6 text-lg font-semibold text-gray-900">Weekly Adherence Overview</h3>
                    <div className="flex h-64 items-end justify-between gap-4">
                        {weeklyAdherence.map((day, i) => (
                            <div key={i} className="flex h-full flex-1 flex-col-reverse items-center gap-2">
                                <p className="text-xs text-gray-500">{day.day}</p>
                                <div className="w-full rounded bg-[#17cf54]/20" style={{ height: `${Math.max(day.value, 5)}%` }}>
                                    <div
                                        className="h-full w-full rounded bg-[#17cf54] transition-all duration-300 hover:opacity-80"
                                    />
                                </div>
                            </div>
                        ))}
                    </div>
                </div>

                {/* Pending Reviews */}
                <div className="rounded-xl border border-gray-200 bg-white">
                    <div className="flex items-center justify-between p-4 border-b border-gray-100">
                        <h3 className="font-semibold text-gray-900">Pending Reviews</h3>
                        <Link href="/dashboard/reviews" className="text-sm text-[#17cf54] hover:underline font-medium">
                            View all
                        </Link>
                    </div>
                    <div className="divide-y divide-gray-100">
                        {pendingReviews.length === 0 ? (
                            <div className="p-4 text-center text-gray-500 text-sm">
                                No pending reviews
                            </div>
                        ) : (
                            pendingReviews.map((review) => (
                                <Link
                                    key={review.id}
                                    href={`/dashboard/reviews`}
                                    className="flex items-center justify-between p-4 hover:bg-gray-50 transition-colors"
                                >
                                    <div className="flex items-center gap-3">
                                        <div className="w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center">
                                            <Camera className="w-5 h-5 text-orange-600" />
                                        </div>
                                        <div>
                                            <p className="font-medium text-gray-900">{review.client}</p>
                                            <p className="text-sm text-gray-500">{review.meal} • {review.time}</p>
                                        </div>
                                    </div>
                                    <ChevronRight className="w-4 h-4 text-gray-400" />
                                </Link>
                            ))
                        )}
                    </div>
                </div>
            </div>

            {/* Recent Clients */}
            <div className="rounded-xl border border-gray-200 bg-white">
                <div className="flex items-center justify-between p-4 border-b border-gray-100">
                    <h3 className="font-semibold text-gray-900">Recent Clients</h3>
                    <Link href="/dashboard/clients" className="text-sm text-[#17cf54] hover:underline font-medium">
                        View all
                    </Link>
                </div>
                <div className="divide-y divide-gray-100">
                    {recentClients.length === 0 ? (
                        <div className="p-4 text-center text-gray-500 text-sm">
                            No clients yet. Add your first client!
                        </div>
                    ) : (
                        recentClients.map((client) => (
                            <Link
                                key={client.id}
                                href={`/dashboard/clients/${client.id}`}
                                className="flex items-center justify-between p-4 hover:bg-gray-50 transition-colors"
                            >
                                <div className="flex items-center gap-3">
                                    <div className="w-10 h-10 rounded-full bg-[#17cf54]/20 flex items-center justify-center text-[#17cf54] font-bold">
                                        {client.avatar}
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <span className="font-medium text-gray-900">{client.name}</span>
                                        {client.status === 'at-risk' && (
                                            <span className="w-2 h-2 rounded-full bg-orange-500" />
                                        )}
                                        {client.status === 'new' && (
                                            <span className="px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded-full">New</span>
                                        )}
                                    </div>
                                </div>
                                <div className="flex items-center gap-3 text-gray-500">
                                    <span className="text-sm">{formatTimeAgo(client.lastActivity)}</span>
                                    <ChevronRight className="w-4 h-4" />
                                </div>
                            </Link>
                        ))
                    )}
                </div>
            </div>
        </div>
    );
}
</file>

<file path="frontend/src/app/join/page.tsx">
'use client';

import { Suspense, useEffect } from 'react';
import { useSearchParams, useRouter } from 'next/navigation';
import { useValidateInvite, useAcceptInvite } from '@/lib/hooks/use-team';
import { useUser, SignInButton } from '@clerk/nextjs';
import { Loader2, CheckCircle, AlertCircle, Building2 } from 'lucide-react';
import { toast } from 'sonner';

function JoinContent() {
    const searchParams = useSearchParams();
    const router = useRouter();
    const token = searchParams.get('token');
    const { user, isLoaded } = useUser();

    // Data Fetching
    const { data: invite, isLoading, error } = useValidateInvite(token || '');
    const acceptMutation = useAcceptInvite();

    const handleJoin = async () => {
        if (!token) return;
        try {
            await acceptMutation.mutateAsync(token);
            toast.success('Successfully joined the team!');
            router.push('/dashboard');
        } catch (err: any) {
            toast.error(err.response?.data?.message || 'Failed to join team');
        }
    };

    if (!token) {
        return (
            <div className="flex flex-col items-center justify-center min-h-[50vh] text-center p-6">
                <AlertCircle className="w-12 h-12 text-red-500 mb-4" />
                <h2 className="text-xl font-bold text-gray-900">Invalid Link</h2>
                <p className="text-gray-500 mt-2">This invitation link is missing a token.</p>
            </div>
        );
    }

    if (isLoading || !isLoaded) {
        return (
            <div className="flex flex-col items-center justify-center min-h-[50vh]">
                <Loader2 className="w-8 h-8 animate-spin text-[#17cf54] mb-4" />
                <p className="text-gray-500">Verifying invitation...</p>
            </div>
        );
    }

    if (error) {
        return (
            <div className="flex flex-col items-center justify-center min-h-[50vh] text-center p-6">
                <AlertCircle className="w-12 h-12 text-red-500 mb-4" />
                <h2 className="text-xl font-bold text-gray-900">Invitation Expired or Invalid</h2>
                <p className="text-gray-500 mt-2">This link may have already been used or has expired.</p>
            </div>
        );
    }

    return (
        <div className="max-w-md mx-auto mt-20 p-6 bg-white rounded-2xl shadow-xl border border-gray-100">
            <div className="text-center mb-8">
                <div className="w-16 h-16 bg-[#17cf54]/10 rounded-full flex items-center justify-center mx-auto mb-4">
                    <Building2 className="w-8 h-8 text-[#17cf54]" />
                </div>
                <h1 className="text-2xl font-bold text-gray-900">Join Team</h1>
                <p className="text-gray-500 mt-2">
                    You have been invited to join <strong>{invite?.orgName}</strong> as a <strong>{invite?.role}</strong>.
                </p>
            </div>

            <div className="space-y-6">
                {!user ? (
                    <div className="space-y-4">
                        <div className="p-4 bg-amber-50 rounded-lg text-amber-800 text-sm border border-amber-200">
                            You need to be logged in to accept this invitation.
                        </div>
                        <SignInButton mode="modal" forceRedirectUrl={`/join?token=${token}`}>
                            <button className="w-full py-3 px-4 bg-[#17cf54] hover:bg-[#17cf54]/90 text-white font-bold rounded-xl transition-all shadow-lg shadow-green-500/20">
                                Sign In / Sign Up to Join
                            </button>
                        </SignInButton>
                    </div>
                ) : (
                    <div className="space-y-4">
                        <div className="flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-100">
                            <div className="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold">
                                {user.firstName?.charAt(0)}
                            </div>
                            <div className="flex-1 min-w-0">
                                <p className="text-sm font-medium text-gray-900 truncate">
                                    Logged in as {user.fullName || user.username}
                                </p>
                                <p className="text-xs text-gray-500 truncate">
                                    {user.primaryEmailAddress?.emailAddress}
                                </p>
                            </div>
                        </div>

                        <button
                            onClick={handleJoin}
                            disabled={acceptMutation.isPending}
                            className="w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#17cf54] hover:bg-[#17cf54]/90 text-white font-bold rounded-xl transition-all shadow-lg shadow-green-500/20 disabled:opacity-50"
                        >
                            {acceptMutation.isPending && <Loader2 className="w-4 h-4 animate-spin" />}
                            Join Organization
                        </button>
                    </div>
                )}
            </div>
        </div>
    );
}

export default function JoinPage() {
    return (
        <Suspense fallback={<div>Loading...</div>}>
            <JoinContent />
        </Suspense>
    );
}
</file>

<file path="frontend/src/app/sign-in/[[...sign-in]]/page.tsx">
import { SignIn } from '@clerk/nextjs';

export default function SignInPage() {
    return (
        <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-emerald-50 to-teal-100">
            <div className="w-full max-w-md">
                <div className="text-center mb-8">
                    <h1 className="text-3xl font-bold text-emerald-800">DietConnect</h1>
                    <p className="text-gray-600 mt-2">Sign in to your account</p>
                </div>
                <SignIn
                    appearance={{
                        elements: {
                            formButtonPrimary: 'bg-emerald-600 hover:bg-emerald-700',
                            card: 'shadow-xl',
                        }
                    }}
                />
            </div>
        </div>
    );
}
</file>

<file path="frontend/src/app/sign-up/[[...sign-up]]/page.tsx">
import { SignUp } from '@clerk/nextjs';

export default function SignUpPage() {
    return (
        <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-emerald-50 to-teal-100">
            <div className="w-full max-w-md">
                <div className="text-center mb-8">
                    <h1 className="text-3xl font-bold text-emerald-800">DietConnect</h1>
                    <p className="text-gray-600 mt-2">Create your account</p>
                </div>
                <SignUp
                    appearance={{
                        elements: {
                            formButtonPrimary: 'bg-emerald-600 hover:bg-emerald-700',
                            card: 'shadow-xl',
                        }
                    }}
                />
            </div>
        </div>
    );
}
</file>

<file path="frontend/src/app/globals.css">
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --background: #ffffff;
  --foreground: #171717;
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

body {
  color: var(--foreground);
  background: var(--background);
  font-family: Arial, Helvetica, sans-serif;
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}
</file>

<file path="frontend/src/app/layout.tsx">
import type { Metadata } from "next";
import localFont from "next/font/local";
import "./globals.css";
import { ClerkProvider } from "@clerk/nextjs";
import { Providers } from "./providers";

const geistSans = localFont({
  src: "./fonts/GeistVF.woff",
  variable: "--font-geist-sans",
  weight: "100 900",
});
const geistMono = localFont({
  src: "./fonts/GeistMonoVF.woff",
  variable: "--font-geist-mono",
  weight: "100 900",
});

export const metadata: Metadata = {
  title: "DietConnect - Nutrition Practice Management",
  description: "Professional diet planning and client management for dietitians",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <ClerkProvider>
      <html lang="en">
        <body
          className={`${geistSans.variable} ${geistMono.variable} antialiased`}
        >
          <Providers>{children}</Providers>
        </body>
      </html>
    </ClerkProvider>
  );
}
</file>

<file path="frontend/src/app/page.tsx">
import { auth } from '@clerk/nextjs/server';
import { redirect } from 'next/navigation';
import Link from 'next/link';
import {
  Leaf,
  UtensilsCrossed,
  Users,
  BarChart3,
  Calendar,
  Shield,
  Smartphone,
  ArrowRight,
  Quote,
  CheckCircle,
  Menu,
} from 'lucide-react';

const features = [
  {
    icon: UtensilsCrossed,
    title: 'Smart Meal Planning',
    description: 'AI-assisted drag-and-drop diet creation. Create balanced plans in seconds, not hours.',
  },
  {
    icon: Users,
    title: 'Client Portal',
    description: 'Secure direct messaging, document sharing, and progress tracking for your clients.',
  },
  {
    icon: BarChart3,
    title: 'Data Analytics',
    description: 'Visualize health trends, weight changes, and adherence rates instantly with beautiful charts.',
  },
  {
    icon: Calendar,
    title: 'Scheduling & Booking',
    description: 'Integrated calendar that syncs with Google and Outlook. Reduce no-shows with automated reminders.',
  },
  {
    icon: Shield,
    title: 'Secure & Compliant',
    description: 'Enterprise-grade security keeps your patient data safe and compliant with regulations.',
  },
  {
    icon: Smartphone,
    title: 'Mobile Companion App',
    description: 'Give clients a dedicated app to log meals, view plans, and stay connected on the go.',
  },
];

const testimonials = [
  {
    quote: "Diet Karo cut my administrative time in half. The meal planning tool is intuitive and my clients love the mobile app. It's a game changer.",
    name: 'Dr. Priya Sharma',
    role: 'Clinical Dietician',
    avatar: 'PS',
  },
  {
    quote: "Finally, a dashboard that looks good and works even better. The analytics feature helps me show tangible progress to my patients.",
    name: 'Rahul Verma',
    role: 'Sports Nutritionist',
    avatar: 'RV',
  },
  {
    quote: "The automated compliance features give me peace of mind. I can manage more clients without feeling overwhelmed. Highly recommended.",
    name: 'Dr. Anjali Mehta',
    role: 'Private Practice Owner',
    avatar: 'AM',
  },
];

const stats = [
  { value: '10k+', label: 'Professionals' },
  { value: '2M+', label: 'Meal Plans Created' },
  { value: '98%', label: 'Customer Satisfaction' },
];

export default async function HomePage() {
  const { userId } = await auth();

  // If user is logged in, redirect to dashboard
  if (userId) {
    redirect('/dashboard');
  }

  return (
    <div className="min-h-screen bg-[#f6f8f6] text-[#0e1b12] font-sans antialiased overflow-x-hidden">
      {/* Navigation */}
      <nav className="sticky top-0 z-50 w-full border-b border-[#e7f3eb] bg-[#f6f8f6]/80 backdrop-blur-md">
        <div className="max-w-7xl mx-auto px-4 sm:px-10 py-3">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="flex items-center justify-center w-8 h-8 rounded-lg bg-[#17cf54]/20 text-[#17cf54]">
                <Leaf className="w-5 h-5" />
              </div>
              <span className="text-lg font-bold tracking-tight">Diet Karo</span>
            </div>
            <div className="hidden md:flex items-center gap-8">
              <a href="#features" className="text-sm font-medium hover:text-[#17cf54] transition-colors">Features</a>
              <a href="#pricing" className="text-sm font-medium hover:text-[#17cf54] transition-colors">Pricing</a>
              <a href="#about" className="text-sm font-medium hover:text-[#17cf54] transition-colors">About</a>
            </div>
            <div className="hidden md:flex items-center gap-2">
              <Link
                href="/sign-in"
                className="px-4 py-2 text-sm font-bold hover:bg-black/5 rounded-lg transition-colors"
              >
                Login
              </Link>
              <Link
                href="/sign-up"
                className="px-4 py-2 text-sm font-bold bg-[#17cf54] hover:bg-[#17cf54]/90 text-[#0e1b12] rounded-lg shadow-sm shadow-[#17cf54]/20 transition-colors"
              >
                Get Started
              </Link>
            </div>
            <button className="md:hidden p-2">
              <Menu className="w-6 h-6" />
            </button>
          </div>
        </div>
      </nav>

      {/* Hero Section */}
      <div className="relative w-full">
        <div className="absolute top-0 right-0 -z-10 w-1/2 h-full bg-gradient-to-l from-[#17cf54]/5 to-transparent" />
        <div className="max-w-7xl mx-auto px-4 md:px-10 lg:px-20 py-16 lg:py-24">
          <div className="flex flex-col lg:flex-row items-center gap-12 lg:gap-16">
            {/* Hero Content */}
            <div className="flex flex-col gap-6 flex-1 text-center lg:text-left">
              <div className="inline-flex items-center gap-2 self-center lg:self-start px-3 py-1 rounded-full bg-[#17cf54]/10 border border-[#17cf54]/20 text-xs font-bold text-[#17cf54] uppercase tracking-wide">
                <span className="w-2 h-2 rounded-full bg-[#17cf54] animate-pulse" />
                New: AI Meal Planning
              </div>
              <h1 className="text-4xl sm:text-5xl lg:text-6xl font-black leading-tight tracking-tight">
                Empower Your Practice with{' '}
                <span className="text-[#17cf54]">Intelligent</span> Nutrition.
              </h1>
              <p className="text-lg text-[#0e1b12]/70 max-w-2xl mx-auto lg:mx-0">
                Streamline client tracking, automate meal plans, and visualize patient progress in one secure dashboard tailored for modern dieticians.
              </p>
              <div className="flex flex-wrap gap-3 justify-center lg:justify-start">
                <Link
                  href="/sign-up"
                  className="flex items-center justify-center gap-2 min-w-[140px] h-12 px-6 bg-[#17cf54] hover:bg-[#17cf54]/90 text-[#0e1b12] text-base font-bold rounded-lg shadow-lg shadow-[#17cf54]/25 transition-all"
                >
                  Start Free Trial
                  <ArrowRight className="w-4 h-4" />
                </Link>
                <Link
                  href="/sign-in"
                  className="flex items-center justify-center min-w-[140px] h-12 px-6 bg-white border border-[#e7f3eb] hover:bg-[#f0fdf4] text-base font-bold rounded-lg transition-all"
                >
                  Book a Demo
                </Link>
              </div>
              <div className="flex items-center justify-center lg:justify-start gap-4 pt-2">
                <div className="flex -space-x-2">
                  {['PS', 'RK', 'AM'].map((initials, i) => (
                    <div
                      key={i}
                      className="w-8 h-8 rounded-full bg-[#17cf54]/20 border-2 border-white flex items-center justify-center text-xs font-bold text-[#17cf54]"
                    >
                      {initials}
                    </div>
                  ))}
                  <div className="w-8 h-8 rounded-full bg-[#17cf54] text-[#0e1b12] text-[10px] font-bold border-2 border-white flex items-center justify-center">
                    +2k
                  </div>
                </div>
                <p className="text-sm font-medium text-[#0e1b12]/60">Professionals trust us</p>
              </div>
            </div>

            {/* Hero Image */}
            <div className="w-full lg:w-1/2 flex justify-center lg:justify-end relative">
              <div className="absolute -inset-4 bg-[#17cf54]/20 blur-3xl rounded-full opacity-30" />
              <div className="relative w-full aspect-[4/3] rounded-xl overflow-hidden shadow-2xl border border-black/5 bg-white">
                <div className="w-full h-full bg-gradient-to-br from-[#f0fdf4] to-[#e7f3eb] flex items-center justify-center">
                  <div className="text-center p-8">
                    <div className="w-24 h-24 mx-auto bg-[#17cf54]/10 rounded-2xl flex items-center justify-center mb-4">
                      <UtensilsCrossed className="w-12 h-12 text-[#17cf54]" />
                    </div>
                    <h3 className="text-xl font-bold text-[#0e1b12]">Diet Dashboard</h3>
                    <p className="text-sm text-[#0e1b12]/60 mt-2">Analytics • Plans • Progress</p>
                  </div>
                </div>
                {/* Floating notification */}
                <div className="absolute bottom-6 left-6 p-4 bg-white rounded-lg shadow-lg border border-[#17cf54]/10 flex items-center gap-3">
                  <div className="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-[#17cf54]">
                    <CheckCircle className="w-5 h-5" />
                  </div>
                  <div>
                    <p className="text-xs text-[#0e1b12]/50 font-medium">Daily Goal</p>
                    <p className="text-sm font-bold text-[#0e1b12]">Meal Plan Added</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      {/* Features Section */}
      <div id="features" className="w-full bg-white py-20">
        <div className="max-w-7xl mx-auto px-4 md:px-10">
          <div className="text-center mb-12">
            <span className="text-[#17cf54] font-bold tracking-wider text-sm uppercase mb-2 block">
              Core Features
            </span>
            <h2 className="text-3xl md:text-4xl font-bold tracking-tight">
              Everything you need to run a modern clinic
            </h2>
            <p className="mt-4 text-[#0e1b12]/60 max-w-2xl mx-auto">
              Focus on your patients while we handle the administration, planning, and tracking.
            </p>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {features.map((feature, i) => (
              <div
                key={i}
                className="group flex flex-col gap-4 rounded-xl border border-[#d0e7d7] bg-[#f6f8f6] p-6 transition-all hover:shadow-lg hover:border-[#17cf54]/50"
              >
                <div className="w-12 h-12 rounded-lg bg-[#17cf54]/10 flex items-center justify-center text-[#17cf54] group-hover:bg-[#17cf54] group-hover:text-[#0e1b12] transition-colors">
                  <feature.icon className="w-6 h-6" />
                </div>
                <div>
                  <h3 className="text-xl font-bold">{feature.title}</h3>
                  <p className="text-[#4e9767] text-sm leading-relaxed mt-2">
                    {feature.description}
                  </p>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>

      {/* Stats Section */}
      <div className="w-full bg-[#17cf54]/5 border-y border-[#17cf54]/10 py-12">
        <div className="max-w-7xl mx-auto px-4 sm:px-10">
          <div className="flex flex-wrap justify-around items-center gap-8 text-center">
            {stats.map((stat, i) => (
              <div key={i} className="flex flex-col gap-1">
                <span className="text-4xl font-black tracking-tight">{stat.value}</span>
                <span className="text-sm font-medium text-[#4e9767] uppercase tracking-wider">
                  {stat.label}
                </span>
              </div>
            ))}
          </div>
        </div>
      </div>

      {/* Testimonials Section */}
      <div className="w-full py-20 bg-[#f6f8f6]">
        <div className="max-w-7xl mx-auto px-4 md:px-10">
          <div className="text-center mb-16">
            <h2 className="text-3xl font-bold tracking-tight">
              Trusted by Top Nutritionists
            </h2>
          </div>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
            {testimonials.map((testimonial, i) => (
              <div
                key={i}
                className="flex flex-col justify-between p-8 bg-white rounded-2xl shadow-sm border border-[#e7f3eb]"
              >
                <div className="mb-6 text-[#17cf54]">
                  <Quote className="w-10 h-10" />
                </div>
                <p className="text-lg font-medium leading-relaxed mb-8">
                  &ldquo;{testimonial.quote}&rdquo;
                </p>
                <div className="flex items-center gap-4">
                  <div className="w-12 h-12 rounded-full bg-[#17cf54]/20 flex items-center justify-center text-[#17cf54] font-bold">
                    {testimonial.avatar}
                  </div>
                  <div>
                    <h4 className="font-bold">{testimonial.name}</h4>
                    <p className="text-sm text-[#4e9767]">{testimonial.role}</p>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>

      {/* CTA Section */}
      <div className="py-20 px-4">
        <div className="max-w-7xl mx-auto bg-[#0e1b12] rounded-3xl overflow-hidden relative">
          <div
            className="absolute inset-0 opacity-20"
            style={{
              backgroundImage: 'radial-gradient(#17cf54 1px, transparent 1px)',
              backgroundSize: '30px 30px',
            }}
          />
          <div className="relative z-10 flex flex-col md:flex-row items-center justify-between p-10 md:p-16 gap-10">
            <div className="flex flex-col gap-6 max-w-2xl">
              <h2 className="text-3xl md:text-5xl font-bold text-white leading-tight">
                Ready to modernize your practice?
              </h2>
              <p className="text-white/80 text-lg">
                Join thousands of health professionals using Diet Karo to deliver better care.
              </p>
              <div className="flex flex-col sm:flex-row gap-4 pt-4">
                <Link
                  href="/sign-up"
                  className="flex items-center justify-center rounded-lg h-12 px-8 bg-[#17cf54] hover:bg-[#17cf54]/90 text-[#0e1b12] text-base font-bold shadow-lg shadow-[#17cf54]/30 transition-all"
                >
                  Get Started Now
                </Link>
                <Link
                  href="/sign-in"
                  className="flex items-center justify-center rounded-lg h-12 px-8 bg-white/10 hover:bg-white/20 text-white text-base font-bold border border-white/20 transition-all"
                >
                  Contact Sales
                </Link>
              </div>
            </div>
            <div className="hidden lg:block relative">
              <div className="w-64 h-64 bg-[#17cf54]/20 rounded-full blur-3xl absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2" />
              <Leaf className="w-48 h-48 text-[#17cf54]/30 rotate-12" />
            </div>
          </div>
        </div>
      </div>

      {/* Footer */}
      <footer className="bg-white border-t border-[#e7f3eb] pt-16 pb-8">
        <div className="max-w-7xl mx-auto px-4 sm:px-10">
          <div className="grid grid-cols-2 md:grid-cols-4 gap-10 mb-16">
            {/* Brand */}
            <div className="col-span-2 md:col-span-1 flex flex-col gap-6">
              <div className="flex items-center gap-2">
                <div className="w-6 h-6 rounded bg-[#17cf54]/20 text-[#17cf54] flex items-center justify-center">
                  <Leaf className="w-4 h-4" />
                </div>
                <span className="font-bold text-lg">Diet Karo</span>
              </div>
              <p className="text-sm text-[#0e1b12]/60">
                The all-in-one platform for nutrition professionals to manage clients, plans, and progress.
              </p>
            </div>
            {/* Links */}
            <div className="flex flex-col gap-4">
              <h4 className="font-bold">Product</h4>
              <a href="#" className="text-sm text-[#0e1b12]/60 hover:text-[#17cf54] transition-colors">Features</a>
              <a href="#" className="text-sm text-[#0e1b12]/60 hover:text-[#17cf54] transition-colors">Pricing</a>
              <a href="#" className="text-sm text-[#0e1b12]/60 hover:text-[#17cf54] transition-colors">Case Studies</a>
            </div>
            <div className="flex flex-col gap-4">
              <h4 className="font-bold">Company</h4>
              <a href="#" className="text-sm text-[#0e1b12]/60 hover:text-[#17cf54] transition-colors">About</a>
              <a href="#" className="text-sm text-[#0e1b12]/60 hover:text-[#17cf54] transition-colors">Careers</a>
              <a href="#" className="text-sm text-[#0e1b12]/60 hover:text-[#17cf54] transition-colors">Contact</a>
            </div>
            <div className="flex flex-col gap-4">
              <h4 className="font-bold">Legal</h4>
              <a href="#" className="text-sm text-[#0e1b12]/60 hover:text-[#17cf54] transition-colors">Privacy Policy</a>
              <a href="#" className="text-sm text-[#0e1b12]/60 hover:text-[#17cf54] transition-colors">Terms of Service</a>
              <a href="#" className="text-sm text-[#0e1b12]/60 hover:text-[#17cf54] transition-colors">Cookie Policy</a>
            </div>
          </div>
          <div className="border-t border-[#e7f3eb] pt-8 text-center">
            <p className="text-sm text-[#0e1b12]/40">
              © 2025 Diet Karo. All rights reserved.
            </p>
          </div>
        </div>
      </footer>
    </div>
  );
}
</file>

<file path="frontend/src/app/providers.tsx">
'use client';

import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { useState } from 'react';

export function Providers({ children }: { children: React.ReactNode }) {
    const [queryClient] = useState(
        () =>
            new QueryClient({
                defaultOptions: {
                    queries: {
                        staleTime: 60 * 1000, // 1 minute
                        refetchOnWindowFocus: false,
                    },
                },
            })
    );

    return (
        <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>
    );
}
</file>

<file path="frontend/src/components/modals/add-client-modal.tsx">
'use client';

import { useState } from 'react';
import { Modal } from '@/components/ui/modal';
import { User, Phone, Mail, Calendar, Target, AlertCircle } from 'lucide-react';

interface AddClientModalProps {
    isOpen: boolean;
    onClose: () => void;
    onSubmit?: (data: ClientFormData) => void;
}

interface ClientFormData {
    name: string;
    email: string;
    phone: string;
    dateOfBirth: string;
    gender: string;
    height: string;
    weight: string;
    targetWeight: string;
    allergies: string;
    medicalConditions: string;
}

export function AddClientModal({ isOpen, onClose, onSubmit }: AddClientModalProps) {
    const [formData, setFormData] = useState<ClientFormData>({
        name: '',
        email: '',
        phone: '',
        dateOfBirth: '',
        gender: '',
        height: '',
        weight: '',
        targetWeight: '',
        allergies: '',
        medicalConditions: '',
    });

    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {
        setFormData({ ...formData, [e.target.name]: e.target.value });
    };

    const handleSubmit = (e: React.FormEvent) => {
        e.preventDefault();
        onSubmit?.(formData);
        onClose();
    };

    return (
        <Modal isOpen={isOpen} onClose={onClose} title="Add New Client" size="lg">
            <form onSubmit={handleSubmit} className="p-6 space-y-6">
                {/* Basic Info */}
                <div className="space-y-4">
                    <h3 className="text-sm font-semibold text-gray-900 uppercase tracking-wider">
                        Basic Information
                    </h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Full Name *
                            </label>
                            <div className="relative">
                                <User className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                                <input
                                    type="text"
                                    name="name"
                                    required
                                    value={formData.name}
                                    onChange={handleChange}
                                    className="w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                    placeholder="Enter full name"
                                />
                            </div>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Email Address *
                            </label>
                            <div className="relative">
                                <Mail className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                                <input
                                    type="email"
                                    name="email"
                                    required
                                    value={formData.email}
                                    onChange={handleChange}
                                    className="w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                    placeholder="email@example.com"
                                />
                            </div>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Phone Number *
                            </label>
                            <div className="relative">
                                <Phone className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                                <input
                                    type="tel"
                                    name="phone"
                                    required
                                    value={formData.phone}
                                    onChange={handleChange}
                                    className="w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                    placeholder="+91 98765 43210"
                                />
                            </div>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Date of Birth *
                            </label>
                            <div className="relative">
                                <Calendar className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                                <input
                                    type="date"
                                    name="dateOfBirth"
                                    required
                                    value={formData.dateOfBirth}
                                    onChange={handleChange}
                                    className="w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                />
                            </div>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Gender *
                            </label>
                            <select
                                name="gender"
                                required
                                value={formData.gender}
                                onChange={handleChange}
                                className="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                            >
                                <option value="">Select gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>
                </div>

                {/* Physical Info */}
                <div className="space-y-4">
                    <h3 className="text-sm font-semibold text-gray-900 uppercase tracking-wider">
                        Physical Information
                    </h3>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Height (cm) *
                            </label>
                            <input
                                type="number"
                                name="height"
                                required
                                value={formData.height}
                                onChange={handleChange}
                                className="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                placeholder="165"
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Current Weight (kg) *
                            </label>
                            <input
                                type="number"
                                name="weight"
                                required
                                value={formData.weight}
                                onChange={handleChange}
                                className="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                placeholder="70"
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Target Weight (kg)
                            </label>
                            <div className="relative">
                                <Target className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                                <input
                                    type="number"
                                    name="targetWeight"
                                    value={formData.targetWeight}
                                    onChange={handleChange}
                                    className="w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                    placeholder="65"
                                />
                            </div>
                        </div>
                    </div>
                </div>

                {/* Medical Info */}
                <div className="space-y-4">
                    <h3 className="text-sm font-semibold text-gray-900 uppercase tracking-wider flex items-center gap-2">
                        <AlertCircle className="w-4 h-4 text-orange-500" />
                        Medical Information
                    </h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Allergies
                            </label>
                            <textarea
                                name="allergies"
                                value={formData.allergies}
                                onChange={handleChange}
                                rows={3}
                                className="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                placeholder="Dairy, Peanuts, Shellfish..."
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Medical Conditions
                            </label>
                            <textarea
                                name="medicalConditions"
                                value={formData.medicalConditions}
                                onChange={handleChange}
                                rows={3}
                                className="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                                placeholder="Diabetes, Hypertension..."
                            />
                        </div>
                    </div>
                </div>

                {/* Actions */}
                <div className="flex justify-end gap-3 pt-4 border-t border-gray-200">
                    <button
                        type="button"
                        onClick={onClose}
                        className="px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"
                    >
                        Cancel
                    </button>
                    <button
                        type="submit"
                        className="px-4 py-2.5 text-sm font-bold text-white bg-[#17cf54] rounded-lg hover:bg-[#17cf54]/90 transition-colors"
                    >
                        Add Client
                    </button>
                </div>
            </form>
        </Modal>
    );
}
</file>

<file path="frontend/src/components/modals/add-food-modal.tsx">
'use client';

import { useState, useEffect } from 'react';
import { Modal } from '@/components/ui/modal';
import { Search, Plus, Loader2 } from 'lucide-react';
import { useFoodItems, FoodItem as ApiFoodItem } from '@/lib/hooks/use-food-items';
import { CreateFoodItemModal } from './create-food-item-modal';

interface AddFoodModalProps {
    isOpen: boolean;
    onClose: () => void;
    mealType?: string;
    onAddFood?: (food: LocalFoodItem) => void;
}

// Local interface for the callback, aligning with what the builder expects
interface LocalFoodItem {
    id: string;
    name: string;
    type: 'food' | 'meal' | 'template';
    calories: number;
    protein: number;
    carbs: number;
    fat: number;
    description?: string;
}

const typeColors = {
    food: 'text-purple-600 bg-purple-100',
    meal: 'text-blue-600 bg-blue-100',
    template: 'text-[#17cf54] bg-[#17cf54]/10',
};

export function AddFoodModal({ isOpen, onClose, mealType = 'Breakfast', onAddFood }: AddFoodModalProps) {
    const [search, setSearch] = useState('');
    const [debouncedSearch, setDebouncedSearch] = useState('');
    const [showCreateModal, setShowCreateModal] = useState(false);

    // Debounce search
    useEffect(() => {
        const timer = setTimeout(() => {
            setDebouncedSearch(search);
        }, 500);
        return () => clearTimeout(timer);
    }, [search]);

    const { data, isLoading } = useFoodItems({
        q: debouncedSearch,
        pageSize: 20
    });

    const foodItems = data?.data || [];

    return (
        <>
            <Modal isOpen={isOpen} onClose={onClose} title={`Add to ${mealType}`} size="xl">
                {/* Search and Actions */}
                <div className="p-4 border-b border-gray-100 flex gap-4">
                    <div className="relative flex-grow">
                        <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                        <input
                            type="text"
                            value={search}
                            onChange={(e) => setSearch(e.target.value)}
                            className="w-full pl-10 pr-4 py-2.5 text-sm border border-gray-200 rounded-lg bg-gray-50 focus:ring-[#17cf54] focus:border-[#17cf54] text-gray-900"
                            placeholder="Search food database..."
                            autoFocus
                        />
                    </div>
                    <button
                        onClick={() => setShowCreateModal(true)}
                        className="flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors flex-shrink-0"
                    >
                        <Plus className="w-4 h-4" />
                        Create New
                    </button>
                </div>

                {/* Food Grid */}
                <div className="p-4 max-h-[400px] overflow-y-auto">
                    {isLoading ? (
                        <div className="flex justify-center py-8">
                            <Loader2 className="w-8 h-8 animate-spin text-[#17cf54]" />
                        </div>
                    ) : foodItems.length === 0 ? (
                        <div className="text-center py-8 text-gray-500">
                            {search ? (
                                <div className="space-y-2">
                                    <p>No foods found matching &quot;{search}&quot;.</p>
                                    <button
                                        onClick={() => setShowCreateModal(true)}
                                        className="text-[#17cf54] font-medium hover:underline"
                                    >
                                        Create a new food item
                                    </button>
                                </div>
                            ) : (
                                'Start typing to search foods.'
                            )}
                        </div>
                    ) : (
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            {foodItems.map((food: ApiFoodItem) => (
                                <div
                                    key={food.id}
                                    className="border border-gray-200 rounded-lg p-4 flex flex-col hover:border-[#17cf54] cursor-pointer transition-colors group"
                                    onClick={() => onAddFood?.({
                                        id: food.id,
                                        name: food.name,
                                        type: 'food',
                                        calories: food.nutrition.calories,
                                        protein: food.nutrition.proteinG || 0,
                                        carbs: food.nutrition.carbsG || 0,
                                        fat: food.nutrition.fatsG || 0,
                                        description: `${food.servingSize} • ${food.nutrition.calories} kcal`
                                    })}
                                >
                                    <div className="flex justify-between items-start mb-2">
                                        <div className="min-w-0">
                                            <p className="font-semibold text-gray-900 truncate" title={food.name}>{food.name}</p>
                                            <span className={`text-xs px-2 py-0.5 rounded-full ${typeColors.food}`}>
                                                Food Item
                                            </span>
                                        </div>
                                        <div className="p-1 text-gray-300 group-hover:text-[#17cf54] transition-colors">
                                            <Plus className="w-5 h-5" />
                                        </div>
                                    </div>
                                    <p className="text-sm text-gray-500 mb-3 flex-grow truncate">{food.category} • {food.servingSize}</p>
                                    <div className="text-xs text-gray-500 flex justify-between items-center bg-gray-50 p-2 rounded">
                                        <span className="font-medium">{food.nutrition.calories} Kcal</span>
                                        <div className="flex gap-2">
                                            <span>P:{food.nutrition.proteinG || 0}</span>
                                            <span>C:{food.nutrition.carbsG || 0}</span>
                                            <span>F:{food.nutrition.fatsG || 0}</span>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>

                {/* Footer */}
                <div className="p-4 border-t border-gray-200 flex justify-end gap-3">
                    <button
                        onClick={onClose}
                        className="px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"
                    >
                        Close
                    </button>
                </div>
            </Modal>

            <CreateFoodItemModal
                isOpen={showCreateModal}
                onClose={() => setShowCreateModal(false)}
            />
        </>
    );
}
</file>

<file path="frontend/src/components/modals/create-food-item-modal.tsx">
'use client';

import { useState, useEffect } from 'react';
import { Modal } from '@/components/ui/modal';
import { useCreateFoodItem, useUpdateFoodItem, CreateFoodItemInput, FoodItem } from '@/lib/hooks/use-food-items';
import { Loader2 } from 'lucide-react';
import { toast } from 'sonner';

interface CreateFoodItemModalProps {
    isOpen: boolean;
    onClose: () => void;
    initialData?: FoodItem;
}

const CATEGORIES = ['Grains', 'Proteins', 'Vegetables', 'Fruits', 'Dairy', 'Beverages', 'Snacks', 'Other'];

export function CreateFoodItemModal({ isOpen, onClose, initialData }: CreateFoodItemModalProps) {
    const createMutation = useCreateFoodItem();
    const updateMutation = useUpdateFoodItem();
    const isEditing = !!initialData;

    const [formData, setFormData] = useState<CreateFoodItemInput>({
        name: '',
        brand: '',
        category: 'Grains',
        servingSizeG: 100,
        calories: 0,
        proteinG: 0,
        carbsG: 0,
        fatsG: 0,
        fiberG: 0,
        dietaryTags: [],
        allergenFlags: []
    });

    // Populate form when initialData changes
    useEffect(() => {
        if (initialData) {
            setFormData({
                name: initialData.name,
                brand: initialData.brand || '',
                category: initialData.category,
                servingSizeG: parseFloat(initialData.servingSize) || 100, // Assuming servingSize comes as "100 g"
                calories: initialData.nutrition.calories,
                proteinG: initialData.nutrition.proteinG || 0,
                carbsG: initialData.nutrition.carbsG || 0,
                fatsG: initialData.nutrition.fatsG || 0,
                fiberG: initialData.nutrition.fiberG || 0,
                dietaryTags: initialData.dietaryTags,
                allergenFlags: initialData.allergenFlags
            });
        } else {
            // Reset if opening in create mode
            setFormData({
                name: '',
                brand: '',
                category: 'Grains',
                servingSizeG: 100,
                calories: 0,
                proteinG: 0,
                carbsG: 0,
                fatsG: 0,
                fiberG: 0,
                dietaryTags: [],
                allergenFlags: []
            });
        }
    }, [initialData, isOpen]);

    const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();
        try {
            if (isEditing && initialData) {
                await updateMutation.mutateAsync({ id: initialData.id, ...formData });
                toast.success('Food item updated successfully');
            } else {
                await createMutation.mutateAsync(formData);
                toast.success('Food item created successfully');
            }
            onClose();
        } catch (error) {
            toast.error(isEditing ? 'Failed to update food item' : 'Failed to create food item');
        }
    };

    const updateField = (field: keyof CreateFoodItemInput, value: string) => {
        const numValue = parseFloat(value) || 0;
        setFormData(prev => ({
            ...prev,
            [field]: numValue
        }));
    };

    return (
        <Modal isOpen={isOpen} onClose={onClose} title={isEditing ? "Edit Food Item" : "Add New Food Item"}>
            <form onSubmit={handleSubmit} className="space-y-6 p-1">
                <div className="grid grid-cols-2 gap-6">
                    <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Name</label>
                        <input
                            required
                            type="text"
                            value={formData.name}
                            onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}
                            className="w-full px-4 py-2.5 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#17cf54]/20 focus:border-[#17cf54] transition-all outline-none text-gray-900 placeholder:text-gray-400"
                            placeholder="e.g., Brown Rice"
                        />
                    </div>
                    <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Brand <span className="text-gray-400 font-normal">(Optional)</span></label>
                        <input
                            type="text"
                            value={formData.brand}
                            onChange={(e) => setFormData(prev => ({ ...prev, brand: e.target.value }))}
                            className="w-full px-4 py-2.5 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#17cf54]/20 focus:border-[#17cf54] transition-all outline-none text-gray-900 placeholder:text-gray-400"
                            placeholder="e.g., Nature's Best"
                        />
                    </div>
                </div>

                <div className="grid grid-cols-2 gap-6">
                    <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Category</label>
                        <div className="relative">
                            <select
                                value={formData.category}
                                onChange={(e) => setFormData(prev => ({ ...prev, category: e.target.value }))}
                                className="w-full px-4 py-2.5 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#17cf54]/20 focus:border-[#17cf54] transition-all outline-none text-gray-900 appearance-none cursor-pointer"
                            >
                                {CATEGORIES.map(c => <option key={c} value={c}>{c}</option>)}
                            </select>
                            <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400">
                                ▼
                            </div>
                        </div>
                    </div>
                    <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Serving Size (g)</label>
                        <div className="relative">
                            <input
                                required
                                type="number"
                                min="1"
                                value={formData.servingSizeG}
                                onChange={(e) => updateField('servingSizeG', e.target.value)}
                                className="w-full px-4 py-2.5 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#17cf54]/20 focus:border-[#17cf54] transition-all outline-none text-gray-900 placeholder:text-gray-400"
                                placeholder="100"
                            />
                            <span className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 text-sm">g</span>
                        </div>
                    </div>
                </div>

                <div className="border border-gray-100 p-5 rounded-xl bg-gray-50/50">
                    <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
                        <span className="w-1 h-4 bg-[#17cf54] rounded-full"></span>
                        Nutrition per serving
                    </h4>
                    <div className="grid grid-cols-3 sm:grid-cols-5 gap-4">
                        <div className="bg-white p-3 rounded-lg border border-gray-100 shadow-sm">
                            <label className="block text-xs font-semibold text-gray-500 mb-1.5 uppercase tracking-wide">Calories</label>
                            <input
                                type="number"
                                min="0"
                                value={formData.calories}
                                onChange={(e) => updateField('calories', e.target.value)}
                                className="w-full p-0 border-none focus:ring-0 text-lg font-bold text-gray-900 placeholder:text-gray-300 bg-transparent"
                                placeholder="0"
                            />
                        </div>
                        <div className="bg-white p-3 rounded-lg border border-gray-100 shadow-sm">
                            <label className="block text-xs font-semibold text-gray-500 mb-1.5 uppercase tracking-wide">Protein</label>
                            <div className="flex items-baseline gap-1">
                                <input
                                    type="number"
                                    min="0"
                                    step="0.1"
                                    value={formData.proteinG}
                                    onChange={(e) => updateField('proteinG', e.target.value)}
                                    className="w-full p-0 border-none focus:ring-0 text-lg font-bold text-gray-900 placeholder:text-gray-300 bg-transparent"
                                    placeholder="0"
                                />
                                <span className="text-xs text-gray-400">g</span>
                            </div>
                        </div>
                        <div className="bg-white p-3 rounded-lg border border-gray-100 shadow-sm">
                            <label className="block text-xs font-semibold text-gray-500 mb-1.5 uppercase tracking-wide">Carbs</label>
                            <div className="flex items-baseline gap-1">
                                <input
                                    type="number"
                                    min="0"
                                    step="0.1"
                                    value={formData.carbsG}
                                    onChange={(e) => updateField('carbsG', e.target.value)}
                                    className="w-full p-0 border-none focus:ring-0 text-lg font-bold text-gray-900 placeholder:text-gray-300 bg-transparent"
                                    placeholder="0"
                                />
                                <span className="text-xs text-gray-400">g</span>
                            </div>
                        </div>
                        <div className="bg-white p-3 rounded-lg border border-gray-100 shadow-sm">
                            <label className="block text-xs font-semibold text-gray-500 mb-1.5 uppercase tracking-wide">Fat</label>
                            <div className="flex items-baseline gap-1">
                                <input
                                    type="number"
                                    min="0"
                                    step="0.1"
                                    value={formData.fatsG}
                                    onChange={(e) => updateField('fatsG', e.target.value)}
                                    className="w-full p-0 border-none focus:ring-0 text-lg font-bold text-gray-900 placeholder:text-gray-300 bg-transparent"
                                    placeholder="0"
                                />
                                <span className="text-xs text-gray-400">g</span>
                            </div>
                        </div>
                        <div className="bg-white p-3 rounded-lg border border-gray-100 shadow-sm">
                            <label className="block text-xs font-semibold text-gray-500 mb-1.5 uppercase tracking-wide">Fiber</label>
                            <div className="flex items-baseline gap-1">
                                <input
                                    type="number"
                                    min="0"
                                    step="0.1"
                                    value={formData.fiberG}
                                    onChange={(e) => updateField('fiberG', e.target.value)}
                                    className="w-full p-0 border-none focus:ring-0 text-lg font-bold text-gray-900 placeholder:text-gray-300 bg-transparent"
                                    placeholder="0"
                                />
                                <span className="text-xs text-gray-400">g</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div className="flex justify-end pt-4 gap-3 border-t border-gray-100 mt-6">
                    <button
                        type="button"
                        onClick={onClose}
                        className="px-5 py-2.5 text-sm font-semibold text-gray-700 bg-white border border-gray-200 rounded-xl hover:bg-gray-50 hover:text-gray-900 transition-colors"
                    >
                        Cancel
                    </button>
                    <button
                        type="submit"
                        disabled={createMutation.isPending || updateMutation.isPending}
                        className="flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-[#17cf54] hover:bg-[#17cf54]/90 rounded-xl shadow-lg shadow-green-500/20 transition-all disabled:opacity-50 disabled:shadow-none"
                    >
                        {(createMutation.isPending || updateMutation.isPending) && <Loader2 className="w-4 h-4 animate-spin" />}
                        {isEditing ? 'Update Food Item' : 'Create Food Item'}
                    </button>
                </div>
            </form>
        </Modal>
    );
}
</file>

<file path="frontend/src/components/modals/invite-member-modal.tsx">
'use client';

import { useState } from 'react';
import { Modal } from '@/components/ui/modal';
import { useInviteMember } from '@/lib/hooks/use-team';
import { Loader2, Mail, Link as LinkIcon, Check, Copy } from 'lucide-react';
import { toast } from 'sonner';

interface InviteMemberModalProps {
    isOpen: boolean;
    onClose: () => void;
}

export function InviteMemberModal({ isOpen, onClose }: InviteMemberModalProps) {
    const inviteMutation = useInviteMember();

    const [email, setEmail] = useState('');
    const [role, setRole] = useState('dietitian');
    const [inviteLink, setInviteLink] = useState<string | null>(null);
    const [copied, setCopied] = useState(false);

    const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();
        try {
            const data = await inviteMutation.mutateAsync({ email, role });
            // content.data.inviteLink contains the real link from backend, but let's use window.location.origin to be safe about ports
            const token = data.invitation.token;
            const link = `${window.location.origin}/join?token=${token}`;
            setInviteLink(link);
            toast.success('Invitation generated! Share the link.');
        } catch (error) {
            toast.error('Failed to generate invitation');
        }
    };

    const copyToClipboard = () => {
        if (inviteLink) {
            navigator.clipboard.writeText(inviteLink);
            setCopied(true);
            setTimeout(() => setCopied(false), 2000);
            toast.success('Link copied to clipboard');
        }
    };

    const handleClose = () => {
        setInviteLink(null);
        setEmail('');
        setRole('dietitian');
        onClose();
    };

    return (
        <Modal isOpen={isOpen} onClose={handleClose} title="Invite Team Member" size="md">
            {!inviteLink ? (
                <form onSubmit={handleSubmit} className="space-y-4 p-4">
                    <p className="text-sm text-gray-500">
                        Send an invitation to a new team member. They will receive an email (simulated) or you can copy the link.
                    </p>

                    <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
                        <div className="relative">
                            <Mail className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" />
                            <input
                                required
                                type="email"
                                value={email}
                                onChange={(e) => setEmail(e.target.value)}
                                className="w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                                placeholder="colleague@example.com"
                            />
                        </div>
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Role</label>
                        <select
                            value={role}
                            onChange={(e) => setRole(e.target.value)}
                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                        >
                            <option value="admin">Admin</option>
                            <option value="dietitian">Dietitian</option>
                        </select>
                    </div>

                    <div className="flex justify-end pt-2 gap-2">
                        <button
                            type="button"
                            onClick={handleClose}
                            className="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50"
                        >
                            Cancel
                        </button>
                        <button
                            type="submit"
                            disabled={inviteMutation.isPending}
                            className="flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-emerald-600 rounded-lg hover:bg-emerald-700 disabled:opacity-50"
                        >
                            {inviteMutation.isPending && <Loader2 className="w-4 h-4 animate-spin" />}
                            Generate Invite
                        </button>
                    </div>
                </form>
            ) : (
                <div className="p-6 space-y-4">
                    <div className="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto text-green-600">
                        <Check className="w-6 h-6" />
                    </div>
                    <div className="text-center">
                        <h3 className="text-lg font-medium text-gray-900">Invitation Ready!</h3>
                        <p className="text-sm text-gray-500 mt-1">
                            Share this link with <strong>{email}</strong> to join the team.
                        </p>
                    </div>

                    <div className="flex gap-2">
                        <input
                            readOnly
                            value={inviteLink}
                            className="flex-grow bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm text-gray-600 font-mono"
                        />
                        <button
                            onClick={copyToClipboard}
                            className="flex items-center gap-2 px-3 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors"
                        >
                            {copied ? <Check className="w-4 h-4" /> : <Copy className="w-4 h-4" />}
                        </button>
                    </div>

                    <button
                        onClick={handleClose}
                        className="w-full py-2 text-sm font-medium text-gray-600 hover:text-gray-900"
                    >
                        Close
                    </button>
                </div>
            )}
        </Modal>
    );
}
</file>

<file path="frontend/src/components/ui/modal.tsx">
'use client';

import { useEffect, useRef } from 'react';
import { X } from 'lucide-react';
import { cn } from '@/lib/utils';

interface ModalProps {
    isOpen: boolean;
    onClose: () => void;
    title?: string;
    size?: 'sm' | 'md' | 'lg' | 'xl' | 'full';
    children: React.ReactNode;
    showCloseButton?: boolean;
}

const sizeClasses = {
    sm: 'max-w-md',
    md: 'max-w-lg',
    lg: 'max-w-2xl',
    xl: 'max-w-4xl',
    full: 'max-w-6xl',
};

export function Modal({
    isOpen,
    onClose,
    title,
    size = 'md',
    children,
    showCloseButton = true,
}: ModalProps) {
    const overlayRef = useRef<HTMLDivElement>(null);

    // Close on escape key
    useEffect(() => {
        const handleEscape = (e: KeyboardEvent) => {
            if (e.key === 'Escape') onClose();
        };
        if (isOpen) {
            document.addEventListener('keydown', handleEscape);
            document.body.style.overflow = 'hidden';
        }
        return () => {
            document.removeEventListener('keydown', handleEscape);
            document.body.style.overflow = 'unset';
        };
    }, [isOpen, onClose]);

    if (!isOpen) return null;

    return (
        <div
            ref={overlayRef}
            className="fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"
            onClick={(e) => {
                if (e.target === overlayRef.current) onClose();
            }}
        >
            <div
                className={cn(
                    'bg-white rounded-xl shadow-2xl w-full flex flex-col max-h-[90vh] overflow-hidden animate-in fade-in zoom-in-95 duration-200',
                    sizeClasses[size]
                )}
            >
                {/* Header */}
                {(title || showCloseButton) && (
                    <header className="flex items-center justify-between p-4 border-b border-gray-200 flex-shrink-0">
                        {title && (
                            <h2 className="text-lg font-semibold text-gray-900">{title}</h2>
                        )}
                        {showCloseButton && (
                            <button
                                onClick={onClose}
                                className="p-2 rounded-full hover:bg-gray-100 text-gray-500 hover:text-gray-700 transition-colors ml-auto"
                            >
                                <X className="w-5 h-5" />
                            </button>
                        )}
                    </header>
                )}

                {/* Content */}
                <div className="flex-1 overflow-y-auto">{children}</div>
            </div>
        </div>
    );
}
</file>

<file path="frontend/src/lib/api/client.ts">
import axios, { AxiosError, AxiosInstance } from 'axios';

const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';

// Create axios instance
export const api: AxiosInstance = axios.create({
    baseURL: `${API_URL}/api/v1`,
    headers: {
        'Content-Type': 'application/json',
    },
});

// Request interceptor to add auth token
api.interceptors.request.use(
    async (config) => {
        // Token will be added by the useApiClient hook on the client side
        return config;
    },
    (error) => Promise.reject(error)
);

// Response interceptor for error handling
api.interceptors.response.use(
    (response) => response,
    (error: AxiosError) => {
        const message =
            (error.response?.data as { error?: { message?: string } })?.error?.message ||
            error.message ||
            'An unexpected error occurred';

        console.error('API Error:', message);
        return Promise.reject(error);
    }
);

// API Types
export interface ApiResponse<T> {
    success: boolean;
    data: T;
    meta?: {
        page: number;
        pageSize: number;
        total: number;
        totalPages: number;
    };
}

export interface ApiError {
    success: false;
    error: {
        code: string;
        message: string;
        details?: Record<string, unknown>;
    };
}

export default api;
</file>

<file path="frontend/src/lib/api/use-api-client.ts">
'use client';

import { useAuth } from '@clerk/nextjs';
import { useMemo } from 'react';
import axios, { AxiosInstance } from 'axios';

const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';

export function useApiClient(): AxiosInstance {
    const { getToken } = useAuth();

    const client = useMemo(() => {
        const instance = axios.create({
            baseURL: `${API_URL}/api/v1`,
            headers: {
                'Content-Type': 'application/json',
            },
        });

        // Add auth token to every request
        instance.interceptors.request.use(async (config) => {
            try {
                const token = await getToken();
                if (token) {
                    config.headers.Authorization = `Bearer ${token}`;
                }
            } catch (error) {
                console.error('Error getting auth token:', error);
            }
            return config;
        });

        // Handle response errors
        instance.interceptors.response.use(
            (response) => response,
            (error) => {
                const message =
                    error.response?.data?.error?.message ||
                    error.message ||
                    'An unexpected error occurred';
                console.error('API Error:', message);
                return Promise.reject(error);
            }
        );

        return instance;
    }, [getToken]);

    return client;
}
</file>

<file path="frontend/src/lib/hooks/use-clients.ts">
'use client';

import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useApiClient } from '../api/use-api-client';

// Types
export interface Client {
    id: string;
    fullName: string;
    email: string;
    phone: string;
    dateOfBirth?: string;
    gender?: 'male' | 'female' | 'other';
    currentWeightKg?: number;
    targetWeightKg?: number;
    heightCm?: number;
    isActive: boolean;
    status?: 'active' | 'at-risk' | 'completed';
    createdAt: string;
    updatedAt: string;
    lastActivityAt?: string;
    primaryDietitian?: {
        id: string;
        fullName: string;
    };
    medicalProfile?: {
        allergies: string[];
        conditions: string[];
        medications: string[];
    };
}

export interface ClientProgress {
    weight: {
        startWeight: number | null;
        currentWeight: number | null;
        targetWeight: number | null;
        totalChange: number | null;
        weeklyAvgChange: number | null;
        progressToGoal: number | null;
    };
    meals: {
        total: number;
        eaten: number;
        substituted: number;
        skipped: number;
        pending: number;
        adherencePercentage: number;
        completionPercentage: number;
    };
    activeDietPlans: number;
}

interface PaginatedResponse<T> {
    success: boolean;
    data: T[];
    meta: {
        page: number;
        pageSize: number;
        total: number;
        totalPages: number;
        hasNextPage?: boolean;
        hasPreviousPage?: boolean;
    };
}

interface ClientsParams {
    page?: number;
    pageSize?: number;
    search?: string;
    status?: string;
}

// Hooks
export function useClients(params: ClientsParams = {}) {
    const api = useApiClient();
    const { page = 1, pageSize = 20, search, status } = params;

    return useQuery({
        queryKey: ['clients', page, pageSize, search, status],
        queryFn: async () => {
            const { data } = await api.get<PaginatedResponse<Client>>('/clients', {
                params: { page, pageSize, search, status },
            });
            return data;
        },
    });
}

export function useClient(id: string) {
    const api = useApiClient();

    return useQuery({
        queryKey: ['clients', id],
        queryFn: async () => {
            const { data } = await api.get(`/clients/${id}`);
            return data.data as Client;
        },
        enabled: !!id,
    });
}

export function useClientProgress(clientId: string, params?: { dateFrom?: string; dateTo?: string }) {
    const api = useApiClient();

    return useQuery({
        queryKey: ['clients', clientId, 'progress', params],
        queryFn: async () => {
            const { data } = await api.get(`/clients/${clientId}/progress`, { params });
            return data.data as ClientProgress;
        },
        enabled: !!clientId,
    });
}

export function useCreateClient() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async (clientData: Partial<Client>) => {
            const { data } = await api.post('/clients', clientData);
            return data.data;
        },
        onSuccess: () => {
            queryClient.invalidateQueries({ queryKey: ['clients'] });
        },
    });
}

export function useUpdateClient() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async ({ id, ...clientData }: Partial<Client> & { id: string }) => {
            const { data } = await api.patch(`/clients/${id}`, clientData);
            return data.data;
        },
        onSuccess: (_, variables) => {
            queryClient.invalidateQueries({ queryKey: ['clients'] });
            queryClient.invalidateQueries({ queryKey: ['clients', variables.id] });
        },
    });
}
</file>

<file path="frontend/src/lib/hooks/use-dashboard.ts">
'use client';

import { useQuery } from '@tanstack/react-query';
import { useApiClient } from '../api/use-api-client';

export interface DashboardStats {
    stats: {
        totalClients: number;
        pendingReviews: number;
        activeDietPlans: number;
        adherencePercent: number;
    };
    weeklyAdherence: { day: string; value: number }[];
    recentClients: {
        id: string;
        name: string;
        avatar: string;
        status: string;
        lastActivity: string;
    }[];
    pendingReviews: {
        id: string;
        client: string;
        meal: string;
        time: string;
    }[];
}

export function useDashboardStats() {
    const api = useApiClient();

    return useQuery({
        queryKey: ['dashboard', 'stats'],
        queryFn: async () => {
            const { data } = await api.get('/dashboard/stats');
            return data.data as DashboardStats;
        },
        staleTime: 30 * 1000, // Refresh every 30 seconds
    });
}
</file>

<file path="frontend/src/lib/hooks/use-diet-plans.ts">
'use client';

import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useApiClient } from '../api/use-api-client';

// Types
export interface Meal {
    id: string;
    name: string;
    mealType: 'breakfast' | 'lunch' | 'dinner' | 'snack';
    scheduledTime: string;
    foods: MealFoodItem[];
}

export interface MealFoodItem {
    id: string;
    foodItem: {
        id: string;
        name: string;
        caloriesPer100g: number;
        proteinPer100g: number;
        carbsPer100g: number;
        fatsPer100g: number;
    };
    quantityG: number;
}

export interface DietPlan {
    id: string;
    clientId?: string; // Optional for templates
    name?: string; // Backend returns name
    title?: string; // Keep for backwards compatibility
    description?: string;
    startDate: string;
    endDate?: string;
    status?: string;
    isPublished?: boolean;
    isTemplate?: boolean;
    templateCategory?: string;
    publishedAt?: string;
    targetCalories?: number;
    targetProteinG?: number;
    targetCarbsG?: number;
    targetFatsG?: number;
    createdAt: string;
    updatedAt: string;
    client?: {
        id: string;
        fullName: string;
    };
    meals?: Meal[];
}

interface PaginatedResponse<T> {
    success: boolean;
    data: T[];
    meta: {
        page: number;
        pageSize: number;
        total: number;
        totalPages: number;
    };
}

interface DietPlansParams {
    page?: number;
    pageSize?: number;
    clientId?: string;
    isPublished?: boolean;
    isTemplate?: boolean;
}

export interface CreateDietPlanInput {
    clientId?: string; // Optional for templates
    title: string; // 'name' in backend schema mapped to 'title'
    description?: string;
    startDate: string;
    endDate?: string;
    targetCalories?: number;
    targetProteinG?: number;
    targetCarbsG?: number;
    targetFatsG?: number;
    notesForClient?: string;
    internalNotes?: string;
    meals?: {
        dayIndex?: number;
        mealDate?: string;
        mealType: string;
        timeOfDay?: string;
        title: string;
        description?: string;
        instructions?: string;
        foodItems?: {
            foodId: string;
            quantity: number;
            notes?: string;
        }[];
    }[];
    options?: {
        saveAsTemplate?: boolean;
        templateCategory?: string;
    };
}

// Hooks
export function useDietPlans(params: DietPlansParams = {}) {
    const api = useApiClient();
    const { page = 1, pageSize = 20, clientId, isPublished, isTemplate } = params;

    return useQuery({
        queryKey: ['diet-plans', page, pageSize, clientId, isPublished, isTemplate],
        queryFn: async () => {
            const { data } = await api.get<PaginatedResponse<DietPlan>>('/diet-plans', {
                params: { page, pageSize, clientId, isTemplate },
            });
            return data;
        },
    });
}

export function useDietPlan(id: string) {
    const api = useApiClient();

    return useQuery({
        queryKey: ['diet-plans', id],
        queryFn: async () => {
            const { data } = await api.get(`/diet-plans/${id}`);
            return data.data as DietPlan;
        },
        enabled: !!id,
    });
}

export function useCreateDietPlan() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async (planData: CreateDietPlanInput) => {
            // Map 'title' to 'name' as expected by backend
            const { title, ...rest } = planData;
            const payload = { ...rest, name: title };
            const { data } = await api.post('/diet-plans', payload);
            return data.data;
        },
        onSuccess: () => {
            queryClient.invalidateQueries({ queryKey: ['diet-plans'] });
        },
    });
}

export function useUpdateDietPlan() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async ({ id, ...planData }: Partial<DietPlan> & { id: string }) => {
            const { data } = await api.patch(`/diet-plans/${id}`, planData);
            return data.data;
        },
        onSuccess: (_, variables) => {
            queryClient.invalidateQueries({ queryKey: ['diet-plans'] });
            queryClient.invalidateQueries({ queryKey: ['diet-plans', variables.id] });
        },
    });
}

export function usePublishDietPlan() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async (id: string) => {
            const { data } = await api.post(`/diet-plans/${id}/publish`);
            return data.data;
        },
        onSuccess: (_, id) => {
            queryClient.invalidateQueries({ queryKey: ['diet-plans'] });
            queryClient.invalidateQueries({ queryKey: ['diet-plans', id] });
        },
    });
}

interface AssignTemplateInput {
    templateId: string;
    clientId: string;
    startDate: string;
    name?: string;
}

export function useAssignTemplate() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async ({ templateId, clientId, startDate, name }: AssignTemplateInput) => {
            const { data } = await api.post(`/diet-plans/${templateId}/assign`, {
                clientId,
                startDate,
                name,
            });
            return data.data;
        },
        onSuccess: () => {
            queryClient.invalidateQueries({ queryKey: ['diet-plans'] });
        },
    });
}
</file>

<file path="frontend/src/lib/hooks/use-food-items.ts">
'use client';

import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useApiClient } from '../api/use-api-client';

// Types
export interface FoodItem {
    id: string;
    name: string;
    brand?: string;
    category: string;
    subCategory?: string;
    servingSize: string;
    isGlobal: boolean;
    isVerified: boolean;
    nutrition: {
        calories: number;
        proteinG: number | null;
        carbsG: number | null;
        fatsG: number | null;
        fiberG: number | null;
    };
    allergenFlags: string[];
    dietaryTags: string[];
    barcode?: string;
}

interface FoodItemsParams {
    page?: number;
    pageSize?: number;
    q?: string;
    category?: string;
}

// Hooks
export function useFoodItems(params: FoodItemsParams = {}) {
    const api = useApiClient();
    const { page = 1, pageSize = 50, q, category } = params;

    return useQuery({
        queryKey: ['food-items', page, pageSize, q, category],
        queryFn: async () => {
            const { data } = await api.get('/food-items', {
                params: { page, pageSize, q, category },
            });
            return data;
        },
    });
}

export function useFoodItem(id: string) {
    const api = useApiClient();

    return useQuery({
        queryKey: ['food-items', id],
        queryFn: async () => {
            const { data } = await api.get(`/food-items/${id}`);
            return data.data as FoodItem;
        },
        enabled: !!id,
    });
}

export interface CreateFoodItemInput {
    name: string;
    brand?: string;
    category: string;
    subCategory?: string;
    servingSizeG: number;
    calories: number;
    proteinG: number;
    carbsG: number;
    fatsG: number;
    fiberG?: number;
    dietaryTags?: string[];
    allergenFlags?: string[];
    nutrition?: never; // Ensure we don't accidentally use this
}

export function useCreateFoodItem() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async (foodData: CreateFoodItemInput) => {
            const { data } = await api.post('/food-items', foodData);
            return data.data;
        },
        onSuccess: () => {
            queryClient.invalidateQueries({ queryKey: ['food-items'] });
        }
    });
}

export type UpdateFoodItemInput = Partial<CreateFoodItemInput> & { id: string };

export function useUpdateFoodItem() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async (data: UpdateFoodItemInput) => {
            const { id, ...updateData } = data;
            const { data: response } = await api.patch(`/food-items/${id}`, updateData);
            return response.data;
        },
        onSuccess: () => {
            queryClient.invalidateQueries({ queryKey: ['food-items'] });
        }
    });
}
</file>

<file path="frontend/src/lib/hooks/use-meal-logs.ts">
'use client';

import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useApiClient } from '../api/use-api-client';

// Types
export interface MealLog {
    id: string;
    mealId: string;
    scheduledDate: string;
    scheduledTime: string;
    status: 'pending' | 'eaten' | 'skipped' | 'substituted';
    mealPhotoUrl?: string;
    mealPhotoSmallUrl?: string;
    clientNotes?: string;
    dietitianFeedback?: string;
    loggedAt?: string;
    createdAt: string;
    client: {
        id: string;
        fullName: string;
    };
    meal?: {
        id: string;
        name: string;
        mealType: string;
    };
    reviewedByUser?: {
        id: string;
        fullName: string;
    };
}

interface PaginatedResponse<T> {
    success: boolean;
    data: T[];
    meta: {
        page: number;
        pageSize: number;
        total: number;
        totalPages: number;
    };
}

interface MealLogsParams {
    page?: number;
    pageSize?: number;
    clientId?: string;
    status?: string;
    dateFrom?: string;
    dateTo?: string;
}

interface ReviewMealLogInput {
    status: 'eaten' | 'skipped' | 'substituted';
    dietitianFeedback?: string;
}

// Hooks
export function useMealLogs(params: MealLogsParams = {}) {
    const api = useApiClient();
    const { page = 1, pageSize = 20, clientId, status, dateFrom, dateTo } = params;

    return useQuery({
        queryKey: ['meal-logs', page, pageSize, clientId, status, dateFrom, dateTo],
        queryFn: async () => {
            const { data } = await api.get<PaginatedResponse<MealLog>>('/meal-logs', {
                params: { page, pageSize, clientId, status, dateFrom, dateTo },
            });
            return data;
        },
    });
}

export function useMealLog(id: string) {
    const api = useApiClient();

    return useQuery({
        queryKey: ['meal-logs', id],
        queryFn: async () => {
            const { data } = await api.get(`/meal-logs/${id}`);
            return data.data as MealLog;
        },
        enabled: !!id,
    });
}

export function useReviewMealLog() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async ({ id, ...reviewData }: ReviewMealLogInput & { id: string }) => {
            const { data } = await api.patch(`/meal-logs/${id}/review`, reviewData);
            return data.data;
        },
        onSuccess: (_, variables) => {
            queryClient.invalidateQueries({ queryKey: ['meal-logs'] });
            queryClient.invalidateQueries({ queryKey: ['meal-logs', variables.id] });
        },
    });
}

export function useUpdateMealLog() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async ({ id, ...updateData }: { id: string; status?: string; clientNotes?: string }) => {
            const { data } = await api.patch(`/meal-logs/${id}`, updateData);
            return data.data;
        },
        onSuccess: (_, variables) => {
            queryClient.invalidateQueries({ queryKey: ['meal-logs'] });
            queryClient.invalidateQueries({ queryKey: ['meal-logs', variables.id] });
        },
    });
}
</file>

<file path="frontend/src/lib/hooks/use-profile.ts">
'use client';

import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useApiClient } from '../api/use-api-client';

export interface UserProfile {
    id: string;
    email: string;
    fullName: string;
    phone?: string;
    profilePhotoUrl?: string;
    specialization?: string;
    bio?: string;
    role: string;
    organizationId: string;
    isActive: boolean;
    mfaEnabled: boolean;
    lastLoginAt?: string;
    createdAt: string;
    updatedAt: string;
}

export function useProfile() {
    const api = useApiClient();

    return useQuery({
        queryKey: ['auth', 'me'],
        queryFn: async () => {
            const { data } = await api.get('/auth/me');
            return data.data as UserProfile;
        },
    });
}

export function useUpdateProfile() {
    const api = useApiClient();
    const queryClient = useQueryClient();

    return useMutation({
        mutationFn: async (profileData: Partial<UserProfile>) => {
            const { data } = await api.patch('/auth/me', profileData);
            return data.data;
        },
        onSuccess: () => {
            queryClient.invalidateQueries({ queryKey: ['auth', 'me'] });
        },
    });
}
</file>

<file path="frontend/src/lib/hooks/use-team.ts">
'use client';

import { useQuery, useMutation } from '@tanstack/react-query';
import { useApiClient } from '../api/use-api-client';

export interface TeamMember {
    id: string;
    name: string;
    email: string;
    phone?: string;
    role: string;
    specialization?: string;
    profilePhotoUrl?: string;
    clientCount: number;
    avatar: string;
}

export interface InviteMemberInput {
    email: string;
    role: string;
}

export function useTeam() {
    const api = useApiClient();

    return useQuery({
        queryKey: ['team'],
        queryFn: async () => {
            const { data } = await api.get('/team');
            return data.data as TeamMember[];
        },
    });
}

export function useInviteMember() {
    const api = useApiClient();

    return useMutation({
        mutationFn: async (data: InviteMemberInput) => {
            const res = await api.post('/team/invite', data);
            return res.data.data;
        }
    });
}

export function useValidateInvite(token: string) {
    const api = useApiClient();

    return useQuery({
        queryKey: ['invitation', token],
        queryFn: async () => {
            const { data } = await api.get(`/team/invitation/${token}`);
            return data.data as { email: string; orgName: string; role: string };
        },
        enabled: !!token,
        retry: false
    });
}

export function useAcceptInvite() {
    const api = useApiClient();

    return useMutation({
        mutationFn: async (token: string) => {
            const res = await api.post('/team/join', { token });
            return res.data;
        }
    });
}
</file>

<file path="frontend/src/lib/utils.ts">
import { type ClassValue, clsx } from 'clsx';
import { twMerge } from 'tailwind-merge';

export function cn(...inputs: ClassValue[]) {
    return twMerge(clsx(inputs));
}
</file>

<file path="frontend/src/middleware.ts">
import { clerkMiddleware, createRouteMatcher } from '@clerk/nextjs/server';

const isProtectedRoute = createRouteMatcher(['/dashboard(.*)']);
const isPublicRoute = createRouteMatcher(['/join(.*)', '/sign-in(.*)', '/sign-up(.*)']);

export default clerkMiddleware(async (auth, request) => {
    if (isProtectedRoute(request)) {
        await auth.protect();
    }
});

export const config = {
    matcher: [
        // Skip Next.js internals and all static files
        '/((?!_next|[^?]*\\.(?:html?|css|js(?!on)|jpe?g|webp|png|gif|svg|ttf|woff2?|ico|csv|docx?|xlsx?|zip|webmanifest)).*)',
        // Always run for API routes
        '/(api|trpc)(.*)',
    ],
};
</file>

<file path="frontend/.env.local.example">
# Clerk Authentication
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_your-key-here
CLERK_SECRET_KEY=sk_test_your-key-here

# API
NEXT_PUBLIC_API_URL=http://localhost:3000

# Clerk Routes
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/dashboard
</file>

<file path="frontend/.eslintrc.json">
{
  "extends": ["next/core-web-vitals", "next/typescript"]
}
</file>

<file path="frontend/.gitignore">
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.js
.yarn/install-state.gz

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# local env files
.env*.local

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts

# clerk configuration (can include secrets)
/.clerk/
</file>

<file path="frontend/next.config.mjs">
/** @type {import('next').NextConfig} */
const nextConfig = {};

export default nextConfig;
</file>

<file path="frontend/package.json">
{
  "name": "frontend",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  },
  "dependencies": {
    "@clerk/nextjs": "^6.36.2",
    "@hookform/resolvers": "^5.2.2",
    "@tanstack/react-query": "^5.90.12",
    "axios": "^1.13.2",
    "clsx": "^2.1.1",
    "date-fns": "^4.1.0",
    "lucide-react": "^0.561.0",
    "next": "14.2.35",
    "next-themes": "^0.4.6",
    "react": "^18",
    "react-dom": "^18",
    "react-hook-form": "^7.68.0",
    "recharts": "^3.5.1",
    "tailwind-merge": "^3.4.0",
    "zod": "^4.1.13"
  },
  "devDependencies": {
    "@types/node": "^20",
    "@types/react": "^18",
    "@types/react-dom": "^18",
    "eslint": "^8",
    "eslint-config-next": "14.2.35",
    "postcss": "^8",
    "tailwindcss": "^3.4.1",
    "typescript": "^5"
  }
}
</file>

<file path="frontend/postcss.config.mjs">
/** @type {import('postcss-load-config').Config} */
const config = {
  plugins: {
    tailwindcss: {},
  },
};

export default config;
</file>

<file path="frontend/README.md">
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.
</file>

<file path="frontend/tailwind.config.ts">
import type { Config } from "tailwindcss";

const config: Config = {
  content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      colors: {
        background: "var(--background)",
        foreground: "var(--foreground)",
      },
    },
  },
  plugins: [],
};
export default config;
</file>

<file path="frontend/tsconfig.json">
{
  "compilerOptions": {
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
</file>

<file path="info.txt">
REF BY BNI/ gaurav kumar (10k-3mon)-given special discount------------------------(wife homemaker)--------AGE-47KG/  92KG/ BLOOD GROUP- B+VEG-------------------(son age-19yr bsc-son- Bengluru / 2nd-9th class)---------MEDICAL HISTORY--Nothing/ Bellyfat,  heart around pain----------(past history 92- 82 KG (3 time done/ diet in 3year )  8-10 kg-weight loss reduced with previous dietitian--------)1.5 yr. back) then 5-6month-maintained with himself----------------6:0AM- ?---------------Body measurements:-

Upper arm : 12.5
Chest : 45
Waist: 39.5
Stomach (around naval); 42
belly (2inch above naval): 41
belly (2inch below naval) 41
Hip: 41
Upper Thigh : 24 
Calf : 15 Inch-----------------------sat/ sun- early morning match-------------pure veg/ egg- (AVOID TUE/THURS)------------------------DISLIKES---------------------LIKES-egg roll //chaap roll--------------------------------------4/6/25----VIT D 23.18
HBA1C 6.3%
Hs CRP 4.1
VIT B12 155-----------------------------------------------------------
</file>

</files>
